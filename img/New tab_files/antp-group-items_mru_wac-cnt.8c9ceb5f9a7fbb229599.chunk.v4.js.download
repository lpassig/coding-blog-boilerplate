(window.officehome_antp_webpackJsonp=window.officehome_antp_webpackJsonp||[]).push([[0],{OWzB:function(e,t,i){"use strict";i.d(t,"a",(function(){return B}));var a=i("bb6g"),n=i("6UlS"),o=i("BaAg"),r=i("cgnd"),s=i("ZBli");class c{static hasNoInvalidCharacter(e,t){for(const i of t)if(-1!==e.indexOf(i))return!1;return!0}static hasNoDuplicates(e,t,i=!1){return i?c.hasNoDuplicatesCaseInsensitiveTrimmed(e,t):-1===t.indexOf(e)}static isNotStartingWithSpace(e){return!e||e&&" "!==e[0]}static isContainingLessThanLimitedCharacters(e,t){return e.length<=t}static isNotEmptyString(e){return null!=e&&e.length>0}static hasNoDuplicatesCaseInsensitiveTrimmed(e,t){for(const i of t)if(e.trim().toLowerCase()===i.trim().toLowerCase())return!1;return!0}}var l=i("hhzZ"),d=i("Brer"),p=i("Mlb/"),h=i("kpuN"),u=i("4/We"),m=i("/I02"),b=i("dFxn");let f=(()=>{class e{constructor(e){this.config=e.parse("createConfig")||{fluidCreateAbpEndpoint:void 0,fluidCreateNewEndpoint:void 0}}}return e.ɵprov=p.bc({factory:function(){return new e(p.cc(b.a))},token:e,providedIn:"root"}),e})();var v=i("hZW2"),g=i("EYcb"),k=i("DQbD"),w=i("TDzr"),N=i("lrJm");let C=(()=>{class e{constructor(){this._inputDialog=new n.a(null)}showInputDialog(e){this._inputDialog.next(e)}get inputDialog(){return this._inputDialog.asObservable()}}return e.ɵprov=p.bc({factory:function(){return new e},token:e,providedIn:"root"}),e})();var T=i("Bc8L"),y=i("PBJH"),F=i("Z0U4"),S=i("Dpxn"),E=i("p6gk"),A=i("v3sZ"),D=i("m+UP"),L=i("idgT"),I=i("TIi1"),O=i("EUVs"),x=i("BMb5"),P=i("hoyd");let B=(()=>{class e{constructor(e,t,i,a,r,s,c,l,d,p,h,u,m,b,f,v,g,k,w,N,C,T,y,F,S,E){this.accessTokenService=e,this.capabilitiesService=t,this.clientStartupConfigService=i,this.contextService=a,this.createConfigService=r,this.documentService=s,this.errorDialogService=c,this.fluidHostContext=l,this.formsService=d,this.globalErrorHandler=p,this.inputDialogService=h,this.instrumentationService=u,this.localAppLauncherService=m,this.locService=b,this.officeRouteService=f,this.oneDriveService=v,this.oneNoteGraphService=g,this.oneNoteConfigService=k,this.startupConfigService=w,this.swayService=N,this.templatesConfigService=C,this.urlLauncherService=T,this.wacContentService=y,this.windowService=F,this.workloadsService=S,this.vroomService=E;const A=this.capabilitiesService.capabilities;this.isPwa=A.pwaEnabled,this.fluidHostCreateEnabled=A.fluidHostEnabled&&A.fluidHostCreateEnabled,this.wacHostApps=A.wacHostApps,this.numCreatesPending=0,this.wacHostCreateNewEnabled=A.wacHostCreateNewEnabled,this.createLcidEnabled=this.templatesConfigService.config.createLcidEnabled,this.createConfig=this.createConfigService.config,this.createLinks=new n.a([]),this.enableFluidTenantAdminCreate().then(e=>{this.getUpdatedCreateLinks(e)}),this.createLinkCandidates=new Map;const D=A.createOneDriveDocApiEnabled;this.createLinkCandidates.set(o.b.Word,{title:b.CreateMenuLinkWordTitle,fileTypeName:b.CreateModalLinkWordTitle,appName:b.WordName,fileType:o.b.Word,newDocName:this.locService.NewWordDocumentFileName,fileExtension:"docx",workloadOnlineName:this.locService.WordName,spinnerColor:"#2b579a",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!A.startPageApps.has(o.b.Word),createDocAspxEnabled:A.createDocAspxWordEnabled,docAspxId:1}),this.createLinkCandidates.set(o.b.Excel,{title:b.CreateMenuLinkExcelTitle,fileTypeName:b.CreateModalLinkExcelTitleAlt,appName:b.ExcelName,fileType:o.b.Excel,newDocName:this.locService.NewExcelWorkbookFileName,fileExtension:"xlsx",workloadOnlineName:this.locService.ExcelName,spinnerColor:"#217346",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!A.startPageApps.has(o.b.Excel),createDocAspxEnabled:A.createDocAspxExcelEnabled,docAspxId:2}),this.createLinkCandidates.set(o.b.PowerPoint,{title:b.CreateMenuLinkPowerPointTitle,fileTypeName:b.CreateModalLinkPowerPointTitle,appName:b.PowerPointName,fileType:o.b.PowerPoint,newDocName:this.locService.NewPowerPointPresentationFileName,fileExtension:"pptx",workloadOnlineName:this.locService.PowerPointName,spinnerColor:"#B7472A",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!A.startPageApps.has(o.b.PowerPoint),createDocAspxEnabled:A.createDocAspxPowerPointEnabled,docAspxId:3}),this.createLinkCandidates.set(o.b.Sway,{title:b.CreateMenuLinkSwayTitle,fileTypeName:b.CreateModalLinkSwayTitle,appName:b.SwayName,fileType:o.b.Sway,workloadOnlineName:this.locService.MicrosoftSwayName,spinnerColor:"#008272",canCreateBlankDocument:A.swayCreateNewEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!A.startPageApps.has(o.b.Sway),createDocAspxEnabled:!1}),A.fluidSupportEnabled&&(A.fluidCreateNewEnabled&&this.createLinkCandidates.set(o.b.Fluid,{title:b.CreateMenuLinkFluidTitle,fileTypeName:b.CreateModalLinkFluidTitle,appName:b.FluidName,fileType:o.b.Fluid,canCreateBlankDocument:A.fluidHostCreateEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1}),A.fluidCreateAbpEnabled&&this.createLinkCandidates.set(o.b.FluidActivityBlueprint,{title:b.CreateMenuLinkFluidAbpTitle,fileTypeName:b.CreateModalLinkFluidAbpTitle,appName:b.FluidName,fileType:o.b.FluidActivityBlueprint,canCreateBlankDocument:A.fluidHostCreateEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1})),A.formsEnabled&&(this.createLinkCandidates.set(o.b.Forms,{appName:b.FormsName,title:b.CreateMenuLinkFormsTitle,fileTypeName:b.CreateModalLinkFormsTitle,workloadOnlineName:b.FormsName,fileType:o.b.Forms,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,spinnerColor:"#008272"}),this.createLinkCandidates.set(o.b.FormsQuiz,{appName:b.FormsName,title:b.CreateMenuLinkFormsQuizTitle,fileTypeName:b.CreateModalLinkFormsQuizTitle,workloadOnlineName:b.FormsName,fileType:o.b.FormsQuiz,canCreateBlankDocument:!0,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:!1,spinnerColor:"#008272"})),A.startPageApps.has(o.b.OneNote)&&this.oneNoteConfigService.config.enableOneNoteApis&&this.createLinkCandidates.set(o.b.OneNote,{title:b.CreateMenuLinkOneNoteTitle,fileTypeName:b.CreateModalLinkOneNoteTitle,appName:b.OneNoteName,fileType:o.b.OneNote,workloadOnlineName:this.locService.OneNoteName,spinnerColor:"#7719AA",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!0,canFallbackToLandingPage:!1,createDocAspxEnabled:!1}),A.startPageApps.has(o.b.Visio)?this.createLinkCandidates.set(o.b.Visio,{title:b.CreateMenuLinkVisioTitle,fileTypeName:b.CreateModalLinkVisioTitle,appName:b.VisioName,fileType:o.b.Visio,newDocName:this.locService.NewVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:this.locService.VisioName,spinnerColor:"#3955A3",canCreateBlankDocument:D,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!1,createDocAspxEnabled:A.createDocAspxVisioEnabled,docAspxId:8}):A.createVisioEnabled&&this.createLinkCandidates.set(o.b.Visio,{title:b.CreateMenuLinkVisioTitle,fileTypeName:b.CreateModalLinkVisioTitle,appName:b.VisioName,fileType:o.b.Visio,newDocName:this.locService.NewVisioDrawingFileName,fileExtension:"vsdx",workloadOnlineName:this.locService.VisioName,spinnerColor:"#3955A3",canCreateBlankDocument:D&&A.createDocAspxVisioEnabled,canOpenBlankDocInNativeApp:!1,canFallbackToLandingPage:!0,createDocAspxEnabled:A.createDocAspxVisioEnabled,docAspxId:8}),A.createDocumentSupported&&(A.createDocAspxWordEnabled||A.createDocAspxExcelEnabled||A.createDocAspxPowerPointEnabled)&&this.accessTokenService.getAccessToken("OneDrive")}ngOnDestroy(){this.createLinks.complete()}getCreateLinks(){return 0===this.createLinks.value.length&&this.workloadsService.getProvisionedWorkloads().then(t=>{t=t||[];const i=[];e.menuOrdering.forEach(e=>{let a=void 0;if(a=t.find(t=>t.FileType===e||e===o.b.FormsQuiz&&t.FileType===o.b.Forms),a){const t=this.getCreateLinkForWorkload(a,e===o.b.FormsQuiz?o.b.FormsQuiz:null);t&&i.push(t)}}),this.createLinks.next(i)}).catch(e=>{this.createLinks.error(e)}),this.createLinks}createItem(e,t,i,a,n="",r,s){const d=this.createLinkCandidates.get(e);if(!d)return a&&a({type:"Error",latency:0}),Promise.resolve();const p=()=>{const p=this.shouldOpenInUIHost(e,null==i?void 0:i.AssetId);return new Promise(h=>{const u=s||this.getNewDocLinkTarget(e),m=e=>{a&&a(e),h("CreatePending"===e.type)};if("_self"===u&&this.numCreatesPending>0)m({type:"CreatePending",latency:-1});else if(this.numCreatesPending++,d.canCreateBlankDocument){const s=Date.now(),m=this.windowService.nativeWindow;let b;const f=o=>{if(d.createDocAspxEnabled&&!p){const c=this.getDocAspxApiUrl(d.docAspxId,this.getOriginParam(!0,!!i),s,i?i.AssetId:null,n),l=this.accessTokenService.getAccessToken("OneDrive");Promise.all([c,l]).then(n=>{const c=n[0],l=n[1];if(!l||!l.success)return void this.requestNewItem(d,e,s,t,b,h,a,o,i,r);let p;b&&b!==m?(b.document.write("<!doctype html> <html> <head> </head> <body> </body> </html> "),p=b.document):p=this.documentService.nativeDocument;const u=this.getDocaspxFormHtml(c,l.token);this.documentService.appendHTMLToElement(p.body,u);const f=p.getElementById("create-new-doc-form");if(f){const e=Date.now()-s;a&&a({type:"GoToBlankDocInstant",latency:e,platform:"Web"}),f.submit(),h()}else this.requestNewItem(d,e,s,t,b,h,a,o,i,r)}).catch(()=>{this.requestNewItem(d,e,s,t,b,h,a,o,i,r)})}else this.requestNewItem(d,e,s,t,b,h,a,o,i,r)},v={NativeWindow:()=>{b=m},Blank:()=>{b=m.open("","_blank"),this.newTabWindow=b}},g=this.isPwa||p||"_blank"!==u||this.fluidHostCreateEnabled?v.NativeWindow:v.Blank;switch(e){case o.b.OneNote:const t=this.templatesConfigService.resources(e);return void this.inputDialogService.showInputDialog(class{static createOnenoteNotebookDialog(e,t,i,a,n){const o=[e=>c.isNotEmptyString(e)?null:{isValid:!1,message:""},t=>c.hasNoInvalidCharacter(t,["?","*","\\","/",":","<",">","|","'"])?null:{isValid:!1,message:e.CreateNewNoteBookNameInvalidChars},t=>c.isNotStartingWithSpace(t)?null:{isValid:!1,message:e.CreateNewNoteBookNameCannotStartWithSpace},t=>c.isContainingLessThanLimitedCharacters(t,128)?null:{isValid:!1,message:e.CreateNewNoteBookNameExceeds128Chars}],r=t=>{s.inputValidator=e=>d(e,[...o]),i.getNoteBooks(t).results.toPromise().then(t=>{if(t&&t.value&&t.value.length){const i=[].concat(o);i.push(i=>c.hasNoDuplicates(i,t.value.map(e=>e.displayName),!0)?null:{isValid:!1,message:e.CreateNewNoteBookNameAlreadyExist}),s.inputValidator=e=>d(e,i)}})},s={title:t.CreateNewBlankText,placeholder:t.CreateFileDialogOneNoteInputPlaceholder,dismissAction:n},d=(e,t)=>{for(const i of t){const t=i(e);if(t)return t}return{isValid:!0,message:""}};return s.inputValidator=e=>d(e,[...o]),r("cache-first-network-onmiss"),s.inputButtonModel={executeAction:e=>{a(e),r("network-first")},text:e.CreateFileDialogButtonText},s.componentArea=l.b.Templates,s}}.createOnenoteNotebookDialog(this.locService,t,this.oneNoteGraphService,e=>{this.instrumentationService.logClickEvent("Input_Dialog_Button_Click","FileDialogCreateNewButton",l.b.InputDialog,o.a.referralFromFileType(o.b.OneNote)),g(),f(e)}));default:g(),f()}}else{const e=()=>{t&&d.canFallbackToLandingPage?this.urlLauncherService.openUrl(t,"CreateNewFallback").then(()=>{m({type:"GoToLanding",latency:0,platform:"Web"})}).catch(()=>{this.showError("Generic",d.fileType,"OpenFailed",t),m({type:"Error",latency:0})}):(this.showError("Generic",d.fileType),m({type:"Error",latency:0}))};this.launchOfficeApp(d.fileType).then(()=>{m({type:"GoToLanding",latency:0,platform:"Native"})}).catch(()=>{e()})}}).then(e=>{e||this.numCreatesPending--})};return e===o.b.Excel&&!i&&this.capabilitiesService.capabilities.pwaEnabled?this.localAppLauncherService.launchOfficeApp(o.b[o.b.Excel],"",null,!0).then(e=>e?(a&&a({type:"GoToLanding",latency:0,platform:"Native"}),Promise.resolve()):p()).catch(p):p()}getUpdatedCreateLinks(e){const t=this.capabilitiesService.capabilities;if(e&&!this.createLinksContainsFluid()){const e=[];if(t.fluidCreateAbpEnabled){const t=this.getFluidWorkload(o.b.FluidActivityBlueprint);e.push(this.getCreateLinkForWorkload(t,null))}if(t.fluidCreateNewEnabled){const t=this.getFluidWorkload(o.b.Fluid);e.push(this.getCreateLinkForWorkload(t,null))}if(e.length>0){const i=t.fluidFirst?e.concat(this.createLinks.value):this.createLinks.value.concat(e);this.createLinks.next(i)}}}createLinksContainsFluid(){for(const e of this.createLinks.value)if(e.creationFileType===o.b.Fluid||e.creationFileType===o.b.FluidActivityBlueprint)return!0;return!1}getFluidWorkload(e){const t={getId:()=>"ShellFluid",Id:"ShellFluid",Referral:"Fluid",FileType:o.b.Fluid,Url:this.createConfig.fluidCreateNewEndpoint,Color:"#0078D7",IconUnicodeCodepointCssClass:"ms-ohp-svg-Icon ms-ohp-Icon ms-ohp-Icon--fluidLogo",Text:void 0,SubText:void 0,Title:void 0,IsThirdParty:!1,IsNativeClientOnlyApp:!1,IconFont:void 0,Size:void 0,ClickCount:void 0,FirstOccurrence:void 0,LastOccurrence:void 0,InAppNav:void 0,ThirdPartyIcon:void 0,HideTile:void 0,ChangeColorInDarkMode:void 0,AppId:void 0,CollectorId:void 0};switch(e){case o.b.Fluid:return t;case o.b.FluidActivityBlueprint:return t.getId=()=>"ShellFluidAbp",t.Id="ShellFluidAbp",t.FileType=o.b.FluidActivityBlueprint,t.Url=this.createConfig.fluidCreateAbpEndpoint,t}}requestNewItem(e,t,i,a,n,s,c,l,d,p){const h=e=>{c&&c(e),s()},u=()=>Date.now()-i,m=(t,i,a)=>{const o=i=>{this.showError("OpenFailed"===i&&"GoToBlankDoc"===a?"OpenNewDocFailed":"Generic",e.fileType,i,"OpenFailed"===i?t:""),h({type:"Error",latency:u()})};if(t){if(!this.isPwa)return void 0!==n.open?(c&&c({type:i,latency:u(),platform:"Web"}),n.open(t,"_top"),void s()):void o("OpenFailed");this.urlLauncherService.openUrl(t,a).then(()=>{h({type:i,latency:u(),platform:"Web"})},()=>{o("OpenFailed")})}else o("CreateFile")},b=t=>{const i=()=>{if(a&&e.canFallbackToLandingPage)m(a,"GoToLandingFallback","CreateNewFallback");else{this.showError(t,e.fileType);const i=u();h({type:"Error",latency:i})}};this.launchOfficeApp(e.fileType).then(()=>{h({type:"GoToLandingFallback",latency:u(),platform:"Native"})}).catch(()=>{i()})},f=()=>{let a=null,n=null,s="GoToBlankDoc";switch(t){case o.b.Sway:a=this.swayService.createNew().then(e=>({canonicalUrl:e,webUrl:e}));break;case o.b.OneNote:a=this.oneNoteGraphService.createNewNotebook(l).then(e=>{const t=e.links.oneNoteWebUrl.href;return{canonicalUrl:t,webUrl:t}});break;case o.b.Forms:a=this.formsService.createForm(o.b.Forms,p).then(e=>({canonicalUrl:e,webUrl:e})),s="CreateNewFallback";break;case o.b.FormsQuiz:a=this.formsService.createForm(o.b.FormsQuiz,p).then(e=>({canonicalUrl:e,webUrl:e})),s="CreateNewFallback";break;default:[n,a]=this.createOneDriveFile(e,d?d.AssetId:null,i)}const c=this.shouldOpenInUIHost(t,null==d?void 0:d.AssetId)?this.wacContentService.bootstrapZeroByteFile({fileName:n,fileType:t,wdOrigin:this.getOriginParam(!1,!!d)},i,a):void 0;a.then(t=>{e.canOpenBlankDocInNativeApp?this.launchOfficeApp(e.fileType,t.canonicalUrl).then(()=>{h({type:"GoToBlankDoc",latency:u(),platform:"Native"})}).catch(()=>{this.launchWebApp(t,s,m,c)}):this.launchWebApp(t,s,m,c)}).catch(e=>{this.globalErrorHandler.handleError(e,"foSs8");const t=e&&e.error&&e.error.code||"";b("404"===t?"OneDriveProvisioning":e&&e.error&&"CAP_Error"===e.error.data?"ConditionalAccessFallback":this.clientStartupConfigService.config.authType===r.a.MSA&&"403"===t?"OneDriveDisabled":"Generic")})};if(!n)return n=this.windowService.nativeWindow,void b("Generic");if(this.isPwa||void 0!==n.open){if(n!==this.windowService.nativeWindow)try{const e=this.getLoadingPageHtml(t);n.document.write(e)}catch(e){return this.globalErrorHandler.handleError(e,"T3UKJ"),void b("Generic")}this.localAppLauncherService.launchOfficeAppWithTemplate(o.b[t],d?d.TemplateBinaryUrl:null).then(e=>{if(!e)throw new Error("launchOfficeAppWithTemplate failed");h({type:"GoToBlankDoc",latency:u(),platform:"Native"})}).catch(()=>{t===o.b.Fluid||t===o.b.FluidActivityBlueprint?(this.numCreatesPending--,this.launchFluidExperience(t)):f()})}else b("Generic")}createOneDriveFile(e,t,i){const a=`${e.newDocName}.${e.fileExtension}`,n=this.shouldOpenInUIHost(e.fileType,t);return[a,new Promise((o,r)=>{const c=Date.now();this.oneDriveService.createNewFile(a,e.fileType,n).then(e=>{const a={};e.webDavUrl&&(a.canonicalUrl=e.webDavUrl);let r=e.webUrl;r=r.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew"),-1===r.lastIndexOf("action=editnew")&&(r=s.a.appendQuery(r,"action=editnew")),t&&(r=r+"&wdTpl="+t),(t||this.createLcidEnabled)&&(r+="&wdlcid="+this.contextService.sharedContext.officeMarketLcid);const l=this.getOriginParam(!1,!!t);r=s.a.appendQuery(r,`wdNewAndOpenCt=${i}&wdPreviousSession=${this.startupConfigService.config.sharedClientStartupContext.correlationId}&wdOrigin=${l}`),a.webUrl=r,n&&(e.parentReference&&(a.docId=e.id,a.driveId=e.parentReference.driveId,a.fileName=e.name),a.wopiFetchData={fetchDiagnostics:{startTime:c},wopiHostData:d.a.getWopiHostDataFromItem(e)}),o(a)}).catch(e=>{this.globalErrorHandler.handleError(e,"dYEKI"),r(e||"Creating new file failed")})})]}getNewDocLinkTarget(e){const t=this.createLinkCandidates.get(e);return this.capabilitiesService.capabilities.capPopupEnabled&&(e===o.b.Word||e===o.b.Excel||e===o.b.PowerPoint||e===o.b.Visio||e===o.b.OneNote)&&this.accessTokenService.hasCAPError("Graph")||e===o.b.Fluid||e===o.b.FluidActivityBlueprint?"_self":this.isPwa||"_blank"===this.contextService.sharedContext.defaultLinkTarget&&(this.clientStartupConfigService.config.authType===r.a.OrgId||!t.canCreateBlankDocument)?"_blank":"_self"}showError(e,t,i="CreateFile",a){this.newTabWindow&&(this.newTabWindow.close(),this.newTabWindow=null),this.errorDialogService.showErrorDialog({category:i,error:e,fileType:t,inputText:a})}getLoadingPageHtml(e){let t=" <!doctype html> <html> <head> <title>TITLE</title> <meta charset=utf-8 /> <style>body{margin:0;padding:0}.parent{text-align:center;width:100%;height:100%}.title{font-family:'Segoe UI SemiLight','Segoe UI WPC Semilight','Segoe UI',Segoe,Tahoma,Helvetica,Arial,sans-serif;font-size:30px;margin-bottom:-12px}.load_center{position:absolute;left:0;right:0;bottom:50%}.spinner{display:inline-block;margin:25px auto;border-radius:50%;border:1.5px solid #d9d9d9;border-top-color:SPINNERCOLOR;width:40px;height:40px;-webkit-animation:spinAnimation 1.3s infinite cubic-bezier(.53,.21,.29,.67);animation:spinAnimation 1.3s infinite cubic-bezier(.53,.21,.29,.67)}@-webkit-keyframes spinAnimation{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spinAnimation{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}</style> </head> <body> <div class=parent> <div class=load_center> <div class=title>ONLINEAPPNAME</div> <br> <span role=presentation class=spinner></span> </div> </div> </body> </html> ";return t=t.replace("TITLE",this.locService.CreateNewDocumentLoadingPageTitle),t=t.replace("SPINNERCOLOR",this.getWorkloadSpinnerColor(e)),t=t.replace("ONLINEAPPNAME",this.getWorkloadOnlineName(e)),t}getDocaspxFormHtml(e,t){return"<form id=create-new-doc-form method=post action=APIURL style=display:none target=_top><input id=create-new-doc-token name=access_token value=ONEDRIVETOKEN /></form> ".replace("APIURL",e).replace("ONEDRIVETOKEN",t)}getWorkloadOnlineName(e){const t=this.createLinkCandidates.get(e);return t?t.workloadOnlineName:""}getWorkloadSpinnerColor(e){const t=this.createLinkCandidates.get(e);return t&&t.spinnerColor?t.spinnerColor:"#2b579a"}getCreateLinkForWorkload(e,t){const i=t||e.FileType,a=this.createLinkCandidates.get(i);let n=e.Id;if(!a)return null;let r=e.Url;return i===o.b.Sway?r=s.a.appendQuery(r,"campaign=OHPCreateNew"):i!==o.b.Forms&&i!==o.b.FormsQuiz||(r=this.formsService.getCreateFormsLink(i),n=i===o.b.FormsQuiz?e.Id+"Quiz":e.Id),{ariaLabel:this.locService.format(this.locService.CreateMenuLinkAriaLabelFormat,a.title),title:a.title,fileTypeName:a.fileTypeName,appName:a.appName,icon:o.a.documentIconFromType(e.FileType,"32x32"),workload:e,url:r,creationFileType:i,getId:()=>n}}getDocAspxApiUrl(e,t,i,a,n){return new Promise((o,r)=>{this.oneDriveService.getMyDriveRootUrl().then(s=>{const c=s.userRoot,l=c.lastIndexOf("/Documents");if(-1===l)return void r("docliburl not in expected format");let d=`${c.substring(0,l)}/_layouts/15/doc.aspx?action=editnew&doctype=${e}&wdOrigin=${t}&docliburl=${c}&ct=${i}`;a&&(d+=n?`&templateDriveId=${n}&templateItemId=${a}`:"&wdTpl="+a),(a||this.createLcidEnabled)&&(d+="&wdlcid="+this.contextService.sharedContext.officeMarketLcid);const p=this.clientStartupConfigService.config.sharedClientStartupContext.flights.toLowerCase();p.includes("enterprisetemplatescf")?d+="&wdFlights=ET-Control":p.includes("enterprisetemplates")&&(d+="&wdFlights=ET-Treatment"),o(d)}).catch(()=>{r("Failed to get doclib url")})})}getOriginParam(e,t){return this.contextService.getWdOrigin(t?e?"TEMPLATES-INSTANT":"TEMPLATES":e?"NEW-INSTANT":"NEW")}launchOfficeApp(e,t=""){return this.localAppLauncherService.launchOfficeApp(o.b[e],t).then(e=>{if(!e)return Promise.reject()})}shouldOpenInUIHost(e,t){return!t&&this.wacHostCreateNewEnabled&&this.capabilitiesService.wacHostEnabledForFileType(e)&&this.wacHostApps&&this.wacHostApps.has(e)}launchWebApp(e,t,i,a){a?a():i(e.webUrl,"GoToBlankDoc",t)}launchFluidExperience(e){this.fluidHostContext.hostScenarioStartTime=Date.now(),this.fluidHostContext.hostScenarioName=e===o.b.Fluid?"CreateNew":"CreateNew.Abp",this.oneDriveService.getMyDriveRoot("network-first").then(t=>{const i=t.webUrl.lastIndexOf("/Documents");if(-1===i)return;const a=t.webUrl.substring(0,i);this.officeRouteService.navigateTo({route:"Content",app:o.b.Fluid},!1,{action:"editnew",abpId:e===o.b.Fluid?void 0:1,siteUrl:a,drive:t.parentReference.driveId})})}enableFluidTenantAdminCreate(){return Object(a.b)(this,void 0,void 0,(function*(){try{return yield this.vroomService.getIsFluidEnabled("cache-only")}catch(e){try{return yield this.vroomService.getIsFluidEnabled("network-first")}catch(e){return this.instrumentationService.logErrorEvent("FluidEnabled_Error"),!1}}}))}}return e.menuOrdering=[o.b.Word,o.b.Excel,o.b.PowerPoint,o.b.OneNote,o.b.Forms,o.b.FormsQuiz,o.b.Sway,o.b.Visio,o.b.FluidActivityBlueprint,o.b.Fluid],e.ɵprov=p.bc({factory:function(){return new e(p.cc(h.a),p.cc(u.a),p.cc(r.b),p.cc(m.a),p.cc(f),p.cc(v.a),p.cc(g.a),p.cc(k.a),p.cc(w.a),p.cc(N.b),p.cc(C),p.cc(l.a),p.cc(T.a),p.cc(y.a),p.cc(F.a),p.cc(S.a),p.cc(E.a),p.cc(A.a),p.cc(r.b),p.cc(D.a),p.cc(L.a),p.cc(I.a),p.cc(O.a),p.cc(x.b),p.cc(P.a),p.cc(d.a))},token:e,providedIn:"root"}),e})()},p6gk:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var a=i("GAcG"),n=i("oAX+"),o=i("aQ3G"),r=i("pOWU"),s=i("Mlb/"),c=i("kpuN"),l=i("hhzZ"),d=i("R7NL"),p=i("/I02"),h=i("wwmn"),u=i("vk2e"),m=i("lrJm"),b=i("casz");let f=(()=>{class e extends o.a{constructor(e,t,i,a,n,o,r,s){super(e,t,i,a,n,o,r,s)}createNewNotebook(t){const i=e.myOneNoteEndpoint+"notebooks",a={displayName:t};return new Promise((e,t)=>{this.postGraph("OneNote_Graph_Create_NoteBook_Request",i,a,i=>{i.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(i=>{const a=i.data;a&&a.links&&a.links.oneNoteWebUrl?e(a):t(new r.b(i,"Could not parse notebook item from Graph response"))}).catch(e=>{this.globalErrorHandler.handleError(e,"vFlcr")})},e=>{e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()})})}getNoteBooks(e){if("stale-while-revalidate"===e){const e=this.fetchNoteBooks("cache-only"),t=this.fetchNoteBooks("network-first");return n.a.createResultsWithCacheObservable(e,t)}return"cache-first-network-onmiss"===e?{results:a.a.create(e=>{this.fetchNoteBooks("cache-only").then(t=>{e.next(t),e.complete()}).catch(()=>{this.fetchNoteBooks("network-first").then(t=>{e.next(t),e.complete()})})}),initialCompletion:null}:{results:a.a.create(t=>{this.fetchNoteBooks(e).then(e=>{t.next(e),t.complete()})}),initialCompletion:null}}fetchNoteBooks(t){return this.getGraph("OneNote_Graph_Get_NoteBooks_Request",e.myOneNoteEndpoint+"notebooks?orderby=lastModifiedTime%20desc",t,(e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>Object.assign(e.data,{fromCache:e.fromCache}))}handleQueryParam(e,t){"mockgetnotebooks"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)}}return e.myOneNoteEndpoint="me/onenote/",e.ɵprov=s.bc({factory:function(){return new e(s.cc(c.a),s.cc(l.a),s.cc(d.a),s.cc(p.a),s.cc(h.a),s.cc(u.q),s.cc(m.b),s.cc(b.a))},token:e,providedIn:"root"}),e})()}}]);
//# sourceMappingURL=antp-group-items~mru~wac-cnt.8c9ceb5f9a7fbb229599.chunk.v4.js.map