(window.officehome_antp_webpackJsonp=window.officehome_antp_webpackJsonp||[]).push([[8],{GHXR:function(e,t,i){"use strict";i.r(t),i.d(t,"MruModuleNgFactory",(function(){return ft}));var s=i("Mlb/"),a=i("WJAz"),n=i("WKA6"),r=i("70cc"),o=i("rmEM"),l=i("1ygu"),c=i("CC5A"),h=i("hhzZ"),u=i("BaAg"),d=i("p6Zr"),m=i("Eu1D"),p=i("L/Tc"),b=i("QOOv"),S=i("JT1q"),g=i("fKR7"),f=i("cgnd"),v=i("ZBli"),T=i("rBrS");let y=(()=>{class e{constructor(t){const i=[],s=[];for(let e=0;e<t.length;e++){const a=t[e];a.isPinned?i.push(a):s.push(a)}this.documents={[e.PinnedStateKey]:i,[e.UnpinnedStateKey]:s,[e.AllCategoryKey]:t}}getAllPinnedDocuments(){return this.documents[e.PinnedStateKey]||[]}getAllUnpinnedDocuments(){return this.documents[e.UnpinnedStateKey]||[]}getAllDocuments(){return this.documents[e.AllCategoryKey]||[]}removeItem(e){const t=e.isPinned?this.getAllPinnedDocuments():this.getAllUnpinnedDocuments();this.deleteItemFromList(t,e),this.deleteItemFromList(this.getAllDocuments(),e)}addItem(e){const t=e.isPinned?this.getAllPinnedDocuments():this.getAllUnpinnedDocuments();this.addItemToList(t,e),this.addItemToList(this.getAllDocuments(),e)}deleteItemFromList(e,t){if(e)for(let i=0;i<e.length;i++)if(e[i].id===t.id)return void e.splice(i,1)}addItemToList(e,t){if(e){for(let i=0;i<e.length;i++)if(e[i].lastViewedTime<=t.lastViewedTime)return void e.splice(i,0,t);e.push(t)}}}return e.AllCategoryKey="all",e.PinnedStateKey="pinned",e.UnpinnedStateKey="unpinned",e})(),I=(()=>{class e{constructor(e,t,i,a,n,r,o,l,c,h,u,d,m,p,b,S,g,f,v,T,y,I,L,M,w,D,C,A,E,k,x,R,P,O){this.capabilitiesService=e,this.changeDetector=t,this.clientStartupConfigService=i,this.contextService=a,this.dataSecurityService=n,this.deviceDetector=r,this.documentService=o,this.eventService=l,this.formsService=c,this.instrumentationService=h,this.jumpListService=u,this.locService=d,this.mruConfigService=m,this.onenoteGraphService=p,this.oneNoteService=b,this.onNoteConfigService=S,this.performanceService=g,this.mruDataService=f,this.sharedWithMeService=v,this.substrateInsightsService=T,this.activatedRoute=y,this.globalErrorHandler=I,this.userContextService=L,this.uploadConfigService=M,this.activityDescriptionService=w,this.officeRouteService=D,this.swayServiceConfigService=C,this.analyticsService=A,this.browserPaintMeasurementService=E,this.urlAuthenticatorService=k,this.oneDriveUploadService=x,this.createMenuService=R,this.oneDriveService=P,this.themingService=O,this.numLoggableItems=0,this.emptyViewName="empty-view",this.tabImpressionIndex=0,this.stateChanged=new s.n,this.listAnimation=this.capabilitiesService.capabilities.disableAnimation?"None":"FadeAndScale"}ngOnInit(){this.defaultView=this.fileType===u.b.Forms?"Card":"List";const t=this.capabilitiesService.capabilities;t.filePicker&&this.initializeFilePicker(),this.stateChanged.emit({state:m.a.Loading}),this.bottomTrayEnabled=t.bottomTrayEnabled,this.componentArea=h.b.Documents,this.isAntpExperience=t.antpLoaded,this.recentSectionLandmarkAriaLabel=this.locService.RecentDocumentsLandmarkAriaLabel,this.themed=this.userContextService.user.themed,this.mruConfig=this.mruConfigService.config,this.pinnedDocsEnabled=this.mruConfig.mruPinEnabled,this.selectedTab=0,this.tileViewEnabled=this.mruConfig.tileViewEnabled,this.sharedWithMeViewEnabled=this.mruConfig.sharedWithMeViewEnabled&&this.fileType!==u.b.Sway,this.trendingDocsEnabled=this.mruConfig.trendingDocsEnabled&&this.fileType!==u.b.Sway&&this.fileType!==u.b.Forms,this.mobile=!this.deviceDetector.isDesktopDevice(),this.appFilter=this.fileType?new Set([this.fileType]):null,this.appSuffix=this.fileType?"-"+u.b[this.fileType].toLowerCase():"",this.maxInitialDocumentCards=this.maxInitialDocs||2*e.maxCardsPerLine,this.maxInitialDocuments=this.maxInitialDocs||this.mruConfig.maxInitialListItems,this.maxTotalDocuments=this.maxTotalDocs||this.mruConfig.maxTotalListItems,this.showAnalytics=this.mruConfig.analyticsEnabled&&this.fileType===u.b.Sway,this.showActivity=!this.showAnalytics&&this.mruConfig.activityEnabled&&this.fileType!==u.b.OneNote&&this.fileType!==u.b.Forms,this.showSharing=!this.showAnalytics&&this.mruConfig.sharingStatusEnabled&&this.fileType!==u.b.Forms,this.showMobileShareAndActivity=this.mruConfig.mobileShareAndActivityEnabled,this.isConsumer=this.clientStartupConfigService.config.authType===f.a.MSA,this.backplatesEnabled=this.themingService.backplatesTheming,this.capabilitiesService.capabilities.darkModeEnabled&&this.capabilitiesService.capabilities.reactShellEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe(e=>{this.darkMode=e,this.updateEmptyStates()})),t.oneDriveUploadEnabled&&this.uploadConfigService.config&&this.fileType!==u.b.Sway&&this.fileType!==u.b.OneNote&&this.fileType!==u.b.Forms&&this.oneDriveUploadService.uploadEnabledPromise.then(e=>this.uploadEnabled=e),this.createButtonSubscription=this.createMenuService.createButtonEnabled.subscribe(e=>this.createButtonEnabled=e),this.routeSubscription=this.officeRouteService.subscribeToRouteChangeEnd(e=>{if(e.currentRoute){const t=e.currentRoute.route,i=e.previousRoute?e.previousRoute.route:null;("Templates"===i&&"Start"===t||null!==i&&"OfficeHome"===t)&&(this.listAnimation="None"),"Content"===i&&this.mruDataService.updateMruDocuments(this.appFilter)}}),this.recentTabListModel=new c.b({id:this.fileType===u.b.Forms?T.a.FormsTabList:T.a.Recent,area:this.componentArea,tabs:[],logImpression:this.logTabImpression.bind(this),headerText:this.title,tabActivationAriaLabel:this.locService.MruTabActivationAriaLabel}),this.recentMruStreamData||(this.recentMruStreamData=this.mruDataService.getMruDocuments(this.appFilter)),this.recentMruStream=this.recentMruStreamData.results.subscribe(e=>this.processRecentMruTask(e)),this.recentMruStreamData.initialCompletion.then(e=>{e&&(this.globalErrorHandler.handleCacheObservableError(e,"jM9a5","al4U3"),this.recentTab||(this.stateChanged.emit({state:m.a.Failed}),e.cacheError&&e.networkError&&t.antpLoaded&&this.eventService.broadcastEvent({name:"mruFailed",args:[]})))});const i=this.recentMruStreamData.results.pipe(Object(n.a)(1)).toPromise().then(e=>{if(!e)return Promise.reject("Observable completed with no values")});(t.isPwaInUwp||t.antpLoaded||this.isConsumer)&&i.then(()=>this.eventService.broadcastEvent({name:"mruReady",args:[]})),this.initialTabsPromise=i.then(()=>{u.b.OneNote===this.fileType&&this.onNoteConfigService.config.enableOneNoteApis&&this.recentTabListModel.updateOrAddTab(this.createMyAppItemsLoadingTab(this.fileType)),this.sharedWithMeViewEnabled&&(this.createSharedLoadingTab(),this.recentTabListModel.updateOrAddTab(this.sharedWithMeTab)),u.b.OneNote===this.fileType&&this.userContextService.user.isEdu&&this.onNoteConfigService.config.enableOneNoteApis&&this.recentTabListModel.updateOrAddTab(this.createClassNoteBookLoadingTab()),this.trendingDocsEnabled&&(this.createTrendingLoadingTab(),this.recentTabListModel.updateOrAddTab(this.trendingTab))}).catch(()=>{})}ngOnDestroy(){var e,t,i,s,a,n,r,o;this.logPendingTabImpression(),null===(e=this.recentMruStream)||void 0===e||e.unsubscribe(),null===(t=this.routeSubscription)||void 0===t||t.unsubscribe(),null===(i=this.sharedWithMeSubscription)||void 0===i||i.unsubscribe(),null===(s=this.trendingDocSubscription)||void 0===s||s.unsubscribe(),null===(a=this.appItemStreamSubscription)||void 0===a||a.unsubscribe(),null===(n=this.themeShadesSubscription)||void 0===n||n.unsubscribe(),null===(r=this.filePickerModuleLoadedSubscription)||void 0===r||r.unsubscribe(),null===(o=this.createButtonSubscription)||void 0===o||o.unsubscribe()}onTabClicked(e){this.selectedTab=e,this.focusFirstItem=!1,this.updateNumLoggableItems(),this.updateWithNewZeroStateCheck()}onDeleteItem(e){if(5===e.deleteOption)e.item.fileType===u.b.Forms&&(this.eventService.broadcastEvent({name:"mruItemStateChange",args:[0,e.item]}),this.formsService.unpinSharedForm(e.item.docId).then(()=>{const t=this.sharedData,i=t.value.findIndex(t=>t.id===e.item.docId);t.value.splice(i,1),t.fromCache=!1,this.processSharedDocTask(t,!1),this.eventService.broadcastEvent({name:"mruItemStateChange",args:[1,e.item]})}).catch(()=>{this.eventService.broadcastEvent({name:"mruItemStateChange",args:[1,e.item]})}));else{const t=e.item;this.documents.removeItem(t),this.mruDataService.removeDocument(Object(S.i)(t)),this.updateListModels(),this.setFocusOnStateChange(e.index)}}onAddItem(e){this.eventService.broadcastEvent({name:"mruItemStateChange",args:[0,e.addedItem]}),this.formsService.postCopyForm(e.addedItem.docId,e.addedItem.ownerId,this.clientStartupConfigService.config.objectId,e.addedItem.ownerType,"users").then(()=>{this.eventService.broadcastEvent({name:"mruItemStateChange",args:[1,e.addedItem]})}).catch(()=>{this.eventService.broadcastEvent({name:"mruItemStateChange",args:[1,e.addedItem]})})}initializeFilePicker(){this.filePickerEnabled=this.capabilitiesService.capabilities.filePicker,this.filePickerModuleLoadedSubscription=this.eventService.events.withScope(0).pipe(Object(r.a)(e=>"filePickerModuleLoaded"===e.name)).pipe(Object(n.a)(1)).subscribe(()=>{this.showFilePickerUploadButton=!0})}onChangePinState(e){const t=e.item;this.documents.removeItem(t),t.isPinned=e.isPinned,this.documents.addItem(t),this.updateListModels(),this.mruDataService.updatePinnedState(Object(S.i)(t)),this.changeDetector.detectChanges(),this.setFocusOnStateChange(e.index,e.element)}trackByIndex(e){return e}updateEmptyStates(){!this.appSuffix&&this.recentTabListModel&&this.recentTabListModel.tabs&&this.recentTabListModel.tabs.length&&(this.pinnedTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-pinned-darkmode":"emptystate-icons-sprite emptystate-pinned",this.recentTabListModel.updateOrAddTab(this.pinnedTab),this.recentTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-recent-darkmode":"emptystate-icons-sprite emptystate-recent",this.recentTabListModel.updateOrAddTab(this.recentTab),this.sharedWithMeTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-swm-darkmode":"emptystate-icons-sprite emptystate-swm",this.recentTabListModel.updateOrAddTab(this.sharedWithMeTab),this.trendingTab&&(this.trendingTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-discover-darkmode":"emptystate-icons-sprite emptystate-discover",this.recentTabListModel.updateOrAddTab(this.trendingTab)))}setFocusOnStateChange(e,t){setTimeout(()=>{const i=this.recentTabListModel.tabs[this.selectedTab];let s;if(0===i.listModel.items.length)s=this.documentService.nativeDocument.getElementById("tab-list-header-link-"+i.id);else if(t&&i!==this.pinnedTab)s=t.nativeElement;else{const t=i.listModel.items[(!i.listModel.maxItemCount||e<i.listModel.maxItemCount)&&e<i.listModel.items.length?e:i.listModel.items.length];s=t?this.documentService.nativeDocument.getElementById(`${i.id}-${t.getId()}`):null}s&&s.focus()},0)}isEmptyRecentView(){return this.recentTab&&this.recentTabListModel.tabs[this.selectedTab]===this.recentTab&&this.recentTab.listModel&&this.recentTab.listModel.items&&0===this.recentTab.listModel.items.length&&!this.recentTab.hasError&&!this.fileType}getSharedDocuments(){return this.sharedWithMeService.getSharedDocuments(this.mruConfig.mruNumItemsToRequest,this.appFilter)}getTrendingDocuments(){return this.substrateInsightsService.getTrendingDocuments(this.maxTotalDocuments,this.appFilter)}waitOnItemInflations(e){return Object(a.a)(e.map(e=>e.initialInflationCompleted)).toPromise()}processShared(e){if(!e)return;let t=null;return t=e.map(this.fileType===u.b.Forms?(e,t)=>Object(S.b)(e,"forms_shared_item_"+t,"FormsSharedDocsImpression",this.contextService.isRtl,this.clientStartupConfigService.config.authType,!1,g.a.SharedForm):(e,t)=>Object(S.g)(e,"shared_item_"+t,"SharedDocsImpression",this.contextService.isRtl,this.clientStartupConfigService.config.authType,!1)),new o.a(t,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,(e,i)=>this.logTabImpression(t,b.a.sharedListId,e,i,!1),!0,!0,this.listAnimation,null,null,null,null,this.fileType===u.b.Forms,this.fileType===u.b.Forms)}getNotebooks(){return this.onenoteGraphService.getNoteBooks("stale-while-revalidate")}processAppItems(e){return new Promise(t=>{if(!e.value)return void t();const i=[];for(const t of e.value)this.fileType===u.b.OneNote&&i.push(Promise.resolve(t));Promise.all(i).then(e=>{const i=e.filter(e=>null!==e).map((e,t)=>{if(this.fileType===u.b.OneNote)return Object(S.c)(e,`${u.a.fileTypeNameFromType(this.fileType)}_item_${t}`,u.a.fileTypeNameFromType(this.fileType)+"Impression",this.contextService.isRtl,this.clientStartupConfigService.config.authType,!1)});t(new o.a(i,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,(e,t)=>this.logTabImpression(i,b.a.appItemListId,e,t,!1),!0,!0,this.listAnimation,null,null,null,null,this.fileType===u.b.Forms,this.fileType===u.b.Forms))})})}getClassNoteBooks(){return this.oneNoteService.getClassNoteBooks().then(e=>this.processClassNoteBooks(e))}processClassNoteBooks(e){if(!e)return;const t=e.map((e,t)=>Object(S.a)(e,"classnotebook_item_"+t,"ClassNoteBookImpression",this.contextService.isRtl,this.clientStartupConfigService.config.authType,!1));return new o.a(t,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,(e,i)=>this.logTabImpression(t,b.a.classNoteBookListId,e,i,!1),!0,!0,this.listAnimation)}createClassNoteBookLoadingTab(){const e=this.createClassNoteBookTab();return e.onLoad=()=>this.getClassNoteBooks().then(t=>{e.listModel=t}),e}createClassNoteBookTab(e){const t=this.locService.ClassNotebookTabTitle;return{id:b.a.classNoteBookListId,title:t,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,t),listModel:e,zeroExperienceTitle:this.locService.NoClassNotebooksTitle,zeroExperienceSubtitle:this.locService.NoClassNotebooksSubTitle,zeroExperienceImage:"zero-docs-icon-sprite zero-docs-icon-sprite-icon-emptyfolder-208x208",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:null,loaded:!!e,fromCache:!1}}createMyAppItemsLoadingTab(e){if(e!==u.b.OneNote)return;let t=!1;this.myAppItemsTab=this.createMyAppItemsTab();const i=e=>new Promise(i=>{this.processAppItems(e).then(s=>{s&&(this.myAppItemsTab.listModel=s,this.myAppItemsTab.fromCache=e.fromCache,this.myAppItemsTab.loaded=!0,!e.fromCache&&t&&this.recentTabListModel.updateOrAddTab(this.myAppItemsTab)),i()})});return this.myAppItemsTab.onLoad=()=>new Promise((s,a)=>{let n=null;e===u.b.OneNote&&(n=this.getNotebooks()),this.appItemStreamSubscription=n.results.subscribe(e=>{e.fromCache&&(t=!0),i(e).then(()=>{s()})}),n.initialCompletion.then(e=>{t=!0,e&&(this.globalErrorHandler.handleCacheObservableError(e,"uLfZP","yUFz9"),e.cacheError&&e.networkError&&a())})}),this.myAppItemsTab}createMyAppItemsTab(e){const t={id:b.a.appItemListId,title:"",ariaLabel:"",listModel:e,zeroExperienceTitle:"",zeroExperienceSubtitle:"",zeroExperienceImage:"emptystate-icons-sprite emptystate-recent",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:null,loaded:!!e,fromCache:!1,showCardsInTileView:this.isShowInCardView()};return this.fileType===u.b.OneNote&&(t.zeroExperienceTitle=this.locService.NoOwnedOneNoteItems,t.zeroExperienceSubtitle=this.locService.NoOwnedOneNoteItemsMemo,t.title=this.locService.MyNotebooksTabTitle,t.ariaLabel=this.locService.format(this.locService.DocumentTabAriaLabelFormat,this.locService.MyNotebooksTabTitle)),t}createSharedLoadingTab(){this.sharedWithMeTab=this.createSharedTab(),this.sharedWithMeTab.onLoad=()=>new Promise((e,t)=>{let i=null;i=this.fileType===u.b.Forms?this.formsService.getSharedForms():this.getSharedDocuments();let s=!1;this.sharedWithMeSubscription=i.results.subscribe(t=>{t.fromCache&&(s=!0),this.processSharedDocTask(t,s),e()}),i.initialCompletion.then(e=>{s=!0,e&&(this.globalErrorHandler.handleCacheObservableError(e,"Vu9AW","idjiA"),e.cacheError&&e.networkError&&t())})})}processSharedDocTask(e,t){this.sharedData&&e.fromCache||(this.sharedData=e);let i=null;i=this.processShared(this.fileType===u.b.Forms?this.sharedData.value:this.sharedData.items),this.sharedWithMeTab.listModel=i,this.sharedWithMeTab.fromCache=this.sharedData.fromCache,this.sharedWithMeTab.loaded=!0,!this.sharedData.fromCache&&t&&this.recentTabListModel.updateOrAddTab(this.sharedWithMeTab)}createSharedTab(){const e=this.locService.SharedDocumentsSectionTitleLowercase;return{id:b.a.sharedListId,title:e,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,e),listModel:null,zeroExperienceTitle:this.locService.appResource("NoSharedWithMeTitle",this.fileType),zeroExperienceSubtitle:this.locService.appResource("NoSharedWithMeSubtitle",this.fileType),zeroExperienceImage:this.darkMode?"emptystate-icons-sprite-darkmode emptystate-sharedwithme-darkmode":"emptystate-icons-sprite emptystate-swm",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:this.createAttribution(this.mruConfig.oneDriveSharedViewId),loaded:!1,fromCache:!1,showCardsInTileView:this.isShowInCardView()}}processTrending(e){if(!e)return;const t=e.map((e,t)=>Object(S.h)(e,"trending_item_"+t,"TrendingDocsImpression",this.contextService.isRtl,this.clientStartupConfigService.config.authType,!1));return new o.a(t,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,(e,i)=>this.logTabImpression(t,b.a.trendingListId,e,i,!1),!0,!0,this.listAnimation,null,null,this.maxInitialDocumentCards)}createTrendingLoadingTab(){const e=this.locService.TrendingDocumentsSectionTitle;this.trendingTab={id:b.a.trendingListId,title:e,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,e),listModel:null,zeroExperienceTitle:this.locService.appResource("NoDiscoverTitle",this.fileType),zeroExperienceSubtitle:this.locService.appResource("NoDiscoverSubtitle",this.fileType),zeroExperienceImage:this.darkMode?"emptystate-icons-sprite-darkmode emptystate-discover-darkmode":"emptystate-icons-sprite emptystate-discover",errorTitle:this.locService.MruErrorTitle,errorSubtitle:this.locService.MruErrorSubtitle,errorImage:"emptystate-icons-sprite emptystate-error",showZeroExperience:!0,attribution:this.createAttribution(this.mruConfig.oneDriveDiscoverViewId),loaded:!1,fromCache:!1,showCardsInTileView:!0},this.trendingTab.onLoad=()=>new Promise((e,t)=>{const i=this.getTrendingDocuments();let s=!1;this.trendingDocSubscription=i.results.subscribe(t=>{t.fromCache&&(s=!0),this.processTrendingTask(t,s),e()}),i.initialCompletion.then(e=>{s=!0,e&&(this.globalErrorHandler.handleCacheObservableError(e,"IyhlP","HFUrB"),e.cacheError&&e.networkError&&t())})})}isShowInCardView(){return this.fileType===u.b.Forms}processTrendingTask(e,t){const i=this.processTrending(e.items);this.trendingTab.listModel=i,this.trendingTab.fromCache=e.fromCache,this.trendingTab.loaded=!0,!e.fromCache&&t&&this.recentTabListModel.updateOrAddTab(this.trendingTab)}processRecentMruTask(t){const i=(t.items||[]).map((e,i)=>Object(S.e)(e,"mru_item_"+i,t.impressionId,this.locService,this.contextService.isRtl,this.clientStartupConfigService.config.authType,t.fromCache));if(this.documents){const e=this.documents.getAllUnpinnedDocuments().slice(0,this.maxTotalDocuments).concat(this.documents.getAllPinnedDocuments().slice(0,this.maxTotalDocuments));this.copyInflationData(e,i)}let s,a;if(this.documents=new y(i),this.impressionId=t.impressionId,this.pinnedDocsEnabled){const e=this.documents.getAllPinnedDocuments();s=new o.a(e,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,e.length,(e,i)=>this.logTabImpression(this.pinnedTab.listModel.items,b.a.pinnedListId,e,i,t.fromCache),!0,!0,this.listAnimation,null,null,null,null,this.fileType===u.b.Forms,this.fileType===u.b.Forms),a=new o.a(this.documents.getAllDocuments(),this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,(e,i)=>{this.logTabImpression(this.recentTab.listModel.items,b.a.unpinnedListId,e,i,t.fromCache),this.focusFirstItem=!1},!0,!0,this.listAnimation,null,null,null,this.mruConfig.infiniteShowMoreEnabled,this.fileType===u.b.Forms,this.fileType===u.b.Forms)}else a=new o.a(i,this.locService.ShowMoreMruResultsAriaLabel,this.locService.ShowLessMruResultsAriaLabel,this.locService.ShowMoreMruResultsUpdateAriaLabel,this.locService.ShowLessMruResultsUpdateAriaLabel,this.maxInitialDocuments,this.maxTotalDocuments,(e,i)=>{this.logTabImpression(this.recentTab.listModel.items,"mru",e,i,t.fromCache),this.focusFirstItem=!1},!0,!0,this.listAnimation,null,null,null,this.mruConfig.infiniteShowMoreEnabled,this.fileType===u.b.Forms,this.fileType===u.b.Forms);const r=this.locService.RecentDocumentsSectionTitleLowercase;if(this.recentTab={id:this.pinnedDocsEnabled?b.a.unpinnedListId:"mru",title:r,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,r),listModel:a,timestampHeader:this.lastOpened,zeroExperienceTitle:this.locService.appResource("NoRecentTitle",this.fileType),zeroExperienceSubtitle:this.isAntpExperience?this.locService.EdgeNoRecentSubtitle:this.locService.appResource(this.uploadConfigService.config&&this.uploadConfigService.config.dragAndDropEnabled&&this.fileType!==u.b.Sway?"NoRecentSubtitleDragAndDrop":"NoRecentSubtitle",this.fileType),zeroExperienceImage:this.darkMode?"emptystate-icons-sprite-darkmode emptystate-recent-darkmode":"emptystate-icons-sprite emptystate-recent",showZeroExperience:!0,errorTitle:null,attribution:this.createAttribution(this.mruConfig.oneDriveRecentViewId),loaded:!0,fromCache:t.fromCache,footerText:null,showCardsInTileView:this.isShowInCardView()},this.recentTabListModel.updateOrAddTab(this.recentTab),s){const e=this.locService.PinnedDocumentsSectionTitleLowercase;this.pinnedTab={id:b.a.pinnedListId,title:e,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,e),listModel:s,timestampHeader:this.lastOpened,zeroExperienceTitle:this.locService.appResource("NoPinnedTitle",this.fileType),zeroExperienceSubtitle:this.locService.appResource("NoPinnedSubtitle",this.fileType),zeroExperienceImage:this.darkMode?"emptystate-icons-sprite-darkmode emptystate-pinned-darkmode":"emptystate-icons-sprite emptystate-pinned",showZeroExperience:!0,errorTitle:null,attribution:this.createAttribution(this.mruConfig.oneDriveRecentViewId),loaded:!0,fromCache:t.fromCache,showCardsInTileView:this.isShowInCardView()},this.recentTabListModel.updateOrAddTab(this.pinnedTab)}if(this.oneDriveUploadService.uploadEnabledPromise.then(e=>{e&&this.uploadConfigService.config&&this.uploadConfigService.config.dragAndDropEnabled&&this.fileType!==u.b.Sway&&this.fileType!==u.b.OneNote&&this.fileType!==u.b.Forms&&(this.recentTab.footerText=this.locService.UploadFooter)}),this.updateNumLoggableItems(),a.items.length?(this.markMruReady(t.fromCache),this.updateWithNewZeroStateCheck()):Promise.all([this.oneDriveUploadService.uploadEnabledPromise,this.initialTabsPromise]).then(()=>{this.markMruReady(t.fromCache),this.updateWithNewZeroStateCheck()}),this.stateChanged.emit({state:m.a.Displayed}),e.shellDeeplinkPromise||(e.shellDeeplinkPromise=this.activatedRoute.queryParams.pipe(Object(n.a)(1)).toPromise().then(e=>{const t=e.section;t&&"recentdocs"===t.toLowerCase()&&(this.initialListState=l.a.Open,this.focusFirstItem=!0,setTimeout(()=>this.recentTabElement.nativeElement.scrollIntoView(!0),1e3))})),this.showAnalytics){const e=[...this.documents.getAllPinnedDocuments().slice(0,this.maxTotalDocuments),...this.documents.getAllUnpinnedDocuments().slice(0,this.maxTotalDocuments)];this.analyticsService.prefetchAnalytics(e,t.fromCache)}this.appFilter&&0!==this.appFilter.size||this.jumpListService.registerRecentJumpList(i)}copyInflationData(e,t){for(const i of t){let t=null;e.some(e=>e.documentUrl===i.documentUrl&&(t=e,!0))&&i.copyInflationData(t,this.mruConfig.mruActivityEnabled)}}createAttribution(e){if(this.fileType===u.b.Sway)return{title:this.locService.AllSways,url:this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.swayServiceConfigService.config.myEndpoint),tooltip:this.locService.AllSwaysLinkTooltip,ariaLabel:this.locService.AllSwaysLinkAriaLabel,referral:d.a.Sway,zeroTitle:this.locService.AllSways};if(this.fileType===u.b.Forms)return{title:this.locService.AllMyFormsRedirectLabel,onClick:()=>{this.officeRouteService.navigateTo({app:u.b.Forms,route:"AppItems"})},tooltip:this.locService.AllMyFormsRedirectTooltip,ariaLabel:this.locService.AllMyFormsRedirectTooltip,referral:d.a.Forms,zeroTitle:this.locService.AllMyFormsRedirectLabel};{const t={title:this.locService.SeeMoreInOneDrive,url:this.contextService.sharedContext.oneDriveUrl,ariaLabel:this.locService.OpenOneDriveAriaLabel,referral:d.a.OneDrive,zeroTitle:this.locService.GoToOneDrive};return this.oneDriveService.getMyDriveRootUrl().then(i=>{i&&i.userRoot&&(t.url=v.a.appendQuery(i.userRoot,`${this.clientStartupConfigService.config.authType===f.a.MSA?"qt":"view"}=${e}`))}).catch(e=>{this.globalErrorHandler.handleError(e,"u9Mjx")}),t}}updateWithNewZeroStateCheck(){this.emptyRecentNewButtonEnabled=this.isEmptyRecentView(),this.recentTab.attribution=!this.mobile&&this.emptyRecentNewButtonEnabled?null:this.createAttribution(this.mruConfig.oneDriveRecentViewId)}updateListModels(){this.pinnedDocsEnabled?(this.pinnedTab.listModel.items=this.documents.getAllPinnedDocuments(),this.pinnedTab.listModel.maxItemCount=this.pinnedTab.listModel.items.length,this.recentTab.listModel.items=this.documents.getAllDocuments()):this.recentTab.listModel.items=this.documents.getAllDocuments(),this.updateNumLoggableItems(),this.updateWithNewZeroStateCheck()}logTabImpression(e,t,i,s,a,n=c.a.Loaded){this.pendingTabImpressionEvent&&this.logPendingTabImpression();const r=e.slice(0,i),o=this.createImpressionEvent(e,t,r,s,a,n),l=++this.tabImpressionIndex;this.pendingTabImpressionEvent={event:o,items:r,id:l},n===c.a.Loaded?(this.updateNumLoggableItems(),this.waitOnItemInflations(r).then(()=>{this.pendingTabImpressionEvent&&this.pendingTabImpressionEvent.id===l&&this.logPendingTabImpression()})):this.logPendingTabImpression()}logPendingTabImpression(){if(!this.pendingTabImpressionEvent)return;const e=this.pendingTabImpressionEvent.event;this.fillInflatedImpressionParams(e.params,this.pendingTabImpressionEvent.items),e.record(),this.pendingTabImpressionEvent=null}fillInflatedImpressionParams(e,t){e.ActivityDistribution=t.map(e=>this.activityDescriptionService.displayedActivityType(e.activities,e.lastViewedTime,!0)).reduce((e,t,i)=>e+(0===i?"":";")+p.a[t],""),e.IsNewDistribution=t.map(e=>"boolean"==typeof e.isNew?e.isNew.toString():"undefined").reduce((e,t,i)=>e+(0===i?"":";")+t,""),e.IsSharedDistribution=t.map(e=>e.sharing&&"boolean"==typeof e.sharing.shared?e.sharing.shared.toString():"undefined").reduce((e,t,i)=>e+(0===i?"":";")+t,"")}createImpressionEvent(e,t,i,s,a,n=c.a.Loaded,r){const o=!i||this.dataSecurityService.securityLevel>=2?i:i.filter(e=>!e.isLocal),l=u.a.distributionFromFileItems(o),h={};if(h.RenderSize=(o?o.length:0).toString(),h.Distribution=l,h.ElementId=t,h.TotalSize=this.getNumLoggableItems(e).toString(),h.State=s,h.TabState=c.a[n],h.ImpressionId=this.impressionId,h.FromServiceWorkerCache=(!!a).toString(),void 0!==r&&(h.Index=r.toString()),e.length>0){const t=e[0].timeSinceLastOpenInSeconds();null!==t&&(h.InactivityDuration=t.toString())}return this.instrumentationService.generateEvent("Mru_Impression","Generic_Impression",0,h)}markMruReady(e){this.performanceService.mark(e?"Cached_MRU_Ready":"MRU_Ready"),this.browserPaintMeasurementService.recordWhenPainted("MRU")}updateNumLoggableItems(){const e=this.recentTabListModel.tabs[this.selectedTab];this.numLoggableItems=e&&e.listModel?this.getNumLoggableItems(e.listModel.items):0}getNumLoggableItems(e){return e?this.dataSecurityService.securityLevel>=2?e.length:e.filter(e=>!e.isLocal).length:0}}return e.maxCardsPerLine=4,e})();const L=I;class M{}var w=i("fYis"),D=i("7IJ8"),C=i("QhWD"),A=i("lrJm"),E=i("casz"),k=i("RsrG"),x=i("6Po3"),R=i("WLAd"),P=i("9gjh"),O=i("2lMP"),N=i("kpuN"),F=i("dx17"),U=i("4/We"),z=i("/I02"),V=i("pd4Y"),B=i("W3Zz"),W=i("hZW2"),_=i("7Gwk"),j=i("DQbD"),H=i("Bc8L"),q=i("PBJH"),Z=i("kfAr"),$=i("7Rc8"),G=i("dOgD"),J=i("Z0U4"),K=i("EqbI"),Q=i("1Bt+"),Y=i("OPwp"),X=i("55A9"),ee=i("uNUv"),te=i("6u39"),ie=i("TIi1"),se=i("RZcl"),ae=i("EUVs"),ne=i("BMb5"),re=i("vk2e"),oe=i("hjJp"),le=i("345u"),ce=i("xoWf"),he=i("AXqk"),ue=i("TDzr"),de=i("rBEp"),me=i("p6gk"),pe=i("v3sZ"),be=i("Uqr9"),Se=i("3GGT"),ge=i("OyI4"),fe=i("pOWU"),ve=i("oAX+"),Te=i("R7NL"),ye=i("wwmn"),Ie=i("ZtId");let Le=(()=>{class e extends ge.a{constructor(t,i,s,a,n,r,o,l,c,h,u){super(t,i,s,a,n,r,o,l,c,r.config.sharedWithMeV2Enabled?"docs/v2.0/sharedwithme":"docs/sharedwithme",r.config.supportedFileTypesSwM,u),this.updateContentService=h,this.mruConfig=r.config,this.sharingTypeParam=this.mruConfig.sharedWithMeV2Enabled&&!this.mruConfig.sharedAttachmentsEnabled?e.sharingSpecifier:"",this.sharedDocsDataStreamMap=new Map}getSharedDocuments(e,t){const i=`${this.serviceBaseUrl}?${this.requestParams(e,t)}${this.sharingTypeParam}`;if(this.sharedDocsDataStreamMap.has(i))return this.sharedDocsDataStreamMap.get(i);const s=this.updateContentService.getOrAddUpdateStream("sharedwithme-"+i,()=>this.fetchSharedData(i,"network-first")),a=this.fetchSharedData(i,"cache-only"),n=this.fetchSharedData(i,"network-first"),r=ve.a.createResultsWithCacheObservable(a,n,s,e=>this.sharedDocsDataStreamMap.delete(i));return this.sharedDocsDataStreamMap.set(i,r),r}handleQueryParam(e,t,i){"mocksharedwithme"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}fetchSharedData(e,t){return new Promise((i,s)=>{const a=this.mruConfig.sharedWithMeV2Enabled?"2":"1";this.get("Shared_With_Me_Request",e,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e),e.ok&&(t.params.SharedWithMeVersion=a,e.data&&e.data.shared_documents?t.params.ActualSize=e.data.shared_documents.length.toString():t.params.HttpCode=Se.a.UnexpectedResponse.toString())}).then(e=>{e.ok&&e.data&&e.data.shared_documents?(e.data.shared_documents.sort((e,t)=>new Date(t.SharedDate).getTime()-new Date(e.SharedDate).getTime()),i({items:e.data.shared_documents,fromCache:e.fromCache})):s(new fe.b(e,"No data returned"))}).catch(e=>{this.globalErrorHandler.handleError(e,"sMMaG")})},s,this.getNewRequestConfig(!1),t)})}}return e.sharingSpecifier="&sharingTypes=ShareFlow",e.ɵprov=s.bc({factory:function(){return new e(s.cc(N.a),s.cc(h.a),s.cc(Te.a),s.cc(z.a),s.cc(ye.a),s.cc(b.a),s.cc(re.q),s.cc(A.b),s.cc(f.b),s.cc(Ie.a),s.cc(E.a))},token:e,providedIn:"root"}),e})(),Me=(()=>{class e extends fe.a{constructor(e,t,i,s,a,n,r,o,l){super(e,t,i,"Substrate",s,a,r,l),this.mruConfigService=n,this.globalErrorHandler=o,this.requestConfig={headers:new Map([["Accept","application/json"],["Prefer",'exchange.behavior="OfficeGraphInsights"']])},this.trendingDataStreamMap=new Map}static fileType(e){return e&&e.ResourceVisualization&&e.ResourceVisualization.Type?u.a.fileTypeNameToFileType(e.ResourceVisualization.Type):u.b.Unknown}getTrendingDocuments(t,i){const s=this.mruConfigService.config.supportedFileTypes,a=(i&&i.size?s.filter(e=>i.has(u.a.fileTypeNameToFileType(e))):s).reduce((e,t,i)=>`${e}${i>0?" or ":""}resourceVisualization/Type eq '${t}'`,""),n=`${this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:this.mruConfigService.config.substrateApiEndpoint}${e.trendingPath}?$top=${t}&$filter=${encodeURIComponent(a)}`;if(this.trendingDataStreamMap.has(n))return this.trendingDataStreamMap.get(n);const r=this.fetchTrendingDocData(n,"cache-only"),o=this.fetchTrendingDocData(n,"network-first"),l=ve.a.createResultsWithCacheObservable(r,o,null,e=>this.trendingDataStreamMap.delete(n));return this.trendingDataStreamMap.set(n,l),l}handleQueryParam(e,t){"mockinsights"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)}fetchTrendingDocData(t,i){return new Promise((s,a)=>{this.get("Trending_Documents_Request",t,t=>{t.instrument((t,i)=>{i.params.RequestId=this.getRequestIdFromResponse(t),t.ok&&(t.data&&t.data.value?(i.params.ActualSize=t.data.value.length.toString(),i.params.Distribution=u.a.distributionFromFileTypes(t.data.value.map(t=>e.fileType(t)))):i.params.HttpCode=Se.a.UnexpectedResponse.toString())}).then(e=>{e&&e.data&&e.data.value?s({items:e.data.value,fromCache:e.fromCache}):a(new fe.b(e,"No data returned"))}).catch(e=>{this.globalErrorHandler.handleError(e,"hLENC")})},a,this.requestConfig,i)})}}return e.trendingPath="/api/beta/me/officegraphinsights/trending",e.ɵprov=s.bc({factory:function(){return new e(s.cc(N.a),s.cc(h.a),s.cc(Te.a),s.cc(z.a),s.cc(ye.a),s.cc(b.a),s.cc(re.q),s.cc(A.b),s.cc(E.a))},token:e,providedIn:"root"}),e})();var we=i("qk26"),De=i("JH4S"),Ce=i("JScD"),Ae=i("6GOa"),Ee=i("Ry9Z"),ke=i("7wk3"),xe=i("BJbw"),Re=i("9MHL"),Pe=i("6UlS"),Oe=i("OWzB");let Ne=(()=>{class e{constructor(e,t,i){this.createDocumentService=e,this.capabilitiesService=t,this.globalErrorHandler=i,this.createLinks=new Pe.a([]),this.createButtonEnabled=new Pe.a(!1),this.createLinksSubscription=this.createDocumentService.getCreateLinks().subscribe(e=>{this.onCreateLinks(e)},e=>{this.onError(e)})}ngOnDestroy(){var e;null===(e=this.createLinksSubscription)||void 0===e||e.unsubscribe()}onCreateLinks(e){this.createLinks.next(e),this.createButtonEnabled.next(this.capabilitiesService.capabilities.createDocumentSupported&&e.length>0)}onError(e){this.globalErrorHandler.handleError(e,"wmh4W")}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(Oe.a),s.cc(U.a),s.cc(A.b))},token:e,providedIn:"root"}),e})();var Fe=i("Dpxn"),Ue=i("w1PR"),ze=s.wb({encapsulation:2,styles:[],data:{}});function Ve(e){return s.ac(0,[(e()(),s.yb(0,16777216,null,null,2,null,null,null,null,null,null,null)),s.xb(1,475136,null,0,D.a,[C.a,s.O,A.b,f.b,E.a,k.a,x.a,s.z,R.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),s.Qb(2,{showAsLink:0,fileType:1,numDocuments:2}),(e()(),s.hb(0,null,null,0))],(function(e,t){var i=t.component,s=e(t,2,0,!0,i.fileType,(null==i.recentTabListModel||null==i.recentTabListModel.tabs[i.selectedTab]||null==i.recentTabListModel.tabs[i.selectedTab].listModel||null==i.recentTabListModel.tabs[i.selectedTab].listModel.items?null:i.recentTabListModel.tabs[i.selectedTab].listModel.items.length)||0);e(t,1,0,"upload-button#UploadButtonModule",s)}),null)}function Be(e){return s.ac(0,[(e()(),s.yb(0,0,null,null,1,"ohp-mru-item",[],null,[[null,"addItem"],[null,"deleteItem"],[null,"changePinState"]],(function(e,t,i){var s=!0,a=e.component;return"addItem"===t&&(s=!1!==a.onAddItem(i)&&s),"deleteItem"===t&&(s=!1!==a.onDeleteItem(i)&&s),"changePinState"===t&&(s=!1!==a.onChangePinState(i)&&s),s}),P.b,P.a)),s.xb(1,770048,null,0,O.a,[N.a,F.a,U.a,f.b,z.a,V.a,B.b,W.a,_.a,j.a,h.a,H.a,q.a,b.a,Z.a,$.a,G.a,J.a,K.a,s.D,Q.a,Y.b,X.a,ee.a,te.a,ie.a,se.a,ae.a,ne.b],{item:[0,"item"],index:[1,"index"],view:[2,"view"],listId:[3,"listId"],focusOnLoad:[4,"focusOnLoad"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{addItem:"addItem",deleteItem:"deleteItem",changePinState:"changePinState"})],(function(e,t){var i=t.component;e(t,1,0,t.parent.context.item,t.parent.context.index,t.parent.context.itemView,t.parent.context.listId,t.parent.context.focusOnLoad,i.showActivity,i.showSharing,i.showAnalytics,i.fileType)}),null)}function We(e){return s.ac(0,[(e()(),s.yb(0,0,null,null,1,"ohp-mru-item",[],null,[[null,"addItem"],[null,"deleteItem"],[null,"changePinState"]],(function(e,t,i){var s=!0,a=e.component;return"addItem"===t&&(s=!1!==a.onAddItem(i)&&s),"deleteItem"===t&&(s=!1!==a.onDeleteItem(i)&&s),"changePinState"===t&&(s=!1!==a.onChangePinState(i)&&s),s}),P.b,P.a)),s.xb(1,770048,null,0,O.a,[N.a,F.a,U.a,f.b,z.a,V.a,B.b,W.a,_.a,j.a,h.a,H.a,q.a,b.a,Z.a,$.a,G.a,J.a,K.a,s.D,Q.a,Y.b,X.a,ee.a,te.a,ie.a,se.a,ae.a,ne.b],{item:[0,"item"],index:[1,"index"],view:[2,"view"],listId:[3,"listId"],focusOnLoad:[4,"focusOnLoad"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{addItem:"addItem",deleteItem:"deleteItem",changePinState:"changePinState"})],(function(e,t){var i=t.component;e(t,1,0,t.parent.context.item,t.parent.context.index,t.parent.context.itemView,t.parent.context.listId,0===t.parent.context.index,i.showActivity,i.showSharing,i.showAnalytics,i.fileType)}),null)}function _e(e){return s.ac(0,[(e()(),s.yb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),s.hb(16777216,null,null,1,null,Be)),s.xb(2,16384,null,0,re.k,[s.O,s.L],{ngIf:[0,"ngIf"]},null),(e()(),s.hb(16777216,null,null,1,null,We)),s.xb(4,16384,null,0,re.k,[s.O,s.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,!i.focusFirstItem),e(t,4,0,i.focusFirstItem)}),null)}function je(e){return s.ac(0,[(e()(),s.yb(0,16777216,null,null,2,null,null,null,null,null,null,null)),s.xb(1,475136,null,0,D.a,[C.a,s.O,A.b,f.b,E.a,k.a,x.a,s.z,R.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),s.Qb(2,{buttonOrigin:0,fileType:1,numDocuments:2}),(e()(),s.hb(0,null,null,0))],(function(e,t){var i=t.component,s=e(t,2,0,i.emptyViewName,i.fileType,i.numLoggableItems);e(t,1,0,"upload-button#UploadButtonModule",s)}),null)}function He(e){return s.ac(0,[(e()(),s.yb(0,16777216,null,null,2,null,null,null,null,null,null,null)),s.xb(1,475136,null,0,D.a,[C.a,s.O,A.b,f.b,E.a,k.a,x.a,s.z,R.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),s.Qb(2,{buttonOrigin:0,numDocuments:1}),(e()(),s.hb(0,null,null,0))],(function(e,t){var i=t.component,s=e(t,2,0,i.emptyViewName,i.numLoggableItems);e(t,1,0,"create-menu#CreateMenuModule",s)}),null)}function qe(e){return s.ac(0,[(e()(),s.yb(0,0,null,null,4,"div",[["class","buttons-container buttons-container--empty"]],null,null,null,null,null)),(e()(),s.hb(16777216,null,null,1,null,je)),s.xb(2,16384,null,0,re.k,[s.O,s.L],{ngIf:[0,"ngIf"]},null),(e()(),s.hb(16777216,null,null,1,null,He)),s.xb(4,16384,null,0,re.k,[s.O,s.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,(!i.filePickerEnabled||i.filePickerEnabled&&i.showFilePickerUploadButton)&&i.uploadEnabled),e(t,4,0,i.createButtonEnabled)}),null)}function Ze(e){return s.ac(0,[(e()(),s.yb(0,0,[[1,0],["recentTab",1]],null,14,"div",[],null,null,null,null,null)),s.xb(1,278528,null,0,re.i,[s.s,s.t,s.l,s.D],{ngClass:[0,"ngClass"]},null),s.Pb(131072,re.b,[s.h]),s.Qb(3,{"recent-tab__height-restrictor":0,"mru-component":1,"width-restrictor--backplate":2}),(e()(),s.yb(4,0,null,null,8,"ohp-tab-list",[],null,[[null,"tabClicked"]],(function(e,t,i){var s=!0;return"tabClicked"===t&&(s=!1!==e.component.onTabClicked(i)&&s),s}),oe.b,oe.a)),s.xb(5,4308992,null,1,le.b,[B.b,h.a,q.a,ce.a,U.a,s.h,f.b,A.b],{model:[0,"model"],columnsEnabled:[1,"columnsEnabled"],tileViewEnabled:[2,"tileViewEnabled"],listState:[3,"listState"],defaultStateNoMinHeight:[4,"defaultStateNoMinHeight"],customButtonEnabled:[5,"customButtonEnabled"],defaultView:[6,"defaultView"]},{tabClicked:"tabClicked"}),s.Tb(603979776,2,{tabListItems:1}),(e()(),s.yb(7,0,null,0,3,"div",[["ohpTabListButton",""]],null,null,null,null,null)),s.xb(8,16384,null,0,le.a,[],null,null),(e()(),s.hb(16777216,null,null,1,null,Ve)),s.xb(10,16384,null,0,re.k,[s.O,s.L],{ngIf:[0,"ngIf"]},null),(e()(),s.hb(0,null,null,1,null,_e)),s.xb(12,16384,[[2,4]],0,le.c,[s.L],null,null),(e()(),s.hb(16777216,null,null,1,null,qe)),s.xb(14,16384,null,0,re.k,[s.O,s.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,a=e(t,3,0,!(null!=i.recentTabListModel.tabs[i.selectedTab].listModel&&i.recentTabListModel.tabs[i.selectedTab].listModel.items.length)||i.recentTabListModel.tabs[i.selectedTab].hasError,i.isAntpExperience,s.Yb(t,1,0,s.Nb(t,2).transform(i.backplatesEnabled)));e(t,1,0,a),e(t,5,0,i.recentTabListModel,!0,i.tileViewEnabled,i.initialListState,!0,(i.uploadEnabled&&!i.filePickerEnabled||i.uploadEnabled&&i.filePickerEnabled&&i.showFilePickerUploadButton)&&i.headless,i.defaultView),e(t,10,0,(!i.filePickerEnabled||i.showFilePickerUploadButton)&&i.uploadEnabled&&i.headless),e(t,14,0,i.emptyRecentNewButtonEnabled&&(i.createButtonEnabled||i.uploadEnabled))}),null)}function $e(e){return s.ac(0,[s.Tb(671088640,1,{recentTabElement:0}),(e()(),s.hb(16777216,null,null,1,null,Ze)),s.xb(2,16384,null,0,re.k,[s.O,s.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,null==i.recentTabListModel.tabs?null:i.recentTabListModel.tabs.length)}),null)}function Ge(e){return s.ac(0,[(e()(),s.yb(0,0,null,null,1,"ohp-mru-component",[],null,null,null,$e,ze)),s.xb(1,245760,null,0,I,[U.a,s.h,f.b,z.a,he.a,B.b,W.a,_.a,ue.a,h.a,de.a,q.a,b.a,me.a,K.a,pe.a,be.b,$.a,Le,Me,we.a,A.b,De.a,Ce.a,F.a,J.a,Ae.a,Ee.a,ke.a,xe.a,Re.a,Ne,Fe.a,Ue.a],null,null)],(function(e,t){e(t,1,0)}),null)}var Je=s.ub("ohp-mru-component",I,Ge,{fileType:"fileType",maxInitialDocs:"maxInitialDocs",maxTotalDocs:"maxTotalDocs",headless:"headless",recentMruStreamData:"recentMruStreamData",title:"title"},{stateChanged:"stateChanged"},[]),Ke=i("xIlw"),Qe=i("lQwO"),Ye=i("+P5Z"),Xe=i("izKO"),et=i("L9A/"),tt=i("+a0u"),it=i("ej7j"),st=i("VY7U"),at=i("up2P"),nt=i("D8EG"),rt=i("cxfp"),ot=i("D6F8"),lt=i("9InZ"),ct=i("T/SX"),ht=i("upmJ"),ut=i("T6pR"),dt=i("5WpM"),mt=i("ApBt"),pt=i("mOWz"),bt=i("ci1G");class St{}var gt=i("CCRL"),ft=s.vb(M,[],(function(e){return s.Kb([s.Lb(512,s.j,s.Y,[[8,[w.a,Je]],[3,s.j],s.x]),s.Lb(4608,re.m,re.l,[s.u]),s.Lb(1073742336,re.c,re.c,[]),s.Lb(1073742336,Ke.a,Ke.a,[]),s.Lb(1073742336,Qe.a,Qe.a,[]),s.Lb(1073742336,Ye.a,Ye.a,[]),s.Lb(1073742336,Xe.a,Xe.a,[]),s.Lb(1073742336,et.a,et.a,[]),s.Lb(1073742336,tt.a,tt.a,[]),s.Lb(1073742336,it.a,it.a,[]),s.Lb(1073742336,we.n,we.n,[[2,we.s],[2,we.m]]),s.Lb(1073742336,st.a,st.a,[]),s.Lb(1073742336,at.a,at.a,[]),s.Lb(1073742336,nt.a,nt.a,[]),s.Lb(1073742336,rt.a,rt.a,[]),s.Lb(1073742336,ot.a,ot.a,[]),s.Lb(1073742336,lt.a,lt.a,[]),s.Lb(1073742336,ct.a,ct.a,[]),s.Lb(1073742336,ht.a,ht.a,[]),s.Lb(1073742336,ut.a,ut.a,[]),s.Lb(1073742336,dt.a,dt.a,[]),s.Lb(1073742336,mt.b,mt.b,[]),s.Lb(1073742336,pt.f,pt.f,[]),s.Lb(1073742336,bt.a,bt.a,[]),s.Lb(1073742336,St,St,[]),s.Lb(1073742336,M,M,[]),s.Lb(256,gt.a,L,[])])}))},WJAz:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var s=i("GAcG"),a=i("r7hm"),n=i("UGNb"),r=i("/zlj"),o=i("REFP"),l=i("O6Zd");function c(...e){let t;return"function"==typeof e[e.length-1]&&(t=e.pop()),1===e.length&&Object(a.a)(e[0])&&(e=e[0]),0===e.length?n.a:t?c(e).pipe(Object(l.a)(e=>t(...e))):new s.a(t=>new h(t,e))}class h extends o.a{constructor(e,t){super(e),this.sources=t,this.completed=0,this.haveValues=0;const i=t.length;this.values=new Array(i);for(let e=0;e<i;e++){const i=t[e],s=Object(r.a)(this,i,null,e);s&&this.add(s)}}notifyNext(e,t,i,s,a){this.values[i]=t,a._hasValue||(a._hasValue=!0,this.haveValues++)}notifyComplete(e){const{destination:t,haveValues:i,values:s}=this,a=s.length;e._hasValue?(this.completed++,this.completed===a&&(i===a&&t.next(s),t.complete())):t.complete()}}},rBrS:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var s=function(e){return e.Recent="recent",e.FormsTabList="formsTabList",e}({})}}]);
//# sourceMappingURL=antp-mru.a11f6376b7d7d7d16ef6.chunk.v4.js.map