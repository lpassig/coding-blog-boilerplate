(window.officehome_antp_webpackJsonp=window.officehome_antp_webpackJsonp||[]).push([[4],{aBzG:function(n,e,l){"use strict";l.r(e),l.d(e,"ContextMenuModuleNgFactory",(function(){return N}));var t=l("Mlb/");let i=(()=>{class n{constructor(n,e,l,t,i){this.capabilitiesService=n,this.contextService=e,this.contextMenuService=l,this.documentService=t,this.shellHeight=i}set menuComponent(n){n&&this.mobileMenusEnabled&&this.focusOnOpen&&n.setActiveIndex(0,!0)}ngOnInit(){this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileContextMenusEnabled,this.antpLoaded=this.capabilitiesService.capabilities.antpLoaded,this.contextMenuSubscription=this.contextMenuService.subscribeToOpenEvents(n=>{n&&(this.animationState="open",this.focusOnOpen=n.focusFirstItem,this.menu=n,this.mobileMenusEnabled||this.positionMenu())})}ngOnDestroy(){this.contextMenuSubscription&&this.contextMenuSubscription.unsubscribe()}onSelectItem(n){this.menu.menu.items[n.index].executeAction(n.nativeDomEvent),this.onCloseMenu()}onCloseMenu(){var n,e;this.contextMenuService.closeMenu(this.menu),this.animationState=null,this.focusOnOpen=!1;const l=document.getElementById(null===(e=null===(n=this.menu)||void 0===n?void 0:n.menu)||void 0===e?void 0:e.id);null==l||l.focus(),this.menu=null}positionMenu(){const e=this.documentService.nativeDocument.querySelector(this.antpLoaded?"#antp__scroll-content":"#officeHome__scroll-content");this.menuStyle={"left.px":this.menu.position.left,"top.px":this.menu.position.top-this.shellHeight+e.scrollTop};const l=this.contextService.isRtl;(this.menu.position.left<n.ContextMenuBuffer&&(l?!this.menu.menu.rightAligned:this.menu.menu.rightAligned)||this.menu.position.left>e.clientWidth-n.ContextMenuBuffer&&(l?this.menu.menu.rightAligned:!this.menu.menu.rightAligned))&&(this.menu.menu.rightAligned=!this.menu.menu.rightAligned),this.menu.position.top<n.ContextMenuBuffer&&this.menu.menu.bottomAligned?this.menu.menu.bottomAligned=!1:this.menu.position.top>e.clientHeight+this.shellHeight-n.ContextMenuBuffer&&!this.menu.menu.bottomAligned&&(this.menu.menu.bottomAligned=!0)}}return n.ContextMenuBuffer=300,n})();const u=i;class o{}var s=l("fYis"),a=l("pzhl"),c=l("PkQn"),m=l("4/We"),b=l("vk2e"),r=l("NdOS"),p=l("RitX"),h=l("mu6k"),d=l("W3Zz"),f=l("hZW2"),v=l("PBJH"),x=l("BMb5"),M=l("/I02"),g=l("5FMq"),y=l("vW6f"),C=t.wb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"open",definitions:[{type:1,expr:"* => open",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:"{{ opacity }}"},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"150ms",opacity:.5}}},options:null},options:null}],options:{}}]}});function _(n){return t.ac(0,[(n()(),t.yb(0,0,null,null,0,"div",[["class","page-overlay__background page-overlay__background--darker"]],[[24,"@open",0]],null,null,null,null))],null,(function(n,e){n(e,0,0,e.component.animationState)}))}function S(n){return t.ac(0,[(n()(),t.yb(0,0,null,null,5,null,null,null,null,null,null,null)),(n()(),t.yb(1,0,null,null,4,"div",[["class","actions-menu-item__flex-content"]],null,null,null,null,null)),(n()(),t.yb(2,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,a.b,a.a)),t.xb(3,638976,null,0,c.a,[m.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontCssClass:[2,"iconFontCssClass"],iconFontType:[3,"iconFontType"],size:[4,"size"]},null),(n()(),t.yb(4,0,null,null,1,"div",[],[[8,"className",0]],null,null,null,null)),(n()(),t.Xb(5,null,["",""]))],(function(n,e){n(e,3,0,e.context.item.iconColor,t.Fb(2,"actions-menu-item__icon ms-fcl-bl ",e.component.mobileMenusEnabled?"actions-menu-item__icon--mobile":""," ",e.context.item.disabled?"menu-item__icon--disabled":"",""),e.context.item.iconCssClass,e.context.item.icon,"16")}),(function(n,e){n(e,4,0,t.Fb(1,"list-item__title menu-item__title ms-fcl-bl ",e.context.item.disabled?"menu-item__title--disabled":"","")),n(e,5,0,e.context.item.title)}))}function L(n){return t.ac(0,[(n()(),t.yb(0,0,null,null,12,"div",[["ohpViewCacheOperation","remove-node"]],[[1,"role",0],[1,"aria-modal",0],[1,"data-view-cache-operation",0],[1,"data-view-cache-parameters",0]],null,null,null,null)),t.xb(1,278528,null,0,b.i,[t.s,t.t,t.l,t.D],{ngClass:[0,"ngClass"]},null),t.Qb(2,{"o365cs-base page-overlay":0}),t.xb(3,16384,null,0,r.a,[],{viewCacheOperation:[0,"viewCacheOperation"]},null),(n()(),t.hb(16777216,null,null,1,null,_)),t.xb(5,16384,null,0,b.k,[t.O,t.L],{ngIf:[0,"ngIf"]},null),(n()(),t.yb(6,0,null,null,6,"div",[["class","context-menu"]],null,null,null,null,null)),t.xb(7,278528,null,0,b.n,[t.l,t.t,t.D],{ngStyle:[0,"ngStyle"]},null),(n()(),t.yb(8,0,null,null,4,"ohp-menu",[],null,[[null,"selectItem"],[null,"closeMenu"]],(function(n,e,l){var t=!0,i=n.component;return"selectItem"===e&&(t=!1!==i.onSelectItem(l)&&t),"closeMenu"===e&&(t=!1!==i.onCloseMenu()&&t),t}),p.b,p.a)),t.xb(9,4440064,[[1,4]],1,h.a,[d.b,f.a,t.h,v.a,t.D,t.l,x.b],{menuModel:[0,"menuModel"],mobileMenu:[1,"mobileMenu"]},{selectItem:"selectItem",closeMenu:"closeMenu"}),t.Tb(603979776,2,{menuItems:1}),(n()(),t.hb(0,null,null,1,null,S)),t.xb(12,16384,[[2,4]],0,h.b,[t.L],null,null)],(function(n,e){var l=e.component,t=n(e,2,0,l.mobileMenusEnabled);n(e,1,0,t),n(e,3,0,"remove-node"),n(e,5,0,l.mobileMenusEnabled),n(e,7,0,l.menuStyle),n(e,9,0,l.menu.menu,l.mobileMenusEnabled)}),(function(n,e){var l=e.component;n(e,0,0,l.mobileMenusEnabled?"dialog":null,!!l.mobileMenusEnabled||null,t.Nb(e,3).viewCacheOperation,t.Nb(e,3).viewCacheParameters)}))}function I(n){return t.ac(0,[t.Tb(671088640,1,{menuComponent:0}),(n()(),t.hb(16777216,null,null,1,null,L)),t.xb(2,16384,null,0,b.k,[t.O,t.L],{ngIf:[0,"ngIf"]},null)],(function(n,e){n(e,2,0,e.component.menu)}),null)}function O(n){return t.ac(0,[(n()(),t.yb(0,0,null,null,1,"ohp-context-menu",[],null,null,null,I,C)),t.xb(1,245760,null,0,i,[m.a,M.a,g.a,f.a,y.a],null,null)],(function(n,e){n(e,1,0)}),null)}var w=t.ub("ohp-context-menu",i,O,{},{},[]),E=l("xIlw"),A=l("lQwO"),k=l("+a0u"),B=l("+P5Z"),F=l("ej7j"),D=l("qk26"),z=l("VY7U"),H=l("cxfp"),T=l("CCRL"),N=t.vb(o,[],(function(n){return t.Kb([t.Lb(512,t.j,t.Y,[[8,[s.a,w]],[3,t.j],t.x]),t.Lb(4608,b.m,b.l,[t.u]),t.Lb(1073742336,b.c,b.c,[]),t.Lb(1073742336,E.a,E.a,[]),t.Lb(1073742336,A.a,A.a,[]),t.Lb(1073742336,k.a,k.a,[]),t.Lb(1073742336,B.a,B.a,[]),t.Lb(1073742336,F.a,F.a,[]),t.Lb(1073742336,D.n,D.n,[[2,D.s],[2,D.m]]),t.Lb(1073742336,z.a,z.a,[]),t.Lb(1073742336,H.a,H.a,[]),t.Lb(1073742336,o,o,[]),t.Lb(256,T.a,u,[])])}))}}]);
//# sourceMappingURL=antp-context-menu.017a838c7e00d883fb83.chunk.v4.js.map