!function(e){function t(t){for(var n,r,a=t[0],l=t[1],c=t[2],u=0,d=[];u<a.length;u++)r=a[u],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(h&&h(t);d.length;)d.shift()();return o.push.apply(o,c||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],n=!0,r=1;r<i.length;r++)0!==s[i[r]]&&(n=!1);n&&(o.splice(t--,1),e=a(a.s=i[0]))}return e}var n={},r={1:0},s={1:0},o=[];function a(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.e=function(e){var t=[];r[e]?t.push(r[e]):0!==r[e]&&{3:1,5:1,6:1,7:1,9:1,10:1,14:1}[e]&&t.push(r[e]=new Promise((function(t,i){for(var n="antp-"+({0:"group-items~mru~wac-cnt",3:"app-items",4:"context-menu",5:"fl-unsupported-page",6:"group-items",7:"m365-apps",8:"mru",9:"odsp-start-onedrive",10:"odsp-start-sharepoint",11:"share-control",12:"vendors~lpc-bootstrapper",13:"vendors~m365-apps",14:"wac-cnt"}[e]||e)+"."+{0:"31d6cfe0d16ae931b73c",3:"0e4338761429b4eb16ac",4:"31d6cfe0d16ae931b73c",5:"fd7e305f943bd6789fd9",6:"44c3c66960354ba5b569",7:"02d0c2e79cd59adb2cf4",8:"31d6cfe0d16ae931b73c",9:"640799bcbd1a5e0c0d6e",10:"640799bcbd1a5e0c0d6e",11:"31d6cfe0d16ae931b73c",12:"31d6cfe0d16ae931b73c",13:"31d6cfe0d16ae931b73c",14:"0cb35e49acf899a87a0e"}[e]+".chunk.v4.css",s=a.p+n,o=document.getElementsByTagName("link"),l=0;l<o.length;l++){var c=(h=o[l]).getAttribute("data-href")||h.getAttribute("href");if("stylesheet"===h.rel&&(c===n||c===s))return t()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){var h;if((c=(h=u[l]).getAttribute("data-href"))===n||c===s)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var n=t&&t.target&&t.target.src||s,o=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=n,delete r[e],d.parentNode.removeChild(d),i(o)},d.href=s,0!==d.href.indexOf(window.location.origin+"/")&&(d.crossOrigin="anonymous"),document.getElementsByTagName("head")[0].appendChild(d)})).then((function(){r[e]=0})));var i=s[e];if(0!==i)if(i)t.push(i[2]);else{var n=new Promise((function(t,n){i=s[e]=[t,n]}));t.push(i[2]=n);var o,l=document.createElement("script");l.charset="utf-8",l.timeout=120,a.nc&&l.setAttribute("nonce",a.nc),l.src=function(e){return a.p+"antp-"+({0:"group-items~mru~wac-cnt",3:"app-items",4:"context-menu",5:"fl-unsupported-page",6:"group-items",7:"m365-apps",8:"mru",9:"odsp-start-onedrive",10:"odsp-start-sharepoint",11:"share-control",12:"vendors~lpc-bootstrapper",13:"vendors~m365-apps",14:"wac-cnt"}[e]||e)+"."+{0:"8c9ceb5f9a7fbb229599",3:"ea642a203683e06c8171",4:"017a838c7e00d883fb83",5:"5c29da7f0c91b800fc48",6:"bb2872daac00c504f2d6",7:"916bd2579ec82c804f3c",8:"a11f6376b7d7d7d16ef6",9:"1e156c65ee8ee8e07237",10:"723c7e52e6696b2bb062",11:"ce80e7ca8c0222144633",12:"851b7ce7d9ed751b2a12",13:"92da8f239716858a2439",14:"96ac25c464fea58490ff"}[e]+".chunk.v4.js"}(e),0!==l.src.indexOf(window.location.origin+"/")&&(l.crossOrigin="anonymous");var c=new Error;o=function(t){l.onerror=l.onload=null,clearTimeout(u);var i=s[e];if(0!==i){if(i){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+r+")",c.name="ChunkLoadError",c.type=n,c.request=r,i[1](c)}s[e]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:l})}),12e4);l.onerror=l.onload=o,document.head.appendChild(l)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(i,n,function(t){return e[t]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a.oe=function(e){throw console.error(e),e};var l=window.officehome_antp_webpackJsonp=window.officehome_antp_webpackJsonp||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var h=c;o.push([0,2]),i()}({"+2OL":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("dFxn");let s=(()=>{class e{constructor(e){this.config=e.parse("serviceWorkerConfig")||{diskPreloadEnabled:!1,enabled:!1,pilotFlights:[],serviceWorkerAllowedFlights:[],scope:"",scriptUrl:""}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a))},token:e,providedIn:"root"}),e})()},"+P5Z":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("p6wn"),r=i("hhzZ");class s{static forRoot(){return{ngModule:s,providers:[{provide:r.a,useClass:n.a}]}}}},"+a0u":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},"/I02":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("H90i"),r=i("Mlb/"),s=i("4/We"),o=i("Qo/9"),a=i("hZW2"),l=i("Z0U4"),c=i("Ax7d"),u=i("dFxn");let h=(()=>{class e{constructor(e,t,i,n,r,s){this.capabilitiesService=e,this.cookieService=t,this.documentService=i,this.officeRouteService=n,this.webPwaService=r,this.sharedContext=s.parse("sharedContext")||{abtSignoutPath:null,activityLifetimeInSeconds:0,activityTrackingEnabled:!1,consumerShellServiceEndpoint:null,createButtonTextCompleteStopCount:0,createButtonTextEmptyStopCount:0,createButtonTextTypingSpeed:0,dataUpdateCooldownInSeconds:0,dataUpdateIntervalInSeconds:0,dataUpdateMaxConsecutiveFailures:0,dataUpdateTimeoutInSeconds:0,dateOverride:null,defaultLinkTarget:"_blank",fluentHeroImageUrl:null,graphApiRoot:null,graphMaxBatchSize:1,graphApiRootRefreshIntervalInSeconds:0,heroImageUrl:null,heroTitleGradientImageUrl:null,iceApplicationId:-1,inactivityTimeoutInSeconds:60,inMockMode:!1,msaAppId:null,msaTokenRedirectUrl:null,msaTokenTimeoutMs:0,officeHomeApiRoot:null,officeMarket:"en-us",officeMarketCountry:"us",officeMarketLcid:"1033",oneDriveConsumerApi:null,oneDriveResourceId:null,oneDriveUrl:null,oneNoteCreateClassNoteBookUrl:null,outlookServiceRoot:null,portalRoot:null,recommendedIceApplicationId:-1,serviceWorkerIntervalUpdateEnabled:!1,sharePointResourceId:null,signOutRedirectUrl:null,signOutUrlTemplate:null,spaceThemeHeroImageUrl:null,substrateSearchRoot:null,tokenLoginUrlTemplate:null,updateDataOnViewEnabled:!1,usingOneDriveResourceAsSharePointResource:!1};const o=this.documentService.nativeDocument.getElementsByTagName("html");this.isRtl=o&&o[0]&&"rtl"===o[0].getAttribute("dir"),this.defaultLinkTarget=this.sharedContext.defaultLinkTarget,this.webPwaService.isStandalone.subscribe(e=>{this.isStandalone=e,this.sharedContext.defaultLinkTarget=e&&!this.webPwaService.isOfficeApp()?"_self":this.defaultLinkTarget})}getCsrfToken(){return this.cookieService.get("AjaxSessionKey")}getWdOrigin(e){return`OFFICECOM-${this.getWdOriginApp()}.${this.getWdOriginPage()}.${e}`}getWdOriginPage(){const e=this.officeRouteService.getCurrentRoute();if(e)switch(e.route){case"Start":return n.c.Start;case"Templates":return n.c.Templates;case"Content":return n.c.Content;case"Search":return n.c.Search;default:return n.c.Home}return n.c.Home}getWdOriginApp(){return this.isStandalone?n.b.PWA:this.capabilitiesService.capabilities.antpLoaded?n.b.NTP:this.capabilitiesService.capabilities.pwaEnabled?n.b.HWA:n.b.Web}}return e.ɵprov=r.bc({factory:function(){return new e(r.cc(s.a),r.cc(o.d),r.cc(a.a),r.cc(l.a),r.cc(c.a),r.cc(u.a))},token:e,providedIn:"root"}),e})()},0:function(e,t,i){i("xDq8"),e.exports=i("kS0f")},"1A1F":function(e,t,i){},"1Bt+":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t,i){this.dateService=e,this.locService=t,this.timestampFormatService=i}transform(e,t,i,n){return e?(null==i&&(i=e.toDateString()),this.commonFormat(e,t,i,n)):""}commonFormat(e,t,i,n){if(!this.locService.supportsLocaleSpecifiers)return i;const r=this.dateService.timespanInSeconds(e);switch(this.timestampFormatService.getTimestampType(e)){case 9:return this.timespanString(r,this.locService.NumberMinutesInShort,-60);case 0:return"";case 1:return n?this.locService.JustNowLowerCase:this.locService.JustNow;case 2:return this.timespanString(r,this.locService.NumberMinutesAgoShort,60);case 3:return this.timespanString(r,this.locService.NumberHoursAgoShort,3600);case 4:return t?n?this.locService.YesterdayLowerCase:this.locService.Yesterday:this.locService.format(n?this.locService.TimeYesterdayLowerCase:this.locService.TimeYesterday,this.locService.formatTimeFromDate(e));case 5:return t?this.locService.localizedWeekday(e):this.locService.format(this.locService.TimeDayOfWeek,this.locService.localizedWeekday(e),this.locService.formatTimeFromDate(e));case 6:return this.locService.localizedMonthDate(e);default:return this.locService.localizedDateStringMedium(e)}}timespanString(e,t,i){const n=Math.round(e/i);return this.locService.format(t,this.locService.localizedNumberString(n))}}},"1ygu":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e[e.Closed=0]="Closed",e[e.Open=1]="Open",e}({})},"24t9":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));let n=(()=>{class e{static getKey(t){return e.KeysToKeyboardKeys[t.key]||e.KeyCodesToKeyboardKeys[t.keyCode]||0}}return e.KeysToKeyboardKeys={Tab:1,Enter:2,Shift:16,Esc:3,Escape:3,Up:4,ArrowUp:4,Down:5,ArrowDown:5,Zero:48,Nine:57,a:65,z:90,A:65,Z:90,"/":191},e.KeyCodesToKeyboardKeys={9:1,13:2,16:16,27:3,38:4,40:5,48:48,57:57,65:65,90:90,191:191},e})()},"2lMP":function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("Mlb/"),r=i("70cc"),s=i("OPwp"),o=i("A/um"),a=i("hhzZ"),l=i("BaAg"),c=i("L/Tc"),u=i("QOOv"),h=i("JT1q"),d=i("fKR7"),m=i("EUVs"),p=i("cgnd"),f=i("uUrA"),g=i("24t9"),b=i("WFKr"),v=i("ZBli"),S=i("H90i");let y=(()=>{class e{constructor(t,i,r,o,a,c,u,h,d,m,f,g,b,v,S,y,w,C,I,T,k,E,A,P,x,D,M,F,L){this.accessTokenService=t,this.activityDescriptionService=i,this.capabilitiesService=r,this.clientStartupConfigService=o,this.contextService=a,this.dateService=c,this.deviceDetector=u,this.documentService=h,this.eventService=d,this.fluidHostContext=m,this.instrumentationService=f,this.localAppLauncherService=g,this.locService=b,this.mruConfigService=v,this.mruItemInflationService=S,this.mruDataService=y,this.officeFeedService=w,this.officeRouteService=C,this.onenoteService=I,this.renderer=T,this.responsiveRelativeDatePipe=k,this.shareControlService=E,this.sidePopupMenuService=A,this.thumbnailInstrumentationService=P,this.uploadLocalFileService=x,this.urlLauncherService=D,this.wacBootstrapperService=M,this.wacContentService=F,this.windowService=L,this.leftAlignActionsMenu=!1,this.ShareControlMode=s.a,this.shareControlOutputs={dismiss:()=>this.onShareControlDismiss(!0)},this.MRU_ITEM_LOADING_STATE=0,this.addItem=new n.n,this.deleteItem=new n.n,this.changePinState=new n.n;const O=this.mruConfigService.config;this.activityEnabled=O.activityEnabled,this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileContextMenusEnabled,this.isConsumer=this.clientStartupConfigService.config.authType===p.a.MSA,e.applicationConversionMap||(e.applicationConversionMap=new Map,(O.tileViewEnabled||O.newMruActions)&&(e.applicationConversionMap.set(l.b.Word,{iconFontClass:O.wordIconFontClass,iconFontColor:"#2b579a",nativeUriScheme:"ms-word:ofe|u|"}),e.applicationConversionMap.set(l.b.Excel,{iconFontClass:O.excelIconFontClass,iconFontColor:"#217346",nativeUriScheme:"ms-excel:ofv|ofc|u|"}),e.applicationConversionMap.set(l.b.Visio,{iconFontClass:O.visioIconFontClass,iconFontColor:"#3955A3",nativeUriScheme:"ms-visio:ofe|u|"}),e.applicationConversionMap.set(l.b.PowerPoint,{iconFontClass:O.powerPointIconFontClass,iconFontColor:"#B7472A",nativeUriScheme:"ms-powerpoint:ofe|u|"}),e.applicationConversionMap.set(l.b.OneNote,{iconFontClass:O.oneNoteIconFontClass,iconFontColor:"#7719AA",nativeUriScheme:"onenote:"}),e.applicationConversionMap.set(l.b.Sway,{iconFontClass:O.swayIconFontClass,iconFontColor:"#008272"}),e.applicationConversionMap.set(l.b.Forms,{iconFontClass:O.formsIconFontClass,iconFontColor:"#008272"}),e.applicationConversionMap.set(l.b.PowerBI,{iconFontClass:O.powerBIIconFontClass,iconFontColor:"#f2c811"})))}isFileCardSupported(e){return!([l.b.PowerBI,l.b.Forms,l.b.FormsQuiz,l.b.Portfolio,l.b.Project,l.b.Sway,l.b.Fluid,l.b.FluidActivityBlueprint].lastIndexOf(e)>=0)}ngOnInit(){this.isFileCardEnabled=this.capabilitiesService.capabilities.fileHoverCardEnabled&&this.isFileCardSupported(this.item.fileType),this.disableFileNavigation=this.item.isDeleted,this.mruItemStateSubscription=this.eventService.events.withScope(0).pipe(Object(r.a)(e=>"mruItemStateChange"===e.name)).subscribe(e=>{e.args[1].docId===this.item.docId&&(0!==e.args[0]&&1!==e.args[0]||(this.mruItemState=e.args[0]))}),this.isFormResponsesEnabled=this.mruAppType===l.b.Forms&&this.item.fileType===l.b.Forms,this.uiCardType=this.item.fileType===l.b.Forms||this.item.fileType===l.b.FormsQuiz?"borderless":"normal",this.isCardCreateByLabel=this.item.fileType===l.b.Forms;const e=this.mruConfigService.config;this.shortDate=this.windowService.innerWidth<640,this.locService.supportsLocaleSpecifiers&&(this.dateSubscription=this.eventService.events.withScope(1).pipe(Object(r.a)(e=>"contentWidthChanged"===e.name)).subscribe(e=>{let t;[t]=e.args,this.shortDate=t<640})),this.thumbnailSWEnabled=e.thumbnailSWEnabled,this.permissionsEnabled=e.permissionsEnabled,this.sharedText=this.locService.SharedText,this.privateText=this.locService.OnlyYouText,this.shareActionTitle=this.locService.ShareActionTitle,this.copyLinkActionTitle=this.locService.CopyLinkActionTitle,this.pinActionTitle=this.locService.PinDocumentActionTitle,this.unpinActionTitle=this.locService.UnpinDocumentActionTitle,this.saveAClassNotebook=this.locService.SaveAClassNotebook,this.uploadLocalFileTitle=this.locService.UploadToOneDriveTitle,this.uploadAndOpen=this.locService.PwaUploadAndOpenMenuItem,this.isAntpExperience=this.capabilitiesService.capabilities.antpLoaded,this.isMobile=this.deviceDetector.isMobileDevice(),this.isTouch=this.isMobile||this.deviceDetector.isTabletDevice(),this.showMobileShareAndActivity=this.mruConfigService.config.mobileShareAndActivityEnabled,this.showOnlyMruActivity=this.item.format===d.a.Recent&&this.mruConfigService.config.onlyMruActivityEnabled,this.mruActivity=this.mruConfigService.config.mruActivityEnabled,this.recommendedDeepLinkEnabled=this.capabilitiesService.capabilities.recommendedDeepLinkEnabled,this.recommendedTeamsLinkEnabled=this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled,this.recommendedMotion=e.recommendedMotionEnabled,this.recommendedNewCards=e.recommendedNewCardsEnabled,this.isStreamsVideo=this.item.format===d.a.StreamsVideo,this.leftNavEnabled=this.capabilitiesService.capabilities.leftNavReact||this.capabilitiesService.capabilities.leftNavReactSquares,this.isNewTitle=this.locService.IsNewTitle,this.mruAppSuffix=this.mruAppType?"-"+l.b[this.mruAppType].toLowerCase():"",this.upcomingMeetingAttendeeDisplayMax=e.upcomingMeetingAttendeeDisplayMax,this.initializeItemFeatures()}ngOnChanges(e){e.hasOwnProperty("item")&&(!e.hasOwnProperty("index")||this.isRecommended||this.isOfficeFeed)&&(this.initializeItemFeatures(),this.thumbnailAltText=this.createThumbnailAltText(this.item.fileType)),!e.hasOwnProperty("view")||e.view.firstChange||"Tile"!==e.view.currentValue&&"Card"!==e.view.currentValue||this.isRecommended||this.isOfficeFeed||this.thumbnailLoaded||this.thumbnailUrl||this.mruItemInflationService.inflateThumbnails(this.item).then(()=>{this.thumbnailUrl=this.getThumbnailUrl(),this.onThumbnailLoad(),this.thumbnailAltText=this.createThumbnailAltText(this.item.fileType)})}ngOnDestroy(){this.dateSubscription&&this.dateSubscription.unsubscribe(),this.mruItemStateSubscription&&this.mruItemStateSubscription.unsubscribe(),this.removeShareControlListeners()}showAsListItem(){return void 0===this.view||"List"===this.view}showAsTile(){return"Tile"===this.view&&this.item.format!==d.a.Trending}showAsCard(){return"Card"===this.view||"Tile"===this.view&&this.item.format===d.a.Trending}iconFontClass(){const t=e.applicationConversionMap.get(this.item.fileType);return t?t.iconFontClass:null}iconFontColor(){const t=e.applicationConversionMap.get(this.item.fileType);return t?t.iconFontColor:null}onItemClick(e){if(this.disableFileNavigation)return void e.preventDefault();if(e.defaultPrevented)return;this.isOfficeFeed&&this.officeFeedService.logInstrumentation([this.item.feedbackId],["read"],[this.item.fromCache?"cache":"service"]),e.preventDefault();const[t,i]=this.getLaunchUrlAndClickId(this.url),n=this.getClickData(e),r=n.params.ElementId||"Unknown";i&&(n.params.RequestId=i);let s=!1;const o=(e,t,i,o)=>{if(s)return;s=!0;const a=e?n.params.Referral:"";o&&(n.params.ClickDestination="ContentPage"),this.instrumentationService.logClickEvent(n.eventName,r,this.instrumentationArea,a,t,n.params,n.metrics,this.dataSecurityThreshold,i)};"_blank"!==this.contextService.sharedContext.defaultLinkTarget&&o(!0,"Web");const a=()=>{const i=this.capabilitiesService.wacHostEnabledForFileType(this.item.fileType),n=(!this.item.isOnPremOrVanity||this.isConsumer)&&this.accessTokenService.hasOneDriveToken()||this.contextService.sharedContext.inMockMode,r=this.capabilitiesService.capabilities.fluidHostEnabled&&this.item.fileType===l.b.Fluid;if(i&&n||r)if(e.ctrlKey){const e="/"+"launch/:app/content".replace(":app",l.b[this.item.fileType]),t=v.a.replacePathAndAddParams(this.windowService.nativeWindow.location.href,e,m.a.getParamsForMruFileItem(this.item,r?{siteUrl:this.item.sharepointIds.siteUrl}:{}));this.urlLauncherService.openUrl(t,"OpenMruItem",l.b.Forms===this.item.fileType?"_self":"_blank").then(()=>{o(!0,"Web")},()=>{o(!1)})}else{const e=Date.now();r&&(this.fluidHostContext.hostScenarioName="DocumentClick",this.fluidHostContext.hostScenarioStartTime=e),o(!0,"Web",!0,!0),i?this.wacContentService.bootstrapAndRouteMruFileItem(this.item,this.getWdOrigin(!1),void 0,e,this.inflationPromise):this.officeRouteService.navigateTo({route:"Content",app:this.item.fileType},!1,m.a.getParamsForMruFileItem(this.item,r?{siteUrl:this.item.sharepointIds.siteUrl}:{}))}else{if(this.item.fileType===l.b.Pdf&&!this.item.isEmailAttachment){const e=Object(h.i)(this.item);this.isRecommended&&(e.Application="PdfViewer",e.MruV2Type="DocumentUrl"),this.mruDataService.writeMruDocument(e)}this.urlLauncherService.openUrl(t,"OpenMruItem",this.item.fileType===l.b.Forms||this.item.fileType===l.b.FormsQuiz?"_self":null).then(()=>{o(!0,"Web")},()=>{o(!1)})}};this.item.isEmailAttachment?a():this.localAppLauncherService.launchOfficeApp(this.item.application,this.item.canonicalUrl,null).then(e=>e||this.item.isLocal?e:(a(),!0)).then(e=>{e?o(!0,"Native"):(this.openUploadLocalModal(1),o(!1))}).catch(()=>{a()})}onPathClick(e){e.preventDefault(),this.openFolder();const t=this.getAttributionClickData();this.instrumentationService.logClickEvent(t.eventName,t.params.ElementId||"Unknown",this.instrumentationArea,t.params.Referral,this.item.isLocal?"Native":"Web",t.params,t.metrics,this.dataSecurityThreshold)}onShareClick(e,t,i){if(e&&e.preventDefault(),this.item.isLocal)this.openUploadLocalModal(2);else{if(this.shareControlMode=i,this.showDesktopShareControl=!this.mobileMenusEnabled,this.shareControlLoading=!0,this.currentShareSource=t,this.showDesktopShareControl){const e=e=>{if(!this.shareControlLoading&&this.showDesktopShareControl&&!(e instanceof MouseEvent&&2===e.button)){if(this.shareControl.nativeElement.contains(e.target))return;this.onShareControlDismiss(!1)}},t=e=>{const t=g.a.getKey(e);this.showDesktopShareControl&&3===t&&this.onShareControlDismiss(!0)};this.shareControlClickListener=this.renderer.listen(this.documentService.nativeDocument,"click",e),this.shareControlTouchListener=this.renderer.listen(this.documentService.nativeDocument,"touchend",e),this.shareControlKeyListener=this.renderer.listen(this.documentService.nativeDocument,"keyup",t),setTimeout(()=>this.shareControlLoading=!1,0)}this.mobileMenusEnabled&&(this.shareControlKeyboardFocus=e instanceof KeyboardEvent,this.shareControlService.showControl({file:this.item,index:this.index,mode:this.shareControlMode}),this.shareControlService.subscribeToCloseEvents(e=>{this.item===e.file&&this.index===e.index&&this.onShareControlDismiss(this.shareControlKeyboardFocus)})),this.instrumentAction(`${s.a[i].toLowerCase()}_${t}`)}}onShareControlDismiss(e){this.showDesktopShareControl=!1,this.removeShareControlListeners(),e&&this.focusOnShareAction(),this.currentShareSource=""}pinItem(e,t){if(this.item.isLocal)return e&&e.preventDefault(),void this.openUploadLocalModal(0);this.updatePinnedState(!0,e,t)}unpinItem(e,t){this.updatePinnedState(!1,e,t)}onThumbnailLoad(){setTimeout(()=>{this.thumbnailLoaded=!0}),this.thumbnailInstrumentationService.instrumentThumbnailLoad(!0,this.thumbnailUrl,this.listId,this.index,this.item.fileType)}onThumbnailError(){setTimeout(()=>{this.item.thumbnails=null,this.thumbnailLoaded=!1}),this.thumbnailInstrumentationService.instrumentThumbnailLoad(!1,this.thumbnailUrl,this.listId,this.index,this.item.fileType)}onActionsMenuToggle(e){this.actionsMenuOpen=e,this.recommendedMotion&&(this.isHovered="unhovered")}onFocus(){this.itemFocused=!0}onBlur(){this.itemFocused=!1}onAnalyticsDescriptionChanged(e){this.analyticsDescriptiveAriaLabel=e,this.setDescriptiveAriaLabel()}uploadLocal(e){e&&e.preventDefault(),this.uploadLocalFileService.getLocalFileInfo(this.item.url,this.item.fileName).then(e=>{this.uploadLocalFileService.uploadFile(e,"upload-local-file-commanding")})}recommendedHover(e){!this.actionsMenuOpen&&this.recommendedMotion&&(this.isHovered=e)}getWdOriginTaskForClick(e=!1){return this.isRecommended||this.isOfficeFeed?e?"REC-OIB":"REC":this.listId===u.a.unpinnedListId?e?"MRU-OIB":"MRU":"OTHER"}getDisplayTime(){return this.item.format===d.a.Shared||this.item.format===d.a.SharedForm?this.item.sharedTime>new Date("1980-01-01T00:00:00Z")?this.item.sharedTime:null:this.item.format===d.a.Trending||this.item.format===d.a.ClassNoteBook||this.item.format===d.a.NoteBook||this.item.format===d.a.Form?this.item.lastModifiedTime:this.item.lastViewedTime}openUploadLocalModal(e){this.uploadLocalFileService.showModal(this.item.url,this.item.fileName,e)}initializeItemFeatures(){const t=this.mruConfigService.config;this.showSharing=this.showSharing&&!(this.mruAppType===l.b.OneNote&&(d.a.Shared===this.item.format||d.a.ClassNoteBook===this.item.format||d.a.NoteBook===this.item.format))&&!(this.item.fileType===l.b.Forms&&this.item.format===d.a.Shared),this.isRecommended=this.item.format===d.a.Recommended,this.isOfficeFeed=this.item.format===d.a.News||this.item.format===d.a.OfficeFeedDocument||this.item.format===d.a.StreamsVideo||this.item.format===d.a.UpcomingMeeting,this.isNewsArticle=this.item.format===d.a.News,this.isUpcomingMeeting=this.item.format===d.a.UpcomingMeeting,this.instrumentationArea=this.isRecommended||this.isOfficeFeed?a.b.Recommended:a.b.Documents,this.url=t.webUrlMruConsumerEnabled&&this.isConsumer&&this.item.webUrl?this.item.webUrl:this.item.url;const i=this.item.fileType!==l.b.Sway&&this.item.fileType!==l.b.Project,n=b.a.Format(this.item.isEmailAttachment&&this.item.emailReference&&this.item.emailReference.Subject?[this.item.emailReference.Subject]:this.item.isEmailAttachment?[this.locService.OpenFileLocationActionTitle]:this.item.pathArray,this.contextService.isRtl,e.shortPathCharacterLimit);this.shortPath=i?n[1]:null,this.openFolderAriaLabel=this.item.isEmailAttachment?this.locService.OpenFileLocationActionTitle:this.locService.format(this.locService.OpenFileLocationActionWithLocationTitle,i?n[0]:null),this.displayTime=this.getDisplayTime(),this.displayTimeString=this.displayTime?this.locService.localizedDateString(this.displayTime):null,this.shareControlEnabled=t.shareControlEnabled&&this.item.fileType!==l.b.PowerBI&&this.item.fileType!==l.b.Project&&this.item.fileType!==l.b.Portfolio&&this.item.fileType!==l.b.Sway&&this.item.fileType!==l.b.Forms&&this.item.fileType!==l.b.StreamsVideo&&!(this.item.format===d.a.Shared&&this.item.isEmailAttachment)&&this.item.format!==d.a.UpcomingMeeting,this.copyLinkEnabled=t.copyLinkEnabled&&this.shareControlEnabled,this.mruPinEnabled=t.mruPinEnabled&&this.item.format===d.a.Recent,this.clickableFolderEnabled=t.clickableFolderEnabled&&!!this.item.attributionUrl,this.setupActionsMenu(),this.updateAnimation(this.item),this.setDescriptiveAriaLabel(),this.thumbnailLoaded=this.thumbnailUrl&&this.thumbnailUrl===this.getThumbnailUrl(),this.dataSecurityThreshold=this.item.isLocal?2:0,this.activityDeepLink=this.recommendedDeepLinkEnabled&&this.item.navigationId?`${this.url}&nav=${this.item.navigationId}`:void 0,this.teamsDeepLink=this.recommendedTeamsLinkEnabled&&this.item.teamsDeepLink,this.inflationPromise=this.mruItemInflationService.inflateItem(this.item,"Card"===this.view||"Tile"===this.view,this.showAnalytics,this.mruAppType),this.inflationPromise.then(e=>{this.updateAnimation(e),this.thumbnailUrl=this.getThumbnailUrl(),this.setBorderlessCardDetail1(),this.setDescriptiveAriaLabel(),this.capabilitiesService.wacHostEnabledForFileType(this.item.fileType)&&this.item.wopiData&&this.item.wopiData.wac&&this.item.wopiData.wac.bootstrapperUrl&&this.wacBootstrapperService.loadBootstrapper(this.item.wopiData.wac.bootstrapperUrl,this.item.wopiData.wac.applicationUrl,this.item.fileType)})}setBorderlessCardDetail1(){this.item.fileType===l.b.Forms&&(this.borderlessCardDetail1=this.item.metaData&&null!=this.item.metaData.formsResponseCount?this.locService.format(this.locService.ResponsesText,this.item.metaData.formsResponseCount.toString()):"")}setDescriptiveAriaLabel(){const e=[this.locService.format(this.locService.DocumentDescriptiveAriaLabelTitle,this.item.title)];this.showSharing&&this.item.sharing&&e.push(this.locService.format(this.item.sharing.shared?this.locService.DocumentDescriptiveAriaLabelShared:this.locService.DocumentDescriptiveAriaLabelPrivate,this.item.fileTypeName));const t=this.buildDescriptiveDate();if(t&&e.push(t),this.showActivity&&!this.isRecommended&&!this.isOfficeFeed){const t=this.activityDescriptionService.activityDescription(this.item.activities,this.item.lastViewedTime,!1);e.push(t&&t.plainText?this.locService.format(this.locService.DocumentDescriptiveAriaLabelActivity,t.plainText):this.locService.DocumentDescriptiveAriaLabelNoActivity)}this.showAnalytics&&this.analyticsDescriptiveAriaLabel&&e.push(this.analyticsDescriptiveAriaLabel),this.isCardCreateByLabel&&(e.push(this.locService.format(this.locService.DocumentDescriptiveAriaLabelCreatedBy,this.item.createdBy)),this.item.metaData&&null!=this.item.metaData.formsResponseCount&&e.push(this.locService.format(this.locService.DocumentDescriptiveAriaLabelNumResponses,this.item.metaData.formsResponseCount.toString()))),this.descriptiveAriaLabel=e.join(" ")}buildDescriptiveDate(){const e=this.responsiveRelativeDatePipe.transform(this.displayTime,!1,this.displayTimeString,!1);let t=e;if(e)switch(this.item.format){case d.a.Trending:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelLastModified,e);break;case d.a.Shared:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelDateShared,e);break;case d.a.Recommended:case d.a.News:case d.a.OfficeFeedDocument:t=this.item.activity&&this.item.activity.plainText?this.item.activity.plainText+e:"";break;default:t=this.locService.format(this.locService.DocumentDescriptiveAriaLabelLastOpened,e)}return t}focusOnShareAction(){"topLevel"===this.currentShareSource?this.shareTopLevelElement.nativeElement.focus():this.actionsMenuElement.dropdownMenu.dropdownLink.nativeElement.focus()}removeShareControlListeners(){this.shareControlClickListener&&this.shareControlClickListener(),this.shareControlTouchListener&&this.shareControlTouchListener(),this.shareControlKeyListener&&this.shareControlKeyListener()}updateAnimation(e){this.isNew=e.isNew,this.isNewAnimationState=this.isNew?"active":"inactive"}updatePinnedState(e,t,i){t&&t.preventDefault(),this.item.lastViewedTime=this.dateService.getCurrentDate(),this.displayTime=this.getDisplayTime(),this.displayTimeString=this.displayTime?this.locService.localizedDateString(this.displayTime):null,this.changePinState.emit({item:this.item,isPinned:e,element:this.mruListItem,index:this.index});const n=this.contextMenu.items.findIndex(t=>t.getId()===(e?"pin":"unpin"));-1!==n&&(this.contextMenu.items[n]=e?this.unpinAction:this.pinAction,this.instrumentAction(`${e?"pin":"unpin"}_${i}`),this.itemFocused=!1)}setupActionsMenu(){var t;const i=this.mruConfigService.config,n=e.applicationConversionMap.get(this.item.fileType),r=i.newMruActions&&n;let s;if(this.item.isEmailAttachment){const a=this.item.format===d.a.OfficeFeedDocument||1===this.item.emailReference.AttachmentType?this.locService.OpenInOutlookActionTitle:this.locService.format(this.locService.OpenOnlineActionTitle,this.item.application);return s=[{getId:()=>"open",title:a,ariaLabel:a,iconCssClass:r?n.iconFontClass:"",icon:r?null:o.a.FolderOpen,iconColor:r?n.iconFontColor:null,executeAction:()=>{this.urlLauncherService.openUrl(this.url,"OpenAttachment"),this.instrumentAction("open")}}],this.shareControlEnabled&&1!==(null===(t=this.item.emailReference)||void 0===t?void 0:t.AttachmentType)&&this.getShareControlElements(s),(this.isRecommended||this.isOfficeFeed)&&i.recommendedRemoveItemEnabled&&s.push(this.createRemoveActionItem()),this.showActionsMenu=!0,void(this.contextMenu={id:this.getContextMenuId(),items:s,customLogging:!0,cssClass:e.actionsMenuCssClass})}s=[],this.disableFileNavigation||s.push({getId:()=>"open",title:this.isUpcomingMeeting?this.locService.OpenInCalendar:this.locService.OpenInBrowser,ariaLabel:this.isUpcomingMeeting?this.locService.OpenInCalendar:this.locService.OpenInBrowser,iconCssClass:r?n.iconFontClass:"",icon:r?null:this.isUpcomingMeeting?o.a.Calendar:o.a.FolderOpen,iconColor:r?n.iconFontColor:null,executeAction:this.item.isLocal?()=>this.openUploadLocalModal(1):()=>{var e;const[t]=this.getLaunchUrlAndClickId(null!==(e=this.item.webUrl)&&void 0!==e?e:this.url,!0);this.urlLauncherService.openUrl(t,"OpenFile"),this.instrumentAction("open")},disabled:this.item.isLocal}),this.item.isLocal&&s.push({getId:()=>"upload",title:this.uploadAndOpen,ariaLabel:this.uploadAndOpen,icon:o.a.Upload,executeAction:()=>{this.uploadLocal()}}),this.shareControlEnabled&&(this.showDesktopShareControl=!1,this.getShareControlElements(s));const a=this.item.fileType!==l.b.PowerBI&&this.item.fileType!==l.b.Sway&&this.item.fileType!==l.b.OneNote&&this.item.fileType!==l.b.Forms&&this.item.fileType!==l.b.Project&&this.item.fileType!==l.b.Portfolio&&this.item.fileType!==l.b.StreamsVideo&&this.item.format!==d.a.UpcomingMeeting;if(i.newMruActions){if(n&&n.nativeUriScheme){const e=this.deviceDetector.isDesktopDevice()?this.locService.OpenInDesktopApp:this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice()?this.locService.OpenInApp:this.locService.OpenActionTitle;s.splice(1,0,{getId:()=>"openInApp",title:e,ariaLabel:e,iconCssClass:r?n.iconFontClass:"",icon:r?null:o.a.FolderOpen,iconColor:r?n.iconFontColor:null,executeAction:()=>{this.localAppLauncherService.launchOfficeApp(this.item.application,this.item.canonicalUrl).then(e=>{if(!e){if(!this.item.isLocal)throw new Error("fallback to protocol handler");this.urlLauncherService.openUrl(`${n.nativeUriScheme}${this.item.canonicalUrl}`,"OpenInApp","_self").catch(()=>{this.openUploadLocalModal(1)})}}).catch(()=>{const e=this.item.canonicalUrl.lastIndexOf("?");let t=this.item.canonicalUrl;e>0&&(t=t.substring(0,e)),this.urlLauncherService.openUrl(`${n.nativeUriScheme}${t}`,"OpenInApp","_self")}),this.instrumentAction("openInApp")}})}a&&i.showDownloadAction&&!this.item.isLocal&&this.item.format!==d.a.News&&s.push({getId:()=>"download",title:this.locService.DownloadMruItemActionTitle,ariaLabel:this.locService.DownloadMruItemActionTitle,icon:o.a.Download,executeAction:()=>{this.urlLauncherService.openUrl(this.item.documentUrl,"Download"),this.instrumentAction("download")}}),a&&s.push({getId:()=>"openFileLocation",title:this.locService.OpenFileLocationActionTitle,ariaLabel:this.openFolderAriaLabel,icon:o.a.Folder,executeAction:()=>{this.openFolder(),this.instrumentAction("openFileLocation")}})}if(this.item.format===d.a.Recent&&this.mruPinEnabled){let e;this.pinAction={getId:()=>"pin",title:this.pinActionTitle,ariaLabel:this.pinActionTitle,icon:o.a.PinDown,executeAction:()=>this.pinItem(null,"menu"),disabled:this.item.isLocal},this.unpinAction={getId:()=>"unpin",title:this.unpinActionTitle,ariaLabel:this.unpinActionTitle,icon:o.a.Unpin,executeAction:()=>this.unpinItem(null,"menu"),disabled:this.item.isLocal},e=this.item.isPinned?this.unpinAction:this.pinAction,i.newMruActions&&a?s.splice(s.length-(this.item.isLocal?1:2),0,e):s.push(e)}if(this.item.fileType===l.b.Forms&&this.item.format===d.a.SharedForm&&s.push({getId:()=>"formsSharedUnpin",title:this.locService.RemoveFromSharedWithMe,ariaLabel:this.locService.RemoveFromSharedWithMe,icon:o.a.Unpin,executeAction:()=>{this.deleteItem.emit({index:this.index,item:this.item,deleteOption:5})},disabled:this.item.isLocal}),!this.item.isLocal&&(this.item.format===d.a.Recent||(this.isRecommended||this.isOfficeFeed)&&i.recommendedRemoveItemEnabled)){const e=this.createRemoveActionItem();i.newMruActions&&a?s.splice(s.length-1,0,e):s.push(e)}this.item.format===d.a.ClassNoteBook&&s.push({getId:()=>"copyClassNoteBook",title:this.locService.SaveAClassNotebook,ariaLabel:this.saveAClassNotebook,icon:o.a.Save,executeAction:()=>{this.urlLauncherService.openUrl(this.onenoteService.generateSaveCopyClassNotebookLink(this.item.docId,this.item.fileName,this.url),"CopyNotebook","_NewSaveCopyWindow",500,500),this.instrumentAction("copyClassNoteBook")}}),this.item.fileType!==l.b.Forms||this.item.format!==d.a.Form||this.item.isDeleted||"groups"===this.item.ownerType||s.push({getId:()=>"move",title:this.locService.MoveActionMenuLabel,ariaLabel:this.locService.MoveActionMenuLabel,icon:o.a.Move,executeAction:()=>{const e={isShown:!0,type:0,movingFileItem:this.item};this.instrumentAction("move"),this.sidePopupMenuService.sidePopupMenuEmitter.next(e)},disabled:this.item.isLocal}),this.item.fileType!==l.b.Forms||this.item.format!==d.a.Form&&this.item.format!==d.a.SharedForm||this.item.isDeleted||s.push({getId:()=>"copy",title:this.locService.CopyActionMenuLabel,ariaLabel:this.locService.CopyActionMenuLabel,icon:o.a.Copy,executeAction:()=>{this.instrumentAction("copy"),this.addItem.emit({addOption:1,addedItem:this.item,position:this.index})},disabled:this.item.isLocal}),this.item.fileType===l.b.Forms&&this.item.format===d.a.Form&&this.item.isDeleted&&!this.item.isLocal&&s.push({getId:()=>"restore",title:this.locService.RestoreActionMenuLabel,ariaLabel:this.locService.RestoreActionMenuLabel,icon:o.a.Restore,executeAction:()=>{this.instrumentAction("restore"),this.deleteItem.emit({item:this.item,index:this.index,deleteOption:4})},disabled:!1}),this.item.fileType!==l.b.Forms||this.item.format!==d.a.Form||this.item.isLocal||s.push({getId:()=>"delete",title:this.locService.DeleteActionMenuLabel,ariaLabel:this.locService.DeleteActionMenuLabel,icon:o.a.Delete,executeAction:()=>{this.instrumentAction("delete"),this.deleteItem.emit({item:this.item,index:this.index,deleteOption:this.item.isDeleted?2:1})},disabled:!1}),this.showActionsMenu=!(1===s.length&&"open"===s[0].getId()),this.contextMenu={id:this.getContextMenuId(),items:s,customLogging:!0,cssClass:(this.leftNavEnabled?"actions-menu--left-nav ":"")+e.actionsMenuCssClass+(this.isTouch&&(this.isRecommended||this.isOfficeFeed)?" actions-menu--mobile":"")}}getShareControlElements(e){e.push({getId:()=>"share",title:this.shareActionTitle,ariaLabel:this.shareActionTitle,icon:o.a.Share2,executeAction:e=>{this.onShareClick(e,"menu",s.a.Share)},disabled:this.item.isLocal}),this.copyLinkEnabled&&e.push({getId:()=>"copylink",title:this.copyLinkActionTitle,ariaLabel:this.copyLinkActionTitle,icon:o.a.Link,executeAction:e=>{this.onShareClick(e,"menu",s.a.CopyLink)},disabled:this.item.isLocal}),this.isAntpExperience||this.item.isOnPremOrVanity||this.shareControlService.getToken(this.item.documentUrl)}getContextMenuId(){return`${this.listId}-${this.item.id}`}getClickData(e){const t=this.item.getClickData(this.isRecommended||this.isOfficeFeed?"Recommended_Click":"Mru_Click","Click",this.index),i=e.target;if(t.params.ItemId=this.titleElement&&i===this.titleElement.nativeElement?"title":this.fileIconElement&&i===this.fileIconElement.nativeElement?"icon":this.attributionElement&&i===this.attributionElement.nativeElement?"attribution":this.timestampElement&&i===this.timestampElement.nativeElement?"timestamp":"item",void 0!==this.relativeIndex&&(t.params.RelativeIndex=this.relativeIndex.toString()),t.params.ItemCategory=this.listId,t.params.State=this.view,t.params.ResourceId=this.item.resourceId,this.activityEnabled){const e=this.item.activities||[],i=this.activityDescriptionService.filterActivities(e,this.item.lastViewedTime)||[];t.params.ActivityCommentsCount=i.filter(e=>e.action.type===c.a.Comment).length.toString(),t.params.ActivityEditsCount=i.filter(e=>e.action.type===c.a.Edit).length.toString(),t.params.ActivityMentionsCount=i.filter(e=>e.action.type===c.a.Mention).length.toString(),t.params.ActivityTotalCount=e.length.toString(),t.params.ActivityCountSinceLastOpened=i.length.toString(),t.params.ActivityCollaboration=this.getActivityCollab(),t.params.ActivityDisplayed=c.a[this.activityDescriptionService.displayedActivityType(i,this.item.lastViewedTime,!1)]}return t.params.ClickDestination="ExternalPage",t}getAttributionClickData(){const e=this.item.getClickDataForPath("Mru_Path_Click","Click",this.index);return e.params.ItemCategory=this.listId,e.params.ResourceId=this.item.resourceId,e}instrumentAction(e){const t={};t.RenderSize=this.contextMenu.items.length.toString(),t.Index=this.index.toString(),t.DocumentType=this.item.fileTypeName,t.ItemCategory=this.listId,t.Pinned=this.item.isPinned.toString(),t.State=this.view,t.ResourceId=this.item.resourceId,t.ActivityCollaboration=this.getActivityCollab(),void 0!==this.relativeIndex&&(t.RelativeIndex=this.relativeIndex.toString());let i,n=null;if("open"===e||"openInApp"===e?(n=d.b.referralFromFileType(this.item.fileType),i="open"===e?"Web":"Native"):"openFileLocation"===e&&(n=d.b.referralFromFileLocation(this.url),i=this.item.isLocal?"Native":"Web"),this.item.format===d.a.OfficeFeedDocument||this.item.format===d.a.News||this.item.format===d.a.UpcomingMeeting){let t="read";switch(e){case"copylink_menu":t="copyLink";break;case"share_menu":t="share"}"join_meeting"===e?this.officeFeedService.logInstrumentation([this.item.feedbackId],[t],[this.item.fromCache?"cache":"service"],["joinMeeting"]):"remove"!==e&&this.officeFeedService.logInstrumentation([this.item.feedbackId],[t],[this.item.fromCache?"cache":"service"])}this.instrumentationService.logClickEvent("Actions_Menu_Item_Click",e,this.instrumentationArea,n,i,t,[],this.dataSecurityThreshold)}getActivityCollab(){return(this.isRecommended||this.isOfficeFeed)&&this.item.isCollab?"true":(this.item.activities||[]).some(e=>!this.activityDescriptionService.isCurrentUser(e.actor.user)).toString()}getThumbnailUrl(){return this.item.format===d.a.StreamsVideo?(this.streamsVideoThumbnail=this.officeFeedService.getStreamsThumbnail(this.item.thumbnails.recommendedThumbnail),this.streamsVideoThumbnail.then(()=>{this.onThumbnailLoad()}).catch(()=>{this.onThumbnailError()}),null):this.item.thumbnails?this.isRecommended||this.isOfficeFeed||this.item.format===d.a.Trending?this.item.thumbnails.recommendedThumbnail||this.item.thumbnails.large:this.item.thumbnails.medium:null}openFolder(){this.item.isLocal?this.localAppLauncherService.openPathInExplorer(this.item.attributionUrl):(this.urlLauncherService.openUrl(this.isUpcomingMeeting?this.item.joinUrl:this.item.isEmailAttachment?this.url:this.item.attributionUrl,"OpenFileLocation"),this.isUpcomingMeeting&&this.instrumentAction("join_meeting"))}createRemoveActionItem(){return{getId:()=>"remove",title:this.locService.RemoveDocumentActionTitle,ariaLabel:this.locService.RemoveDocumentActionTitle,icon:o.a.Minus,executeAction:()=>{this.deleteItem.emit({item:this.item,index:this.index}),this.instrumentAction("remove")}}}getWdOrigin(e=!1){return this.contextService.getWdOrigin(this.getWdOriginTaskForClick(e))}getLaunchUrlAndClickId(e,t=!1){if(this.mruConfigService.config.addWacParams&&this.item.fileType!==l.b.Sway&&this.item.fileType!==l.b.Forms&&this.item.fileType!==l.b.Pdf&&this.item.fileType!==l.b.Fluid&&this.item.fileType!==l.b.PowerBI&&!this.item.isLocal&&!this.item.isOnPremOrVanity&&!this.item.isEmailAttachment&&this.item.format!==d.a.News){const i=Date.now(),n=f.a.createGuid();return[v.a.appendAndReplaceQueryParams(e,{ct:i,wdOrigin:this.getWdOrigin(t),cid:n},!0),n]}if(this.item.fileType===l.b.Forms){const t=this.officeRouteService.getCurrentRoute();return[v.a.appendAndReplaceQueryParams(e,{origin:S.a,route:t&&t.route?t.route:void 0,lang:this.contextService.sharedContext.officeMarket},!0),void 0]}return[e,void 0]}createThumbnailAltText(e){const t=this.locService.ThumbnailImageAltText;switch(e){case l.b.Word:return this.locService.format(t,this.locService.ThumbnailWordType);case l.b.Excel:return this.locService.format(t,this.locService.ThumbnailExcelType);case l.b.PowerPoint:return this.locService.format(t,this.locService.ThumbnailPowerPointType);case l.b.OneNote:case l.b.OneNoteClassNoteBook:return this.locService.format(t,this.locService.ThumbnailOneNoteType);case l.b.Pdf:return this.locService.format(t,this.locService.ThumbnailPdfType);case l.b.Visio:return this.locService.format(t,this.locService.ThumbnailVisioType);case l.b.Text:return this.locService.format(t,this.locService.ThumbnailTextType);case l.b.Sway:return this.locService.format(t,this.locService.ThumbnailSwayType);case l.b.Forms:return this.locService.format(t,this.locService.ThumbnailFormsType);case l.b.Project:return this.locService.format(t,this.locService.ThumbnailProjectType);case l.b.Portfolio:return this.locService.format(t,this.locService.ThumbnailProjectPortfolioType);case l.b.NewsArticle:return this.locService.format(t,this.locService.ThumbnailNewsType);case l.b.PowerBI:return this.locService.format(t,this.locService.ThumbnailPowerBIType);default:return""}}}return e.shortPathCharacterLimit=25,e.actionsMenuCssClass="actions-menu",e})()},"345u":function(e,t,i){"use strict";i.d(t,"c",(function(){return c})),i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return h}));var n=i("Mlb/"),r=i("lrJm"),s=i("A/um"),o=i("cgnd"),a=i("1ygu"),l=i("CC5A");i("ALB0");class c{constructor(e){this.templateRef=e}}class u{}let h=(()=>{class e{constructor(e,t,i,r,s,o,a,l){this.deviceDetector=e,this.instrumentationService=t,this.locService=i,this.userDataStorageService=r,this.capabilitiesService=s,this.changeDetectorRef=o,this.startupConfigService=a,this.globalErrorHandler=l,this.tabClicked=new n.n,this.cardView="Card",this.tileView="Tile",this.listColView="ListCol"}ngOnInit(){this.tilesListMenuEnabled=!this.deviceDetector.isMobileDevice(),this.showAsListAriaLabel=this.locService.ListViewToggleAriaLabel,this.showAsTilesAriaLabel=this.locService.TileViewToggleAriaLabel,this.tileViewText=this.locService.TileViewToggleAriaTooltip,this.listViewText=this.locService.ListViewToggleAriaTooltip,this.isConsumer=this.startupConfigService.config.authType===o.a.MSA,this.altaChangesEnabled=this.capabilitiesService.capabilities.altaChangesEnabled&&this.isConsumer,this.model.registerOnTabAddedOrUpdated((e,t,i)=>{i&&this.selectedTab===t&&this.showTab(t,!0)}),void 0===this.listState&&(this.listState=a.a.Closed),this.loadTabListState().then(()=>{this.tileViewEnabled&&this.tilesListMenuEnabled&&(this.tilesListMenuModel=this.createTilesListMenuModel()),this.showTab(this.model.defaultTab||0,!0)})}ngAfterViewInit(){if(1!==this.tabListItems.length)throw new r.a("Must have exactly 1 *ohpTabListItem in an TabListComponent as a child");this.listItemTemplate=this.tabListItems.first.templateRef,this.changeDetectorRef.detectChanges()}showingTiles(){return"Tile"===this.itemView||"Card"===this.itemView}showTimestampHeader(){const e=this.model.tabs[this.selectedTab];return!this.columnsEnabled&&e&&e.loaded&&!e.hasError&&e.listModel.items.length&&e.timestampHeader&&!this.showingTiles()}showTileToggle(){const e=this.model.tabs[this.selectedTab];return this.tileViewEnabled&&e&&e.loaded&&!e.hasError&&e.listModel.items.length}selectTab(e,t){e&&e.preventDefault(),this.showTab(t),this.tabClicked.emit(t)}toggleTileView(){const e=this.model.tabs[this.selectedTab];this.changeTilesListView(this.showingTiles()?"List":e.showCardsInTileView?"Card":"Tile")}itemViewExists(){return null!=this.itemView}trackByIndex(e){return e}onToggleTilesListMenu(e){const t={};t.State=this.itemView,t.Action=e?"Open":"Close",this.instrumentationService.logClickEvent("Tile_Toggle_Open","tile-toggle-menu-"+this.model.tabs[this.selectedTab].id,this.model.area,null,null,t)}onSelectTilesListMenuItem(e){const t=e.item;let i=t.view;"Tile"===i&&this.model.tabs[this.selectedTab].showCardsInTileView&&(i="Card"),this.tilesListMenuModel&&(this.tilesListMenuModel.linkAriaLabel="List"===t.view?this.locService.ListViewMenuAriaLabel:this.locService.TileViewMenuAriaLabel),this.changeTilesListView(i)}widgetAttributionClick(e){this.model.tabs[this.selectedTab].attribution.onClick&&(e.preventDefault(),this.model.tabs[this.selectedTab].attribution.onClick())}showTab(e,t=!1){if(!this.model.tabs||!this.model.tabs.length)return;this.tabAnnouncement="",this.selectedTab=e;const i=this.model.tabs[e];this.showingTiles()&&(this.itemView=i.showCardsInTileView?"Card":"Tile"),this.ensureTabLoaded(i).then(i=>{const n=this.model.tabs[e],r=n.hasError?-1:n.listModel.itemsShown(this.listState===a.a.Open,this.showingTiles()),s=n.hasError?[]:n.listModel.items;i&&this.model.logImpression(s,n.id,r,this.itemView,n.fromCache,l.a.Loading),this.selectedTab===e&&(this.model.logImpression(s,n.id,r,this.itemView,n.fromCache,n.hasError?l.a.Error:l.a.Loaded),t||setTimeout(()=>this.tabAnnouncement=n.hasError?n.errorTitle?`${n.errorTitle}. ${n.errorSubtitle||""}`:"":r?this.model.tabActivationAriaLabel?this.locService.format(this.model.tabActivationAriaLabel,n.titleForAnnouncement||n.title,this.locService.localizedNumberString(r)):"":n.zeroExperienceTitle?`${n.zeroExperienceTitle}. ${n.zeroExperienceSubtitle||""}`:"",0))})}changeTilesListView(e){if(this.itemView!==e){const t=this.showingTiles();this.itemView=e,this.toggleAnnouncement=t?this.locService.ListViewToggleUpdateAriaLabel:this.locService.TileViewToggleUpdateAriaLabel,this.saveTabListState();const i={};i.State=e,this.instrumentationService.logClickEvent("Tile_Toggle_Select","tile-toggle-"+this.model.tabs[this.selectedTab].id,this.model.area,null,null,i)}}saveTabListState(){const e={tileView:this.showingTiles()};this.userDataStorageService.set(this.tabListStateKey(),e)}loadTabListState(){return this.userDataStorageService.get(this.tabListStateKey(),0).then(e=>{this.itemView=e?e.tileView?this.model&&this.model.tabs&&this.model.tabs.length&&this.model.tabs[this.model.defaultTab||0].showCardsInTileView?"Card":"Tile":"ListCol"===this.defaultView?"ListCol":"List":this.tileViewEnabled&&this.defaultView||"ListCol"===this.defaultView?this.defaultView:"List"}).catch(e=>{this.globalErrorHandler.handleError(e,"I6SDK"),this.itemView=this.tileViewEnabled&&this.defaultView||"ListCol"===this.defaultView?this.defaultView:"List"})}tabListStateKey(){return`${e.TabListStateKey}_${this.model.id}`}ensureTabLoaded(e,t=!1){return e.loaded?Promise.resolve(!1):e.onLoad?(t||(this.tabAnnouncement=this.locService.TabLoadingAriaLabel),e.onLoad().catch(()=>e.hasError=!0).then(()=>(e.loaded=!0,e.listModel||(e.hasError=!0),!0))):(e.loaded=!0,Promise.resolve(!1))}createTilesListMenuModel(){return{id:"tiles-list-menu",items:[{title:this.listViewText,view:"List",icon:s.a.ListBullets,ariaLabel:this.locService.ListViewMenuItemAriaLabel,ariaSelected:"List"===this.itemView,getId:()=>"list"},{title:this.tileViewText,view:"Tile",icon:s.a.TileView,ariaLabel:this.locService.TileViewMenuItemAriaLabel,ariaSelected:"Tile"===this.itemView,getId:()=>"tile"}],linkAriaLabel:this.showingTiles()?this.locService.TileViewMenuAriaLabel:this.locService.ListViewMenuAriaLabel,linkCssClass:"icon-button tab-list-header__spacer ms-fcl-nd-h ms-fcl-ns ms-bgc-g40-h",linkTooltip:this.locService.ListTileMenuAriaTooltip,rightAligned:!0,hostComponentArea:this.model.area,announceItemIsSelected:!0}}}return e.TabListStateKey="TabListStateKey",e})()},"36QD":function(e,t,i){},"3GGT":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e[e.Unknown=0]="Unknown",e[e.OK=200]="OK",e[e.Created=201]="Created",e[e.NoContent=204]="NoContent",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.Locked=423]="Locked",e[e.NotImplemented=501]="NotImplemented",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.UnexpectedResponse=700]="UnexpectedResponse",e[e.TokenRefreshFailed=701]="TokenRefreshFailed",e[e.TokenUnavailable=702]="TokenUnavailable",e[e.RetryFailed=703]="RetryFailed",e[e.AlternateResponse=704]="AlternateResponse",e[e.Cancelled=705]="Cancelled",e[e.Offline=706]="Offline",e[e.Timeout=707]="Timeout",e[e.DecryptionError=708]="DecryptionError",e[e.CacheMiss=709]="CacheMiss",e}({})},"4/We":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("O6Zd");let r,s=!1;var o=i("BaAg"),a=i("W3Zz"),l=i("bb6g"),c=i("Mlb/"),u=i("uzn7"),h=i("5aVq");let d=(()=>{class e{constructor(e,t){this.localStorageService=e,this.shellShimService=t}static parseBooleanFlagsAndFilter(e,t=new Set){return Object.keys(e).filter(i=>"boolean"==typeof e[i]&&!t.has(i)).reduce((t,i)=>(t[i]=e[i],t),{})}registerFlagsAndGetConfig(e){return this.registerFeatures(e),this.mergeConfigWithOverrides(e)}mergeConfigWithOverrides(e){const t=this.getOverrides();return Object.keys(e).reduce((i,n)=>{var r;return i[n]=null!==(r=t[n])&&void 0!==r?r:e[n],i},{})}getOverrides(){var t;return null!==(t=this.localStorageService.getGlobal(e.localStorageKey))&&void 0!==t?t:{}}registerFeatures(e){return Object(l.b)(this,void 0,void 0,(function*(){(yield this.shellShimService.getShellShim()).FeatureFlags.AddFeatureFlags(e)}))}}return e.localStorageKey="ShellFeatureFlags",e.ɵprov=c.bc({factory:function(){return new e(c.cc(u.a),c.cc(h.a))},token:e,providedIn:"root"}),e})();var m=i("dFxn"),p=i("Ax7d"),f=i("BMb5");let g=(()=>{class e{constructor(e,t,i,l,c){if(this.featureManagerService=i,this.shouldOpenWithUIHost=!1,this.capabilities=t.parse("capabilities")||{activityBasedTimeoutEnabled:!1,antpLoaded:!1,appManifestEnabled:!1,appsInHero:!1,altaChangesEnabled:!1,altaBrandingChangesEnabled:!1,consumerHeroImageRefresh:!1,backplateThemingEnabled:!1,batchGraphEnabled:!1,bottomTrayEnabled:!1,calendarEnabled:!1,capPopupEnabled:!1,capturingIntentEnabled:!1,clientTokenFetchEnabled:!1,conciergeEnabled:!1,consumerThemesCalloutEnabled:!1,createButtonWithAnimationEnabled:!1,createDocAspxExcelEnabled:!1,createDocAspxPowerPointEnabled:!1,createDocAspxVisioEnabled:!1,createDocAspxWordEnabled:!1,createDocumentSupported:!1,createModalExpV3Enabled:!1,createSmallLinks:!1,createOneDriveDocApiEnabled:!1,createVisioEnabled:!1,clientPwasEnabled:!1,darkModeEnabled:!1,darkModeOverride:!1,darkThemeEnabled:!1,delayedServiceWorkerInit:!1,detailedConsumerHeadersEnabled:!1,disableAnimation:!1,edgeworthEnabled:!1,edgeworthInstrumentationEnabled:!1,eduPageTourFreEnabled:!1,errorDialogEnabled:!1,featureFlagsEnabled:!1,filePicker:!1,fluidCreateAbpEnabled:!1,fluidCreateNewEnabled:!1,fluidDevBuildEnabled:!1,fluidDTTEnabled:!1,fluidFirst:!1,fluidHostCreateEnabled:!1,fluidHostEnabled:!1,fluidPreloadEnabled:!1,fluidSupportEnabled:!1,formsEnabled:!1,highResRecThumbnailsEnabled:!1,hoverPreloadTelemetryEnabled:!1,heroBackgroundOptimizationEnabled:!0,heroGradient:!0,incrementalCalloutEnabled:!1,isPwaInUwp:!1,leftNavReact:!1,leftNavReactSquares:!1,leftNavEmptyImage:"",limitNetworkRequests:!1,maxInitialPlaces:0,maxTotalPlaces:0,mobileContextMenusEnabled:!1,modalFreCalloutEnabled:!1,msaClientTokensEnabled:!1,m365AppsEnabled:!1,m365AppsPageRootPath:null,nativeSearchInHeaderEnabled:!1,officeHomeFloodgate:!1,oneDriveApisEnabled:!1,oneDriveUploadEnabled:!1,otherFlights:"",paidConsumerFreFloodgateEnabled:!1,peopleCardsEnabled:!1,prefetchDataEnabled:!1,pwaCommercialNonEduFreEnabled:!1,pwaEnabled:!1,pwaFreeConsumerFreEnabled:!1,pullToRefreshEnabled:!1,reactShellEnabled:!1,recommendedDeepLinkEnabled:!1,recommendedFloodgate:!1,recommendedReact:!1,recommendedTeamsLinkEnabled:!1,redirectWhenSignedOutFromWorkloads:!0,reloadWhenAuthExpired:!0,reloadWhenPolicyCheckFailed:!0,reloadWhenReauthRequired:!0,secondaryTokensEnabled:!1,skypeChatEnabled:!1,sharePointEnabled:!1,shellFeedbackEnabled:!1,shellPinEnabled:!1,showA2HSPrompt:!1,showBusinessApps:!1,showFeedback:!1,showFloodgate:!1,showFolders:!1,showPwaFeelingsSurvey:!1,showSearch:!1,showThemingCallout:!1,spaceModeEnabled:!1,startPageAppsArray:new Array,startPageRootPath:null,stayingAwareEnabled:!1,svgAppIconsEnabled:!1,swayCreateNewEnabled:!1,templatePageRootPath:null,templatesEnabled:!1,themingCalloutEnabled:!1,useOdbUrlForVroom:!1,useVroomForOneDriveApis:!1,wacHostAppsArray:new Array,wacHostCreateNewEnabled:!1,wacHostDocRebootEnabled:!1,wacHostEnabled:!1,wacHostHoverPreloadEnabled:!1,wacHeaderDisabled:!1,wacHostPagePath:"",wacSharingLinkEnabled:!1,wacStartPageEnabled:!1,fileHoverCardEnabled:!1},this.capabilities.featureFlagsEnabled&&this.updateWithOverrides(),this.capabilities.oneDriveUploadEnabled=this.capabilities.oneDriveUploadEnabled&&e.isDesktopDevice(),this.capabilities.createDocumentSupported=!e.isMobileDevice()&&!e.isTabletDevice(a.d.AndroidTablet),this.capabilities.isPwaInUwp=this.capabilities.pwaEnabled&&e.isUwp(),this.capabilities.disableAnimation=this.capabilities.pwaEnabled||this.capabilities.antpLoaded,this.capabilities.mobileContextMenusEnabled=e.isMobileDevice(),this.capabilities.leftNavReact=this.capabilities.leftNavReact&&!e.isMobileDevice(),this.capabilities.leftNavReactSquares=this.capabilities.leftNavReactSquares&&!e.isMobileDevice(),s||(r=!!document.getElementById("AppShellEnabled"),s=!0),r&&(this.capabilities.clientTokenFetchEnabled=!0),this.capabilities.wacHostAppsArray&&(this.capabilities.wacHostApps=new Set(this.capabilities.wacHostAppsArray.map(e=>o.a.fileTypeNameToFileType(e)))),this.capabilities.startPageAppsArray&&(this.capabilities.startPageApps=new Set(this.capabilities.startPageAppsArray.map(e=>o.a.fileTypeNameToFileType(e)))),this.openWithUIHost=l.isStandalone.pipe(Object(n.a)(e=>this.capabilities.wacHostEnabled||this.capabilities.clientPwasEnabled&&e)),this.openWithUIHost.subscribe(e=>this.shouldOpenWithUIHost=e),void 0===this.capabilities.templatesEnabled){const e=c.nativeWindow.location.hostname;this.capabilities.templatesEnabled=e&&e.lastIndexOf(".com")===e.length-4}}wacHostEnabledForFileType(e){const t=this.capabilities.wacHostApps;return this.wacHostEnabled()&&!!t&&t.has(e)}wacHostEnabled(){return this.shouldOpenWithUIHost}updateWithOverrides(){const e=new Set(["featureFlagsEnabled","disableAnimation","createDocumentSupported"]),t=this.featureManagerService.registerFlagsAndGetConfig(d.parseBooleanFlagsAndFilter(this.capabilities,e)),i=Object.keys(t);for(const e of i)this.capabilities[e]=t[e]}}return e.ɵprov=c.bc({factory:function(){return new e(c.cc(a.b),c.cc(m.a),c.cc(d),c.cc(p.a),c.cc(f.b))},token:e,providedIn:"root"}),e})()},"4ach":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static getOwnerPrincipalTypeToFormType(e){return"user"===e.toLowerCase()?"users":"group"===e.toLowerCase()?"groups":void 0}static getExtensionToFormType(e){return"form"===e.toLowerCase()?"users":"groupform"===e.toLowerCase()?"groups":void 0}static getFormsUserExperienceType(e){return e.toLowerCase()==="FormsPro".toLowerCase()?"FormsPro":"Forms"}}},"511z":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("Mlb/").q)("SERVICE_WORKER_API_AVAILABLE")},"55A9":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("6UlS"),r=i("Mlb/");let s=(()=>{class e{constructor(){this.sidePopupMenuEmitter=new n.a(null)}}return e.ɵprov=r.bc({factory:function(){return new e},token:e,providedIn:"root"}),e})()},"5FMq":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("EYJY"),r=i("70cc"),s=i("O6Zd"),o=i("Mlb/");let a=(()=>{class e{constructor(){this.contextMenu=new n.a}showMenu(e){this.updateNext(e,0)}closeMenu(e){this.updateNext(e,1)}subscribeToOpenEvents(e){return this.contextMenu.asObservable().pipe(Object(r.a)(e=>e&&0===e.type),Object(s.a)(e=>({menu:e.menu,position:e.position,focusFirstItem:e.focusFirstItem}))).subscribe(e)}subscribeToCloseEvents(e){return this.contextMenu.asObservable().pipe(Object(r.a)(e=>e&&1===e.type),Object(s.a)(e=>({menu:e.menu,position:e.position}))).subscribe(e)}updateNext(e,t){e&&e.menu&&e.position&&this.contextMenu.next({type:t,menu:e.menu,position:e.position,focusFirstItem:e.focusFirstItem})}}return e.ɵprov=o.bc({factory:function(){return new e},token:e,providedIn:"root"}),e})()},"5MEU":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("Mlb/").q)("WorkloadQueryParameter")},"5aVq":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("bb6g"),r=i("70cc"),s=i("WKA6"),o=i("Mlb/"),a=i("BMb5"),l=i("7Gwk");let c=(()=>{class e{constructor(e,t){this.windowService=e,this.eventService=t,this.afterShellRendered=this.onEventFired("shellRendered"),this.afterShellPlusLoaded=this.onEventFired("shellPlusLoaded")}getShellShim(){return Object(n.b)(this,void 0,void 0,(function*(){return yield this.afterShellRendered,this.windowService.nativeWindow.O365Shell}))}onEventFired(e){return this.eventService.events.withScope(0).pipe(Object(r.a)(t=>t.name===e),Object(s.a)(1)).toPromise()}}return e.ɵprov=o.bc({factory:function(){return new e(o.cc(a.b),o.cc(l.a))},token:e,providedIn:"root"}),e})()},"6GOa":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("dFxn");let s=(()=>{class e{constructor(e){this.config=e.parse("swayConfig")||{analyticsBatchSize:1,apiUrl:null,myEndpoint:null,thumbnailsEnabled:!1,uploadMaxFileSize:0,uploadSupportedExtensions:[]}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a))},token:e,providedIn:"root"}),e})()},"6Po3":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Mlb/");let r=(()=>{class e{constructor(e){this.ngZone=e,this.inRAF=!1}runAfterPaint(e,t=!0){return t?this.afterPaint(e):this.ngZone.runOutsideAngular(()=>this.afterPaint(e))}runBeforeLayout(e,t=!0){return t?this.beforeLayout(e):this.ngZone.runOutsideAngular(()=>this.beforeLayout(e))}cancel(e){e&&cancelAnimationFrame(e)}afterPaint(e){return this.beforeLayout(()=>{setTimeout(e,0)})}beforeLayout(e){if(!this.inRAF)return requestAnimationFrame(()=>{this.inRAF=!0,e(),Promise.resolve().then(()=>{this.inRAF=!1})});e()}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(n.z))},token:e,providedIn:"root"}),e})()},"6cfW":function(e,t,i){"use strict";function n(e){return e instanceof Error&&e.message&&"the operation is insecure."===e.message.toLowerCase()}i.d(t,"a",(function(){return n}))},"6u39":function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("6UlS"),r=i("uUrA"),s=i("k+kJ"),o=i("Mlb/"),a=i("7Gwk"),l=i("dFxn");let c=(()=>{class e{constructor(e){this.config=e.parse("pwaConfig")||{bridgeTimeoutInSeconds:0,diagnosticsTimeoutInSeconds:30,enablePwaIdleCallback:!1,installedAppsToLookFor:null,pwaJumpListEnabled:!1,PwaStartPageEnabled:!1,resourceUrlMap:null,shellAndConfigApiEndpoint:null,splashScreenTimeoutInMilliseconds:2e3,officeAfoRedemptionEnabled:!1,viewCacheEnabled:!1},this.config.mock&&(window.appsLaunched=new Array,this.config.mock.appsLaunched=window.appsLaunched)}}return e.ɵprov=o.bc({factory:function(){return new e(o.cc(l.a))},token:e,providedIn:"root"}),e})();var u=i("hhzZ"),h=i("BaAg"),d=i("p6Zr"),m=i("cgnd"),p=i("ZBli"),f=i("4/We"),g=i("/I02"),b=i("Bc8L");let v=(()=>{class e{constructor(){this._uploadResources=new n.a(null),this.uploadResources=this._uploadResources.asObservable(),this._uploadSession=new n.a(null),this.uploadSession=this._uploadSession.asObservable()}upload(e,t,i,n,r){if(this.uploadInProgress&&!this.uploadInProgress.finished())return null;this.currentSubscription&&(this.currentSubscription.unsubscribe(),this.currentSubscription=null,this.uploadInProgress=null);const s=t.upload(e,i,r);return s&&(this.currentSubscription=s.subscribe(e=>{this._uploadResources.next(n),this.uploadInProgress=e,this._uploadSession.next(e)})),s}uploadFiles(e,t,i,r){if(this.uploadInProgress&&!this.uploadInProgress.finished())return null;this.currentSubscription&&(this.currentSubscription.unsubscribe(),this.currentSubscription=null,this.uploadInProgress=null);const o=new s.b(t,e[0],r),a=new n.a(o);return o.cancellationToken.onCancel(()=>{o.state=s.c.Cancelled,a.next(o)}),o.error={title:i.multipleFilesErrorTitle,type:s.a.MultipleFiles,message:i.multipleFiles},o.state=s.c.Failed,a.next(o),this.currentSubscription=a.subscribe(e=>{this._uploadResources.next(i),this.uploadInProgress=e,this._uploadSession.next(e)}),a.asObservable()}cancelUpload(){this.uploadInProgress&&this.uploadInProgress.cancellationToken.cancel()}}return e.ɵprov=o.bc({factory:function(){return new e},token:e,providedIn:"root"}),e})();var S=i("JScD"),y=i("TIi1"),w=i("9MHL"),C=i("hZW2"),I=i("70cc"),T=i("WKA6"),k=i("O6Zd"),E=i("MFXD"),A=i("pjz5"),P=i("Uqr9"),x=i("BMb5"),D=i("XV2T");let M=(()=>{class e extends D.a{constructor(e,t,i){try{super(t.config.puid,i.getStorage(x.a.SessionStorage)),i.isStorageAvailable(x.a.SessionStorage)||e.logGenericEvent("Session_Storage_Unavailable")}catch(e){}}}return e.ɵprov=o.bc({factory:function(){return new e(o.cc(u.a),o.cc(m.b),o.cc(x.b))},token:e,providedIn:"root"}),e})();var F=i("EYcb");let L=(()=>{class e{constructor(e,t,i,n,r,s,o,a){this.windowService=e,this.documentService=t,this.contextService=i,this.capabilitiesService=n,this.sessionStorageService=r,this.instrumentationService=s,this.clientStartupConfigService=o,this.errorDialogService=a,this._responses=new E.a,this.supportedTokens=new Map,this.handlerErrorId="handler_error",this.init()}supportsToken(e){return this.supportedTokens.has(e)}requiresInteractiveLogin(e){if(this.capabilitiesService.capabilities.isPwaInUwp)return!1;const t=this.getTokenFromCache(e);return!(t&&t.success&&t.token&&t.expiryMs>Date.now())&&t&&!t.success&&t.error&&(-1!==t.error.indexOf("login_required")||-1!==t.error.indexOf("interaction_required"))}fetchTokenInteractive(e){return new Promise((t,i)=>{this.showLoginDialog(()=>{const n=this.supportedTokens.get(e),r=this.getState("popup"),s=this.windowService.nativeWindow,o=this.getTokenFetchUrl(n,r,"login"),a=P.a.now(),l=function(e,t){return t.open(e,"login_window",`width=483,height=600,top=${t.innerHeight/2-300+t.screenY},left=${t.innerWidth/2-241.5+t.screenX}`)}(o,s);if(!l){const e="Could not create login popup";return this.logFetchRequest(!1,!0,!1,-1,e),void i(e)}const c=function(e,t,i){const n=t.setInterval(()=>{e&&!e.closed&&void 0!==e.closed||(t.clearInterval(n),i())},100);return n}(l,s,()=>{const e=P.a.now(),t="Popup closed by user";this.logFetchRequest(!1,!0,!1,Math.ceil(e-a),t),i(t)});this.waitForToken(e,r,a,!1,!0).catch().then(e=>{s.clearInterval(c),e&&e.success?t(e):i("Failed to fetch token through popup")})},()=>{const e="Verify dialog closed by user";this.logFetchRequest(!1,!0,!1,-1,e),i(e)})})}getAccessTokenResponse(e,t=!1,i=!1){if(!this.supportsToken(e))return Promise.reject("token not supported");if(t&&this.requiresInteractiveLogin(e))return this.fetchTokenInteractive(e);const n=P.a.now();if(!i){const t=this.getTokenFromCache(e);if(t&&t.success&&t.token&&t.expiryMs>Date.now()){const e=P.a.now();return this.logFetchRequest(!0,!1,!0,Math.ceil(e-n)),Promise.resolve(t)}}const r=this.getState("iframe"),s=this.supportedTokens.get(e),o=this.getTokenFetchUrl(s,r,"none"),a=this.getIframeId(e),l=this.documentService.nativeDocument.getElementById(a);return l?l.setAttribute("src",o):this.documentService.addIframeToPage(o,a),this.waitForToken(e,r,n,!0,!1)}waitForToken(e,t,i,n,r){let s=null;const o=[];if(n){const e=new Promise(e=>{s=setTimeout(()=>{e({success:!1,token:null,format:"RPSDelegation",error:"timeout",source:"MSA"})},this.contextService.sharedContext.msaTokenTimeoutMs)});o.push(e)}const a=this.responses.withScope(1).pipe(Object(I.a)(e=>e.state===t||e.state===this.handlerErrorId),Object(T.a)(1),Object(k.a)(e=>e&&e.state!==this.handlerErrorId&&e.token&&e.token.TokenValue&&!e.error?{success:!0,token:e.token.TokenValue,format:"RPSDelegation",source:"MSA",expiryMs:e.token.ExpiryMs}:{success:!1,token:null,format:"RPSDelegation",error:u.a.filterPii(e.error),source:"MSA"})).toPromise();return o.push(a),Promise.race(o).then(t=>{const n=P.a.now();return this.logFetchRequest(!1,r,t.success,Math.ceil(n-i),t.error),s&&clearTimeout(s),this.saveTokenToCache(e,t),t})}getTokenFromCache(e){return this.sessionStorageService.get(this.getCacheKey(e))}saveTokenToCache(e,t){this.sessionStorageService.set(this.getCacheKey(e),t)}getCacheKey(e){return"_msatoken_"+e}get responses(){return this._responses.asScopableObservable()}init(){this.capabilitiesService.capabilities.msaClientTokensEnabled&&(this.windowService.nativeWindow.addEventListener("message",e=>{const{origin:t,data:i}=e;this.windowService.sameOriginRegex.test(t)&&this._responses.next(i)}),this.supportedTokens.set("OneDrive","onedrive_implicit.access"),this.supportedTokens.set("Graph","Family.Read Files.ReadWrite People.Read User.Read Contacts.Read"),this.supportedTokens.forEach((e,t)=>{this.documentService.addIframeToPage(null,this.getIframeId(t))}))}getIframeId(e){return"ohpMSAToken_"+e}getInstrumentationParams(e,t){const i={};return i.State=e?"FromCache":"FromNetwork",i.Action=t?"interactive":"silent",i}logFetchRequest(e,t,i,n,r){const s=this.getInstrumentationParams(e,t);this.instrumentationService.logRequestEvent("Msa_Token_Fetch",i?200:500,n,r,e,s)}getTokenFetchUrl(e,t,i){const n=this.contextService.sharedContext.msaAppId,r=this.contextService.sharedContext.msaTokenRedirectUrl;return`${this.contextService.sharedContext.inMockMode?this.contextService.sharedContext.officeHomeApiRoot+`/getMsaToken?mockmode=${this.getMockMode()}&`:"https://login.live.com/oauth20_authorize.srf?"}client_id=${n}&response_type=token&redirect_uri=`+encodeURIComponent(r)+"&response_mode=fragment&scope="+encodeURIComponent(e)+"&state="+encodeURIComponent(t)+"&prompt="+i+"&username="+encodeURIComponent(this.clientStartupConfigService.config.userPrincipalName)}getState(e){return`${e}|${r.a.createGuid()}`}showLoginDialog(e,t){this.errorDialogService.showErrorDialog({category:"VerifyIdentity",error:"LoginRequired",onActionClicked:e,onClose:t})}getMockMode(){return A.a.getQueryParams(this.windowService.nativeWindow.location.search).mockmsatoken||"default"}}return e.ɵprov=o.bc({factory:function(){return new e(o.cc(x.b),o.cc(C.a),o.cc(g.a),o.cc(f.a),o.cc(M),o.cc(u.a),o.cc(m.b),o.cc(F.a))},token:e,providedIn:"root"}),e})(),O=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c,u){this.capabilitiesService=e,this.contextService=t,this.instrumentationService=i,this.localAppLauncherService=n,this.uploadManagerService=r,this.uploadConfigService=s,this.startupConfigService=o,this.urlLauncherService=a,this.uploadService=l,this.documentService=c,this.msaTokenService=u}getClickDataForId(e,t,i,n,r){const o={};return o.UploadSessionId=t,o.ElementId=e=n?`${e}-${n}`:e,o.Area=u.b.Documents,o.ItemCount=(r||0).toString(),o.ItemCategory=s.d[i],{eventName:"Upload_Click",params:o,metrics:[]}}uploadFile(e,t,i,n,r){const o=h.a.fileTypeFromFileName(e.name);let a=!1;const l=(e,t)=>{a||(a=!0,this.logClick(n,i,r,o,e,t))},c=this.uploadManagerService.upload(e,this.uploadService,i,this.uploadConfigService.config.oneDriveResources,r);if(c){const e=(new Date).getTime();let n=!1;this.uploadSubscription=c.subscribe(a=>{if(a.state===s.c.Completed){n=!0;const t={};t.UploadSessionId=i,t.Latency=Math.ceil(a.duration).toString(),t.ItemCategory=s.d[r],this.instrumentationService.logGenericEvent("Upload_Completed",t,["Upload_Completed"]);const c=a.result.canonicalUrl,u=p.a.appendQuery(a.result.webUrl,`wdNewAndOpenCt=${e}&wdPreviousSession=${this.startupConfigService.config.sharedClientStartupContext.correlationId}&wdOrigin=${this.contextService.getWdOrigin("UPLOAD")}`),d=()=>{const e=e=>{l(!0,"Web"),this.urlLauncherService.openUrl(u,"Upload",e)};c?this.localAppLauncherService.launchOfficeApp(h.b[o],c).then(t=>{t?l(!0,"Native"):e("_blank")}).catch(()=>e("_top")):e(this.capabilitiesService.capabilities.pwaEnabled?"_blank":"_top")},m=this.uploadConfigService.config.minUploadDuration-a.duration;m<=0?d():setTimeout(d,m)}else a.state===s.c.Cancelled?(this.uploadSubscription.unsubscribe(),t&&setTimeout(()=>t.nativeElement.focus(),0),n||l(!1)):a.state===s.c.Failed&&l(!1)})}}uploadFiles(e,t,i,n){const r=h.a.fileTypeFromFileName(e[0].name);let o=!1;const a=(e,s)=>{if(o)return;o=!0;const a=this.getClickDataForId(i,t,n);this.instrumentationService.logClickEvent(a.eventName,i,a.params.Area,e?this.uploadConfigService.config.uploadFileTypes.has(r)?h.a.referralFromFileType(r):d.a.OneDrive:"",s,a.params,a.metrics)},l=this.uploadManagerService.uploadFiles(e,t,this.uploadConfigService.config.oneDriveResources,n);l&&(this.uploadSubscription=l.subscribe(e=>{e.state===s.c.Cancelled?(this.uploadSubscription.unsubscribe(),a(!1)):e.state===s.c.Failed&&a(!1)}))}startUploadFlow(e,t,i,n,r){this.documentService.selectFile(e).then(e=>{const s=e[0];this.startupConfigService.config.authType===m.a.MSA&&this.msaTokenService.requiresInteractiveLogin("OneDrive")?this.msaTokenService.fetchTokenInteractive("OneDrive").then(()=>{this.uploadFile(s,i,t,n,r)}).catch(()=>{const e=h.a.fileTypeFromFileName(s.name);this.logClick(n,t,r,e,!1)}):this.uploadFile(s,i,t,n,r)})}logClick(e,t,i,n,r,s){const o=this.getClickDataForId(e,t,i);this.instrumentationService.logClickEvent(o.eventName,e,o.params.Area,r?this.uploadConfigService.config.uploadFileTypes.has(n)?h.a.referralFromFileType(n):d.a.OneDrive:"",s,o.params,o.metrics)}}return e.ɵprov=o.bc({factory:function(){return new e(o.cc(f.a),o.cc(g.a),o.cc(u.a),o.cc(b.a),o.cc(v),o.cc(S.a),o.cc(m.b),o.cc(y.a),o.cc(w.a),o.cc(C.a),o.cc(L))},token:e,providedIn:"root"}),e})(),R=(()=>{class e{constructor(e,t,i,r){this.eventService=e,this.pwaConfigService=t,this.uploadButtonService=i,this.instrumentationService=r,this._modalInfo=new n.a(null),this.updateNextSessionId()}showModal(e,t,i){this._modalInfo.next({filePath:e,fileName:t,type:i})}get modalInfo(){return this._modalInfo.asObservable()}uploadFile(e,t){this.currentUploadSessionId=this.nextUploadSessionId,this.updateNextSessionId(),this.uploadButtonService.uploadFile(e,null,this.currentUploadSessionId,t,s.d.Button)}getLocalFileInfo(e,t){return new Promise(i=>{this.pwaConfigService.config.mock?i(new File([],t)):Windows.Storage.StorageFile.getFileFromPathAsync(e).then(e=>{if(!e)throw new Error("Null file returned for path");return Windows.Storage.FileIO.readBufferAsync(e).then(e=>e,()=>{throw new Error("Unable to create buffer")})},()=>{throw this.eventService.broadcastEvent({name:"needAccessToFileSystem",args:["allow-file-system-access-upload"]}),new Error("Unable to access local file")}).then(e=>{if(!e)throw new Error("Null buffer");try{const n=Windows.Storage.Streams.DataReader.fromBuffer(e),r=n.unconsumedBufferLength,s=new Uint8Array(r);for(let e=0;e<r;e++)s[e]=n.readByte();const o=new Blob([s]);o.lastModifiedDate=new Date,o.name=t,i(o)}catch(e){throw new Error("Error reading from buffer")}}).then(null,e=>{const t={};t.Error=e?e.message:"",t.ItemCategory=s.d[s.d.Button],this.instrumentationService.logGenericEvent("Upload_Local_Error",t,[],2)})})}updateNextSessionId(){this.nextUploadSessionId=r.a.createGuid()}}return e.ɵprov=o.bc({factory:function(){return new e(o.cc(a.a),o.cc(c),o.cc(O),o.cc(u.a))},token:e,providedIn:"root"}),e})()},"72nV":function(e,t,i){},"7Gwk":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("70cc"),r=i("WKA6"),s=i("MFXD"),o=i("Mlb/"),a=i("BMb5");let l=(()=>{class e{constructor(e){this.windowService=e,this._events=new s.a,this.mutateGlobalWindowState()}broadcastEvent(e){this._events.next(e)}get events(){return this._events.asScopableObservable()}whenEventFired(e,t){return this.events.withScope(t).pipe(Object(n.a)(t=>t.name===e),Object(r.a)(1)).toPromise()}mutateGlobalWindowState(){this.windowService.nativeWindow.ng2EventService=this}}return e.ɵprov=o.bc({factory:function(){return new e(o.cc(a.b))},token:e,providedIn:"root"}),e})()},"7IJ8":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("bb6g"),r=i("Mlb/");class s{constructor(e,t,i,n,s,o,a,l,c){this.lazyViewLoaderService=e,this.viewRef=t,this.globalErrorHandler=i,this.clientStartupConfigService=n,this.scheduler=s,this.modulePriorityService=o,this.browserPaintService=a,this.ngZone=l,this.pageVisibilityService=c,this.componentLoaded=new r.n,this.outputsSubscriptionMap=new Map}ngOnInit(){return Object(n.b)(this,void 0,void 0,(function*(){if(this.ngModulePath)try{yield this.loadComponent()}catch(e){this.globalErrorHandler.handleError(e,"ehPAl")}}))}ngDoCheck(){this.setInputsOutputs()}ngOnDestroy(){this.creationHandle&&this.browserPaintService.cancel(this.creationHandle),this.outputsSubscriptionMap.forEach(e=>e.unsubscribe()),this.viewRef.clear()}setInputsOutputs(){if(this.lazyComponentRef){for(const e in this.inputs)this.lazyComponentRef.instance[e]=this.inputs[e];for(const e in this.outputs){if(this.outputsSubscriptionMap.has(e))continue;const t=this.lazyComponentRef.instance[e];if(!(t&&t instanceof r.n))continue;const i=t.subscribe(this.outputs[e]);this.outputsSubscriptionMap.set(e,i)}}}loadComponent(){return Object(n.b)(this,void 0,void 0,(function*(){const e=yield this.lazyViewLoaderService.loadLazyViewFromModule(this.ngModulePath),t=()=>{this.lazyComponentRef=this.viewRef.createComponent(e),this.componentLoaded.emit(this.lazyComponentRef)};if("idle-callback"===this.clientStartupConfigService.config.chunkLoadStrategy&&this.pageVisibilityService.isVisible()){const e=this.modulePriorityService.getSchedulePriority(this.ngModulePath);this.scheduler.scheduleWork(()=>{this.creationHandle=this.browserPaintService.runBeforeLayout(()=>{this.creationHandle=null,this.ngZone.run(()=>{t(),this.setInputsOutputs()})})},e)}else t()}))}}},"7Rc8":function(e,t,i){"use strict";i.d(t,"b",(function(){return T})),i.d(t,"a",(function(){return k}));var n=i("Mlb/"),r=i("BaAg"),s=i("RR/o"),o=i("kpuN"),a=i("R7NL"),l=i("hhzZ"),c=i("/I02"),u=i("wwmn"),h=i("JH4S"),d=i("QOOv"),m=i("vk2e"),p=i("lrJm"),f=i("cgnd"),g=i("Uqr9"),b=i("Z0U4"),v=i("ZtId"),S=i("casz"),y=i("BMb5"),w=i("4/We"),C=i("BJbw");let I=(()=>{class e{constructor(e,t,i,n,r,o,a,l,c,u,h,d,m,p,f,g,b){this.mruService=new s.b(e,i,t,n,r,o,a,l,c,u,h,m,p,f,g,b),g.capabilities.edgeworthEnabled||d.subscribeToRouteChangeStart(e=>{e.currentRoute&&this.warmDocumentCache(e.currentRoute)})}getMruService(){return this.mruService}warmDocumentCache(e){switch(e.route){case"OfficeHome":case"Pwa":this.mruService.getMruDocuments();break;case"Start":e.app!==r.b.SharePoint&&e.app!==r.b.OneDrive&&this.mruService.getMruDocuments(new Set([e.app]))}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(o.a),n.cc(a.a),n.cc(l.a),n.cc(c.a),n.cc(u.a),n.cc(h.a),n.cc(d.a),n.cc(m.q),n.cc(p.b),n.cc(f.b),n.cc(g.b),n.cc(b.a),n.cc(v.a),n.cc(S.a),n.cc(y.b),n.cc(w.a),n.cc(C.a))},token:e,providedIn:"root"}),e})();var T=function(e){return e[e.Unknown=0]="Unknown",e[e.SkyDrive=1]="SkyDrive",e[e.SkyDrivePro=2]="SkyDrivePro",e[e.SharePointOnline=3]="SharePointOnline",e}({});let k=(()=>{class e{}return e.ɵprov=n.bc({factory:function(){return(e=>e.getMruService())(n.cc(I))},token:e,providedIn:"root"}),e})()},"7wk3":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("vk2e"),r=i("BaAg"),s=i("Mlb/"),o=i("Uqr9"),a=i("WLAd"),l=i("6Po3"),c=i("Z0U4"),u=i("4/We"),h=i("BMb5"),d=i("7Gwk"),m=i("R4AA"),p=i("hhzZ");let f=(()=>{class e{constructor(e,t,i,n,r,s,o){this.capabilitiesService=e,this.windowService=t,this.performanceService=i,this.eventService=n,this.ntpService=r,this.instrumentationService=s,this.pageVisibilityService=o,this.paintRecordings=new Set(["SharePoint","MRU","Recommended"]),this.eventService.whenEventFired("sharePointFailed",0).then(()=>{this.mark("SharePoint")}),this.eventService.whenEventFired("mruFailed",0).then(()=>{this.mark("MRU")}),this.eventService.whenEventFired("recommendedFailed",0).then(()=>{this.mark("Recommended")})}mark(e){this.paintRecordings.delete(e)&&this.capabilitiesService.capabilities.antpLoaded&&(0===this.paintRecordings.size&&(!this.windowService.nativeWindow.antpTtvrLogged&&this.ntpService.logHistogram(62)&&(this.windowService.nativeWindow.antpTtvrLogged=!0),this.pageVisibilityService.isVisible()&&(this.performanceService.mark("Paint_Antp",2,0,window.getCommonParamsAntp()),this.instrumentationService.logGenericEvent("Antp_View",window.getCommonParamsAntp())),this.eventService.broadcastEvent({name:"antpReady",args:[]})),this.paintMinAntpRecorded||(this.pageVisibilityService.isVisible()&&(this.performanceService.mark("Paint_AntpMin",2,0,window.getCommonParamsAntp()),this.instrumentationService.logGenericEvent("Antp_MinView",window.getCommonParamsAntp())),this.paintMinAntpRecorded=!0))}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(u.a),s.cc(h.b),s.cc(o.b),s.cc(d.a),s.cc(m.a),s.cc(p.a),s.cc(a.a))},token:e,providedIn:"root"}),e})(),g=(()=>{class e{constructor(e,t,i,n,r,s){this.performanceService=e,this.platformId=t,this.pageVisibilityService=i,this.browserPaintService=n,this.visuallyReadyService=s,this.queuedEvents=new Set,this.markedEvents=new Set,this.setupOnHiddenListener(),r.subscribeToRouteChangeStart(e=>this.currentRoute=e.currentRoute)}recordWhenPainted(e){const t=e+(this.currentRoute&&this.currentRoute.route?`_${this.currentRoute.route}${this.currentRoute.app?r.b[this.currentRoute.app]:""}`:"");Object(n.t)(this.platformId)&&!this.markedEvents.has(t)&&this.pageVisibilityService.isVisible()&&(this.queuedEvents.add(e),this.markedEvents.add(t),this.paintListenerHandle||(this.paintListenerHandle=this.browserPaintService.runAfterPaint(()=>{this.pageVisibilityService.isVisible()&&this.queuedEvents.forEach(e=>{this.performanceService.mark("Paint_"+e),this.visuallyReadyService&&this.visuallyReadyService.mark(e)}),this.resetListener()},!1)))}setupOnHiddenListener(){this.pageVisibilityService.addOnVisibilityChanged(e=>{"hidden"===e&&this.cancelPaintListener()})}cancelPaintListener(){this.paintListenerHandle&&this.browserPaintService.cancel(this.paintListenerHandle),this.resetListener()}resetListener(){this.queuedEvents.clear(),this.paintListenerHandle=null}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(o.b),s.cc(s.B),s.cc(a.a),s.cc(l.a),s.cc(c.a),s.cc(f,8))},token:e,providedIn:"root"}),e})()},9260:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("bb6g"),r=i("BaAg"),s=i("RR/o"),o=i("pOWU"),a=i("uUrA"),l=i("oAX+");let c=(()=>{class e extends o.a{constructor(e,t,i,n,r,s,o,a,l,c,u,h,d,m){super(e,n,r,"Substrate",i,o,a,h),this.capabilitiesService=t,this.mruConfigService=s,this.globalErrorHandler=l,this.startupConfigService=c,this.updateContentService=u,this.windowService=d,this.aadAppId=m,this.fetchRequestIndex=0;const p=this.mruConfigService.config;this.allApps=["Word","Excel","PowerPoint","OneNote"],p.recommendedPdfEnabled&&this.allApps.push("Pdf"),p.recommendedVisioEnabled&&this.allApps.push("Visio"),p.recommendedFluidEnabled&&this.allApps.push("Fluid","Bohemia"),this.sources=["EmailAttachment","OneDrive","Sharepoint"],this.capabilitiesService.capabilities.isPwaInUwp&&this.sources.push("LocalFile"),this.baseUrl=(this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:p.substrateApiEndpoint)+`/${p.recommendedB2ApiRootPath}/`,this.recommendedDataStreams=new Map}getRecommendedDocs(e){const t=this.getUrl(e);if(this.recommendedDataStreams.has(t))return this.recommendedDataStreams.get(t);const i=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchRecommendedDocs(t):this.fetchRecommendedDocs("network-first",t,e),n=this.updateContentService.getOrAddUpdateStream(this.getUpdateStreamKey(t),()=>this.fetchRecommendedDocs("network-first",t,e)),r=l.a.createResultsWithCacheObservable(this.fetchRecommendedDocs("cache-only",t,e),i,n,e=>this.recommendedDataStreams.delete(t));return this.recommendedDataStreams.set(t,r),r}updateRecommendedDocs(e){return this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e)))}removeDocument(e,t){const i=a.a.createGuid(),n=this.createRequestConfig(i);return new Promise((i,r)=>{this.post("Recommended_Delete_Request",this.baseUrl+this.mruConfigService.config.recommendedApiDismissedDocumentsPath,{id:e,until:t},e=>{e.then(()=>i(null))},r,n)})}fetchRecommendedDocs(t,i,n){return new Promise((r,s)=>{const o=a.a.createGuid(),l=this.createRequestConfig(o);this.get("Recommended_Request",i,i=>{i.instrument((t,i)=>{if(i.params.RequestId=this.getRequestIdFromResponse(t),i.params.DebugInfo=this.getServerDebugInfo(t),i.params.Index=(this.fetchRequestIndex++).toString(),i.params.ImpressionId=!!t.headers&&t.headers.get(e.clientRequestIdHeader)||o,i.params.DocumentType=n?this.getTypesParam(n):"All",t.ok&&t.data){let e=0;t.data.documents_group&&t.data.documents_group.documents&&(e=t.data.documents_group.documents.length,i.params.ResourceIdDistribution=t.data.documents_group.documents.map(e=>e.resource_id).toString()),i.params.ActualSize=e.toString()}}).then(i=>this.processLocalRecommendedData(i.data).then(n=>{r({items:n||[],impressionId:!!i.headers&&i.headers.get(e.clientRequestIdHeader)||o,fromCache:"cache-only"===t})})).catch(e=>{this.globalErrorHandler.handleError(e,"QG6EV")})},s,l,t)})}prefetchRecommendedDocs(e){return this.windowService.nativeWindow.prefetchRecommendedDataPromise?this.windowService.nativeWindow.prefetchRecommendedDataPromise.then(e=>e?this.processLocalRecommendedData(e).then(t=>({items:t,impressionId:e.recommendedRequestId||"",fromCache:!1})):Promise.reject("Prefetch failed")):this.fetchRecommendedDocs("network-first",e)}handleQueryParam(e,t,i){"mockrecommended"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}static fileType(t){let i=r.a.fileTypeFromExtension(t.extension);return i&&i!==r.b.None||(i=e.fileTypeFromAppName(t.app)||r.b.Unknown),i}static fileTypeFromAppName(e){return e?r.a.fileTypeNameToFileType(e):null}createRequestConfig(t){const i=this.startupConfigService.config;return{headers:new Map([["X-AnchorMailbox",`${i.objectId}@${i.tenantId}`],["X-Office-Application",this.contextService.sharedContext.recommendedIceApplicationId.toString()],["X-RoutingParameter-SessionKey",i.objectId],["X-Ms-ClientAppId",this.aadAppId],[e.clientRequestIdHeader,t]])}}getUrl(t){const i=this.getTypesParam(t),n=this.sources.join(",");return`${this.baseUrl}${this.mruConfigService.config.recommendedB2ApiFilesPath}?${e.countParam}${this.mruConfigService.config.numRecommendedToRequest}&${e.skipCacheParam}&${e.appsParam}${i}&${e.locParam}${this.contextService.sharedContext.officeMarket}&${e.sourcesParam}${n}`}getTypesParam(e){return(e&&e.size?this.allApps.filter(t=>e.has(r.a.fileTypeNameToFileType(t))):this.allApps).join(",")}getUpdateStreamKey(e){return"recommended-"+e}convertToMruDataItem(t,i=!1){const n=t.activity_info?t.activity_info.badge:void 0,o=n&&n.timestamp?new Date(n.timestamp):null,a="EmailAttachment"===t.service_info.service_id||"FP_EXCHANGE_ORGID"===t.service_info.service_id;let l=null;a&&(l={AttachmentType:1,ConversationId:"",Subject:n&&n.conversation_info?n.conversation_info.subject:""});let c=void 0;return this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled&&n&&n.sharing_action&&(c=n.sharing_action.web_url),{Application:t.app,Category:"Document",DocId:t.onedrive_info&&t.onedrive_info.item_id,DriveId:t.onedrive_info&&t.onedrive_info.drive_id,FileName:t.title,Title:t.title,Url:a||i?t.web_url:t.url,WebUrl:t.web_url,LastAccessedTime:o,FileType:r.b[e.fileType(t)],PathArray:null,Provenance:r.c[r.c.Substrate],ResourceId:t.resource_id,UrlAlreadyEncoded:!0,Activity:t.activity_info?s.b.convertMruActivityToActivityDescription(t.activity_info):void 0,IsCollab:!!t.activity_info&&t.activity_info.is_collab,IsEmailAttachment:a,IsLocal:i,OneDriveInfo:t.onedrive_info,SharepointInfo:t.sharepoint_info,SPOId:t.id,EmailReference:l,NavigationId:t.activity_info&&t.activity_info.badge&&t.activity_info.badge.navigation_info?t.activity_info.badge.navigation_info.id:null,TeamsDeepLink:c}}processLocalRecommendedData(e){var t;return Object(n.b)(this,void 0,void 0,(function*(){const i=(null===(t=null==e?void 0:e.documents_group)||void 0===t?void 0:t.documents)||[];return Promise.all(i.map(e=>this.checkLocalFileAndProcess(e))).then(e=>e.filter(e=>null!==e&&e.Activity&&e.Activity.formatString))}))}getServerDebugInfo(e){if(!e||!e.headers)return"";const t=e.headers;return`BE: ${t.get("X-CalculatedBETarget")||""}. FE: ${t.get("X-FEServer")||""}.`}checkLocalFileAndProcess(e){return Object(n.b)(this,void 0,void 0,(function*(){return new Promise(t=>{var i;if("LocalFile"!==(null===(i=e.service_info)||void 0===i?void 0:i.service_id))t(this.convertToMruDataItem(e));else if(this.capabilitiesService.capabilities.isPwaInUwp){const i=e.web_url;try{Windows.Storage.StorageFile.getFileFromPathAsync(i).then(i=>{t(i?this.convertToMruDataItem(e,!0):null)},()=>{t(null)})}catch(e){t(null)}}else t(null)})}))}}return e.clientRequestIdHeader="client-request-id",e.countParam="show=",e.skipCacheParam="skipCache=false",e.appsParam="apps=",e.locParam="rs=",e.sourcesParam="sources=",e})()},"9InZ":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},"9MHL":function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var n=i("6UlS"),r=i("3GGT"),s=i("hhzZ"),o=i("BaAg"),a=i("p6Zr"),l=i("cgnd");class c{static resolveGraphError(e,t){const i=e.httpResponse||e;if(i&&"number"==typeof i.status){const e=i.status,n=i.data;if(n&&n.error){const e=[];let i=n.error;for(;i;)e.push(i),i=i.innererror;for(i=e.pop();i;){const n=t(i.code);if(void 0!==n)return n;i=e.pop()}}return t(e)}}}var u=i("ZBli"),h=i("k+kJ"),d=i("Uqr9");class m{constructor(e,t){this.totalBytes=t,this.startTime=d.a.now(),this.expirationTime=this.startTime+e,this.progressPoints=0}doesActivityHaveRemainingCapacity(e){const t=this.getRateRatio(e);return void 0===t||t<=1}didActivityHaveExtraCapacity(){const e=d.a.now();return this.expirationTime-e>e-this.startTime}getRateRatio(e){this.progressPoints++;const t=d.a.now(),i=t-this.startTime,n=this.expirationTime-t;let r;return this.progressPoints>=4&&i>=4e3&&n>0&&i>0&&(r=(this.totalBytes-e)/n/(e/i)),r}}var p=i("IAGz");class f{constructor(e,t,i){this.oneDriveService=e,this.windowService=i,this.uploadConfig=t.config}advanceState(e,t,i){const{sessionUrl:n,nextExpectedRanges:r}=t;let s;return s=n?r?this.uploadItemState(e,t,i):this.getStatusState(e,t,i):this.createSessionState(e,t,i),s.then(e=>e.error?this.handleGeneralErrorState(e,i):this.getState(e,{waitDuration:void 0,clientAttemptsRemaining:void 0,serverAttemptsRemaining:void 0}))}createSessionState(e,t,i){return this.oneDriveService.createUploadSession(e.file,e.sessionId,null,null,i).then(e=>this.getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl}),e=>this.getState(t,{error:e}))}getStatusState(e,t,i){return this.oneDriveService.getUploadSessionStatus(t.sessionUrl,e.sessionId,i).then(e=>this.getState(t,{nextExpectedRanges:e.nextExpectedRanges}),e=>this.getState(t,{error:e}))}uploadItemState(e,t,i){const n=e.file.size,r=this.getNextRange(n,t.nextExpectedRanges);let s;return s=r&&r.start<n?this.uploadFragmentState(r,e,t,i):this.cancelSessionState(e,t,i),s.then(e=>e.error?this.handleUploadItemErrorState(e,i):e)}uploadFragmentState(e,t,i,n){const{sessionUrl:r,speed:s=this.uploadConfig.initialSpeed}=i,{start:o,end:a}=e;t.updateProgress(o);const l=this.getFragmentSize(s),c=Math.min(o+l,a),u=s>this.uploadConfig.minSpeed?this.uploadConfig.fragmentTimeoutInMs:this.uploadConfig.fragmentTimeoutInMs*this.uploadConfig.slowFragmentTimeoutMultiplier,h=new m(u,c-o),d=t.file,f=new p.a;return n.onCancel(()=>{f.cancel()}),new Promise(e=>{this.oneDriveService.uploadFragment(r,o,c,d.size,d.slice(o,c),t.sessionId,n=>{const r=o+n.loaded;s>this.uploadConfig.minSpeed&&!h.doesActivityHaveRemainingCapacity(r-o)&&(f.cancel(),e(this.getState(i,{speed:Math.max(s*this.uploadConfig.slowSpeedDowngradeRatio,this.uploadConfig.minSpeed),nextExpectedRanges:void 0}))),t.updateProgress(r)},f,u).then(n=>{t.updateProgress(c),i=this.isDriveItem(n)?this.getState(i,{item:n}):this.getState(i,{nextExpectedRanges:n.nextExpectedRanges,speed:Math.min(h.didActivityHaveExtraCapacity()?s*this.uploadConfig.speedUpgradeRatio:s,1)}),e(i)},t=>{e(this.getState(i,{error:t}))})})}cancelSessionState(e,t,i){return this.oneDriveService.cancelUploadSession(t.sessionUrl,e.sessionId,i).then(()=>this.getState(t,{sessionUrl:void 0}),()=>this.getState(t,{sessionUrl:void 0}))}handleUploadItemErrorState(e,t){const{speed:i=1}=e;return e=this.getState(e,{nextExpectedRanges:void 0}),this.handleErrorState(e,n=>{switch(n){case r.a.Offline:case r.a.Unknown:return this.windowService.nativeWindow.navigator.onLine?Promise.resolve(this.getState(e,{speed:Math.max(i*this.uploadConfig.speedDowngradeRatio,this.uploadConfig.minSpeed)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case r.a.NotFound:return Promise.resolve(this.getState(e,{error:void 0,sessionUrl:void 0}));case"invalidRange":case r.a.RangeNotSatisfiable:return this.wait(this.uploadConfig.standardWaitDurationInMs,t).then(()=>this.getState(e,{error:void 0}))}})}handleGeneralErrorState(e,t){const{waitDuration:i=this.uploadConfig.initialWaitDurationInMs,clientAttemptsRemaining:n=this.uploadConfig.numClientAttempts,serverAttemptsRemaining:s=this.uploadConfig.numServerAttempts}=e;return this.handleErrorState(e,o=>{switch(o){case"unauthenticated":case r.a.Unauthorized:case"lockMismatch":case r.a.Locked:case r.a.NotImplemented:case"quotaLimitReached":case r.a.InsufficientStorage:case r.a.Offline:return}if("number"==typeof o){if(o>=400&&o<500)return;if(0===o||o>=500&&o<600){if(!s)return;return this.wait(i,t,!0).then(()=>this.getState(e,{error:void 0,waitDuration:Math.min(2*i,this.uploadConfig.maxWaitDurationInMs),serverAttemptsRemaining:Math.max(s-1,0)}))}if(!n)return;return this.wait(this.uploadConfig.standardWaitDurationInMs,t).then(()=>this.getState(e,{error:void 0,waitDuration:void 0,clientAttemptsRemaining:Math.max(n-1,0)}))}})}handleErrorState(e,t){const{error:i}=e;let n=c.resolveGraphError(i,t);return void 0===n&&(n=Promise.resolve(e)),n}getState(e,t){return Object.assign(Object.assign({},e),t)}getNextRange(e,t=[]){return t.reduce((t,i)=>{const[n,r]=i.split("-",2),s=parseInt(n,10);let o;return o=!t||s<t.start&&s<e?{start:s,end:""===r?e:Math.min(parseInt(r,10)+1,e)}:t,o},void 0)}isDriveItem(e){return!!e.id}getFragmentSize(e){const t=e*this.uploadConfig.maxFragmentSize;let i;return i=t>this.uploadConfig.discreteChunkSize?t-t%this.uploadConfig.discreteChunkSize:t-t%this.uploadConfig.minFragmentSize,Math.min(Math.max(i,this.uploadConfig.minFragmentSize),this.uploadConfig.maxFragmentSize)}wait(e,t,i=!1){let n;const r=new Promise(t=>{n=setTimeout(()=>{t()},e)});let s;const o=new Promise(e=>{s=()=>{i&&e()},this.windowService.nativeWindow.addEventListener("online",s)}),a=t?t.onCancel(()=>Promise.reject(null)):new Promise(()=>{});return new Promise(e=>{Promise.race([r,o,a]).then(()=>{e()},()=>{}).then(()=>{this.windowService.nativeWindow.removeEventListener("online",s),clearTimeout(n)})})}}var g=i("Mlb/"),b=i("/I02"),v=i("PBJH"),S=i("Dpxn"),y=i("JScD"),w=i("TIi1"),C=i("BMb5"),I=i("4/We"),T=i("lrJm");let k=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l){this.contextService=e,this.locService=t,this.oneDriveService=i,this.uploadConfigService=n,this.urlLauncherService=r,this.windowService=s,this.capabilitiesService=o,this.globalErrorHandler=a,this.clientStartupConfigService=l,this.setupUploadPromise(),this.uploadConfigService.config&&(this.stateMachine=new f(this.oneDriveService,this.uploadConfigService,this.windowService))}upload(e,t,i){const r=this.uploadConfigService.config;if(!r)return null;const s=new h.b(t,e,i),o=new n.a(s);return s.cancellationToken.onCancel(()=>{s.sessionUrl&&!s.finished()&&this.oneDriveService.cancelUploadSession(s.sessionUrl,s.sessionId),s.state=h.c.Cancelled,o.next(s)}),this.isValidFileType(e)?this.startUpload(s,o):(s.error=this.suggestOneDriveErrorWithText(r.oneDriveResources.errorTitle,this.locService.format(r.oneDriveResources.unsupportedFile,this.locService.OpenOneDrive),h.a.InvalidFileType,s),s.state=h.c.Failed,o.next(s)),o.asObservable()}setupUploadPromise(){return this.uploadEnabledPromise=new Promise(e=>{this.capabilitiesService.capabilities.oneDriveUploadEnabled&&this.uploadConfigService.config?this.oneDriveService.getMyDriveRootUrl().then(t=>{e(!!t)}).catch(t=>{this.globalErrorHandler.handleError(t,"IRW0y"),e(!(this.capabilitiesService.capabilities.isPwaInUwp||this.clientStartupConfigService.config.authType!==l.a.MSA||!t||!t.networkError||!t.networkError.httpResponse||t.networkError.httpResponse.status!==r.a.TokenUnavailable))}):e(!1)}),this.uploadEnabledPromise}startUpload(e,t){e.state=h.c.Started,t.next(e),this.uploadToOneDrive(e).then(i=>{e.result=i,e.state=h.c.Completed,t.next(e)},i=>{e.error=this.getUploadSessionError(i,e,t),e.state=h.c.Failed,t.next(e)})}isValidFileType(e){const t=o.a.fileTypeFromFileName(e.name);return this.uploadConfigService.config.uploadFileTypes.has(t)}uploadToOneDrive(e){return(e.file.size<this.uploadConfigService.config.simpleUploadMaxSize?this.uploadSmall(e):this.uploadLarge(e)).then(t=>{const i={};t.webDavUrl&&(i.canonicalUrl=t.webDavUrl);let n=t.webUrl;const r=o.a.fileTypeFromFileName(e.file.name);if(this.uploadConfigService.config.editableFileTypes.has(r)){const e="action=edit";n=n.replace(new RegExp("([?&])action[^&]*"),"$1"+e),-1===n.lastIndexOf(e)&&(n=u.a.appendQuery(n,e))}return i.webUrl=n,i})}uploadSmall(e){return this.oneDriveService.uploadFile(e.file,e.sessionId,null,null,t=>e.updateProgress(t.loaded),e.cancellationToken)}uploadLarge(e){return this.uploadState(e,{})}uploadState(e,t){const{sessionUrl:i,item:n,error:r}=t;return e.sessionUrl=i,new Promise((s,o)=>{n?s(n):r&&!i?o(r):r?this.oneDriveService.cancelUploadSession(i,e.sessionId,e.cancellationToken).catch(()=>{}).then(()=>o(r)):this.stateMachine.advanceState(e,t,e.cancellationToken).then(t=>{this.uploadState(e,t).then(s,o)},o)})}getUploadSessionError(e,t,i){const n=this.uploadConfigService.config.oneDriveResources;if(!e.httpResponse||e.clientError)return{title:n.errorTitle,type:h.a.Unknown,message:""};const s=this.uploadConfigService.config.commonResources;return c.resolveGraphError(e,e=>{switch(e){case"quotaLimitReached":case r.a.InsufficientStorage:return this.suggestOneDriveErrorWithText(n.errorTitle,n.outOfSpace,h.a.OutOfSpace,t);case"maxFileSizeExceeded":case r.a.RequestEntityTooLarge:return{title:n.errorTitle,type:h.a.FileTooLarge,message:n.largeFile};case r.a.Offline:return this.retryErrorWithText(n.errorTitle,s.checkConnection,h.a.BadConnection,t,i);case r.a.TokenUnavailable:case r.a.TokenRefreshFailed:return{title:n.errorTitle,type:h.a.Auth,message:""}}})||{title:n.errorTitle,type:h.a.Unknown,message:""}}retryErrorWithText(e,t,i,n,r){const s=this.uploadConfigService.config.commonResources;return{title:e,type:i,message:t,recourseAction:{text:s.retryButtonTitle,ariaLabel:s.retryButtonAriaLabel,action:()=>{this.startUpload(n,r)},clickData:this.recourseClickDataWithId("upload-retry",n.sessionId,n.uploadSource)}}}suggestOneDriveErrorWithText(e,t,i,n){return this.contextService.sharedContext.oneDriveUrl?{title:e,type:i,message:t,recourseAction:{text:this.locService.OpenOneDrive,ariaLabel:this.locService.OpenOneDrive,action:()=>{this.urlLauncherService.openUrl(this.contextService.sharedContext.oneDriveUrl,"OpenOneDriveUploadAction")},clickData:this.recourseClickDataWithId("upload-open-onedrive",n.sessionId,n.uploadSource,a.a.OneDrive)}}:{title:e,type:h.a.Unknown,message:""}}recourseClickDataWithId(e,t,i,n){const r={};return r.UploadSessionId=t,r.ElementId=e,r.Referral=n,r.Area=s.b.UploadDialog,r.ItemCategory=h.d[i],{eventName:"Upload_Click",params:r,metrics:[]}}}return e.ɵprov=g.bc({factory:function(){return new e(g.cc(b.a),g.cc(v.a),g.cc(S.a),g.cc(y.a),g.cc(w.a),g.cc(C.b),g.cc(I.a),g.cc(T.b),g.cc(l.b))},token:e,providedIn:"root"}),e})()},"9gjh":function(e,t,i){"use strict";i.d(t,"a",(function(){return qe})),i.d(t,"b",(function(){return hi}));var n=i("Mlb/"),r=i("7IJ8"),s=i("QhWD"),o=i("lrJm"),a=i("cgnd"),l=i("casz"),c=i("RsrG"),u=i("6Po3"),h=i("WLAd"),d=i("pzhl"),m=i("PkQn"),p=i("4/We"),f=i("vk2e"),g=i("bb6g"),b=i("70cc"),v=i("kaEK"),S=i("Eup2"),y=i("A/um"),w=i("hhzZ"),C=i("BaAg"),I=i("jCfB"),T=i("fKR7"),k=i("CVeG");let E=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c,u,h,d,m){this.activityDescriptionService=e,this.capabilitiesService=t,this.changeDetectorRef=i,this.documentService=n,this.domSanitizer=r,this.eventService=s,this.instrumentationService=o,this.locService=a,this.mruItemInflationService=l,this.peopleCardService=c,this.responsiveRelativeDatePipe=u,this.urlLauncherService=h,this.wacContentService=d,this.windowService=m,this.mobileListItem=!1,this.activityDeepLinkHovered=!1}ngOnInit(){this.activityState=this.activities?"active":"inactive",this.iconSize=this.iconSize||16,this.shortDate=this.windowService.innerWidth<640,this.inTeams=this.locService.TimeSentInTeams,this.locService.supportsLocaleSpecifiers&&(this.eventsSubscription=this.eventService.events.withScope(1).pipe(Object(b.a)(e=>"contentWidthChanged"===e.name)).subscribe(e=>{let t;[t]=e.args,this.shortDate=t<640,this.updateDescription()})),this.updateDescription()}ngOnChanges(){this.updateDescription()}ngAfterViewInit(){this.softUpdatePeopleCards()}ngDoCheck(){this.softUpdatePeopleCards()}ngOnDestroy(){this.eventsSubscription&&this.eventsSubscription.unsubscribe(),this.removePeopleCards()}onHover(){this.updatePeopleCards()}activityHovered(){this.activityDeepLinkHovered=!0}activityUnhovered(){this.activityDeepLinkHovered=!1}clicked(e){if(!this.activityDeepLink&&!this.teamsDeepLink)return;e&&e.preventDefault();const t=this.activityDeepLink||this.teamsDeepLink;!this.teamsDeepLink&&this.capabilitiesService.capabilities.wacHostEnabled&&this.capabilitiesService.capabilities.wacHostApps.has(this.fileType)?(this.logClick(),this.wacContentService.bootstrapAndRoute({docUrl:t,fileType:this.fileType,wdOrigin:"",applicationUrlParams:{actnavid:this.navId}},{[I.a.Nav]:this.navId})):(this.urlLauncherService.openUrl(t,"RecommendedDeepLink"),this.logClick())}getActivityElementId(){return`${e.activitySectionId}-${this.docId}`}logClick(t=!1){const i={};i.ItemId=this.activityDeepLink?"activity-description":"teams-deep-link",i.Index=this.index.toString(),i.ItemCategory=S.a.recommendedListId,i.State="Card",i.ResourceId=this.docId,i.Area=w.b.Recommended,i.DocumentType=C.b[this.fileType],i.ActivityDisplayed=this.activityReason?v.a[this.activityReason]:"",i.ClickDestination=t?"ContentPage":"ExternalPage";const n=T.b.referralFromFileType(this.fileType);this.instrumentationService.logClickEvent("Recommended_Click",e.activitySectionId,w.b.Recommended,n,"Web",i)}updateDescription(){const e=this.activityDescriptionInput||this.activityDescriptionService.activityDescription(this.activities,this.lastViewedTime,this.shortDate,2===this.numLines);let t=null;if(e&&(t=this.createDescription(e)),!t||this.htmlDescription&&t.html.toString()===this.htmlDescription.html.toString()?!t&&this.htmlDescription&&(this.removePeopleCards(),this.htmlDescription=null,this.dateString=null,this.activityState="inactive"):(this.removePeopleCards(),this.htmlDescription=t,this.dateString=this.getDateString(this.htmlDescription.activityDescription.timestamp),this.activityState="active",this.needPeopleCardUpdate=!0),this.capabilitiesService.capabilities.recommendedDeepLinkEnabled||this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled){this.changeDetectorRef.detectChanges();const e=this.documentService.nativeDocument.getElementById(this.getActivityElementId());e&&(this.clickHandler&&e.removeEventListener("click",this.clickHandler),this.clickHandler=e=>this.clicked(e),e.addEventListener("click",this.clickHandler))}}createDescription(e){return this.activityReason=e?e.reasonType:void 0,e&&e.formatString?{activityDescription:e,html:this.generateHtml(e),icon:this.reasonTypeToIcon(e.reasonType,1===this.numLines)}:null}generateHtml(e){if(!e.people||!e.people.length)return e.formatString;let t=k.a.escapeHtml(e.formatString);if(this.activityDeepLink){const e=t.split(/(&lt;c[0-9]+&gt;.*?&lt;\/c[0-9]+&gt;)/);for(let t=0;t<e.length;t++)t%2==0&&(e[t]=` <span class='activity-deep-link__underlined'>${e[t].trim()}</span> `);t=e.join("").trim()}for(let i=0;i<e.people.length;i++){const n=e.people[i];n.tag&&(t=t.replace(new RegExp(`&lt;${n.tag.trim()}&gt;`,"g"),n.upn?`<span class="activity-user-name ms-fcl-nd ms-fcl-nd-h" title="${k.a.escapeHtml(n.name)}" data-email="${k.a.escapeHtml(n.upn)}">`:"<span>"),t=t.replace(new RegExp(`&lt;/${n.tag.trim()}&gt;`,"g"),"</span>"))}return this.domSanitizer.bypassSecurityTrustHtml(t)}reasonTypeToIcon(e,t){switch(e){case v.a.Edit:return t?y.a.PencilSolid:y.a.Pencil;case v.a.Comment:return t?y.a.Chat:y.a.Comment;case v.a.Mention:return y.a.At;case v.a.Open:return y.a.FolderOpen;case v.a.Share:return y.a.People2;case v.a.Attachment:return y.a.Mail;case v.a.SnoozeExpiry:return y.a.Calendar;case v.a.Trending:return y.a.Trending;case v.a.News:return y.a.News;case v.a.Meeting:return y.a.Calendar;case v.a.Video:return y.a.Video;case v.a.Default:default:return y.a.Compass}}getDateString(e){const t=this.locService.localizedDateString(e);return this.responsiveRelativeDatePipe.transform(e,this.shortDate,t,!1)}softUpdatePeopleCards(){if(this.capabilitiesService.capabilities.peopleCardsEnabled){if(this.peopleCardService.population()>0)return void this.updatePeopleCards();if(this.queuedPeopleCardUpdate||!this.needPeopleCardUpdate)return;this.queuedPeopleCardUpdate=this.mruItemInflationService.waitOnInflations().then(()=>{this.updatePeopleCards(),this.queuedPeopleCardUpdate=null})}}updatePeopleCards(){if(!(this.capabilitiesService.capabilities.peopleCardsEnabled&&this.needPeopleCardUpdate&&this.htmlDescription&&this.htmlDescription.activityDescription&&this.htmlDescription.activityDescription.people))return void(this.needPeopleCardUpdate=!1);if(!this.descriptionElement||!this.descriptionElement.nativeElement)return;this.changeDetectorRef.detectChanges();const e=this.descriptionElement.nativeElement.querySelectorAll(".activity-user-name");for(let t=0;t<e.length;t++){const i=e[t].getAttribute("data-email");this.peopleCardService.addPersonaCard(e[t],i)}this.needPeopleCardUpdate=!1}removePeopleCards(){return Object(g.b)(this,void 0,void 0,(function*(){if(!(this.capabilitiesService.capabilities.peopleCardsEnabled&&this.htmlDescription&&this.htmlDescription.activityDescription&&this.htmlDescription.activityDescription.people&&this.descriptionElement&&this.descriptionElement.nativeElement))return;const e=this.descriptionElement.nativeElement.querySelectorAll(".activity-user-name");for(let t=0;t<e.length;t++){const i=e[t].getAttribute("data-email");try{yield this.peopleCardService.removePersonaCard(e[t],i)}catch(e){}}}))}}return e.activitySectionId="activity-description-div",e})();var A=i("dx17"),P=i("hZW2"),x=i("C0xW"),D=i("7Gwk"),M=i("PBJH"),F=i("kfAr"),L=i("31lE"),O=i("mXGw"),R=i("xARA"),_=i("Uqr9"),U=i("kpuN"),N=i("/I02"),W=i("dFxn");let B=(()=>{class e{constructor(e){this.config=e.parse("peopleCardConfig")}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(W.a))},token:e,providedIn:"root"}),e})();var H=i("Bc8L"),q=i("TIi1"),V=i("BMb5");let $=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c){this.accessTokenService=e,this.capabilitiesService=t,this.contextService=i,this.startupConfigService=n,this.instrumentationService=r,this.peopleCardConfigService=s,this.localAppLauncherService=o,this.urlLauncherService=a,this.windowService=l,this.scheduler=c,this.peopleCount=0}addPersonaCard(e,t){return this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.bootstrap().then(()=>{this.lpc&&(this.lpc.addedPersonaToPageV2(e,{personaInfo:{identifiers:{Smtp:t,PersonaType:"User"}},externalAppSessionCorrelationId:this.startupConfigService.config.sharedClientStartupContext.correlationId,behavior:{onCardOpen:()=>{const i={};i.ElementId=e.id,i.ItemId=new w.d(t,L.AWTPiiKind.SmtpAddress),this.instrumentationService.logImpressionEvent("People_Card_Impression",i)},onCardClose:null,disableHover:!1}}),this.peopleCount++)}):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")}addPersonaCardElement(e,t,i="",n=!0){return this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.bootstrap().then(()=>{this.lpc&&R.render(O.createElement(this.windowService.nativeWindow.LivePersonaCardHoverTargetV2,{cardParameters:{personaInfo:{identifiers:{AadObjectId:t,PersonaType:"User",Smtp:i}},externalAppSessionCorrelationId:this.startupConfigService.config.sharedClientStartupContext.correlationId,behavior:{onCardOpen:()=>{const i={};i.ElementId=e.id,i.ItemId=new w.d(t,L.AWTPiiKind.Identity),this.instrumentationService.logImpressionEvent("People_Card_Impression",i)},locationToOpen:n?"ExpandedView":"Card"}}},O.createElement("div",{id:"personCardClickElement"})),e)}):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")}removePersonaCard(e,t){return this.capabilitiesService.capabilities.peopleCardsEnabled?this.peopleCardConfigService.config?this.initPromise?this.initPromise.then(()=>{this.lpc&&(this.lpc.removedPersonaFromPage(e,t),this.peopleCount--)}):Promise.reject("removePersonaCard is called without calling addPersonaCard first"):Promise.reject("peopleCardConfigService.config is not defined"):Promise.reject("People cards disabled")}bootstrap(){if(!this.initPromise)if(this.peopleCardConfigService.config){this.startTime=_.a.now();const e={actionCallbacks:this.capabilitiesService.capabilities.pwaEnabled?{openDocument:e=>{this.localAppLauncherService.launchOfficeApp(e.Type,e.DownloadUrl).then(e=>{if(!e)throw new Error("fallback to browser")}).catch(()=>{this.urlLauncherService.openUrl(e.WebUrl,"OpenDocFromPeopleCard")})},composeMail:e=>{this.urlLauncherService.openUrl("mailto:"+e,"EmailFromPeopleCard")},startChat:e=>{this.urlLauncherService.openUrl(e.imAddressUrl,"OpenChatFromPeopleCard")},handleContactNumber:e=>{this.urlLauncherService.openUrl("tel:"+e,"HandleNumberFromPeopleCard")}}:void 0,culture:this.contextService.sharedContext.officeMarket,region:this.peopleCardConfigService.config.region,clientType:this.peopleCardConfigService.config.clientType,clientContextType:this.peopleCardConfigService.config.clientContextType,clientCorrelationId:this.startupConfigService.config.sharedClientStartupContext.correlationId,logMessage:(e,t,i)=>{},getAuthToken:(e,t)=>{this.getAuthToken((i,n)=>{i?e(i,this.startupConfigService.config.sharedClientStartupContext.correlationId):t(n,this.startupConfigService.config.sharedClientStartupContext.correlationId)})}},{deferBootstrap:t}=this.peopleCardConfigService.config;let i;i=t?new Promise(e=>{this.scheduler.scheduleWork(()=>{this.importBootstrapper().then(e)},3)}):this.importBootstrapper(),this.initPromise=i.then(({initializeLivePersonaCard:i})=>t?new Promise((t,n)=>{this.scheduler.scheduleWork(()=>{i(e).then(()=>t(null)).catch(n)},3)}):i(e)).then(()=>{this.windowService.ensureZoneJs(),this.lpc=this.windowService.nativeWindow.LPC;const e=_.a.now()-this.startTime;this.instrumentInitialization("Start",e)},e=>{this.windowService.ensureZoneJs();const t=_.a.now()-this.startTime;this.instrumentInitialization("Error",t,e)})}else this.initPromise=Promise.reject("peopleCardConfigService.config is not defined");return this.initPromise}population(){return this.peopleCount}instrumentInitialization(t,i,n){const r={};r.State=t,r.Latency=Math.ceil(i).toString(),n&&(r.Error="string"==typeof n&&0===n.indexOf(e.errorPrefix)?n:new w.d(n)),this.instrumentationService.logGenericEvent("People_Card_Initialization",r)}getAuthToken(e){this.accessTokenService.getAccessToken("Loki").then(t=>{e(t.token,t.error?"Error : "+t.error:"")})}importBootstrapper(){return i.e(12).then(i.t.bind(null,"3czk",7))}}return e.errorPrefix="LPCError: ",e.ɵprov=n.bc({factory:function(){return new e(n.cc(U.a),n.cc(p.a),n.cc(N.a),n.cc(a.b),n.cc(w.a),n.cc(B),n.cc(H.a),n.cc(q.a),n.cc(V.b),n.cc(l.a))},token:e,providedIn:"root"}),e})();var z=i("1Bt+"),j=i("EUVs"),G=n.wb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}}]}});function Q(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-icon-font",[],[[1,"aria-label",0]],null,null,d.b,d.a)),n.xb(1,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontType:[1,"iconFontType"],size:[2,"size"]},null)],(function(e,t){var i=t.component;e(t,1,0,n.Fb(1,"ms-fcl-tda activity-icon ",i.iconCssClass,""),i.htmlDescription.icon,i.iconSize)}),(function(e,t){var i=t.component;e(t,0,0,null==i.htmlDescription||null==i.htmlDescription.activityDescription?null:i.htmlDescription.activityDescription.plainText)}))}function K(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),n.Xb(-1,null,[" - "]))],null,null)}function Z(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,"span",[],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(2,{"activity-deep-link__underlined ms-fcl-tda":0}),(e()(),n.Xb(3,null,["",""]))],(function(e,t){var i=t.component,n=e(t,2,0,i.teamsDeepLink&&i.activityDeepLinkHovered);e(t,1,0,n)}),(function(e,t){e(t,3,0,t.component.inTeams)}))}function J(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,7,"div",[["class","activity-description__date"]],[[8,"title",0]],null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"activity-description__title--clipped":0}),(e()(),n.Xb(3,null,[" "," "])),(e()(),n.hb(16777216,null,null,1,null,K)),n.xb(5,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Z)),n.xb(7,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!!i.title);e(t,1,0,"activity-description__date",n),e(t,5,0,i.teamsDeepLink),e(t,7,0,i.teamsDeepLink)}),(function(e,t){var i=t.component;e(t,0,0,n.Fb(1,"",i.title||i.dateString,"")),e(t,3,0,i.title||i.dateString)}))}function X(e){return n.ac(0,[(e()(),n.yb(0,0,[[1,0],["descriptionElement",1]],null,7,"span",[["class","activity-description ms-fcl-ns"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"activity-description--clipped":0,"activity-description--card":1,"activity-description--mobile":2,"activity-description--motion-padding":3}),(e()(),n.yb(3,0,null,null,2,"span",[],[[8,"innerHTML",1],[8,"title",0]],[[null,"mouseenter"]],(function(e,t,i){var n=!0;return"mouseenter"===t&&(n=!1!==e.component.onHover()&&n),n}),null,null)),n.xb(4,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(5,{"activity-deep-link ms-fcl-tda":0,"list-item__text--large activity-description__title--clipped ms-fcl-ns":1}),(e()(),n.hb(16777216,null,null,1,null,J)),n.xb(7,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.numLines,2===i.numLines,i.mobileListItem&&2!==i.numLines,!!i.title);e(t,1,0,"activity-description ms-fcl-ns",n);var r=e(t,5,0,i.activityDeepLink&&i.activityDeepLinkHovered,!!i.title);e(t,4,0,r),e(t,7,0,2===i.numLines)}),(function(e,t){var i=t.component;e(t,3,0,null==i.htmlDescription?null:i.htmlDescription.html,n.Fb(1,"",null==i.htmlDescription||null==i.htmlDescription.activityDescription?null:i.htmlDescription.activityDescription.plainText,""))}))}function Y(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,null,null,null,null,null,null,null)),n.Mb(null,0),(e()(),n.hb(0,null,null,0))],null,null)}function ee(e){return n.ac(0,[n.Tb(671088640,1,{descriptionElement:0}),(e()(),n.yb(1,0,null,null,6,"div",[],[[24,"@fadeIn",0],[8,"id",0]],[[null,"mouseover"],[null,"mouseleave"]],(function(e,t,i){var n=!0,r=e.component;return"mouseover"===t&&(n=!1!==r.activityHovered()&&n),"mouseleave"===t&&(n=!1!==r.activityUnhovered()&&n),n}),null,null)),n.xb(2,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(3,{"activity-description__container":0,"activity-description__container--mobile":1}),(e()(),n.hb(16777216,null,null,1,null,Q)),n.xb(5,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,X)),n.xb(7,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Y)),n.xb(9,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,3,0,!i.iconOnly,i.mobileListItem);e(t,2,0,n),e(t,5,0,null==i.htmlDescription?null:i.htmlDescription.icon),e(t,7,0,(null==i.htmlDescription?null:i.htmlDescription.html)&&!i.iconOnly),e(t,9,0,!i.htmlDescription)}),(function(e,t){var i=t.component;e(t,1,0,i.activityState,i.docId?i.getActivityElementId():null)}))}var te=i("NdOS");i("AXM8");class ie{constructor(e){this.graphPictureService=e,this.fetchImage=!0,this.isUpcomingMeeting=!1,this.status="None",this.hasPadding=!1,this.iconSize=this.iconSize||30}ngOnChanges(){var e;if(this.fetchImage){const t=this.pictureId||(null===(e=this.person)||void 0===e?void 0:e.email);this.imageBase64Promise=t?this.graphPictureService.getPeoplePicture(t,this.iconSize<=48?"48x48":void 0):Promise.resolve(null)}else this.imageBase64Promise=Promise.resolve(this.imageBase64)}}var ne=i("aQ3G"),re=i("R7NL"),se=i("wwmn");let oe=(()=>{class e extends ne.a{constructor(e,t,i,n,r,s,o,a,l){super(t,i,n,r,s,o,a,l),this.cache=new Map,this.batchEnabled=e.capabilities.batchGraphEnabled}getPeoplePictures(e){if(this.batchEnabled)return new Promise((t,i)=>{const n=e.map(e=>({eventName:"OneDrive_Graph_People_Picture_Request",endpoint:`users/${e}/photo/$value`,method:"GET",cacheResult:!0}));this.batchGraph(n,"OneDrive_Graph_Batch_People_Pictures_Request").then(e=>{t((e||[]).map(e=>e&&e.ok?e.data:null))},i)});{const t=[];for(let i=0;i<e.length;i++)t.push(this.getPeoplePicture(e[i]));return Promise.all(t).then(e=>[].concat(...e))}}getPeoplePicture(e,t){if(this.cache.has(e))return this.cache.get(e);const i=void 0===t?`users/${e}/photo/$value`:`users/${e}/photos/${t}/$value`,n=new FileReader,r=new Promise(e=>{this.getGraph("OneDrive_Graph_People_Picture_Request",i,"network-only",null,!0,null,null,null,this.batchEnabled,"blob").then(t=>{t&&t.ok?(n.onloadend=()=>{const t=n.result&&"string"==typeof n.result&&n.result.split(",")||[];e(t.length>1?t[1]:null)},n.onerror=()=>e(null),n.onabort=()=>e(null),n.readAsDataURL(t.data)):e(null)}).catch(t=>{this.globalErrorHandler.handleError(t,"H5HgW"),e(null)})});return this.cache.set(e,r),r}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(p.a),n.cc(U.a),n.cc(w.a),n.cc(re.a),n.cc(N.a),n.cc(se.a),n.cc(f.q),n.cc(o.b),n.cc(l.a))},token:e,providedIn:"root"}),e})();var ae=n.wb({encapsulation:2,styles:[],data:{}});function le(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"img",[],[[8,"src",4],[8,"title",0]],null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"person-picture-upcoming-meeting__display":0,"person-picture__image":1})],(function(e,t){var i=t.component,r=n.Fb(1,"person-picture__",i.iconSize,""),s=e(t,2,0,i.isUpcomingMeeting,!i.isUpcomingMeeting);e(t,1,0,r,s)}),(function(e,t){var i=t.component;e(t,0,0,"data:image/png;base64,"+t.context.ngIf,n.Fb(1,"",null==i.person?null:i.person.fullName,""))}))}function ce(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"ohp-icon-font",[["cssClass","upcomingMeeting-card__attendee_status_image"],["size","16"]],null,null,null,d.b,d.a)),n.xb(2,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,2,0,"upcomingMeeting-card__attendee_status_image",t.component.status,"16")}),null)}function ue(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["aria-hidden","true"],["class","person-picture-upcoming-meeting__display"]],[[8,"title",0]],null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"div",[["class","person-picture-upcoming-meeting__text"]],null,null,null,null,null)),(e()(),n.Xb(2,null,[" "," "]))],null,(function(e,t){var i=t.component;e(t,0,0,n.Fb(1,"",null==i.person?null:i.person.fullName,"")),e(t,2,0,null==i.person?null:i.person.fullName.slice(0,1))}))}function he(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["aria-hidden","true"],["class","person-picture__image person-picture__image--icon"],["style","font-size: 24px;"]],[[8,"title",0]],null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"person-picture__placeholder--padding--7":0,"person-picture__placeholder--padding--4":1}),(e()(),n.yb(3,0,null,null,1,"ohp-icon-font",[["iconFontName","Person"],["size","16"]],null,null,null,d.b,d.a)),n.xb(4,638976,null,0,m.a,[p.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.hasPadding&&30===i.iconSize,i.hasPadding&&24===i.iconSize);e(t,1,0,"person-picture__image person-picture__image--icon",n),e(t,4,0,"Person","16")}),(function(e,t){var i=t.component;e(t,0,0,n.Fb(1,"",null==i.person?null:i.person.fullName,""))}))}function de(e){return n.ac(0,[(e()(),n.hb(16777216,null,null,1,null,ue)),n.xb(1,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,he)),n.xb(3,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(0,null,null,0))],(function(e,t){var i=t.component;e(t,1,0,i.isUpcomingMeeting),e(t,3,0,!i.isUpcomingMeeting)}),null)}function me(e){return n.ac(0,[(e()(),n.hb(16777216,null,null,2,null,le)),n.xb(1,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),n.Pb(131072,f.b,[n.h]),(e()(),n.hb(16777216,null,null,1,null,ce)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(0,[["placeholder",2]],null,0,null,de))],(function(e,t){var i=t.component;e(t,1,0,n.Yb(t,1,0,n.Nb(t,2).transform(i.imageBase64Promise)),n.Nb(t,5)),e(t,4,0,"Accepted"===i.status||"Declined"===i.status||"TentativelyAccepted"===i.status)}),null)}class pe{constructor(e,t){this.elementRef=e,this.peopleCardService=t}ngOnInit(){this.upn&&(this.renderPromise=this.peopleCardService.addPersonaCard(this.elementRef.nativeElement,this.upn))}ngOnDestroy(){this.renderPromise&&this.renderPromise.then(()=>{this.peopleCardService.removePersonaCard(this.elementRef.nativeElement,this.upn)})}}var fe=i("tuJr"),ge=i("s+Eq"),be=i("5FMq");class ve{constructor(e,t,i,r){this.capabilitiesService=e,this.deviceDetector=t,this.instrumentationService=i,this.locService=r,this.leftAlignedCard=!1,this.menuToggled=new n.n,this.menuFocused=new n.n,this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileContextMenusEnabled}ngOnChanges(e){e.hasOwnProperty("menuModel")&&this.initializeDropdownMenuModel(this.menuModel)}ngOnInit(){this.initializeDropdownMenuModel(this.menuModel)}onFocusLink(e){this.menuFocused.emit(e)}onToggleMenu(e){e&&(this.menuModel.rightAligned=!0),this.menuToggled.emit(e),this.instrumentToggle(e)}onSelectItem(e){e.item.executeAction(e.nativeDomEvent)}initializeDropdownMenuModel(e){if(this.dropdownMenuModel=e,!this.dropdownMenuModel)throw new Error("menuModel must be provided to actions-menu");this.dropdownMenuModel.linkAriaLabel=this.locService.MruActionsMenuAriaLabel,this.dropdownMenuModel.linkTooltip=this.locService.MruActionsMenuToolTip,this.dropdownMenuModel.linkCssClass="actions-menu-link ms-fcl-nd ms-bgc-g40-f ms-bgc-g40-h ms-bgc-g40-a commanding-item ms-bgc-g40-h "+(this.deviceDetector.isDesktopDevice()?" actions-menu-link--hidden":"")}instrumentToggle(e){const t=e?"Open":"Close",i={};i.RenderSize=this.menuModel.items.length.toString(),i.Index=this.listItemIndex.toString(),i.Action=t,this.instrumentationService.logClickEvent("Actions_Menu_Toggle","actions-menu-link",this.area,null,null,i,[],this.dataSecurity||0)}}var Se=i("W3Zz"),ye=n.wb({encapsulation:2,styles:[],data:{}});function we(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,6,"div",[["class","actions-menu-item__flex-content"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,d.b,d.a)),n.xb(2,638976,null,0,m.a,[p.a],{color:[0,"color"],cssClass:[1,"cssClass"],iconFontCssClass:[2,"iconFontCssClass"],iconFontType:[3,"iconFontType"],size:[4,"size"]},null),(e()(),n.yb(3,0,null,null,3,"div",[["class","list-item__title menu-item__title ms-fcl-bl"]],null,null,null,null,null)),n.xb(4,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(5,{"menu-item__title--disabled":0}),(e()(),n.Xb(6,null,["",""]))],(function(e,t){e(t,2,0,t.context.item.iconColor,n.Fb(1,"actions-menu-item__icon ms-fcl-bl ",t.context.item.disabled?" menu-item__icon--disabled":"",""),t.context.item.iconCssClass,t.context.item.icon,"16");var i=e(t,5,0,t.context.item.disabled);e(t,4,0,"list-item__title menu-item__title ms-fcl-bl",i)}),(function(e,t){e(t,6,0,t.context.item.title)}))}function Ce(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,8,"ohp-dropdown-menu",[],null,[[null,"toggleMenu"],[null,"selectItem"],[null,"focusLink"]],(function(e,t,i){var n=!0,r=e.component;return"toggleMenu"===t&&(n=!1!==r.onToggleMenu(i)&&n),"selectItem"===t&&(n=!1!==r.onSelectItem(i)&&n),"focusLink"===t&&(n=!1!==r.onFocusLink(i)&&n),n}),fe.b,fe.a)),n.xb(1,4440064,[[1,4]],1,ge.a,[n.h,be.a],{menuModel:[0,"menuModel"],mobileContextMenu:[1,"mobileContextMenu"],leftAlignedCard:[2,"leftAlignedCard"]},{toggleMenu:"toggleMenu",selectItem:"selectItem",focusLink:"focusLink"}),n.Tb(603979776,2,{menuItems:1}),(e()(),n.yb(3,0,null,0,3,"div",[["ohpMenuLinkContent",""]],null,null,null,null,null)),n.xb(4,16384,null,0,ge.c,[],null,null),(e()(),n.yb(5,0,null,null,1,"ohp-icon-font",[["iconFontName","Ellipsis"],["size","16"]],null,null,null,d.b,d.a)),n.xb(6,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null),(e()(),n.hb(0,null,null,1,null,we)),n.xb(8,16384,[[2,4]],0,ge.b,[n.L],null,null)],(function(e,t){var i=t.component;e(t,1,0,i.dropdownMenuModel,i.mobileMenusEnabled,i.leftAlignedCard),e(t,6,0,n.Fb(1,"actions-menu__icon ms-fcl-ns ",i.iconClass,""),"Ellipsis","16",!0)}),null)}function Ie(e){return n.ac(0,[n.Tb(671088640,1,{dropdownMenu:0}),(e()(),n.hb(16777216,null,null,1,null,Ce)),n.xb(2,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,null==i.dropdownMenuModel||null==i.dropdownMenuModel.items?null:i.dropdownMenuModel.items.length)}),null)}class Te{constructor(e,t){this.instrumentationService=t,this.enabled=e.capabilities.hoverPreloadTelemetryEnabled}onMouseEnter(){this.enabled&&(this.startTime=_.a.now())}onMouseLeave(){this.startTime&&this.log(!1)}onClick(){this.startTime&&this.log(!0)}reset(){this.startTime=null}log(e){const t=this.getTimeElapsed().toString(),i={};i.TimeElapsed=t,i.Area=this.area,i.DocumentHoverClick=e.toString(),this.instrumentationService.logGenericEvent("Document_Hover",i),this.reset()}getTimeElapsed(){return _.a.now()-this.startTime}}var ke=i("g0MB"),Ee=i("w1PR");let Ae=(()=>{class e{constructor(e){this.locService=e,this.updateAriaLabel=new n.n}ngOnChanges(){if(this.state=this.analytics?"active":"inactive",this.analytics){const e=this.formatSingularOrPluralString(this.analytics.viewCount,this.locService.DocumentAnalyticsSingleTotalView,this.locService.DocumentAnalyticsMultipleTotalViews),t=this.locService.format(this.locService.DocumentAnalyticsAvgTimeSpent,this.getAvgTimeSpent(this.analytics.averageTimeSpentMs)),i=this.locService.format(this.locService.DocumentAnalyticsAvgCompletion,this.locService.localizedNumberString(Math.floor(100*this.analytics.averageCompletionRatio))),n=this.locService.format(this.locService.DocumentAnalyticsGlancedViews,this.locService.localizedNumberString(this.analytics.glancedReads)),r=this.formatSingularOrPluralString(this.analytics.quickReads,this.locService.DocumentAnalyticsSingleQuickRead,this.locService.DocumentAnalyticsMultipleQuickReads),s=this.formatSingularOrPluralString(this.analytics.deepReads,this.locService.DocumentAnalyticsSingleDeepRead,this.locService.DocumentAnalyticsMultipleDeepReads);this.generalInfo=this.locService.format(this.locService.DocumentAnalyticsTotalViewsAvgTimeSpentAndAvgCompletionFormat,e,t,i),this.detailedViewInfo=this.locService.format(this.locService.DocumentAnalyticsDetailedViewsInfoFormat,n,r,s),this.updateDescription()}}getAvgTimeSpent(t){const i=t/6e4;return i<e.spentTimeLessThanStringThreshold?this.locService.format(this.locService.DocumentAnalyticsLessThanAvgTimeSpent,this.locService.localizedNumberString(e.spentTimeLessThanStringThreshold)):this.locService.format(this.locService.DocumentAnalyticsAvgTimeSpentMinutes,this.locService.localizedNumberString(Math.round(i)))}formatSingularOrPluralString(e,t,i){return this.locService.format(1===e?t:i,this.locService.localizedNumberString(e))}updateDescription(){const e=this.locService.format(this.locService.DocumentDescriptiveAriaLabelAnalytics,this.generalInfo,this.detailedViewInfo);this.updateAriaLabel.emit(e)}}return e.spentTimeLessThanStringThreshold=1,e})();var Pe=n.wb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}}]}});function xe(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"div",[["class","analytics-description__data-piece-label ms-fcl-np"]],null,null,null,null,null)),(e()(),n.Xb(2,null,["",""])),(e()(),n.yb(3,0,null,null,1,"div",[["class","analytics-description__data-piece-label ms-fcl-np"]],null,null,null,null,null)),(e()(),n.Xb(4,null,["",""]))],null,(function(e,t){var i=t.component;e(t,2,0,i.generalInfo),e(t,4,0,i.detailedViewInfo)}))}function De(e){return n.ac(2,[(e()(),n.yb(0,0,null,null,2,"div",[],[[24,"@fadeIn",0]],null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,xe)),n.xb(2,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,2,0,t.component.analytics)}),(function(e,t){e(t,0,0,t.component.state)}))}var Me=i("oAX+");class Fe{constructor(e,t,i,n){this.instrumentedHttp=e,this.domSanitizer=t,this.serviceWorkerStateService=i,this.serviceWorkerConfigService=n}transform(e){return Me.a.createResultsWithCacheObservable(this.getData(e,"cache-only"),this.getData(e,"network-first")).results}getData(e,t){return Object(g.b)(this,void 0,void 0,(function*(){const i=yield this.instrumentedHttp.get("Thumbnail_Cache_Pipe_Load",e,{headers:"Controlled"===this.serviceWorkerStateService.currentState&&this.serviceWorkerConfigService.config.enabled?new Map([["X-SW-OHP-ThumbnailCacheable","ODSP_THUMBNAIL_CACHEABLE"]]):null,responseType:"blob"},t),n=URL.createObjectURL(i.data);return this.domSanitizer.bypassSecurityTrustUrl(n)}))}}var Le=i("JWB6"),Oe=i("+2OL");class Re{transform(e){return{email:e.address,fullName:e.name}}}var _e=i("pd4Y"),Ue=i("uH9+");class Ne{constructor(e,t){this.contextMenuService=e,this.deviceDetector=t}ngOnInit(){this.desktop=this.deviceDetector.isDesktopDevice()}onContextMenu(e){this.desktop&&this.model&&e&&!this.disabled&&(e.preventDefault(),setTimeout(()=>{this.contextMenuService.showMenu({menu:this.model,position:{left:e.clientX,top:e.clientY}})},0))}}var We=i("R0N1"),Be=i("xSeq");class He extends class{constructor(e){this.action=e,this.hoverDelay=100}onMouseEnter(){this.enabled()&&(this.hoverTimeout=setTimeout(()=>{this.action()},this.hoverDelay))}onMouseLeave(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null)}}{constructor(e,t){super(()=>this.wacContentService.loadMruItem(this.itemInfo.item,this.itemInfo.wdOriginType,!0)),this.capabilitiesService=e,this.wacContentService=t}enabled(){return this.capabilitiesService.wacHostEnabledForFileType(this.itemInfo.item.fileType)&&this.capabilitiesService.capabilities.wacHostHoverPreloadEnabled}}i("2lMP"),i("DQbD"),i("QOOv"),i("7Rc8"),i("dOgD"),i("Z0U4"),i("EqbI"),i("OPwp"),i("55A9"),i("uNUv"),i("6u39"),i("RZcl");var qe=n.wb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeInIsNew",definitions:[{type:1,expr:"inactive => active",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"500ms 0ms linear"}],options:null}],options:{}},{type:7,name:"recommendedCardHover",definitions:[{type:0,name:"hovered",styles:{type:6,styles:{transform:"scale(1.05)"},offset:null},options:void 0},{type:1,expr:"* => hovered",animation:{type:4,styles:null,timings:"100ms linear"},options:null}],options:{}}]}});function Ve(e){return n.ac(0,[(e()(),n.yb(0,16777216,null,null,2,null,null,null,null,null,null,null)),n.xb(1,475136,null,0,r.a,[s.a,n.O,o.b,a.b,l.a,c.a,u.a,n.z,h.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),n.Qb(2,{listId:0,item:1}),(e()(),n.hb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,2,0,i.listId,i.item);e(t,1,0,"file-card#FileCardModule",n)}),null)}function $e(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["class","mru-list-item-overlay"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"div",[["class","spinner-container spinner-container--wh-100"]],null,null,null,null,null)),(e()(),n.yb(2,0,null,null,0,"div",[["class","ms-Spinner-circle ms-Spinner--large"]],null,null,null,null,null))],null,null)}function ze(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,ee,G)),n.xb(1,5226496,null,0,E,[A.a,p.a,n.h,P.a,x.b,D.a,w.a,M.a,F.a,$,z.a,q.a,j.a,V.b],{activities:[0,"activities"],activityDeepLink:[1,"activityDeepLink"],docId:[2,"docId"],index:[3,"index"],fileType:[4,"fileType"],navId:[5,"navId"],numLines:[6,"numLines"],teamsDeepLink:[7,"teamsDeepLink"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.item.lastModifiedActivity,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.item.docId,i.index,i.item.fileType,i.item.navigationId,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink)}),null)}function je(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","document-card__header"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,3,"ohp-activity-description",[],null,null,null,ee,G)),n.xb(2,5226496,null,0,E,[A.a,p.a,n.h,P.a,x.b,D.a,w.a,M.a,F.a,$,z.a,q.a,j.a,V.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],activityDeepLink:[2,"activityDeepLink"],docId:[3,"docId"],activityDescriptionInput:[4,"activityDescriptionInput"],index:[5,"index"],fileType:[6,"fileType"],navId:[7,"navId"],numLines:[8,"numLines"],teamsDeepLink:[9,"teamsDeepLink"]},null),(e()(),n.hb(16777216,null,0,1,null,ze)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.item.activities,i.item.lastViewedTime,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.item.docId,i.item.activity,i.index,i.item.fileType,i.item.navigationId,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink),e(t,4,0,i.item.lastModifiedActivity&&!i.item.activity)}),null)}function Ge(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Qe(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.context.ngIf,n.Fb(1,"",t.component.thumbnailAltText,""))}))}function Ke(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["class","video-duration"]],null,null,null,null,null)),(e()(),n.Xb(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.component.item.mediaDuration)}))}function Ze(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,8,"div",[],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,Ge)),n.xb(2,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(3,0,null,null,3,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),(e()(),n.hb(16777216,null,null,2,null,Qe)),n.xb(5,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),n.Pb(131072,f.b,[n.h]),(e()(),n.hb(16777216,null,null,1,null,Ke)),n.xb(8,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.thumbnailLoaded),e(t,5,0,n.Yb(t,5,0,n.Nb(t,6).transform(i.streamsVideoThumbnail))),e(t,8,0,i.thumbnailLoaded)}),(function(e,t){e(t,3,0,!t.component.thumbnailLoaded)}))}function Je(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,"div",[["class","opacity-overlay"]],null,null,null,null,null))],null,null)}function Xe(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onThumbnailLoad()&&n),"error"===t&&(n=!1!==r.onThumbnailError()&&n),n}),null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"document-card__thumbnail-officefeed-news":0}),n.Rb(3,1),n.Pb(131072,f.b,[n.h])],(function(e,t){var i=e(t,2,0,t.component.isNewsArticle);e(t,1,0,"document-card__thumbnail",i)}),(function(e,t){var i=t.component,r=n.Yb(t,0,0,n.Nb(t,4).transform(n.Yb(t,0,0,e(t,3,0,n.Nb(t.parent.parent.parent.parent,0),i.thumbnailUrl))));e(t,0,0,r,n.Fb(1,"",i.thumbnailAltText,""))}))}function Ye(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"img",[["class","document-card__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onThumbnailLoad()&&n),"error"===t&&(n=!1!==r.onThumbnailError()&&n),n}),null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"document-card__thumbnail-officefeed-news":0})],(function(e,t){var i=e(t,2,0,t.component.isNewsArticle);e(t,1,0,"document-card__thumbnail",i)}),(function(e,t){var i=t.component;e(t,0,0,i.thumbnailUrl,n.Fb(1,"",i.thumbnailAltText,""))}))}function et(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,9,null,null,null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,Je)),n.xb(2,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(3,0,null,null,6,"div",[["class","document-card__thumbnail-wrapper"]],[[8,"hidden",0]],null,null,null,null)),n.xb(4,278528,null,0,f.n,[n.l,n.t,n.D],{ngStyle:[0,"ngStyle"]},null),n.Qb(5,{"background-color":0}),(e()(),n.hb(16777216,null,null,1,null,Xe)),n.xb(7,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Ye)),n.xb(9,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.thumbnailLoaded);var n=e(t,5,0,i.item.thumbnails&&i.item.thumbnails.backgroundColor?i.item.thumbnails.backgroundColor:"transparent");e(t,4,0,n),e(t,7,0,i.thumbnailSWEnabled),e(t,9,0,!i.thumbnailSWEnabled)}),(function(e,t){e(t,3,0,!t.component.thumbnailLoaded)}))}function tt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["class","document-card__thumbnail-placeholder"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"div",[],null,null,null,null,null)),n.xb(2,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,2,0,t.component.item.documentIconWithSize("64x64"))}),null)}function it(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","mru-list-item__icon-in-preview"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.n,[n.l,n.t,n.D],{ngStyle:[0,"ngStyle"]},null),n.Qb(2,{color:0}),(e()(),n.yb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,d.b,d.a)),n.xb(4,638976,[[3,4],["fileIconElement",4]],0,m.a,[p.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.iconFontColor());e(t,1,0,n),e(t,4,0,i.iconFontClass(),"16")}),null)}function nt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["class","mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"mru-list-item__icon-in-preview mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function rt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,it)),n.xb(2,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,nt)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.iconFontClass()),e(t,4,0,!i.iconFontClass())}),null)}function st(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,11,"div",[["class","document-card__thumbnail-container"],["ohpViewCacheOperation","use-card-placeholder-image"]],[[1,"data-view-cache-operation",0],[1,"data-view-cache-parameters",0]],null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"document-card__thumbnail-container--recommended":0,"document-card_thumbnail-container--rounded document-card__thumbnail-container--borderless":1,"document-card__thumbnail-container--rounded-card":2}),n.xb(3,16384,null,0,te.a,[],{viewCacheOperation:[0,"viewCacheOperation"],viewCacheParameters:[1,"viewCacheParameters"]},null),(e()(),n.hb(16777216,null,null,1,null,Ze)),n.xb(5,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,et)),n.xb(7,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,tt)),n.xb(9,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,rt)),n.xb(11,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.isRecommended||i.isOfficeFeed,"borderless"===i.uiCardType,(i.isRecommended||i.isOfficeFeed)&&i.recommendedNewCards);e(t,1,0,"document-card__thumbnail-container",n),e(t,3,0,"use-card-placeholder-image",i.item.documentIconWithSize("64x64")),e(t,5,0,i.isStreamsVideo),e(t,7,0,i.thumbnailUrl&&!i.isStreamsVideo),e(t,9,0,!i.thumbnailUrl&&!i.isStreamsVideo||!i.thumbnailLoaded),e(t,11,0,!i.recommendedNewCards&&(i.thumbnailUrl||i.isStreamsVideo)&&i.thumbnailLoaded&&!i.isNewsArticle&&"borderless"!==i.uiCardType)}),(function(e,t){e(t,0,0,n.Nb(t,3).viewCacheOperation,n.Nb(t,3).viewCacheParameters)}))}function ot(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__title"]],[[8,"title",0]],null,null,null,null)),(e()(),n.Xb(1,null,[" "," "]))],null,(function(e,t){var i=t.component;e(t,0,0,i.item.title),e(t,1,0,i.item.title)}))}function at(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__location"]],[[8,"title",0]],null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"ohp-icon-font",[["cssClass","upcomingMeeting-card__location__icon"],["iconFontName","Location"],["size","16"]],null,null,null,d.b,d.a)),n.xb(2,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),n.Xb(3,null,[" "," "]))],(function(e,t){e(t,2,0,"upcomingMeeting-card__location__icon","Location","16")}),(function(e,t){var i=t.component;e(t,0,0,i.item.location),e(t,3,0,i.item.location)}))}function lt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"ohp-person-picture",[],null,null,null,me,ae)),n.xb(1,573440,null,0,ie,[oe],{person:[0,"person"],isUpcomingMeeting:[1,"isUpcomingMeeting"],status:[2,"status"]},null),n.Rb(2,1)],(function(e,t){var i=n.Yb(t,1,0,e(t,2,0,n.Nb(t.parent.parent.parent.parent,1),null==t.parent.context.$implicit?null:t.parent.context.$implicit.emailAddress));e(t,1,0,i,!0,null==t.parent.context.$implicit||null==t.parent.context.$implicit.status?null:t.parent.context.$implicit.status.response)}),null)}function ct(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,"div",[["class","upcomingMeeting-card__attendees__position"]],null,null,null,null,null)),n.xb(1,212992,null,0,pe,[n.l,$],{upn:[0,"upn"]},null),(e()(),n.hb(16777216,null,null,1,null,lt)),n.xb(3,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.context.$implicit.emailAddress.address),e(t,3,0,null==t.context.$implicit?null:t.context.$implicit.emailAddress)}),null)}function ut(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["aria-hidden","true"],["class","person-picture-upcoming-meeting__display "]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"div",[["class","person-picture-upcoming-meeting__text person-picture-upcoming-meeting__placeholder__text"]],null,null,null,null,null)),(e()(),n.Xb(2,null,[" +"," "]))],null,(function(e,t){var i=t.component;e(t,2,0,(null==i.item.attendees?null:i.item.attendees.length)-i.upcomingMeetingAttendeeDisplayMax)}))}function ht(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,12,"div",[["class","document-card__thumbnail-container upcomingMeeting-card__details"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,0,"div",[["class","upcomingMeeting-card__left_rectangle"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,ot)),n.xb(3,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(4,0,null,null,1,"div",[["class","upcomingMeeting-card__default upcomingMeeting-card__time"]],null,null,null,null,null)),(e()(),n.Xb(5,null,[" "," - "," "])),(e()(),n.hb(16777216,null,null,1,null,at)),n.xb(7,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(8,0,null,null,4,"div",[["class","upcomingMeeting-card__attendees"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,ct)),n.xb(10,278528,null,0,f.j,[n.O,n.L,n.s],{ngForOf:[0,"ngForOf"]},null),(e()(),n.hb(16777216,null,null,1,null,ut)),n.xb(12,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,3,0,i.item.title),e(t,7,0,i.item.location),e(t,10,0,null==i.item.attendees?null:i.item.attendees.slice(0,i.upcomingMeetingAttendeeDisplayMax)),e(t,12,0,i.upcomingMeetingAttendeeDisplayMax<(null==i.item.attendees?null:i.item.attendees.length))}),(function(e,t){var i=t.component;e(t,5,0,i.item.startTime,i.item.endTime)}))}function dt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,ee,G)),n.xb(1,5226496,null,0,E,[A.a,p.a,n.h,P.a,x.b,D.a,w.a,M.a,F.a,$,z.a,q.a,j.a,V.b],{activities:[0,"activities"],iconSize:[1,"iconSize"],activityDeepLink:[2,"activityDeepLink"],docId:[3,"docId"],index:[4,"index"],fileType:[5,"fileType"],navId:[6,"navId"],numLines:[7,"numLines"],teamsDeepLink:[8,"teamsDeepLink"],title:[9,"title"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.item.lastModifiedActivity,20,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.item.docId,i.index,i.item.fileType,i.item.navigationId,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink,i.recommendedNewCards&&i.item.title)}),null)}function mt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,3,"ohp-activity-description",[],null,null,null,ee,G)),n.xb(2,5226496,null,0,E,[A.a,p.a,n.h,P.a,x.b,D.a,w.a,M.a,F.a,$,z.a,q.a,j.a,V.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconSize:[2,"iconSize"],activityDeepLink:[3,"activityDeepLink"],docId:[4,"docId"],activityDescriptionInput:[5,"activityDescriptionInput"],index:[6,"index"],fileType:[7,"fileType"],numLines:[8,"numLines"],teamsDeepLink:[9,"teamsDeepLink"],title:[10,"title"]},null),(e()(),n.hb(16777216,null,0,1,null,dt)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,1,[i.item.activities,i.item.lastViewedTime,20,i.recommendedDeepLinkEnabled&&i.activityDeepLink,i.item.docId,i.item.activity,i.index,i.item.fileType,2,i.recommendedTeamsLinkEnabled&&i.teamsDeepLink,i.recommendedNewCards&&i.item.title]),e(t,4,0,i.item.lastModifiedActivity&&!i.item.activity)}),null)}function pt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","document-card__menu"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"document-card__menu--hidden":0}),(e()(),n.yb(3,0,null,null,1,"ohp-actions-menu",[["iconClass","commanding-item__icon ms-fcl-nd"]],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,i){var n=!0,r=e.component;return"menuToggled"===t&&(n=!1!==r.onActionsMenuToggle(i)&&n),"menuFocused"===t&&(n=!1!==(i?r.onFocus():r.onBlur())&&n),n}),Ie,ye)),n.xb(4,638976,[[8,4]],0,ve,[p.a,Se.b,w.a,M.a],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],area:[3,"area"],dataSecurity:[4,"dataSecurity"],leftAlignedCard:[5,"leftAlignedCard"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var i=t.component,n=e(t,2,0,!i.isTouch);e(t,1,0,"document-card__menu",n),e(t,4,0,i.contextMenu,i.index,"commanding-item__icon ms-fcl-nd",i.instrumentationArea,i.dataSecurityThreshold,i.leftAlignActionsMenu)}),null)}function ft(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,6,"div",[["class","document-card__info centered-flex-container"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"document-card__info--expanded":0}),(e()(),n.hb(16777216,null,null,1,null,mt)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,pt)),n.xb(6,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,"borderless"===i.uiCardType);e(t,1,0,"document-card__info centered-flex-container",n),e(t,4,0,i.showActivity),e(t,6,0,i.showActionsMenu)}),null)}function gt(e){return n.ac(0,[(e()(),n.yb(0,0,[[1,0],["titleElement",1]],null,4,"span",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,i){var r=!0;return"mouseenter"===t&&(r=!1!==n.Nb(e,3).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Nb(e,3).onMouseLeave()&&r),"click"===t&&(r=!1!==n.Nb(e,3).onClick()&&r),r}),null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(2,{"ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),n.xb(3,16384,null,0,Te,[p.a,w.a],{area:[0,"area"]},null),(e()(),n.Xb(4,null,["",""]))],(function(e,t){var i=t.component,n=e(t,2,0,i.clickableFolderEnabled);e(t,1,0,n),e(t,3,0,i.instrumentationArea)}),(function(e,t){var i=t.component;e(t,0,0,i.item.title),e(t,4,0,i.item.title)}))}function bt(e){return n.ac(0,[(e()(),n.yb(0,0,[[1,0],["titleElement",1]],null,4,"h4",[],[[8,"title",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,i){var r=!0;return"mouseenter"===t&&(r=!1!==n.Nb(e,3).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Nb(e,3).onMouseLeave()&&r),"click"===t&&(r=!1!==n.Nb(e,3).onClick()&&r),r}),null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(2,{"ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),n.xb(3,16384,null,0,Te,[p.a,w.a],{area:[0,"area"]},null),(e()(),n.Xb(4,null,["",""]))],(function(e,t){var i=t.component,n=e(t,2,0,i.clickableFolderEnabled);e(t,1,0,n),e(t,3,0,i.instrumentationArea)}),(function(e,t){var i=t.component;e(t,0,0,i.item.title),e(t,4,0,i.item.title)}))}function vt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,"span",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns attribution-link"],["role","link"],["tabindex","0"]],[[1,"data-href",0],[1,"aria-label",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onPathClick(i)&&n),"keyup.enter"===t&&(n=!1!==r.onPathClick(i)&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null))],null,(function(e,t){var i=t.component;e(t,0,0,n.Fb(1,"",i.item.isEmailAttachment?i.url:i.item.attributionUrl,""),i.openFolderAriaLabel,n.Fb(1,"",i.openFolderAriaLabel,""),i.shortPath)}))}function St(e){return n.ac(0,[(e()(),n.yb(0,0,[[4,0],["attributionElement",1]],null,0,"span",[],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.shortPath)}))}function yt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","list-item__text--small list-item__secondary ms-fcl-ns"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,vt)),n.xb(2,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,St)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.clickableFolderEnabled),e(t,4,0,!i.clickableFolderEnabled)}),null)}function wt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["class","list-item__text--small list-item__secondary ms-fcl-ns"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),n.Xb(2,null,["",""]))],null,(function(e,t){var i=t.component;e(t,1,0,i.item.createdBy),e(t,2,0,i.item.createdBy)}))}function Ct(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","list-item__text--small list-item__tertiary ms-fcl-nd"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"list-item--bottom":0}),(e()(),n.yb(3,0,[[1,0],["titleElement",1]],null,1,"span",[],[[8,"title",0]],null,null,null,null)),(e()(),n.Xb(4,null,["",""]))],(function(e,t){var i=t.component,n=e(t,2,0,i.isCardCreateByLabel&&i.item.createdBy||i.item.sharedByUsername);e(t,1,0,"list-item__text--small list-item__tertiary ms-fcl-nd",n)}),(function(e,t){var i=t.component;e(t,3,0,i.borderlessCardDetail1),e(t,4,0,i.borderlessCardDetail1)}))}function It(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,15,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"list-item--h-100":0}),(e()(),n.yb(3,0,null,null,6,"div",[["class","list-item__text--large list-item__title ms-fcl-nd"]],null,null,null,null,null)),n.xb(4,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(5,{"list-item__title--double-line":0}),(e()(),n.hb(16777216,null,null,1,null,gt)),n.xb(7,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,bt)),n.xb(9,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,yt)),n.xb(11,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,wt)),n.xb(13,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Ct)),n.xb(15,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,"borderless"===i.uiCardType);e(t,1,0,"list-item__flex-grow",n);var r=e(t,5,0,"borderless"===i.uiCardType);e(t,4,0,"list-item__text--large list-item__title ms-fcl-nd",r),e(t,7,0,"borderless"!==i.uiCardType),e(t,9,0,"borderless"===i.uiCardType),e(t,11,0,!!i.shortPath&&!i.isAntpExperience&&"borderless"!==i.uiCardType),e(t,13,0,i.isCardCreateByLabel&&(null==i.item?null:i.item.createdBy)),e(t,15,0,i.isFormResponsesEnabled)}),null)}function Tt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,7,"div",[["class","list-item__flex-grow"]],null,[[null,"click"],[null,"keyup.enter"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onPathClick(i)&&n),"keyup.enter"===t&&(n=!1!==r.onPathClick(i)&&n),n}),null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"list-item--h-100":0}),(e()(),n.yb(3,0,null,null,4,"div",[["class","upcomingMeeting-card__join_text"]],null,null,null,null,null)),(e()(),n.yb(4,0,null,null,1,"ohp-icon-font",[["cssClass","upcomingMeeting-card_logo"],["iconFontName","Teams"],["size","16"]],null,null,null,d.b,d.a)),n.xb(5,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),n.yb(6,0,null,null,1,"span",[["role","link"],["tabindex","0"]],[[1,"data-href",0],[1,"aria-label",0],[8,"title",0]],[[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null)),(e()(),n.Xb(7,null,[""," "]))],(function(e,t){var i=e(t,2,0,"borderless"===t.component.uiCardType);e(t,1,0,"list-item__flex-grow",i),e(t,5,0,"upcomingMeeting-card_logo","Teams","16")}),(function(e,t){var i=t.component;e(t,6,0,null==i.item?null:i.item.joinUrl,null==i.item?null:i.item.joinMeetingText,null==i.item?null:i.item.joinMeetingText),e(t,7,0,i.item.joinMeetingText)}))}function kt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","document-card__menu"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"document-card__menu--hidden":0}),(e()(),n.yb(3,0,null,null,1,"ohp-actions-menu",[["iconClass","commanding-item__icon ms-fcl-nd"]],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,i){var n=!0,r=e.component;return"menuToggled"===t&&(n=!1!==r.onActionsMenuToggle(i)&&n),"menuFocused"===t&&(n=!1!==(i?r.onFocus():r.onBlur())&&n),n}),Ie,ye)),n.xb(4,638976,[[8,4]],0,ve,[p.a,Se.b,w.a,M.a],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],area:[3,"area"],dataSecurity:[4,"dataSecurity"],leftAlignedCard:[5,"leftAlignedCard"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var i=t.component,n=e(t,2,0,!i.isTouch);e(t,1,0,"document-card__menu",n),e(t,4,0,i.contextMenu,i.index,"commanding-item__icon ms-fcl-nd",i.instrumentationArea,i.dataSecurityThreshold,i.leftAlignActionsMenu)}),null)}function Et(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,8,"div",[["class","document-card__info centered-flex-container"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"document-card__info--expanded":0}),(e()(),n.hb(16777216,null,null,1,null,It)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Tt)),n.xb(6,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,kt)),n.xb(8,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,"borderless"===i.uiCardType);e(t,1,0,"document-card__info centered-flex-container",n),e(t,4,0,!i.isUpcomingMeeting),e(t,6,0,i.isUpcomingMeeting),e(t,8,0,i.showActionsMenu)}),null)}function At(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,12,"div",[["class","document-card ms-bgc-w"]],[[24,"@recommendedCardHover",0]],[[null,"mouseover"],[null,"mouseleave"]],(function(e,t,i){var n=!0,r=e.component;return"mouseover"===t&&(n=!1!==r.recommendedHover("hovered")&&n),"mouseleave"===t&&(n=!1!==r.recommendedHover("unhovered")&&n),n}),null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"carousel-card":0,"document-card--no-padding":1,"document-card--motion":2}),(e()(),n.hb(16777216,null,null,1,null,je)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,st)),n.xb(6,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,ht)),n.xb(8,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,ft)),n.xb(10,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Et)),n.xb(12,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.isRecommended||i.isOfficeFeed,"borderless"===i.uiCardType,i.recommendedNewCards);e(t,1,0,"document-card ms-bgc-w",n),e(t,4,0,i.showActivity&&!i.recommendedNewCards),e(t,6,0,!i.isUpcomingMeeting),e(t,8,0,i.isUpcomingMeeting),e(t,10,0,i.recommendedNewCards),e(t,12,0,!i.recommendedNewCards)}),(function(e,t){e(t,0,0,t.component.isHovered)}))}function Pt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,5,"img",[["class","generic-tile__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onThumbnailLoad()&&n),"error"===t&&(n=!1!==r.onThumbnailError()&&n),n}),null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.xb(2,278528,null,0,f.n,[n.l,n.t,n.D],{ngStyle:[0,"ngStyle"]},null),n.Qb(3,{"background-color":0}),n.Rb(4,1),n.Pb(131072,f.b,[n.h])],(function(e,t){var i=t.component;e(t,1,0,"generic-tile__thumbnail","generic-tile__thumbnail--"+i.item.fileTypeName.toLowerCase());var n=e(t,3,0,i.item.thumbnails&&i.item.thumbnails.backgroundColor?i.item.thumbnails.backgroundColor:"transparent");e(t,2,0,n)}),(function(e,t){var i=t.component,r=n.Yb(t,0,0,n.Nb(t,5).transform(n.Yb(t,0,0,e(t,4,0,n.Nb(t.parent.parent.parent,0),i.thumbnailUrl))));e(t,0,0,r,n.Fb(1,"",i.thumbnailAltText,""))}))}function xt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,"img",[["class","generic-tile__thumbnail"]],[[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onThumbnailLoad()&&n),"error"===t&&(n=!1!==r.onThumbnailError()&&n),n}),null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.xb(2,278528,null,0,f.n,[n.l,n.t,n.D],{ngStyle:[0,"ngStyle"]},null),n.Qb(3,{"background-color":0})],(function(e,t){var i=t.component;e(t,1,0,"generic-tile__thumbnail","generic-tile__thumbnail--"+i.item.fileTypeName.toLowerCase());var n=e(t,3,0,i.item.thumbnails&&i.item.thumbnails.backgroundColor?i.item.thumbnails.backgroundColor:"transparent");e(t,2,0,n)}),(function(e,t){var i=t.component;e(t,0,0,i.thumbnailUrl,n.Fb(1,"",i.thumbnailAltText,""))}))}function Dt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","document-tile__icon"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.n,[n.l,n.t,n.D],{ngStyle:[0,"ngStyle"]},null),n.Qb(2,{color:0}),(e()(),n.yb(3,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,d.b,d.a)),n.xb(4,638976,null,0,m.a,[p.a],{iconFontCssClass:[0,"iconFontCssClass"],size:[1,"size"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.iconFontColor());e(t,1,0,n),e(t,4,0,i.iconFontClass(),"16")}),null)}function Mt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["class","document-tile__icon mru-list-item__document-icon-in-preview"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(e,t){e(t,1,0,"document-tile__icon mru-list-item__document-icon-in-preview",t.component.item.documentIconWithSize("20x20"))}),null)}function Ft(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,10,"div",[],[[8,"hidden",0]],null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(2,{"generic-tile__images":0}),(e()(),n.hb(16777216,null,null,1,null,Pt)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,xt)),n.xb(6,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Dt)),n.xb(8,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Mt)),n.xb(10,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.thumbnailLoaded);e(t,1,0,n),e(t,4,0,i.thumbnailSWEnabled),e(t,6,0,!i.thumbnailSWEnabled),e(t,8,0,i.iconFontClass()),e(t,10,0,!i.iconFontClass())}),(function(e,t){e(t,0,0,!t.component.thumbnailLoaded)}))}function Lt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,"div",[["class","generic-tile__fallback-image-container document-tile__fallback-image-container"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,2,"div",[["class","document-tile__fallback-image"]],null,null,null,null,null)),(e()(),n.yb(2,0,null,null,1,"div",[],null,null,null,null,null)),n.xb(3,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null)],(function(e,t){e(t,3,0,t.component.item.documentIconWithSize("64x64"))}),null)}function Ot(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon is-new-icon--tile ms-fcl-tda"],["iconFontName","Glimmer"],["size","12"]],[[1,"aria-label",0]],null,null,d.b,d.a)),n.xb(1,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,1,0,"is-new-icon is-new-icon--tile ms-fcl-tda","Glimmer","12",t.component.isNewTitle)}),(function(e,t){e(t,0,0,t.component.isNewTitle)}))}function Rt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-icon-font",[["cssClass","document-tile__sharing document-tile__description__icon ms-fcl-np"],["iconFontName","People2"],["size","12"]],[[1,"aria-label",0]],null,null,d.b,d.a)),n.xb(1,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"document-tile__sharing document-tile__description__icon ms-fcl-np","People2","12")}),(function(e,t){e(t,0,0,t.component.sharedText)}))}function _t(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,"span",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns attribution-link document-tile__attribution"],["role","link"],["tabindex","0"]],[[1,"aria-label",0],[1,"data-href",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onPathClick(i)&&n),"keyup.enter"===t&&(n=!1!==r.onPathClick(i)&&n),n}),null,null))],null,(function(e,t){var i=t.component;e(t,0,0,i.openFolderAriaLabel,n.Fb(1,"",i.item.isEmailAttachment?i.url:i.item.attributionUrl,""),n.Fb(1,"",i.openFolderAriaLabel,""),i.shortPath)}))}function Ut(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,"span",[["class","document-tile__attribution list-item__text--small ms-fcl-ns"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.shortPath)}))}function Nt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,6,"div",[["class","document-tile__description"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,Rt)),n.xb(2,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,_t)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Ut)),n.xb(6,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.showSharing&&(null==i.item.sharing?null:i.item.sharing.shared)),e(t,4,0,i.clickableFolderEnabled&&!!i.shortPath),e(t,6,0,!i.clickableFolderEnabled&&!!i.shortPath)}),null)}function Wt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,21,"div",[["class","generic-tile"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,4,"div",[["class","generic-tile__images_container"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,Ft)),n.xb(3,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Lt)),n.xb(5,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(6,0,null,null,9,"div",[["class","document-tile__title-and-icons"]],null,null,null,null,null)),(e()(),n.yb(7,0,null,null,2,"span",[],[[24,"@fadeInIsNew",0]],null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,Ot)),n.xb(9,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(10,0,null,null,5,"div",[["class","document-tile__title list-item__text--medium ms-fcl-np"]],null,null,null,null,null)),(e()(),n.yb(11,0,[[1,0],["titleElement",1]],null,4,"span",[],null,[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,i){var r=!0;return"mouseenter"===t&&(r=!1!==n.Nb(e,14).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Nb(e,14).onMouseLeave()&&r),"click"===t&&(r=!1!==n.Nb(e,14).onClick()&&r),r}),null,null)),n.xb(12,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(13,{"ms-fcl-tda-h mru-list-item__title--hover":0}),n.xb(14,16384,null,0,Te,[p.a,w.a],{area:[0,"area"]},null),(e()(),n.Xb(15,null,["",""])),(e()(),n.yb(16,0,null,null,5,"div",[["class","document-tile__description-wrapper"]],null,null,null,null,null)),(e()(),n.yb(17,0,null,null,4,"div",[["class","document-tile__description-container"]],null,null,null,null,null)),(e()(),n.yb(18,0,null,null,3,"ohp-activity-description",[["iconCssClass","document-tile__description__icon"],["iconSize","12"]],null,null,null,ee,G)),n.xb(19,5226496,null,0,E,[A.a,p.a,n.h,P.a,x.b,D.a,w.a,M.a,F.a,$,z.a,q.a,j.a,V.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconCssClass:[2,"iconCssClass"],iconSize:[3,"iconSize"],activityDescriptionInput:[4,"activityDescriptionInput"],numLines:[5,"numLines"]},null),(e()(),n.hb(16777216,null,0,1,null,Nt)),n.xb(21,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,3,0,i.thumbnailUrl),e(t,5,0,!i.thumbnailUrl||!i.thumbnailLoaded),e(t,9,0,i.isNew);var r=e(t,13,0,i.clickableFolderEnabled);e(t,12,0,r),e(t,14,0,i.instrumentationArea),e(t,19,0,i.showOnlyMruActivity?n.ab:i.item.activities,i.item.lastViewedTime,"document-tile__description__icon","12",i.mruActivity&&i.item.activity,1),e(t,21,0,i.showSharing&&(null==i.item.sharing?null:i.item.sharing.shared)||!!i.shortPath)}),(function(e,t){var i=t.component;e(t,7,0,i.isNewAnimationState),e(t,15,0,i.item.title)}))}function Bt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-icon-font",[["cssClass","is-new-icon ms-fcl-tda"],["iconFontName","Glimmer"],["size","12"]],[[1,"aria-label",0]],null,null,d.b,d.a)),n.xb(1,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){e(t,1,0,"is-new-icon ms-fcl-tda","Glimmer","12",t.component.isNewTitle)}),(function(e,t){e(t,0,0,t.component.isNewTitle)}))}function Ht(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-icon-font",[["iconFontName","People2"],["size","14"]],[[1,"aria-label",0]],null,null,d.b,d.a)),n.xb(1,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],title:[3,"title"]},null)],(function(e,t){var i=t.component;e(t,1,0,"ms-fcl-np document-column--name__share-icon"+(i.showMobileShareAndActivity?" document-column--name__share-icon--mobile":""),"People2","14",i.sharedText)}),(function(e,t){e(t,0,0,t.component.sharedText)}))}function qt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,null,null,null,null,null,null,null))],null,null)}function Vt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,"ohp-activity-description",[],null,null,null,ee,G)),n.xb(1,5226496,null,0,E,[A.a,p.a,n.h,P.a,x.b,D.a,w.a,M.a,F.a,$,z.a,q.a,j.a,V.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],iconSize:[2,"iconSize"],activityDescriptionInput:[3,"activityDescriptionInput"],numLines:[4,"numLines"],mobileListItem:[5,"mobileListItem"]},null),(e()(),n.hb(16777216,null,0,1,null,qt)),n.xb(3,540672,null,0,f.o,[n.O],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.showOnlyMruActivity?n.ab:i.item.activities,i.item.lastViewedTime,12,i.mruActivity&&i.item.activity,1,!0),e(t,3,0,n.Nb(t.parent,21))}),null)}function $t(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,"span",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns attribution-link"],["role","link"],["tabindex","0"]],[[1,"aria-label",0],[1,"data-href",0],[8,"title",0],[8,"innerHTML",1]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onPathClick(i)&&n),"keyup.enter"===t&&(n=!1!==r.onPathClick(i)&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null))],null,(function(e,t){var i=t.component;e(t,0,0,i.openFolderAriaLabel,n.Fb(1,"",i.item.isEmailAttachment?i.url:i.item.attributionUrl,""),n.Fb(1,"",i.openFolderAriaLabel,""),i.item.attribution)}))}function zt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),n.Xb(1,null,[" "," "]))],null,(function(e,t){var i=t.component;e(t,1,0,null==i.item.emailReference?null:i.item.emailReference.Subject)}))}function jt(e){return n.ac(0,[(e()(),n.yb(0,0,[[4,0],["attributionElement",1]],null,0,"span",[],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){e(t,0,0,t.component.item.attribution)}))}function Gt(e){return n.ac(0,[(e()(),n.hb(16777216,null,null,1,null,$t)),n.xb(1,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,zt)),n.xb(3,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,jt)),n.xb(5,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(0,null,null,0))],(function(e,t){var i=t.component;e(t,1,0,i.clickableFolderEnabled&&!i.item.isEmailAttachment&&i.item.attribution),e(t,3,0,i.item.isEmailAttachment),e(t,5,0,!i.clickableFolderEnabled&&i.item.attribution)}),null)}function Qt(e){return n.ac(0,[(e()(),n.yb(0,0,[[7,0],["shareTopLevel",1]],null,5,"span",[["aria-haspopup","true"],["class","commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onShareClick(i,"topLevel",r.ShareControlMode.Share)&&n),"keyup.enter"===t&&(n=!1!==r.onShareClick(i,"topLevel",r.ShareControlMode.Share)&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"commanding-item--responsive":0,"commanding-item--disabled":1,"column--commanding-mobile":2}),n.xb(3,4210688,null,0,ke.a,[n.l,n.D,Ee.a],null,null),(e()(),n.yb(4,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","Share2"],["size","16"]],null,null,null,d.b,d.a)),n.xb(5,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!i.showMobileShareAndActivity,i.item.isLocal,i.showMobileShareAndActivity);e(t,1,0,"commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a",n),e(t,5,0,"commanding-item__icon ms-fcl-nd","Share2","16",!0)}),(function(e,t){var i=t.component;e(t,0,0,i.shareActionTitle,i.shareActionTitle)}))}function Kt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,"span",[["aria-haspopup","true"],["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.uploadLocal(i)&&n),"keyup.enter"===t&&(n=!1!==r.uploadLocal(i)&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null)),n.xb(1,4210688,null,0,ke.a,[n.l,n.D,Ee.a],null,null),(e()(),n.yb(2,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","Upload"],["size","16"]],null,null,null,d.b,d.a)),n.xb(3,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){e(t,3,0,"commanding-item__icon ms-fcl-nd","Upload","16",!0)}),(function(e,t){var i=t.component;e(t,0,0,i.uploadLocalFileTitle,i.uploadLocalFileTitle)}))}function Zt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,5,"span",[["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.pinItem(i,"topLevel")&&n),"keyup.enter"===t&&(n=!1!==r.pinItem(i,"topLevel")&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"commanding-item--disabled":0}),n.xb(3,4210688,null,0,ke.a,[n.l,n.D,Ee.a],null,null),(e()(),n.yb(4,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","PinDown"],["size","16"]],null,null,null,d.b,d.a)),n.xb(5,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var i=e(t,2,0,t.component.item.isLocal);e(t,1,0,"commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a",i),e(t,5,0,"commanding-item__icon ms-fcl-nd","PinDown","16",!0)}),(function(e,t){var i=t.component;e(t,0,0,i.pinActionTitle,i.pinActionTitle)}))}function Jt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,"span",[["class","commanding-item--responsive commanding-item ms-bgc-g40-h ms-bgc-g40-f ms-bgc-g40-a"],["keyboardFocusTooltip",""],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.unpinItem(i,"topLevel")&&n),"keyup.enter"===t&&(n=!1!==r.unpinItem(i,"topLevel")&&n),"focus"===t&&(n=!1!==r.onFocus()&&n),"blur"===t&&(n=!1!==r.onBlur()&&n),n}),null,null)),n.xb(1,4210688,null,0,ke.a,[n.l,n.D,Ee.a],null,null),(e()(),n.yb(2,0,null,null,1,"ohp-icon-font",[["cssClass","commanding-item__icon ms-fcl-nd"],["iconFontName","Unpin"],["size","16"]],null,null,null,d.b,d.a)),n.xb(3,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){e(t,3,0,"commanding-item__icon ms-fcl-nd","Unpin","16",!0)}),(function(e,t){var i=t.component;e(t,0,0,i.unpinActionTitle,i.unpinActionTitle)}))}function Xt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,12,"div",[["class","list-item-column column--commanding"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"column--commanding--hidden":0}),(e()(),n.hb(16777216,null,null,1,null,Qt)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Kt)),n.xb(6,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Zt)),n.xb(8,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Jt)),n.xb(10,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(11,0,null,null,1,"ohp-actions-menu",[["iconClass","commanding-item__icon"]],null,[[null,"menuToggled"],[null,"menuFocused"]],(function(e,t,i){var n=!0,r=e.component;return"menuToggled"===t&&(n=!1!==r.onActionsMenuToggle(i)&&n),"menuFocused"===t&&(n=!1!==(i?r.onFocus():r.onBlur())&&n),n}),Ie,ye)),n.xb(12,638976,[[8,4]],0,ve,[p.a,Se.b,w.a,M.a],{menuModel:[0,"menuModel"],listItemIndex:[1,"listItemIndex"],iconClass:[2,"iconClass"],dataSecurity:[3,"dataSecurity"]},{menuToggled:"menuToggled",menuFocused:"menuFocused"})],(function(e,t){var i=t.component,n=e(t,2,0,!i.isTouch);e(t,1,0,"list-item-column column--commanding",n),e(t,4,0,i.shareControlEnabled),e(t,6,0,i.item.isLocal),e(t,8,0,!i.item.isPinned&&i.mruPinEnabled),e(t,10,0,i.item.isPinned&&i.mruPinEnabled),e(t,12,0,i.contextMenu,i.index,"commanding-item__icon",i.dataSecurityThreshold)}),null)}function Yt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,"div",[["class","list-item-column column--commanding"]],null,null,null,null,null))],null,null)}function ei(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","list-item-column document-column--responses-forms"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,3,"div",[["class","list-item__text--small ms-fcl-ns"]],null,null,null,null,null)),n.xb(2,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(3,{"list-item__last-accessed":0}),(e()(),n.Xb(4,null,[" "," "]))],(function(e,t){var i=e(t,3,0,t.component.showActionsMenu);e(t,2,0,"list-item__text--small ms-fcl-ns",i)}),(function(e,t){e(t,4,0,t.component.borderlessCardDetail1)}))}function ti(e){return n.ac(0,[(e()(),n.yb(0,0,[[5,0],["timestampElement",1]],null,4,"div",[["class","list-item__text--small ms-fcl-ns"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"list-item__last-accessed":0}),(e()(),n.Xb(3,null,[" "," "])),n.Rb(4,4)],(function(e,t){var i=e(t,2,0,t.component.showActionsMenu);e(t,1,0,"list-item__text--small ms-fcl-ns",i)}),(function(e,t){var i=t.component,r=n.Yb(t,3,0,e(t,4,0,n.Nb(t.parent.parent,2),i.displayTime,i.shortDate,i.displayTimeString,!1));e(t,3,0,r)}))}function ii(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["class","activity-user-name sharing-column-name ms-fcl-nd"]],[[8,"title",0]],null,null,null,null)),n.xb(1,212992,null,0,pe,[n.l,$],{upn:[0,"upn"]},null),(e()(),n.Xb(2,null,[" "," "]))],(function(e,t){e(t,1,0,t.component.item.sharedByEmail)}),(function(e,t){var i=t.component;e(t,0,0,n.Fb(1,"",i.item.sharedByUsername,"")),e(t,2,0,i.item.sharedByUsername)}))}function ni(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-icon-font",[["aria-hidden","true"],["cssClass","document-column--sharing__share-icon ms-fcl-np"],["iconFontName","People2"],["size","14"]],null,null,null,d.b,d.a)),n.xb(1,638976,null,0,m.a,[p.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"document-column--sharing__share-icon ms-fcl-np","People2","14")}),null)}function ri(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,6,null,null,null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,ni)),n.xb(2,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(3,0,null,null,3,"div",[["class","list-item__text--small sharing-column--text ms-fcl-ns"]],[[8,"title",0]],null,null,null,null)),n.xb(4,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(5,{"sharing-column--text-shared":0}),(e()(),n.Xb(6,null,[" "," "]))],(function(e,t){var i=t.component;e(t,2,0,null==i.item.sharing?null:i.item.sharing.shared);var n=e(t,5,0,null==i.item.sharing?null:i.item.sharing.shared);e(t,4,0,"list-item__text--small sharing-column--text ms-fcl-ns",n)}),(function(e,t){var i=t.component;e(t,3,0,n.Fb(1,"",i.item.sharing?i.item.sharing.shared?i.sharedText:i.privateText:"","")),e(t,6,0,i.item.sharing?i.item.sharing.shared?i.sharedText:i.privateText:"")}))}function si(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,6,"div",[["class","list-item-column"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"document-column--sharing":0,"document-column--sharing--right":1}),(e()(),n.hb(16777216,null,null,1,null,ii)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,ri)),n.xb(6,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.showActivity,!i.showActivity);e(t,1,0,"list-item-column",n),e(t,4,0,"shared-mru"===i.listId),e(t,6,0,"shared-mru"!==i.listId)}),null)}function oi(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-activity-description",[],null,null,null,ee,G)),n.xb(1,5226496,null,0,E,[A.a,p.a,n.h,P.a,x.b,D.a,w.a,M.a,F.a,$,z.a,q.a,j.a,V.b],{activities:[0,"activities"],lastViewedTime:[1,"lastViewedTime"],activityDescriptionInput:[2,"activityDescriptionInput"],numLines:[3,"numLines"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.showOnlyMruActivity?n.ab:i.item.activities,i.item.lastViewedTime,i.mruActivity&&i.item.activity,i.mruActivity&&i.item.activity?2:void 0)}),null)}function ai(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","list-item-column document-column--activity"]],null,null,null,null,null)),n.xb(1,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"document-column--activity-hidden":0}),(e()(),n.hb(16777216,null,null,1,null,oi)),n.xb(4,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.showMobileShareAndActivity);e(t,1,0,"list-item-column document-column--activity",n),e(t,4,0,i.activityEnabled)}),null)}function li(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["class","list-item-column document-column--analytics document-analytics-container"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"ohp-analytics-description",[],null,[[null,"updateAriaLabel"]],(function(e,t,i){var n=!0;return"updateAriaLabel"===t&&(n=!1!==e.component.onAnalyticsDescriptionChanged(i)&&n),n}),De,Pe)),n.xb(2,573440,null,0,Ae,[M.a],{analytics:[0,"analytics"]},{updateAriaLabel:"updateAriaLabel"})],(function(e,t){e(t,2,0,t.component.item.analytics)}),null)}function ci(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,38,"div",[["class","centered-flex-container list-item__height-restrictor"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,20,"div",[["class","list-item-column"]],null,null,null,null,null)),n.xb(2,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Ob(3,3),(e()(),n.yb(4,0,[[3,0],["fileIconElement",1]],null,0,"div",[],[[8,"className",0],[1,"title",0]],null,null,null,null)),(e()(),n.yb(5,0,null,null,16,"div",[["class","clip"]],null,null,null,null,null)),(e()(),n.yb(6,0,null,null,11,"div",[["class","centered-flex-container"]],null,null,null,null,null)),(e()(),n.yb(7,0,null,null,5,"div",[["class","list-item__text--large list-item__title ms-fcl-nd"]],null,null,null,null,null)),(e()(),n.yb(8,0,[[1,0],["titleElement",1]],null,4,"span",[],null,[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(e,t,i){var r=!0;return"mouseenter"===t&&(r=!1!==n.Nb(e,11).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Nb(e,11).onMouseLeave()&&r),"click"===t&&(r=!1!==n.Nb(e,11).onClick()&&r),r}),null,null)),n.xb(9,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(10,{"ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a mru-list-item__title--themed":0}),n.xb(11,16384,null,0,Te,[p.a,w.a],{area:[0,"area"]},null),(e()(),n.Xb(12,null,["",""])),(e()(),n.yb(13,0,null,null,2,"span",[],[[24,"@fadeInIsNew",0]],null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,Bt)),n.xb(15,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Ht)),n.xb(17,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(18,0,null,null,3,"div",[["class","list-item__text--small list-item__secondary ms-fcl-ns"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,Vt)),n.xb(20,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(e()(),n.hb(0,[["showPath",2]],null,0,null,Gt)),(e()(),n.hb(16777216,null,null,1,null,Xt)),n.xb(23,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Yt)),n.xb(25,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,ei)),n.xb(27,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(28,0,null,null,4,"div",[["class","list-item-column"]],null,null,null,null,null)),n.xb(29,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(30,{"document-column--last-opened":0,"document-column--last-opened--right":1,"document-column--last-opened--subset":2}),(e()(),n.hb(16777216,null,null,1,null,ti)),n.xb(32,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,si)),n.xb(34,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,ai)),n.xb(36,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,li)),n.xb(38,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,r=e(t,3,0,"document-column--name"+(i.showActivity||i.showAnalytics?"":"--subset"),i.mruAppSuffix?"document-column--name"+i.mruAppSuffix:"",i.showMobileShareAndActivity?"document-column--name-mobile":"");e(t,2,0,"list-item-column",r);var s=e(t,10,0,i.clickableFolderEnabled);e(t,9,0,s),e(t,11,0,i.instrumentationArea),e(t,15,0,i.isNew),e(t,17,0,i.showSharing&&(null==i.item.sharing?null:i.item.sharing.shared)),e(t,20,0,i.showMobileShareAndActivity,n.Nb(t,21)),e(t,23,0,i.showActionsMenu),e(t,25,0,!i.showActionsMenu),e(t,27,0,i.isFormResponsesEnabled);var o=e(t,30,0,i.showActivity||i.showAnalytics,!i.showSharing&&!i.showActivity&&!i.showAnalytics,i.showSharing&&!i.showActivity&&!i.showAnalytics);e(t,29,0,"list-item-column",o),e(t,32,0,i.displayTime),e(t,34,0,i.showSharing),e(t,36,0,i.showActivity),e(t,38,0,i.showAnalytics)}),(function(e,t){var i=t.component;e(t,4,0,n.Fb(1,"list-item__icon ",i.item.documentIcon,""),i.item.fileTypeName),e(t,12,0,i.item.title),e(t,13,0,i.isNewAnimationState)}))}function ui(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,6,null,null,null,null,null,null,null)),(e()(),n.yb(1,0,[[6,0],["shareControl",1]],null,5,"div",[["class","share-control"]],null,null,null,null,null)),n.xb(2,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(3,{"mru-list-item__share-control mru-list-item__share-control--columns":0}),(e()(),n.yb(4,16777216,null,null,2,null,null,null,null,null,null,null)),n.xb(5,475136,null,0,r.a,[s.a,n.O,o.b,a.b,l.a,c.a,u.a,n.z,h.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"],outputs:[2,"outputs"]},null),n.Qb(6,{file:0,index:1,mode:2})],(function(e,t){var i=t.component,n=e(t,3,0,i.showAsListItem());e(t,2,0,"share-control",n);var r=e(t,6,0,i.item,i.index,i.shareControlMode);e(t,5,0,"share-control#ShareControlModule",r,i.shareControlOutputs)}),null)}function hi(e){return n.ac(0,[n.Pb(0,Fe,[re.a,x.b,Le.a,Oe.a]),n.Pb(0,Re,[]),n.Pb(0,z.a,[_e.a,M.a,Ue.a]),n.Tb(671088640,1,{titleElement:0}),n.Tb(671088640,2,{mruListItem:0}),n.Tb(671088640,3,{fileIconElement:0}),n.Tb(671088640,4,{attributionElement:0}),n.Tb(671088640,5,{timestampElement:0}),n.Tb(671088640,6,{shareControl:0}),n.Tb(671088640,7,{shareTopLevelElement:0}),n.Tb(671088640,8,{actionsMenuElement:0}),(e()(),n.hb(16777216,null,null,1,null,Ve)),n.xb(12,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(13,0,null,null,18,"div",[["class","list-item__body mru-item__body"]],[[8,"id",0]],[[null,"contextmenu"]],(function(e,t,i){var r=!0;return"contextmenu"===t&&(r=!1!==n.Nb(e,14).onContextMenu(i)&&r),r}),null,null)),n.xb(14,81920,null,0,Ne,[be.a,Se.b],{model:[0,"model"],disabled:[1,"disabled"]},null),(e()(),n.hb(16777216,null,null,1,null,$e)),n.xb(16,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(17,0,[[2,0],["mruListItem",1]],null,12,"a",[["class","mru-list-item"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"id",0],[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"click"],[null,"focus"],[null,"blur"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,i){var r=!0,s=e.component;return"mouseenter"===t&&(r=!1!==n.Nb(e,22).onMouseEnter()&&r),"mouseleave"===t&&(r=!1!==n.Nb(e,22).onMouseLeave()&&r),"click"===t&&(r=!1!==s.onItemClick(i)&&r),"focus"===t&&(r=!1!==s.onFocus()&&r),"blur"===t&&(r=!1!==s.onBlur()&&r),r}),null,null)),n.xb(18,278528,null,0,f.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(19,{"list-item__focused":0,"mru-list-item__padding":1,"mru-list-item__padding--mobile":2,"mru-list-item--local":3}),n.xb(20,81920,null,0,We.a,[N.a],null,null),n.xb(21,4210688,null,0,Be.a,[n.l,n.h],{focusOnLoad:[0,"focusOnLoad"]},null),n.xb(22,16384,null,0,He,[p.a,j.a],{hoverDelay:[0,"hoverDelay"],itemInfo:[1,"itemInfo"]},null),n.Qb(23,{item:0,wdOriginType:1}),(e()(),n.hb(16777216,null,null,1,null,At)),n.xb(25,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Wt)),n.xb(27,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,ci)),n.xb(29,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,ui)),n.xb(31,16384,null,0,f.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,12,0,i.isFileCardEnabled),e(t,14,0,i.contextMenu,i.actionsMenuOpen),e(t,16,0,i.mruItemState===i.MRU_ITEM_LOADING_STATE);var n=e(t,19,0,i.itemFocused||i.actionsMenuOpen,i.showAsListItem(),i.showAsListItem()&&i.showMobileShareAndActivity,i.item.isLocal);e(t,18,0,"mru-list-item",n),e(t,20,0),e(t,21,0,i.focusOnLoad);var r=i.showAsCard()?200:150,s=e(t,23,0,i.item,i.getWdOriginTaskForClick());e(t,22,0,r,s),e(t,25,0,i.showAsCard()),e(t,27,0,i.showAsTile()),e(t,29,0,i.showAsListItem()),e(t,31,0,i.showDesktopShareControl)}),(function(e,t){var i=t.component;e(t,13,0,"body-"+i.listId+"-"+i.item.id),e(t,17,0,i.listId+"-"+i.item.id,n.Fb(1,"",i.url,""),i.descriptiveAriaLabel,n.Nb(t,20).target)}))}},"A/um":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e[e.Accepted=1]="Accepted",e[e.Add=2]="Add",e[e.AddTo=3]="AddTo",e[e.Alert=4]="Alert",e[e.ArrowLeft=5]="ArrowLeft",e[e.ArrowRight=6]="ArrowRight",e[e.At=7]="At",e[e.Calendar=8]="Calendar",e[e.Chat=9]="Chat",e[e.CheckMark=10]="CheckMark",e[e.ChevronDown=11]="ChevronDown",e[e.ChevronLeft=12]="ChevronLeft",e[e.ChevronRight=13]="ChevronRight",e[e.ChevronUp=14]="ChevronUp",e[e.CircleEmpty=15]="CircleEmpty",e[e.CircleInfo=16]="CircleInfo",e[e.Comment=17]="Comment",e[e.Compass=18]="Compass",e[e.Copy=19]="Copy",e[e.Declined=20]="Declined",e[e.Delete=21]="Delete",e[e.Diamond=22]="Diamond",e[e.Document=23]="Document",e[e.Download=24]="Download",e[e.Ellipsis=25]="Ellipsis",e[e.Excel=26]="Excel",e[e.Filter=27]="Filter",e[e.FilterSolid=28]="FilterSolid",e[e.Folder=29]="Folder",e[e.FolderOpen=30]="FolderOpen",e[e.Group=31]="Group",e[e.Link=32]="Link",e[e.ListBullets=33]="ListBullets",e[e.Location=34]="Location",e[e.Mail=35]="Mail",e[e.Minus=36]="Minus",e[e.Move=37]="Move",e[e.News=38]="News",e[e.OfficeForms=39]="OfficeForms",e[e.OfficeStore=40]="OfficeStore",e[e.OfficeThreshold=41]="OfficeThreshold",e[e.OneDrive=42]="OneDrive",e[e.Onenote2=43]="Onenote2",e[e.Outlook=44]="Outlook",e[e.Page=45]="Page",e[e.Pencil=46]="Pencil",e[e.PencilSolid=47]="PencilSolid",e[e.People2=48]="People2",e[e.Person=49]="Person",e[e.PhotoVideoMedia=50]="PhotoVideoMedia",e[e.PinDown=51]="PinDown",e[e.Placeholder=52]="Placeholder",e[e.PowerPoint=53]="PowerPoint",e[e.Preview=54]="Preview",e[e.PreviewLink=55]="PreviewLink",e[e.Question=56]="Question",e[e.Restore=57]="Restore",e[e.RedEye=58]="RedEye",e[e.Save=59]="Save",e[e.Search=60]="Search",e[e.Share2=61]="Share2",e[e.SkypeForBusiness=62]="SkypeForBusiness",e[e.SortDown=63]="SortDown",e[e.SortUp=64]="SortUp",e[e.Sway=65]="Sway",e[e.Sync=66]="Sync",e[e.Teams=67]="Teams",e[e.TentativelyAccepted=68]="TentativelyAccepted",e[e.TextDocument=69]="TextDocument",e[e.TileView=70]="TileView",e[e.ToDo=71]="ToDo",e[e.Trending=72]="Trending",e[e.Unpin=73]="Unpin",e[e.Video=74]="Video",e[e.Upload=75]="Upload",e[e.Waffle=76]="Waffle",e[e.Word=77]="Word",e[e.X=78]="X",e[e.X2=79]="X2",e}({})},ALB0:function(e,t,i){},AXM8:function(e,t,i){},AXqk:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},Ax7d:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("O6Zd"),r=i("BaAg"),s=i("Mlb/"),o=i("dFxn"),a=i("5vx3");let l=(()=>{class e{constructor(e,t){this.breakpointObserver=t,this.manifestData=e.parse("webManifestConfig")||{name:null,short_name:null,start_url:null,scope:null,display:null,orientation:null,icons:[],background_color:null,theme_color:null},this.isStandalone=this.breakpointObserver.observe("(display-mode: standalone)").pipe(Object(n.a)(e=>e.matches))}getManifestFileType(){return r.a.fileTypeNameToFileType(this.manifestData.short_name)}isOfficeApp(){return"Office"===this.manifestData.name}hasManifest(){return!!this.manifestData.name}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(o.a),s.cc(a.a))},token:e,providedIn:"root"}),e})()},BJbw:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("cgnd"),r=i("ZBli"),s=i("pjz5"),o=i("Mlb/");let a=(()=>{class e{constructor(t){const i=t.config.userPrincipalName,s=t.config.authType;if(i&&s!==n.a.Unknown){const t={};t[e.pvrQueryName]=s===n.a.OrgId?"OrgId":"WindowsLiveId",t[e.upnQueryName]=i,this.authParams=r.a.buildQueryPath(t)}}appendPvrAndUpnAuthParams(t){if(!t||!this.authParams)return t;const i=s.a.getLocation(t),n=s.a.getQueryParams(i.search);return n[e.pvrQueryName]||n[e.upnQueryName]?t:r.a.appendQuery(t,this.authParams)}}return e.pvrQueryName="auth_pvr",e.upnQueryName="auth_upn",e.ɵprov=o.bc({factory:function(){return new e(o.cc(n.b))},token:e,providedIn:"root"}),e})()},BMb5:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c}));var n=i("eevI"),r=i("O6Zd"),s=i("Y8if"),o=i("+3x0"),a=i("Mlb/"),l=function(e){return e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e}({});let c=(()=>{class e{constructor(){this._innerWidth=this.getWindow().innerWidth,this.getWindow().shellTokenRequestDictionary={},this.setupInnerWidthListener(),this._sameOriginRegex=new RegExp("^"+this.nativeWindow.location.origin.replace(/\./g,"\\."),"i")}get innerWidth(){return this._innerWidth}get nativeWindow(){return this.getWindow()}get sameOriginRegex(){return this._sameOriginRegex}ensureZoneJs(){try{Zone.assertZonePatched()}catch(e){window.Promise=window.ZoneJSBackupPromise}}isStandalonePwa(){return Object(n.a)(this.getWindow(),"appinstalled").pipe(Object(r.a)(e=>!0),Object(s.a)(this.nativeWindow.matchMedia("(display-mode: standalone)").matches))}getStorage(e){if(!this.isStorageAvailable(e))return null;switch(e){case l.LocalStorage:return this.nativeWindow.localStorage;case l.SessionStorage:return this.nativeWindow.sessionStorage;default:return null}}isStorageAvailable(e){try{return!!window[e]}catch(e){return!1}}getWindow(){return window}setupInnerWidthListener(){Object(n.a)(this.getWindow(),"resize").pipe(Object(o.a)(10)).subscribe(()=>this._innerWidth=this.getWindow().innerWidth)}}return e.ɵprov=a.bc({factory:function(){return new e},token:e,providedIn:"root"}),e})()},BaAg:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return l})),i.d(t,"a",(function(){return c}));var n=i("WFKr"),r=i("lwM0"),s=i("pjz5"),o=i("p6Zr"),a=function(e){return e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.Word=2]="Word",e[e.Excel=3]="Excel",e[e.PowerPoint=4]="PowerPoint",e[e.Pdf=5]="Pdf",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.OneNote=8]="OneNote",e[e.Visio=9]="Visio",e[e.Photos=10]="Photos",e[e.Text=11]="Text",e[e.Outlook=12]="Outlook",e[e.Sway=13]="Sway",e[e.OneNoteClassNoteBook=14]="OneNoteClassNoteBook",e[e.Forms=15]="Forms",e[e.FormsQuiz=16]="FormsQuiz",e[e.Project=17]="Project",e[e.Portfolio=18]="Portfolio",e[e.NewsArticle=19]="NewsArticle",e[e.OneDrive=20]="OneDrive",e[e.SharePoint=21]="SharePoint",e[e.Fluid=22]="Fluid",e[e.FluidActivityBlueprint=23]="FluidActivityBlueprint",e[e.PowerBI=24]="PowerBI",e[e.StreamsVideo=25]="StreamsVideo",e[e.List=26]="List",e[e.UpcomingMeeting=27]="UpcomingMeeting",e[e.Yammer=28]="Yammer",e[e.MindMeister=29]="MindMeister",e}({}),l=function(e){return e[e.Unknown=0]="Unknown",e[e.OfficeGraph=1]="OfficeGraph",e[e.SharePoint=2]="SharePoint",e[e.Exchange=3]="Exchange",e[e.OfficeMru=4]="OfficeMru",e[e.AADGraph=5]="AADGraph",e[e.OneDriveBusiness=6]="OneDriveBusiness",e[e.Substrate=7]="Substrate",e}({});let c=(()=>{class e{constructor(t,i,n,r,s,o,l,c,u,h,d,m,p,f,g,b,v=!0,S=null,y=null,w=!1,C=0,I=!1,T=!1){if(this.id=t,this.impressionId=i,this.docId=n,this.driveId=r,this.fileName=s,this.title=o,this.url=l,this.webUrl=c,this.downloadUrl=u,this.lastModifiedTime=h,this.lastViewedTime=d,this.sharedTime=m,this.fileType=p,this.provenance=f,this.pathArray=g,this.lastModifiedBy=S,this.isLocal=I,this.isSafeLink=T,this.fileTypeName=e.fileTypeNameFromType(this.fileType),this.provenanceName=e.provenanceNameFromType(this.provenance),this.documentIcon=e.documentIconFromType(this.fileType),l&&!T){let e=l;if(!I&&(!w||w&&2===C)&&(p===a.Word||p===a.Excel||p===a.OneNote||p===a.PowerPoint||p===a.Visio||p===a.Fluid)){const t="web=1",i=-1===l.indexOf("?")?"?":"&";e=l+i+t}this.url=w||I?e:this.encodeUrl(e,v,this.fileType===a.Forms||this.fileType===a.Portfolio||this.fileType===a.Project)}this.downloadUrl&&(this.downloadUrl=this.encodeUrl(this.downloadUrl,v)),this.setupAttribution(y,b)}static fileTypeFromExtension(t){return e.extensionToFileType||e.createExtensionToFileTypeValues(),t?e.extensionToFileType[t.toLowerCase()]||a.Unknown:a.None}static fileExtensionsForType(t){if(!t||t===a.None)return[];e.fileTypeNameToExtensions||e.createFileTypeNameToExtensionsValues();const i=e.fileTypeNameFromType(t);return e.fileTypeNameToExtensions[i]||[]}static distributionFromFileTypes(t){return t?t.reduce((t,i,n)=>t+(0===n?"":";")+e.fileTypeNameFromType(i),""):""}static distributionFromFileItems(t){return t?e.distributionFromFileTypes(t.map(e=>e.fileType)):""}static fileIconNameFromType(e){switch(e){case a.Word:return"Word";case a.Excel:return"Excel";case a.PowerPoint:return"PowerPoint";case a.OneNote:return"OneNote";case a.Pdf:return"PDF";case a.Visio:return"Visio";case a.Sway:return"Sway";case a.Forms:return"Forms";case a.Project:return"Project";case a.Portfolio:return"Portfolio";case a.Fluid:case a.FluidActivityBlueprint:return"Fluid";case a.PowerBI:return"PowerBI";case a.StreamsVideo:return"StreamsVideo";default:return"Document"}}static fileTypeNameFromType(e){switch(e){case a.Word:return"Word";case a.Excel:return"Excel";case a.PowerPoint:return"PowerPoint";case a.OneNote:case a.OneNoteClassNoteBook:return"OneNote";case a.Pdf:return"PDF";case a.Visio:return"Visio";case a.Audio:return"Audio";case a.Video:return"Video";case a.Photos:return"Photos";case a.Outlook:return"Outlook";case a.Text:return"Text";case a.Sway:return"Sway";case a.Forms:return"Forms";case a.Project:return"Project";case a.Portfolio:return"Portfolio";case a.NewsArticle:return"NewsArticle";case a.Fluid:return"Fluid";case a.PowerBI:return"PowerBI";case a.StreamsVideo:return"Streams";case a.UpcomingMeeting:return"UpcomingMeeting";default:return"Document"}}static fileTypeNameToFileType(t){return t&&e.NameToFileType[t.toLowerCase()]||a.Unknown}static fileTypeFromFileName(t){return e.fileTypeFromExtension(e.getFileExtension(t))}static provenanceNameFromType(e){switch(e){case l.AADGraph:return"AADGraph";case l.Exchange:return"Exchange";case l.OfficeGraph:return"OfficeGraph";case l.OfficeMru:return"OfficeMru";case l.SharePoint:return"SharePoint";case l.Substrate:return"Substrate";default:return"Unknown"}}static getFileExtension(e){if(!e)return"";const t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1)}static getFileExtensionFromUrl(e){if(!e)return"";const t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1).split("?")[0]}static documentIconFromType(t,i="32x32"){return t===a.Portfolio?`document-icon-sprite document-icon-sprite-${e.fileIconNameFromType(t).toLowerCase()}-${i}`:`document-icon--${i} document-icon--${e.fileIconNameFromType(t).toLowerCase()}`}static referralFromFileType(t){switch(t){case a.Word:return o.a.Word;case a.Excel:return o.a.Excel;case a.PowerPoint:return o.a.PowerPoint;case a.OneNote:return o.a.OneNote;case a.Sway:return o.a.Sway;case a.Visio:return o.a.Visio;case a.Project:case a.Portfolio:return o.a.Project;case a.PowerBI:return o.a.PowerBI;default:return e.fileTypeNameFromType(t)}}static referralFromFileLocation(t){if(t&&t.length){if(t.match(e.OneDriveBusinessUrlRegex)||t.match(e.OneDriveConsumerUrlRegex))return o.a.OneDrive;if(t.match(e.SharePointUrlRegex))return o.a.SharePoint}return null}static isConsumerDocument(e){return s.a.getHostName(e).lastIndexOf("live.net")>0}static fileNameWithoutExtension(e){if(!e)return e;const t=e.lastIndexOf(".");return-1===t?e:e.substring(0,t)}documentIconWithSize(t="32x32"){return e.documentIconFromType(this.fileType,t)}getClickData(t,i,n){const r={};r.ImpressionId=this.impressionId,r.ElementId=this.id,r.Referral=e.referralFromFileType(this.fileType),r.Index=n.toString(),r.DocumentType=this.fileTypeName,r.Action=i;const s=this.timeSinceLastOpenInSeconds();return null!==s&&(r.InactivityDuration=s.toString()),{eventName:t,params:r,metrics:[]}}getClickDataForPath(t,i,n){const r=this.getClickData(t,i,n);return r&&r.params&&(r.params.Referral=e.referralFromFileLocation(this.url)),r}timeSinceLastOpenInSeconds(){return this.lastViewedTime?Math.round(((new Date).getTime()-this.lastViewedTime.getTime())/1e3):null}getId(){return this.id}static createExtensionToFileTypeValues(){e.fileTypeNameToExtensions||e.createFileTypeNameToExtensionsValues(),e.extensionToFileType={};for(const t in e.fileTypeNameToExtensions){if(!e.fileTypeNameToExtensions.hasOwnProperty(t))continue;const i=e.fileTypeNameToFileType(t);if(!i)continue;const n=e.fileTypeNameToExtensions[t];n&&n.forEach(t=>{e.extensionToFileType[t]=i})}}static createFileTypeNameToExtensionsValues(){e.fileTypeNameToExtensions={},e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.Excel)]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.Visio)]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.PowerPoint)]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.Word)]=["doc","dot","docx","docm","dotx","dotm","docb","word"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.Photos)]=["jpg","png","jpeg"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.Video)]=["mp4","mov","avi"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.Outlook)]=["msg","eml"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.OneNote)]=["one"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.Pdf)]=["pdf"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.Audio)]=["mp3"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.Text)]=["txt"],e.fileTypeNameToExtensions[e.fileTypeNameFromType(a.Fluid)]=["fluid"]}encodeUrl(e,t,i){try{let n=e;return t&&(n=r.a.decodeUrl(e),n||(n=e)),r.a.encodeUrl(n,i)}catch(t){return e}}setupAttribution(t,i){if(this.fileType!==a.Sway&&this.fileType!==a.Forms&&this.fileType!==a.Project)if(this.attribution=n.a.Format(this.pathArray,i)[1],t)this.attributionUrl=t;else{const t=this.url?this.url.lastIndexOf(this.isLocal?"\\":"/"):-1;if(this.attributionUrl=-1===t?this.url:this.url.substring(0,t+1),this.attributionUrl&&this.attributionUrl.match(e.OneDriveConsumerUrlRegex)){const e=s.a.getLocation(this.attributionUrl).path;e.lastIndexOf("/",e.length-2)<=0&&(this.attributionUrl=this.attributionUrl+"?id=root")}}}}return e.OneDriveBusinessUrlRegex=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,e.SharePointUrlRegex=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,e.OneDriveConsumerUrlRegex=/http[s]?:\/\/d\.docs\.live\.net/,e.NameToFileType={none:a.None,unknown:a.Unknown,excel:a.Excel,onenote:a.OneNote,pdf:a.Pdf,powerpoint:a.PowerPoint,audio:a.Audio,video:a.Video,visio:a.Visio,word:a.Word,photos:a.Photos,text:a.Text,outlook:a.Outlook,sway:a.Sway,forms:a.Forms,project:a.Project,portfolio:a.Portfolio,newsarticle:a.NewsArticle,onedrive:a.OneDrive,sharepoint:a.SharePoint,bohemia:a.Fluid,fluid:a.Fluid,powerbi:a.PowerBI,streamsvideo:a.StreamsVideo,yammer:a.Yammer,mindmeister:a.MindMeister},e.NameToProvenance={Unknown:l.Unknown,AADGraph:l.AADGraph,Exchange:l.Exchange,OfficeGraph:l.OfficeGraph,OfficeMru:l.OfficeMru,SharePoint:l.SharePoint,Substrate:l.Substrate},e})()},Bc8L:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},Brer:function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var n=i("WKA6"),r=i("BaAg"),s=i("p6Zr"),o=i("L/Tc"),a=i("fKR7"),l=i("cgnd"),c=i("oAX+"),u=i("ZBli"),h=i("pjz5"),d=i("pOWU"),m=i("Mlb/"),p=i("kpuN"),f=i("4/We"),g=i("hhzZ"),b=i("R7NL"),v=i("/I02"),S=i("wwmn"),y=i("pd4Y"),w=i("BMb5"),C=i("vk2e"),I=i("lrJm"),T=i("casz");let k=(()=>{class e extends d.a{constructor(t,i,n,r,s,o,a,c,u,h,d,m){super(t,r,s,"SharePoint",o,a,h,m,"WLID1.1 "),this.capabilitiesService=i,this.dateService=c,this.windowService=u,this.globalErrorHandler=d,this.requestCache=new Map,this.itemPathPredicate=":/",this.requestConfig={headers:new Map([["accept","application/json"],["Prefer","allow-zerobyte"],["application","officehome"]])},this.inMockMode&&(this.itemPathPredicate="?path=");const p=this.contextService.sharedContext;this.isConsumer=n.config.authType===l.a.MSA,this.myDriveUrl=`${this.isConsumer?this.getConsumerBaseUrl():this.getCommercialBaseUrl(p.oneDriveResourceId)}/${e.drivePath}`}static getItemParams(t,i,n,r="",s="open"){const o=i?[...new Set(t.concat(e.WacDataSelectParams))]:t;return[o.length?"$select="+o.join(","):"",n?"$expand=thumbnails":"",i?"action="+s:"",r?"$filter="+r:""].filter(Boolean).join("&")}static getWopiHostDataFromItem(e){var t,i,n,r,s,o,a;return{bundleUrl:null!==(i=null===(t=null==e?void 0:e.officeBundle)||void 0===t?void 0:t.url)&&void 0!==i?i:"",bundleVersion:null!==(r=null===(n=null==e?void 0:e.officeBundle)||void 0===n?void 0:n.version)&&void 0!==r?r:"",downloadUrl:(null==e?void 0:e["@content.downloadUrl"])||(null==e?void 0:e["@microsoft.graph.downloadUrl"]),eTag:null==e?void 0:e.eTag,fileName:null==e?void 0:e.name,fileSize:null==e?void 0:e.size,irmEnabled:null===(s=null==e?void 0:e.file)||void 0===s?void 0:s.irmEnabled,isNewFile:!1,readOnly:null===(o=null==e?void 0:e.currentUserRole)||void 0===o?void 0:o.readOnly,wac:null===(a=null==e?void 0:e.openWith)||void 0===a?void 0:a.wac,sharepointIds:null==e?void 0:e.sharepointIds}}getMyDriveRootUrl(e=0){if(!this.capabilitiesService.capabilities.oneDriveApisEnabled)return Promise.resolve(null);if(!this.myDriveRootUrlPromise){const t=new Promise((t,i)=>{const r=this.getMyDriveRootUrlStream(e);r.results.pipe(Object(n.a)(1)).toPromise().then(e=>{e&&e.userRoot?t(e):i("No/Incomplete data returned.")}),r.initialCompletion.then(e=>{e&&(this.globalErrorHandler.handleCacheObservableError(e,"Escyx","TBMsL"),e.cacheError&&e.networkError&&i(e))})});this.myDriveRootUrlPromise=t}return this.myDriveRootUrlPromise}getMyDriveRootUrlStream(e=0){if(this.myDriveRootUrlStream)return this.myDriveRootUrlStream;const t=this.getMyDriveRootUrlInternal("cache-only",e),i=this.getMyDriveRootUrlInternal("network-first",e),n=c.a.createResultsWithCacheObservable(t,i,null,e=>this.myDriveRootUrlStream=null);return this.myDriveRootUrlStream=n,this.myDriveRootUrlStream}getSharedItemWithThumbnail(t,i,n,r,s,o=!1,a=0){return this.getSharedItemWithParams(t,i,n,e.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],s,!0),r,o,a)}getSharedItemWithoutThumbnail(t,i,n,r,s,o="open",a=!1,l=0){return this.getSharedItemWithParams(t,i,n,e.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],s,!1,"",o),r,a,l)}getSharedItemWithThumbnailAndIds(t,i,n,r,s,o=!1,a=0){return this.getSharedItemWithParams(t,i,n,e.getItemParams(["id","sharepointIds"],s,!0),r,o,a)}getItemWithWacDataAndThumbnails(t,i,n=!1,r=0){return this.getItemWithParams(t.url,t.driveId,t.docId,i,e.getItemParams([],!0,!0),n,r)}getItemWithWacData(t,i,n,r,s="open",o=!1,a=0){return this.getItemWithParams(t,i,n,r,e.getItemParams([],!0,!1,null,s),o,a)}getItemAccessForUser(e,t,i,n){const r=`${this.getCommercialBaseUrl(e,!1,!0)}/drives/${encodeURIComponent(t)}/items/${encodeURIComponent(i)}/oneDrive.checkAccess`;return new Promise((e,t)=>{const i=Object.assign({},this.requestConfig);i.headers.set("Content-Type","application/json"),this.post("Vroom_OneDrive_Item_Check_Access_Request",r,JSON.stringify({value:[{email:n}]}),i=>{i.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(i=>{i&&i.data&&i.data.value&&i.data.value[0]?e(i.data.value[0]):t(new d.b(i,"No data returned"))}).catch(e=>{this.globalErrorHandler.handleError(e,"B95N9")})},t,i,null,null,null,null,void 0,this.contextService.sharedContext.oneDriveResourceId,null,"network-only",null,null)})}getEnterpriseTemplatesLibraries(){const t=e.getItemParams(["id","name","organizationAssets"],!1,!1,"organizationAssets/officeTemplateLibrary%20ne%20null"),i=`${this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)}/drives${t?"?"+t:""}`;return this.getDriveItems("Template_Libraries_Request",i,"cache-only").catch(()=>this.getDriveItems("Template_Libraries_Request",i,"network-first",void 0,null,0,"BrowseOrgTemplates","AUO"))}getDriveItemChildrenWithThumbnails(t,i,n="network-first",r,s){if(!t)return null;const o=e.getItemParams([],!1,!0),a=i?`items/${encodeURIComponent(i)}/`:"root/",l=`${this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId)}/drives/${encodeURIComponent(t)}/${a}children${o?"?"+o:""}`;return this.getDriveItems("Vroom_Item_Request",l,n,void 0,null,0,r,s)}createNewFile(e,t,i=!1){const n=`${this.myDriveUrl}root/children?select=webDavUrl,${i?"openWith,":""}*`,r={name:e,file:{},"@name.conflictBehavior":"rename"};return new Promise((e,i)=>{this.post("Vroom_Create_File_Request",n,r,t=>{t.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(t=>{const n=t.data;n&&n.id?e(n):i(new d.b(t,"Could not parse drive item from Vroom response"))}).catch(e=>{if(e&&e.data){const t={};t.DebugInfo=JSON.stringify(e.data),t.HttpCode=e.status.toString(),this.instrumentationService.logDebugCacheEvent("Vroom_Create_File_Request",t)}this.globalErrorHandler.handleError(e,"vcXyA")})},e=>{e&&e.httpResponse?i(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):i()},this.requestConfig,null,null,null,null,"OneDrive",this.contextService.sharedContext.oneDriveResourceId,null,null,!0,{category:"CreateFile",fileType:t})})}uploadFile(e,t,i,n,r,s,o){return new Promise((a,l)=>{e&&e.name||l(new d.b(null,"Invalid file"));const c=this.getUploadLocation(this.myDriveUrl,e,i,n)+"content?@name.conflictBehavior=rename&select=webDavUrl,*";this.put("Vroom_Upload_File_Request",c,e,i=>{i.instrument((i,n)=>this.instrumentUploadResponse(i,n,e,t)).then(e=>{const t=e.data;t&&t.id?a(t):l(new d.b(e,"Could not parse drive item from Vroom response"))}).catch(e=>{this.globalErrorHandler.handleError(e,"dSenI")})},l,this.requestConfig,r,null,s,o,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)})}createUploadSession(e,t,i,n,r){return new Promise((s,o)=>{e&&e.name||o(new d.b(null,"Invalid file"));const a=`${this.getUploadLocation(this.myDriveUrl,e,i,n)}${this.inMockMode?"":"oneDrive."}createUploadSession`;this.post("Vroom_Create_Upload_Session_Request",a,{item:{"@name.conflictBehavior":"rename"}},i=>{i.instrument((i,n)=>{if(this.instrumentUploadResponse(i,n,e,t),i.ok){const e=i.data;n.params.Length=e&&e.uploadUrl?e.uploadUrl.length.toString():"0"}}).then(e=>{const t=e.data;t&&t.uploadUrl?s(t):o(new d.b(e,"Could not parse upload session from Vroom response"))}).catch(e=>{this.globalErrorHandler.handleError(e,"d9WE9")})},o,this.requestConfig,null,null,r,null,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)})}cancelUploadSession(e,t,i){return this.cancelUploadSessionInternal(e,t,i,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)}uploadFragment(e,t,i,n,r,s,o,a,l){return new Promise((c,h)=>{e||h(new d.b(null,"Invalid session url")),e.endsWith("select=webDavUrl,*")||(e=u.a.appendQuery(e,"select=webDavUrl,*"));const m=new Map,p=Math.max(0,i-t);m.set("Content-Range",`bytes ${t}-${t+p-1}/${n}`),this.put("OneDrive_Graph_Upload_Fragment_Request",e,r,e=>{e.instrument((e,i)=>{i.params.TotalSize=n.toString(),i.params.ActualSize=p.toString(),i.params.Index=t.toString(),i.params.UploadSessionId=s,i.params.RequestId=this.getRequestIdFromResponse(e)}).then(({data:e})=>c(e)).catch(e=>{this.globalErrorHandler.handleError(e,"t59Ym")})},h,{headers:m},o,null,a,l,"None")})}getUploadSessionStatus(e,t,i){return this.getUploadSessionStatusInternal(e,t,i,"OneDrive",this.contextService.sharedContext.oneDriveResourceId)}getDocumentActivity(t,i,n=0){if(!t||!t.driveId||!t.docId)return Promise.reject(new d.b(null,"Drive and doc IDs are required"));const r=`${i}_${t.driveId}_${t.docId}_activity`,s=this.getRequestFromCache(r);if(s)return s;const l=new Promise((s,l)=>{const c=this.getCommercialApiInfo(t.url);c||l("Invalid document url");const u=`${c.baseUrl}/drives/${encodeURIComponent(t.driveId)}/items/${encodeURIComponent(t.docId)}/activities`;this.get("Vroom_Activity_Request",u,i=>{i.instrument((e,i)=>{if(i.params.RequestId=this.getSharepointRequestId(e),i.params.FileFormat=a.a[t.format],e&&e.ok&&e.data&&e.data.value){const t=e.data.value.length.toString();i.params.ActualSize=t,i.params.Distribution=this.distributionByActionType(e.data.value)}}).then(t=>{t&&t.data&&t.data.value?s(t.data.value.map(t=>{let i;return i=t.action.hasOwnProperty(e.mentionKey)?{type:o.a.Mention,data:t.action[e.mentionKey]}:t.action.hasOwnProperty(e.commentKey)?{type:o.a.Comment,data:t.action[e.commentKey]}:t.action.hasOwnProperty(e.editKey)?{type:o.a.Edit,data:t.action[e.editKey]}:{type:o.a.Unknown,data:null},{action:i,actor:t.actor,timestamp:this.getPreferredTime(t.times)}})):l(new d.b(t,"No data returned"))}).catch(e=>{this.globalErrorHandler.handleError(e,"ACZGk")})},e=>{this.requestCache.delete(r),l(e)},this.requestConfig,i,null,null,null,c.tokenType,c.resourceUrl,n)});return this.requestCache.set(r,{promise:l,expiryTime:this.dateService.addSeconds(this.dateService.getCurrentDate(),this.contextService.sharedContext.activityLifetimeInSeconds)}),l}getUploadLocation(e,t,i,n){return`${e}${this.inMockMode?"upload/":`${n?`root${this.itemPathPredicate}${n}/`:i?`items/${i}${this.itemPathPredicate}`:"root"+this.itemPathPredicate}${encodeURIComponent(t.name)}${this.itemPathPredicate}`}`}instrumentUploadResponse(e,t,i,n){t.params.TotalSize=i.size.toString(),t.params.UploadSessionId=n,t.params.RequestId=this.getRequestIdFromResponse(e)}getRootUrlsFromRootItem(t,i){let n=null;const r=t?t.webUrl:null;if(!r)return this.instrumentationService.logGenericEvent("OneDrive_Places_Bad_Url"),null;if(!this.isConsumer){const t=e.oneDriveBaseUrlSearchRegex.exec(r);t&&t.length&&(n=t[0])}return{tenantRoot:n,userRoot:r,fromCache:"cache-only"===i}}getSharesUrl(e){try{let t=this.windowService.nativeWindow.btoa(e),i=t.length-1;for(;"="===t.charAt(i);)--i;return t=t.slice(0,i+1).replace(/\+/g,"-").replace(/\//g,"_"),`shares/u!${t}/driveItem`}catch(e){return this.globalErrorHandler.handleError(e,"fYwwF"),null}}cancelUploadSessionInternal(e,t,i,n,r){return new Promise((s,o)=>{e||o(new d.b(null,"Invalid session url")),this.delete("OneDrive_Graph_Cancel_Upload_Session_Request",e,null,e=>{e.instrument((e,i)=>{i.params.UploadSessionId=t,i.params.RequestId=this.getRequestIdFromResponse(e)}).then(()=>s(null)).catch(e=>{this.globalErrorHandler.handleError(e,"wQvvW")})},o,this.requestConfig,i,null,n,r)})}getUploadSessionStatusInternal(e,t,i,n,r){return new Promise((s,o)=>{e||o(new d.b(null,"Invalid session url")),this.get("OneDrive_Graph_Upload_Status_Request",e,e=>{e.instrument((e,i)=>{i.params.UploadSessionId=t,i.params.RequestId=this.getRequestIdFromResponse(e)}).then(({data:e})=>s(e)).catch(e=>{this.globalErrorHandler.handleError(e,"PPAU2")})},o,this.requestConfig,"network-only",null,i,null,n,r)})}getMyDriveRoot(e,t){return this.getMyDriveItem("root",e,t)}getIsFluidEnabled(t){const i=this.getCommercialBaseUrl(this.contextService.sharedContext.oneDriveResourceId,!1,!0),n=this.getApiInfo(i),r=`${i}/${e.drivePath}root/opStream/fluidEnabled`;return new Promise((e,i)=>{this.get("FluidEnabled_Request",r,t=>{t.then(({data:t})=>e(!!t.isFluidEnabled&&t.isFluidEnabled)).catch(e=>{this.globalErrorHandler.handleError(e,"f1CWO"),i()})},i,this.requestConfig,t,null,null,null,n.tokenType)})}createSharingLink(e,t){if(this.isConsumer)return Promise.reject("api only available for commercial");const i=`${this.getCommercialBaseUrl(this.contextService.sharedContext.sharePointResourceId,!1,!0)}/drives/${encodeURIComponent(e)}/items/${encodeURIComponent(t)}/createLink`,n={type:"addressBar"},r=Object.assign({},this.requestConfig);return r.headers.set("Content-Type","application/json"),new Promise((e,t)=>{this.post("Vroom_Create_Link_Request",i,JSON.stringify(n),i=>{i.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(i=>{var n,r;(null==i?void 0:i.ok)&&(null===(r=null===(n=null==i?void 0:i.data)||void 0===n?void 0:n.link)||void 0===r?void 0:r.webUrl)?e(i.data.link.webUrl):t(i.statusText)}).catch(e=>{this.globalErrorHandler.handleError(e)})},t,r)})}handleQueryParam(e,t){"mockvroom"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)}getRequestIdFromResponse(e){return this.isConsumer?this.getHeaderValue(e.headers,"ms-cv"):super.getRequestIdFromResponse(e)}getMyDriveItem(e,t,i){return this.getDriveItem("Vroom_Item_Request",`${this.myDriveUrl}${e}`,t,null,"OneDrive",this.contextService.sharedContext.oneDriveResourceId,i)}getItemWithParams(e,t,i,n,r,s=!1,o=0){const a=this.getApiInfo(e);if(!a)return Promise.reject("Invalid document url");const l=`${a.baseUrl}/drives/${encodeURIComponent(t)}/items/${encodeURIComponent(i)}/${r?"?"+r:""}`,c=r.includes("openWith");return this.getDriveItem(c?"Vroom_Item_With_Wac_Data_Request":"Vroom_Item_Request",l,n,null,a.tokenType,a.resourceUrl,o,c,s)}getSharedItemWithParams(e,t,i,n,s,o=!1,a=0){const l=this.getSharesUrl(e);if(!l)return Promise.reject(new d.b(null,"Failed to construct shares url"));const c=this.getApiInfo(e),u=this.inMockMode?`shares?itemUrl=${encodeURIComponent(l)}&currentDate=${this.dateService.getCurrentDateMinuteGranularity().toISOString()}`:`${l}${n?"?"+n:""}`,h=`${c.baseUrl}/${u}`,m=n.includes("openWith");return this.getDriveItem(m?"Vroom_Shares_With_Wac_Data_Request":"Vroom_Shares_Request",h,s,(e,n)=>{if(n.params.RequestId=this.getSharepointRequestId(e),n.params.DocumentType=r.b[t],i&&(n.params.FileFormat=i),e.ok){const t=e.data,i=t?t.thumbnails:null;n.params.ItemCount=(i?i.length:0).toString()}},c.tokenType,c.resourceUrl,a,m,o)}getDriveItem(t,i,n,r,s,o,a=0,l=!1,c=!1){const u=`${i}/${n}`,h=c?void 0:this.getRequestFromCache(u);if(h)return h;const m=new Promise((l,c)=>{this.requestConfig.headers.has(e.scenarioHeader)&&this.requestConfig.headers.delete(e.scenarioHeader),this.requestConfig.headers.has(e.scenarioTypeHeader)&&this.requestConfig.headers.delete(e.scenarioTypeHeader),this.get(t,i,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e),r&&r(e,t)}).then(e=>{e&&e.data?l(e.data):c(new d.b(e,"No data returned"))}).catch(e=>{this.globalErrorHandler.handleError(e,"tIvZK")})},e=>{this.requestCache.delete(u),c(e)},this.requestConfig,n,null,null,null,s,o,a)});return this.requestCache.set(u,{promise:m,expiryTime:l?this.dateService.addHours(this.dateService.getCurrentDate(),10):void 0}),m}getDriveItems(t,i,n,r,s,o=0,a,l){const c=`${i}/${n}`,u=this.getRequestFromCache(c);if(u)return u;const h=new Promise((u,h)=>{a?this.requestConfig.headers.has(e.scenarioHeader)?this.requestConfig.headers[e.scenarioHeader]=a:this.requestConfig.headers.set(e.scenarioHeader,a):this.requestConfig.headers.has(e.scenarioHeader)&&this.requestConfig.headers.delete(e.scenarioHeader),l?this.requestConfig.headers.has(e.scenarioTypeHeader)?this.requestConfig.headers[e.scenarioTypeHeader]=l:this.requestConfig.headers.set(e.scenarioTypeHeader,l):this.requestConfig.headers.has(e.scenarioTypeHeader)&&this.requestConfig.headers.delete(e.scenarioTypeHeader),this.get(t,i,e=>{e.then(e=>{e&&e.data?u(e.data):h(new d.b(e,"No data returned"))}).catch(e=>{this.globalErrorHandler.handleError(e,"QYFpr")})},e=>{this.requestCache.delete(c),h(e)},this.requestConfig,n,null,null,null,r,s,o)});return this.requestCache.set(c,{promise:h}),h}distributionByActionType(e){return e?e.map(e=>{if(e&&e.action){const t=Object.keys(e.action);if(t&&t.length)return t[0]}return""}).reduce((e,t,i)=>e+(0===i?"":";")+t,""):""}getPreferredTime(e){return e?e.observedTime?new Date(e.observedTime):e.recordedTime?new Date(e.recordedTime):null:null}getRequestFromCache(e){if(this.requestCache.has(e)){const t=this.requestCache.get(e);if(t.promise&&(!t.expiryTime||t.expiryTime>this.dateService.getCurrentDate()))return t.promise;this.requestCache.delete(e)}return null}getApiInfo(e){return this.isConsumer?this.getConsumerApiInfo(e):this.getCommercialApiInfo(e)}getConsumerApiInfo(e){const t=h.a.getLocation(e);return t&&t.protocol&&t.host?{baseUrl:this.getConsumerBaseUrl(),tokenType:"OneDrive",resourceUrl:this.contextService.sharedContext.oneDriveResourceId,hostname:t.hostname}:null}getCommercialApiInfo(e,t=!1){const i=h.a.getLocation(e);if(!i||!i.protocol||!i.host)return null;let n;const r=this.capabilitiesService.capabilities.useOdbUrlForVroom;return n=r&&this.contextService.sharedContext.oneDriveResourceId?this.contextService.sharedContext.oneDriveResourceId:`${i.protocol}//${i.host}`,{baseUrl:this.getCommercialBaseUrl(n,!1,t),tokenType:r?"OneDrive":this.getTokenType(n),resourceUrl:n,hostname:i.hostname}}getCommercialBaseUrl(e,t,i=!1){return e=this.inMockMode?""+this.contextService.sharedContext.officeHomeApiRoot:e,t?e+"/_api":i?e+"/_api/v2.1":e+"/_api/v2.0"}getConsumerBaseUrl(){return this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:this.contextService.sharedContext.oneDriveConsumerApi}getTokenType(e){return r.a.referralFromFileLocation(e)===s.a.OneDrive?"OneDrive":"SharePoint"}getSharepointRequestId(e){return e.headers&&e.headers.get("SPRequestGuid")}getMyDriveRootUrlInternal(e,t){return this.getMyDriveRoot(e,t).then(t=>this.getRootUrlsFromRootItem(t,e))}}return e.WacDataSelectParams=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds"],e.mentionKey="mention",e.commentKey="comment",e.editKey="edit",e.drivePath="drive/",e.oneDriveBaseUrlSearchRegex=/^https?:\/\/(.(?!\/))*.\//i,e.scenarioHeader="scenario",e.scenarioTypeHeader="scenarioType",e.sharesFileTypes=new Set([r.b.Excel,r.b.PowerPoint,r.b.Visio,r.b.Word,r.b.OneNote]),e.ɵprov=m.bc({factory:function(){return new e(m.cc(p.a),m.cc(f.a),m.cc(l.b),m.cc(g.a),m.cc(b.a),m.cc(v.a),m.cc(S.a),m.cc(y.a),m.cc(w.b),m.cc(C.q),m.cc(I.b),m.cc(T.a))},token:e,providedIn:"root"}),e})()},CC5A:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}));class n{constructor(e){this.onTabAddedOrUpdated=new Array,Object.assign(this,e)}updateOrAddTab(e,t=-1){const i=this.tabs;let n=!1,r=i.length;for(let t=0;t<i.length;t++)if(i[t].id===e.id){n=!0,r=t,i[t]=e;break}n||(-1===t||t>=i.length?i.push(e):i.splice(t,0,e));for(const t of this.onTabAddedOrUpdated)t(e,r,n)}registerOnTabAddedOrUpdated(e){this.onTabAddedOrUpdated.push(e)}}var r=function(e){return e[e.Unknown=0]="Unknown",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Error=3]="Error",e}({})},CCRL:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("Mlb/").q)("LAZY_VIEW_ENTRY_COMPONENT")},CVeG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static escapeHtml(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}static stripTags(e){return e?e.replace(/<.*?>/g,""):""}}},D6F8:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},D8EG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},DCBR:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("qTBP");let n=(()=>{class e{constructor(e,t,i,n,r){this.capabilitiesService=e,this.changeDetector=t,this.deviceDetector=i,this.instrumentationService=n,this.locService=r,this.cardIncrement=4,this.currentCarouselPage=0,this.maxCardsPerLine=4,this.cardMargin=12}ngOnInit(){this.cards=this.carousel.cards,this.canSwipe=!this.deviceDetector.isDesktopDevice(),this.disableAnimation=this.capabilitiesService.capabilities.disableAnimation,this.nextPage=this.locService.ButtonNextPage,this.previousPage=this.locService.ButtonPreviousPage,this.carousel.cards.length>0&&(this.maxCardContainerWidths=[this.maxCardContainerWidth(1),this.maxCardContainerWidth(2),this.maxCardContainerWidth(3),this.maxCardContainerWidth(4)])}navigateCards(e){const t=this.currentCarouselPage+e*this.cardIncrement;return t<this.cards.length&&t>=0&&(this.navigationAnnouncement="",e<0?setTimeout(()=>this.navigationAnnouncement=this.previousPage,0):setTimeout(()=>this.navigationAnnouncement=this.nextPage,0),this.currentCarouselPage=t,this.logNavClick(e),!0)}updateCarouselCardData(e=!1){this.carouselElement&&(this.cardIncrement=this.getNumCards(e))}trackByIndex(e){return e}maxCardContainerWidth(t){return(e.cardMinWidth+this.cardMargin)*t}logNavClick(e){const t={};t.Index=this.currentCarouselPage.toString(),t.Increment=this.cardIncrement.toString(),t.TotalSize=this.cards.length.toString(),this.navClickLogging(t,e<0?"NavPrevious":"NavNext")}getNumCards(e=!1){if(!this.cards||!this.cards.length)return 0;this.changeDetector.detectChanges();let t=this.carouselContainer.nativeElement.clientWidth+12;e&&(t-=50);for(let e=this.maxCardsPerLine;e>0;e--)if(t>=this.maxCardContainerWidths[e-1])return e}}return e.cardMinWidth=217,e})()},DQbD:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("cgnd");let s=(()=>{class e{constructor(e){this.clientStartupConfigService=e,this.bootId=0}get HostContext(){return this}get audience(){return function(e){switch(e){case"bfprod":case"tbprod":case"pfprod":case"prodprv":case"prod":return"Production";case"ppe":case"ppeprv":return"Staging";case"sdf":return"Dogfood";case"dev":case"developer":case"test":default:return"Local"}}(this.clientStartupConfigService.config.sharedClientStartupContext.deploymentEnvironment)}get hostAppVersion(){return""+this.clientStartupConfigService.config.sharedClientStartupContext.buildId}get hostCorrelationId(){return`${this.clientStartupConfigService.config.sharedClientStartupContext.correlationId}.${this.bootId}`}get hostSessionId(){return this.clientStartupConfigService.config.sharedClientStartupContext.correlationId}get hostName(){return"Office.com"}get userContext(){return{user:{oid:this.clientStartupConfigService.config.puid,tenantId:this.clientStartupConfigService.config.tenantId}}}resetFluidHostContext(){this.hostScenarioStartTime=void 0,this.hostScenarioName=void 0,this.bootId++}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.b))},token:e,providedIn:"root"}),e})()},Dpxn:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},EUVs:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("bb6g"),r=i("6UlS"),s=i("O6Zd"),o=i("WKA6"),a=i("BaAg"),l=i("jCfB"),c=i("Mlb/"),u=i("4/We"),h=i("/I02"),d=i("hZW2"),m=i("hhzZ"),p=i("Z0U4"),f=i("dFxn");let g=(()=>{class e{constructor(e){this.reactShellConfig=e.parse("reactShellConfiguration")||{activityTimeout:0,correlationId:null,culture:null,feedbackLinkText:null,homePageTitle:null,homePageUrl:null,isConsumer:!1,logoutText:null,logoutUrl:null,mePhotoSource:null,puid:null,responsiveShellEnabled:!1,searchInHeader:!1,shellBootHost:null,shellDelayResourcesEnabled:!1,showOCVFeedbackLink:!1,signinState:[],skypeChatEnabled:!1,stickyNotesEnabled:!1,switchAccountLinkText:null,testTraffic:!1,thirdPartyNoticeLinkText:null,upn:null,userDisplayName:null,version:null,workloadSettingsSubLinksTitle:null,darkModeEnabled:!1,resourceUrl:null,environment:null,consumerShellServiceEnabled:!1,languageCode:null}}}return e.ɵprov=c.bc({factory:function(){return new e(c.cc(f.a))},token:e,providedIn:"root"}),e})();var b=i("5aVq"),v=i("RZcl"),S=i("BMb5");let y=(()=>{class e{constructor(e,t,i,n,s,o,a,l,c){this.capabilitiesService=e,this.contextService=t,this.documentService=i,this.instrumentationService=n,this.officeRouteService=s,this.reactShellConfigService=o,this.shellShimService=a,this.wacBootstrapperService=l,this.windowService=c,this._loadedDocuments=new r.a(new Map),this.docTitleEnabled=this.capabilitiesService.capabilities.wacHeaderDisabled}static getParamsForDocumentInfo(e,t={}){return Object.assign(Object.assign({},t),{[l.a.DriveId]:e.driveId,[l.a.ItemId]:e.docId,[l.a.DocUrl]:e.docUrl})}static getParamsForMruFileItem(e,t={}){return Object.assign(Object.assign({},t),{[l.a.DriveId]:e.driveId,[l.a.ItemId]:e.docId,[l.a.DocUrl]:e.canonicalUrl})}static getDocumentInfoForMruFileItem(e,t){return{docId:e.docId,docUrl:e.canonicalUrl,driveId:e.driveId,fileType:e.fileType,fileName:e.fileName,wdOrigin:t}}static isValidDocumentInfo(e){return!!e.docId&&!!e.driveId||!!e.docUrl}bootstrapAndRouteMruFileItem(t,i,n={},r,s){this.bootstrapAndRoute(e.getDocumentInfoForMruFileItem(t,i),n,r,s?this.wacBootstrapperService.convertMruInflationPromise(s,i,r):void 0)}bootstrapAndRoute(e,t={},i,n){this.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&this.bootstrap(e,i,n)(t)}bootstrapZeroByteFile(e,t,i){if(!this.capabilitiesService.wacHostEnabledForFileType(e.fileType))return;const r=i.then(t=>({docId:t.docId,driveId:t.driveId,docUrl:t.canonicalUrl,fileName:t.fileName,wdOrigin:e.wdOrigin,fileType:e.fileType,newFile:!0})),s=this.wacBootstrapperService.bootstrapZeroByteDocument(e,t,r);return()=>Object(n.b)(this,void 0,void 0,(function*(){this.updateBootedDocumentsMap({correlationId:s.correlationId,bootedDocumentInfo:{bootId:s.bootedDocumentInfo.bootId,documentInfo:s.bootedDocumentInfo.documentInfo},data:s.data})()}))}bootstrapDocumentFromLoader(e,t,i=!1){return Object(n.b)(this,void 0,void 0,(function*(){if(!this.capabilitiesService.wacHostEnabledForFileType(e.fileType))return;const n=yield this.hasLoadedDocumentsObservable().toPromise();i&&n||this.bootstrap(e,t)}))}loadMruItem(e,t,i=!1){return this.bootstrap({docId:e.docId,driveId:e.driveId,docUrl:e.canonicalUrl,fileType:e.fileType,wdOrigin:this.contextService.getWdOrigin(t)},Date.now(),void 0,i)}bootstrap(e,t=Date.now(),i,n=!1){if(!this.capabilitiesService.wacHostEnabledForFileType(e.fileType))return;const r=this.wacBootstrapperService.bootstrapItem(e,t,i);return this.logLoadStart(r),this.updateBootedDocumentsMap(r,n)}updateBootedDocumentsMap(e,t=!1){const i=new r.a({bootAndLoadInfo:e,visible:!t});return this._loadedDocuments.next(new Map([[e.bootedDocumentInfo.bootId,i]])),(t={})=>{this.routeToContentPage(e.bootedDocumentInfo.documentInfo,t)}}updateInformation(t,i,n,r=!1){var s;const o=null===(s=this._loadedDocuments.getValue())||void 0===s?void 0:s.get(t);if(!o)return;const a=o.getValue();if(!a)return;const l={bootAndLoadInfo:{correlationId:a.bootAndLoadInfo.correlationId,bootedDocumentInfo:{bootId:t,documentInfo:null!=i?i:a.bootAndLoadInfo.bootedDocumentInfo.documentInfo},data:a.bootAndLoadInfo.data},visible:null!=n?n:a.visible};if(o.next(l),r){const t=e.getParamsForDocumentInfo(l.bootAndLoadInfo.bootedDocumentInfo.documentInfo);this.officeRouteService.updateQueryParams(t)}}unloadAllDocuments(){this._loadedDocuments.next(new Map)}resetShell(){return Object(n.b)(this,void 0,void 0,(function*(){const t=this.capabilitiesService.capabilities.reactShellEnabled?this.documentService.nativeDocument.getElementById("ReactShellHeader"):this.documentService.nativeDocument.querySelector("#ShellHeader");if(t&&t.childElementCount){this.documentService.removeCssClassFromElement(t,e.HiddenShellClass);const i=yield this.shellShimService.getShellShim();i.Notifications.UnmuteToasts&&i.Notifications.UnmuteToasts()}else if(!this.docTitleEnabled){const e=this.reactShellConfigService.reactShellConfig.resourceUrl;e&&this.documentService.addScriptToPage(e,()=>this.windowService.nativeWindow.bootstrapReactShell(),()=>this.instrumentationService.logErrorEvent("Shell_Bootstrapper_Load_Error",{ShellBootAfterStartup:"true",ResourceUrl:e}))}}))}getLoadedDocumentsObservable(){return this._loadedDocuments.asObservable().pipe(Object(s.a)(e=>Array.from(e.keys()).map(t=>({bootId:t,data:e.get(t).asObservable()}))))}hasLoadedDocumentsObservable(){return this._loadedDocuments.asObservable().pipe(Object(s.a)(e=>e.size>0),Object(o.a)(1))}getDocumentInfoFromParams(e,t,i){var n;const r=e[l.a.ItemId],s=e[l.a.DriveId],o=null!==(n=this.decodeParamWithKey(e,l.a.DocUrl))&&void 0!==n?n:this.decodeParamWithKey(e,l.a.ContentUri),a=e[l.a.Nav];return{docId:r,driveId:s,docUrl:o,wdOrigin:null!=i?i:this.contextService.getWdOrigin("DIRECT"),applicationUrlParams:a?{actnavid:a}:void 0,fileType:t}}routeToContentPage(t,i){this.officeRouteService.navigateTo({route:"Content",app:t.fileType},!1,e.getParamsForDocumentInfo(t,i))}decodeParamWithKey(e,t){const i=e[t];if(i){let e=i;try{e=decodeURIComponent(i.replace(/\+/g," "))}catch(t){e=null!=i?i:void 0}return e}}logLoadStart(e){const t={ResourceId:e.correlationId,WacHostEntry:e.bootedDocumentInfo.documentInfo.wdOrigin,FileFormat:a.a.fileTypeNameFromType(e.bootedDocumentInfo.documentInfo.fileType)};this.instrumentationService.logGenericEvent("WacDocument_Load_Start",t)}}return e.HiddenShellClass="hide-shell",e.ɵprov=c.bc({factory:function(){return new e(c.cc(u.a),c.cc(h.a),c.cc(d.a),c.cc(m.a),c.cc(p.a),c.cc(g),c.cc(b.a),c.cc(v.a),c.cc(S.b))},token:e,providedIn:"root"}),e})()},EYcb:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("6UlS"),r=i("Mlb/");let s=(()=>{class e{constructor(){this._error=new n.a(null)}showErrorDialog(e){this._error.next(e)}get error(){return this._error.asObservable()}}return e.ɵprov=r.bc({factory:function(){return new e},token:e,providedIn:"root"}),e})()},EqbI:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("pOWU"),r=i("Mlb/"),s=i("kpuN"),o=i("hhzZ"),a=i("R7NL"),l=i("/I02"),c=i("wwmn"),u=i("v3sZ"),h=i("vk2e"),d=i("casz");let m=(()=>{class e extends n.a{constructor(e,t,i,n,r,s,o,a){super(e,t,i,"OneNote",n,r,o,a),this.oneNoteConfigService=s,this.COPY_CLASS_NOTEBOOK="/notebooks/saveacopy",this.CLIENT_DEV_MODE_RESOURCE_URL="https://www.onenote.com",this.BASE_URL="/api",this.VERSION="1.0",this.getClassNoteBookPromise=null,this.inMockMode=n.sharedContext.inMockMode}getClassNoteBooks(){const e={};return this.getClassNoteBookPromise||(this.getClassNoteBookPromise=new Promise((t,i)=>{this.get("Get_ClassNotebooks_Request",this.oneNoteConfigService.config.oneNoteApiPath+this.BASE_URL+"/v"+this.VERSION+"/me/notes/classnotebooks?hasaccessto=true&orderby=lastModifiedTime desc",e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{t(e.data.value)})},e=>{this.getClassNoteBookPromise=null,i(e)},e,"network-only")})),this.getClassNoteBookPromise}generateSaveCopyClassNotebookLink(e,t,i){const n=this.inMockMode?this.CLIENT_DEV_MODE_RESOURCE_URL:this.oneNoteConfigService.config.oneNoteApiPath,r=e.indexOf("-"),s=e.substring(0,r),o=e.substring(r+1).toLowerCase();return`${n}${this.COPY_CLASS_NOTEBOOK}/?notebookId=${s}|{${o}}&notebookName=${t}&notebookUrl=${i}`}getRequestIdFromResponse(e){return e.headers.get("X-CorrelationId")}}return e.ɵprov=r.bc({factory:function(){return new e(r.cc(s.a),r.cc(o.a),r.cc(a.a),r.cc(l.a),r.cc(c.a),r.cc(u.a),r.cc(h.q),r.cc(d.a))},token:e,providedIn:"root"}),e})()},Eu1D:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e[e.Unknown=0]="Unknown",e[e.Disabled=1]="Disabled",e[e.Loading=2]="Loading",e[e.Displayed=3]="Displayed",e[e.Failed=4]="Failed",e}({})},Eup2:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("Mlb/"),r=i("70cc"),s=i("O6Zd"),o=i("WKA6"),a=i("DCBR");class l{constructor(e,t,i,n,r,s=[],o=[],a="callout",l=!1,c=!1,u=!1,h="",d=!1,m=null,p,f){this.calloutElement=e,this.calloutType=t,this.area=i,this.title=n,this.subTitle=r,this.activationClasses=s,this.initialClasses=o,this.buttonIdPrefix=a,this.persistDismissal=l,this.persistCompletion=c,this.inline=u,this.imageClass=h,this.teachingCallout=d,this.dismissCalloutObservable=m,this.horizontalOffsetOverride=p,this.verticalOffsetOverride=f,this.completed=!1}isValid(){return this.calloutElement&&(!!this.subTitle||!!this.title)}}var c=i("CC5A"),u=i("hhzZ"),h=i("BaAg"),d=i("Eu1D"),m=i("JT1q"),p=i("W3Zz");i("aXuH");let f=(()=>{class e extends a.a{constructor(e,t,i,r,s,o,a,l,c,u,h,d,m,p,f,g,b,v,S,y,w,C,I,T){super(e,t,d,f,m),this.capabilitiesService=e,this.changeDetector=t,this.recommendedService=i,this.contextService=r,this.floodgateService=s,this.globalErrorHandler=o,this.performanceService=a,this.jumpListService=l,this.browserPaintMeasurementService=c,this.oneDriveGraphService=u,this.mruConfigService=h,this.deviceDetector=d,this.locService=m,this.documentService=p,this.instrumentationService=f,this.dataSecurityService=g,this.eventService=b,this.userDataStorageService=v,this.featureCalloutService=S,this.userProfileService=y,this.officeFeedService=w,this.clientStartupContextService=C,this.themingService=I,this.windowService=T,this.recommendedDocView="Card",this.currentCarouselPage=0,this.translateX="0",this.stateChanged=new n.n}ngOnInit(){const t=this.capabilitiesService.capabilities;let i;this.stateChanged.emit({state:d.a.Loading}),this.isAntpExperience=t.antpLoaded,this.mruConfig=this.mruConfigService.config,this.recommendedTitle=this.locService.RecommendedDocumentsSectionTitle,this.canSwipeRecommended=this.deviceDetector.isMobileDevice(),this.previousPage=this.locService.ButtonPreviousPage,this.nextPage=this.locService.ButtonNextPage,this.maxCardsPerLine=this.isAntpExperience?5:4,this.componentArea=u.b.Recommended,this.appFilter=this.fileType?new Set([this.fileType]):null,this.disableAnimation=t.disableAnimation,this.bottomTrayEnabled=t.bottomTrayEnabled,this.isOfficeFeed=(this.mruConfig.officeFeedControlEnabled||this.mruConfig.officeFeedFlightEnabled)&&!this.isStartPage,this.listId=this.isOfficeFeed?e.officeFeedListId:e.recommendedListId,this.recommendedEnabled=this.mruConfig.recommendedEnabled&&this.fileType!==h.b.Sway&&this.fileType!==h.b.OneNote&&this.fileType!==h.b.Forms&&(this.fileType!==h.b.Visio||this.mruConfig.recommendedVisioEnabled),this.showAnalytics=this.mruConfig.analyticsEnabled&&this.fileType===h.b.Sway,this.showActivity=!this.showAnalytics&&this.mruConfig.activityEnabled&&this.fileType!==h.b.OneNote,this.showSharing=!this.showAnalytics&&this.mruConfig.sharingStatusEnabled,this.recommendedMotion=!this.isAntpExperience&&this.mruConfig.recommendedMotionEnabled&&!this.canSwipeRecommended&&this.deviceDetector.deviceInfo.browser.browserType!==p.a.Safari,this.backplatesEnabled=this.themingService.backplatesTheming;const n=e=>{this.eventService.broadcastEvent({name:"recommendedReady",args:[e]})};if(this.recommendedEnabled){if(this.isOfficeFeed){const e=this.officeFeedService.getOfficeFeed();i=e.results,this.recommendedStream=i.subscribe(e=>this.processRecommendedTask(e)),e.initialCompletion.then(e=>{e&&(this.globalErrorHandler.handleCacheObservableError(e,"bCXkx","K0yti"),this.stateChanged.emit({state:d.a.Failed}))}),this.isStartPage||(this.officefeedBounce=this.eventService.events.withScope(1).pipe(Object(r.a)(e=>"appTileClick"===e.name),Object(s.a)(e=>e.args[0])).subscribe(e=>{if(this.cards){const t=Math.min(this.currentCarouselPage+this.cardIncrement-1,this.cards.length-1),i=this.cards[t];i&&this.officeFeedService.logInstrumentation([i.feedbackId],["bounce"],[i.fromCache?"cache":"service"],[e])}}))}else{const e=this.recommendedService.getRecommendedDocs(this.appFilter);i=e.results,this.recommendedStream=i.subscribe(e=>this.processRecommendedTask(e)),e.initialCompletion.then(e=>{e&&(this.globalErrorHandler.handleCacheObservableError(e,"tCyIn","jtlYX"),this.stateChanged.emit({state:d.a.Failed}),(t.isPwaInUwp||t.antpLoaded)&&(n(0),e.cacheError&&e.networkError&&this.eventService.broadcastEvent({name:"recommendedFailed",args:[]})))})}i?i.pipe(Object(o.a)(1)).toPromise().then(e=>n(e.items.length)):n(0)}}ngAfterViewChecked(){this.recommendedEnabled&&this.mruConfig.recommendedCalloutEnabled&&!this.recommendedCalloutPromise&&void 0!==this.carouselElement&&this.cards&&this.cards.length>0&&(this.recommendedCalloutPromise=this.userProfileService.doesMetricExist("Recommended_Callout_Impression",!0),this.recommendedCalloutPromise.then(e=>{e||this.userDataStorageService.get("SawRecommended",1).then(e=>{if(e)this.userProfileService.incrementMetric("Recommended_Callout_Impression");else{const e=this.documentService.nativeDocument.querySelector(".list-header__title--card-carousel");this.featureCalloutService.addCallout(new l(e,"Recommended",u.b.Documents,this.locService.RecommendedDocumentsCalloutTitle,this.locService.RecommendedDocumentsCalloutSubtitle,null,null,null,!1,!1,!0)),this.instrumentationService.logImpressionEvent("Recommended_Callout_Impression",{},["Recommended_Callout_Impression"])}})}))}ngOnDestroy(){this.recommendedStream&&this.recommendedStream.unsubscribe(),this.officefeedBounce&&this.officefeedBounce.unsubscribe()}recommendedMotionDone(){this.recommendedMotion&&(this.motionState="",this.checkCorrectTranslation())}navigateCards(e){if(super.navigateCards(e)){if(this.isOfficeFeed){const e=this.cards.slice(this.currentCarouselPage,this.currentCarouselPage+this.cardIncrement);this.logOfficeFeedGeneralViews(e),this.loggedFirstScroll&&this.loggedLimitScroll||this.logOfficeFeedScroll()}if(this.recommendedMotion){const t=Math.min(this.currentCarouselPage+this.cardIncrement+1,this.cards.length);t>this.recommendedMotionList.length&&this.recommendedMotionList.push(...this.cards.slice(this.currentCarouselPage+1,t)),this.setRightOffset(),this.translateX=`translateX(${100*-e}%) translateX(${50*e}px)`,this.motionState="moving"}return this.statusAnnouncement="",this.changeDetector.detectChanges(),this.statusAnnouncement=-1===e?this.locService.RecommendedScrollPreviousAriaAnnouncement:this.locService.RecommendedScrollNextAriaAnnouncement,this.logRecommendedImpression(this.cards[this.currentCarouselPage].fromCache),!0}return!1}updateCarouselCardData(){if(super.updateCarouselCardData(this.recommendedMotion),this.recommendedMotion&&this.checkCorrectTranslation(),this.canSwipeRecommended){const e=this.virtualCards&&this.virtualCards.first&&this.virtualCards.first.nativeElement?this.virtualCards.first.nativeElement.clientWidth:null;e&&this.eventService.broadcastEvent({name:"recommendedCardSize",args:[e,501.77>this.windowService.nativeWindow.innerWidth?2:766.98>this.windowService.nativeWindow.innerWidth?3:4]})}}onDeleteRecommendedItem(e){const t=this.cards.indexOf(e.item);t>-1&&(this.cards.splice(t,1),this.currentCarouselPage>=this.cards.length&&(this.currentCarouselPage=Math.max(0,this.currentCarouselPage-this.cardIncrement)),this.recommendedMotion&&(this.recommendedMotionList=this.cards.slice(0,this.currentCarouselPage+this.cardIncrement+1))),this.isOfficeFeed?this.officeFeedService.logInstrumentation([e.item.feedbackId],["neverShowAgain"],[e.item.fromCache?"cache":"service"]):this.recommendedService.removeDocument(e.item.spoId),this.cards.length>0&&this.logRecommendedImpression(this.cards[this.currentCarouselPage].fromCache),this.statusAnnouncement="",this.changeDetector.detectChanges(),this.statusAnnouncement=this.locService.RemoveDocumentAriaTitle}logNavClick(e){const t={};t.Index=this.currentCarouselPage.toString(),t.Increment=this.cardIncrement.toString(),t.TotalSize=this.cards.length.toString(),t.ItemCategory=this.listId,t.ImpressionId=this.impressionId,this.instrumentationService.logClickEvent("Recommended_Nav_Click",e<0?"NavPrevious":"NavNext",this.componentArea,null,null,t)}checkCorrectTranslation(){this.setRightOffset(),this.carouselElement.nativeElement.style.cssText="right: "+this.calcTranslateX}setRightOffset(){if(this.cardIncrement){const e=this.currentCarouselPage/this.cardIncrement,t=Math.round(1e4*e)/100;this.calcTranslateX=`calc(${t}% - ${38*e}px)`}}processRecommendedTask(e){if(!e.items)return;this.impressionId=e.impressionId;const t=e.items.map(this.isOfficeFeed?(t,i)=>Object(m.d)(t,"mru_item_"+i,e.impressionId,this.contextService.isRtl,this.clientStartupContextService.config.authType,e.fromCache):(t,i)=>Object(m.f)(t,"mru_item_"+i,e.impressionId,this.contextService.isRtl,this.clientStartupContextService.config.authType,e.fromCache));if(this.cards&&this.copyInflationData(this.cards,t),this.cards=t,this.stateChanged.emit({state:d.a.Displayed}),this.performanceService.mark(e.fromCache?"Cached_Recommended_Ready":"Recommended_Ready"),this.browserPaintMeasurementService.recordWhenPainted("Recommended"),this.capabilitiesService.capabilities.batchGraphEnabled){const e=t.map(e=>e.url);this.oneDriveGraphService.getSharedItemsWithThumbnails(e)}if(this.cards.length>0){if(this.maxCardContainerWidths=[this.maxCardContainerWidth(1),this.maxCardContainerWidth(2),this.maxCardContainerWidth(3),this.maxCardContainerWidth(4)],this.isAntpExperience&&this.maxCardContainerWidths.push(this.maxCardContainerWidth(5)),this.cardIncrement=this.getNumCards(this.recommendedMotion),this.recommendedMotion&&(this.recommendedMotionList=this.cards.slice(0,this.currentCarouselPage+this.cardIncrement+1)),this.logRecommendedImpression(e.fromCache),this.isOfficeFeed){const e=this.cards.slice(0,this.cardIncrement);this.logOfficeFeedGeneralViews(e)}this.capabilitiesService.capabilities.recommendedFloodgate&&this.capabilitiesService.capabilities.showFloodgate&&this.floodgateService.recordFloodgate(["RecommendedImpressionGeneral"])}this.appFilter&&0!==this.appFilter.size||this.jumpListService.registerRecommendedJumpList(this.cards)}logOfficeFeedGeneralViews(e){const t=e.map(e=>e.feedbackId),i=e.map(()=>"view"),n=e.map(e=>e.fromCache?"cache":"service");this.officeFeedService.logInstrumentation(t,i,n)}logOfficeFeedScroll(){const e=[],t=[],i=[];if(this.loggedFirstScroll){if(this.currentCarouselPage+this.cardIncrement>=this.cards.length&&!this.loggedLimitScroll){const n=Math.min(this.currentCarouselPage+this.cardIncrement-1,this.cards.length-1);e.push(this.cards[n].feedbackId),t.push("scrollLimit"),i.push(this.cards[n].fromCache?"cache":"service"),this.loggedLimitScroll=!0}}else{const n=this.cards[this.currentCarouselPage-1];e.push(n.feedbackId),t.push("scrollStart"),i.push(n.fromCache?"cache":"service"),this.loggedFirstScroll=!0}t.length>0&&e.length>0&&i.length>0&&this.officeFeedService.logInstrumentation(e,t,i)}copyInflationData(e,t){for(const i of t){let t=null;e.some(e=>e.documentUrl===i.documentUrl&&(t=e,!0))&&i.copyInflationData(t,this.mruConfig.mruActivityEnabled)}}logRecommendedImpression(e){const t=this.cards,i=t.slice(this.currentCarouselPage,Math.min(this.currentCarouselPage+this.cardIncrement,this.cards.length)),n=!i||this.dataSecurityService.securityLevel>=2?i:i.filter(e=>!e.isLocal),r=h.a.distributionFromFileItems(n),s={};if(s.RenderSize=(n?n.length:0).toString(),s.Distribution=r,s.ElementId=this.listId,s.TotalSize=this.getNumLoggableItems(t).toString(),s.State="Card",s.TabState=c.a[c.a.Loaded],s.ImpressionId=this.impressionId,s.FromServiceWorkerCache=(!!e).toString(),void 0!==this.currentCarouselPage&&(s.Index=this.currentCarouselPage.toString()),void 0!==this.cardIncrement&&(s.Increment=this.cardIncrement.toString()),t.length>0){const e=t[0].timeSinceLastOpenInSeconds();null!==e&&(s.InactivityDuration=e.toString())}this.instrumentationService.logImpressionEvent("Recommended_Impression",s)}getNumLoggableItems(e){return e?this.dataSecurityService.securityLevel>=2?e.length:e.filter(e=>!e.isLocal).length:0}}return e.recommendedListId="recommended-mru",e.officeFeedListId="officefeed-mru",e})()},"Ft/N":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n="X-SW-OHP-FetchStrategy"},H90i:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return s}));const n="OfficeDotCom";var r=function(e){return e.Home="MAIN",e.Start="START",e.Content="CONTENT",e.Templates="TEMPLATES",e.Search="SEARCH",e}({}),s=function(e){return e.Web="WEB",e.HWA="HWA",e.PWA="PWA",e.NTP="NTP",e}({})},IAGz:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(){this.reset()}cancel(){this.cancelPromise()}onCancel(e){return this.promise.then(e)}reset(){this.promise=new Promise(e=>{this.cancelPromise=e})}}},JH4S:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("dFxn");let s=(()=>{class e{constructor(e){this.user=e.parse("userContext")||{companyDisplayName:null,displayName:null,hasNoLicense:!1,hasTrialSubscription:!1,isAdmin:!1,isEdu:!1,isEduFaculty:!1,isEduStudent:!1,isSmb:!1,isIw:!1,isDynamics:!1,isGcc:!1,isValid:!1,mruAvailable:!1,themed:!1,themeId:"Unknown",isFirstRelease:!1},this.user.mruAvailable=this.user.isValid&&!this.user.hasNoLicense}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a))},token:e,providedIn:"root"}),e})()},JScD:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("BaAg"),r=i("Mlb/"),s=i("dFxn");let o=(()=>{class e{constructor(e){this.config=e.parse("uploadConfig"),this.config&&(this.config.uploadFileTypes=new Set([n.b.Excel,n.b.Word,n.b.PowerPoint,n.b.Visio]),this.config.editableFileTypes=new Set([n.b.Excel,n.b.Word,n.b.PowerPoint]))}}return e.ɵprov=r.bc({factory:function(){return new e(r.cc(s.a))},token:e,providedIn:"root"}),e})()},JT1q:function(e,t,i){"use strict";i.d(t,"e",(function(){return c})),i.d(t,"f",(function(){return u})),i.d(t,"d",(function(){return h})),i.d(t,"c",(function(){return d})),i.d(t,"b",(function(){return m})),i.d(t,"a",(function(){return p})),i.d(t,"g",(function(){return f})),i.d(t,"h",(function(){return g})),i.d(t,"i",(function(){return b}));var n=i("BaAg"),r=i("lwM0"),s=i("4ach"),o=i("7Rc8"),a=i("fKR7");function l(e){if(e){const t=r.a.decodeUrl(e);if(t){const e=t.split("://");if(e.length>1){const t=e[1].split("/");return t.pop(),t}}}return[]}function c(e,t,i,r,o,l,c){let u,h,d,m,p;const f=e.MetaData,g=n.a.fileTypeNameToFileType(e.FileType);if(f){f.SPListId&&f.SPListItemUniqueId&&f.SPSiteId&&f.SPSiteUrl&&f.SPWebId&&(u={listId:f.SPListId,listItemId:null,listItemUniqueId:f.SPListItemUniqueId,siteId:f.SPSiteId,siteUrl:f.SPSiteUrl,webId:f.SPWebId}),f.CreatedDate&&(h=new Date(f.CreatedDate)),f.DriveId&&(d=f.DriveId);const e=f.SwayMetaData;e&&(m=e.ThumbnailId,p=e.IsTransformedFromWord?r.SwayTransformedFromWord:null)}const b=e&&e.MetaData&&g===n.b.Forms?e.MetaData.FormsMetaData:null,v=new a.b(a.a.Recent,t,i,e.DocId,d||e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,null,e.LastAccessedTime,null,g,0,n.a.NameToProvenance[e.Provenance],e.PathArray,o,l,c,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,g===n.b.PowerBI?e.MetaData.PowerBIMetaData.breadcrumb_url:null,e.Category,e.MruV2Type,e.MruId,e.Activity,!1,e.IsLocal,h,u,void 0!==e.Sharing?{shared:!!e.Sharing}:void 0,e.LifecycleInfo,null,null,null,null,{thumbnailId:m},p,null,!1,e.ServiceId,null,null,e.FeedbackId,e.ServerDocId,b?b.owner_name:e&&e.MetaData?e.MetaData.CreatedByUserName:null,null,e.Extension?s.a.getExtensionToFormType(e.Extension):b&&b.owner_type?s.a.getOwnerPrincipalTypeToFormType(b.owner_type):null,b?b.owner_id:null);return v.metaData=b,v}function u(e,t,i,r,s,o){let c;const u=e.SharepointInfo;return u&&u.list_id&&u.list_item_unique_id&&u.site_id&&u.site_url&&u.web_id&&(c={listId:u.list_id,listItemId:null,listItemUniqueId:u.list_item_unique_id,siteId:u.site_id,siteUrl:u.site_url,webId:u.web_id}),new a.b(a.a.Recommended,t,i,e.DocId,e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,e.LastAccessedTime,e.LastAccessedTime,null,n.a.fileTypeNameToFileType(e.FileType),0,n.a.NameToProvenance[e.Provenance],e.IsEmailAttachment?[]:l(e.Url),r,s,o,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,null,e.Category,null,null,e.Activity,e.IsEmailAttachment,e.IsLocal,null,c,null,!1,e.EmailReference,null,null,null,null,null,e.SPOId,e.IsCollab,null,e.NavigationId,null,null,e.ServerDocId,null,e.TeamsDeepLink)}function h(e,t,i,r,s,o){let c;const u=e.SharepointInfo;let h;u&&(c={listId:u.list_id,listItemId:null,listItemUniqueId:u.list_item_unique_id,siteId:u.site_id,siteUrl:u.site_url,webId:u.web_id}),e.ThumbnailUrl&&(h={small:e.ThumbnailUrl,medium:e.ThumbnailUrl,large:e.ThumbnailUrl,recommendedThumbnail:e.ThumbnailUrl});const d=new a.b(function(e){let t=a.a.OfficeFeedDocument;switch(e.toLocaleLowerCase()){case"upcomingmeeting":t=a.a.UpcomingMeeting;break;case"newsarticle":t=a.a.News;break;case"streamsvideo":t=a.a.StreamsVideo}return t}(e.Category),t,i,e.DocId,e.DriveId,e.FileName,e.Title,e.Url,e.WebUrl,null,e.LastAccessedTime,e.LastAccessedTime,null,n.a.fileTypeNameToFileType(e.FileType),0,n.a.NameToProvenance[e.Provenance],e.PathArray||(e.IsEmailAttachment?[]:l(e.Url)),r,s,o,e.Application,e.ResourceId,e.StorageHost,e.UrlAlreadyEncoded,e.IsPinned,null,null,e.Category,null,null,e.Activity,e.IsEmailAttachment,!1,null,c,null,!1,e.EmailReference,null,null,null,null,null,e.SPOId,e.IsCollab,null,e.NavigationId,h,e.FeedbackId,e.ServerDocId,null,e.TeamsDeepLink,null,null,!1,!1,null,null,null,null,null,[],null,null,null,e.MediaDuration);return"upcomingmeeting"===e.Category.toLowerCase()&&(d.startTime=e.MeetingStart,d.endTime=e.MeetingEnd,d.location=e.Location,d.attendees=e.Attendees,d.joinUrl=e.JoinUrl,d.organizer=e.Organizer,d.joinMeetingText=e.JoinMeetingText),d}function d(e,t,i,r,s,o){return new a.b(a.a.NoteBook,t,i,e.id,null,e.displayName,n.a.fileNameWithoutExtension(e.displayName),e.links.oneNoteWebUrl.href,null,null,new Date(e.lastModifiedDateTime),null,null,n.b.OneNote,null,n.a.NameToProvenance[e.displayName],l(e.links.oneNoteWebUrl.href),r,s,o,n.a.fileTypeNameFromType(n.b.OneNote),null,null,!0,!1,{fullName:e.displayName,email:null},null,null,null,null,null,!1,!1,new Date(e.createdDateTime))}function m(e,t,i,r,s,o,l,c){return new a.b(l||a.a.Form,t,i,e.id,null,e.title,n.a.fileNameWithoutExtension(e.title),e.url,null,null,new Date(e.modifiedDate),null,new Date(e.dateTimeShared),n.b.Forms,0,null,null,r,s,o,n.b[n.b.Forms],null,null,!0,!1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,{thumbnailId:e.otherInfo&&e.otherInfo.Theme&&e.otherInfo.Theme.Name?e.otherInfo.Theme.Name:null,thumbnailUrl:e.background?e.background.resourceUrl:null,thumbnailFillColor:e.otherInfo?e.otherInfo.SecondaryCustomizedThemeColor:null},null,null,null,null,null,null,null,e.id,e.ownerDisplayName,null,c||e.ownerPrincipalType,e.ownerId,!!e.softDeleted)}function p(e,t,i,r,s,o){return new a.b(a.a.ClassNoteBook,t,i,e.id,null,e.name,n.a.fileNameWithoutExtension(e.name),e.links.oneNoteWebUrl.href,null,null,new Date(e.lastModifiedTime),null,null,n.b.OneNote,null,n.a.NameToProvenance[e.name],l(e.links.oneNoteWebUrl.href),r,s,o,n.a.fileTypeNameFromType(n.b.OneNote),null,null,!0,!1,{fullName:e.lastModifiedBy,email:null},null,null,null,null,null,!1,!1,new Date(e.createdTime))}function f(e,t,i,r,s,o){let c;const u=e.SharepointIds;u&&u.ListId&&u.ListItemUniqueId&&u.SiteId&&u.SiteUrl&&u.WebId&&(c={listId:u.ListId,listItemId:null,listItemUniqueId:u.ListItemUniqueId,siteId:u.SiteId,siteUrl:u.SiteUrl,webId:u.WebId});const h=new Date(e.SharedDate),d=e.EmailReference&&1===e.EmailReference.AttachmentType;return new a.b(a.a.Shared,t,i,e.ItemId,e.DriveId,e.FileName,n.a.fileNameWithoutExtension(e.FileName),e.DocumentUrl,e.WebUrl,null,new Date(e.LastModifiedDate),null,h,n.a.fileTypeNameToFileType(e.Application),e.SharingType,n.a.NameToProvenance[e.FileName],d?[]:l(e.DocumentUrl),r,s,o,e.Application,e.ResourceId,e.StorageHost,!0,!1,null,null,null,null,null,null,!!e.EmailReference,!1,new Date(e.CreatedDate),c,null,void 0,e.EmailReference,e.SharedByUserName,e.SharedByUserEmail,null,null,null,null,null,null,null,null,null,e.ItemId,e.CreatedByUserName,null,e.OwnerType,e.OwnerId)}function g(e,t,i,r,s,c){let u=null,h=null;if(e&&e.ResourceReference&&e.ResourceReference.Id){const t=e.ResourceReference.Id.split("/");4===t.length&&(u=t[1],h=t[3])}const d=e.ResourceVisualization.LastModifiedBy?{fullName:e.ResourceVisualization.LastModifiedBy.Name,email:e.ResourceVisualization.LastModifiedBy.Address}:null,m=new Date(e.ResourceVisualization.LastModifiedDateTime),p=e.ResourceVisualization.ContainerWebUrl,f=e.ResourceVisualization.Title;return new a.b(a.a.Trending,t,i,h,u,f,f,e.ResourceReference.WebUrl,null,null,m,null,null,n.a.fileTypeNameToFileType(e.ResourceVisualization.Type),0,n.c.Substrate,l(p+"/"+f),r,s,c,e.ResourceVisualization.Type,e.Id,o.b.SharePointOnline,!0,!1,d,p)}function b(e){return{DocId:e.docId,Extension:e.extension,FileName:e.fileName,Title:e.title,Url:e.documentUrl,WebUrl:e.webUrl,LastAccessedTime:e.lastViewedTime,FileType:e.fileTypeName,Provenance:e.provenanceName,PathArray:e.pathArray,IsPinned:e.isPinned,Application:e.application,ResourceId:e.resourceId,StorageHost:e.storageHost,Category:e.mruV2Category,MruV2Type:e.mruV2Type,MruId:e.mruV2Id,Activity:e.activity,DriveId:e.driveId,EmailReference:e.emailReference,IsEmailAttachment:e.isEmailAttachment,IsLocal:e.isLocal}}},JWB6:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("6UlS"),r=i("6cfW"),s=i("Mlb/"),o=i("511z"),a=i("BMb5"),l=i("lrJm");let c=(()=>{class e{constructor(e,t,i){if(this.hasServiceWorkerApi=e,this.windowService=t,this.globalErrorHandler=i,e){const e=t.nativeWindow.navigator.serviceWorker;e.controller?this.updateCurrentState("Controlled"):(this.updateCurrentState("SupportedNotControlled"),e.ready.then(()=>{e.controller&&this.updateCurrentState("Controlled")}).catch(e=>{this.updateCurrentState("Unsupported"),Object(r.a)(e)||i.handleError(e,"E5E2n")}))}else this.updateCurrentState("Unsupported")}get stateObservable(){return this.stateSubject.asObservable()}get currentState(){return this.currentServiceWorkerState}updateCurrentState(e){this.currentServiceWorkerState=e,this.stateSubject?this.stateSubject.next(e):this.stateSubject=new n.a(e),"Controlled"!==e&&"Unsupported"!==e||this.stateSubject.complete()}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(o.a),s.cc(a.b),s.cc(l.b))},token:e,providedIn:"root"}),e})()},"L/Tc":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.Edit=2]="Edit",e[e.Comment=3]="Comment",e[e.Mention=4]="Mention",e}({})},"L9A/":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},MFXD:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("EYJY"),r=i("FwwM");class s{constructor(){this.onlyFuture=new n.a,this.pastAndFuture=new r.a}withScope(e){switch(e){case 1:return this.onlyFuture.asObservable();case 0:return this.pastAndFuture.asObservable();default:throw new Error("Unknown Observable Scope")}}next(e){this.onlyFuture.next(e),this.pastAndFuture.next(e)}asScopableObservable(){return this}}},NdOS:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},OMbk:function(e,t,i){},OPwp:function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return p}));var n=i("EYJY"),r=i("70cc"),s=i("O6Zd"),o=i("BaAg"),a=i("p6Zr"),l=i("pjz5"),c=i("Mlb/"),u=i("kpuN"),h=i("4/We"),d=i("w1PR"),m=function(e){return e[e.Share=1]="Share",e[e.CopyLink=2]="CopyLink",e[e.AtMention=3]="AtMention",e[e.LinkSettings=4]="LinkSettings",e[e.ManageAccess=5]="ManageAccess",e[e.Notify=6]="Notify",e[e.AddPeople=7]="AddPeople",e}({});let p=(()=>{class e{constructor(e,t,i){this.accessTokenService=e,this.capabilitiesService=t,this.themingService=i,this.shareControl=new n.a,this.capabilitiesService.capabilities.darkModeEnabled&&this.capabilitiesService.capabilities.reactShellEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe(e=>{this.isDarkMode=e}))}static getShareControlModeFromString(e){switch(e){case"copy":return m.CopyLink;case"atMention":return m.AtMention;case"linkSettings":return m.LinkSettings;case"manageAccess":return m.ManageAccess;case"notify":return m.Notify;case"addPeople":return m.AddPeople;default:return m.Share}}ngOnDestroy(){this.themeShadesSubscription&&this.themeShadesSubscription.unsubscribe()}getToken(e,t=null){const i=l.a.getLocation(e),n=i?`${i.protocol}//${i.hostname}`:"";return null===t&&(t=this.getTokenType(e)),this.accessTokenService.getAccessToken(t,!1,n)}getTokenType(e){return o.a.referralFromFileLocation(e)===a.a.OneDrive?"OneDrive":"SharePoint"}showControl(e){this.updateNext(e,0)}hideControl(e){this.updateNext(e,1)}subscribeToOpenEvents(e){return this.shareControl.asObservable().pipe(Object(r.a)(e=>e&&0===e.type),Object(s.a)(e=>e.shareControl)).subscribe(e)}subscribeToCloseEvents(e){return this.shareControl.asObservable().pipe(Object(r.a)(e=>e&&1===e.type),Object(s.a)(e=>e.shareControl)).subscribe(e)}getDarkMode(){return this.isDarkMode}updateNext(e,t){e&&e.file&&null!=e.index&&this.shareControl.next({type:t,shareControl:e})}}return e.ɵprov=c.bc({factory:function(){return new e(c.cc(u.a),c.cc(h.a),c.cc(d.a))},token:e,providedIn:"root"}),e})()},OyI4:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("BaAg"),r=i("pOWU"),s=i("uUrA");let o=(()=>{class e extends r.a{constructor(e,t,i,n,r,s,o,a,l,c,u,h){super(e,t,i,"MruPlusPlus",n,r,o,h),this.globalErrorHandler=a,this.startupConfigService=l;const d=this.contextService.sharedContext,m=s.config;this.supportedApps=u,this.serviceBaseUrl=this.inMockMode?`${d.officeHomeApiRoot}/${c}`:`${m.mruServiceRoot}/${c}`}requestParams(t,i){const r=i&&i.size?this.supportedApps.filter(e=>i.has(n.a.fileTypeNameToFileType(e))):this.supportedApps;return`${e.appSpecifier}${r.join(",")}&${e.sizeSpecifier}${t}&${e.localeSpecifier}${this.contextService.sharedContext.officeMarket}`}getNewRequestConfig(e){return{headers:this.requestHeaders(e,s.a.createGuid())}}getRequestIdFromResponse(e){return super.getRequestIdFromResponse(e,"X-CorrelationId")}requestHeaders(e,t){const i=this.startupConfigService.config.sharedClientStartupContext,n=new Map([["X-Office-Platform","Web"],["X-Office-Application",this.contextService.sharedContext.iceApplicationId.toString()],["X-Office-Version",i.buildId],["X-CorrelationId",t]]);return e&&n.set("Content-Type","application/json"),n}}return e.localeSpecifier="rs=",e.sizeSpecifier="show=",e.appSpecifier="apps=",e})()},P9EA:function(e,t,i){},PBJH:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("BaAg"),r=i("Mlb/"),s=i("/I02"),o=i("dFxn"),a=i("BMb5");let l=(()=>{class e{constructor(e,t,i){this.windowService=i,this.dateFormatOptionsMap=new Map,this.intlSupported=!0,this.officeMarket=e.sharedContext.officeMarket,this.setSupportsLocaleSpecifiers(),this.dateFormatOptionsMap.set(1,{year:"numeric",month:"short",day:"numeric"}),this.dateFormatOptionsMap.set(2,{year:"numeric",month:"long",day:"numeric",weekday:"long"}),this.dateFormatOptionsMap.set(3,{day:"numeric",weekday:"short"}),this.dateFormatOptionsMap.set(4,{day:"numeric",weekday:"long"}),this.dateFormatOptionsMap.set(5,{month:"short",day:"numeric"}),this.dateFormatOptionsMap.set(6,{weekday:"short"}),this.dateFormatOptionsMap.set(7,{hour:"numeric",minute:"numeric"}),this.intlDateFormatterMap=new Map,this.tryInitializeIntlFormatter();const n=t.parse("resourceStrings");n&&Object.assign&&Object.assign(this,n)}appResource(e,t){return this[`${e}${n.b[t]}`]||this[e]}format(e,...t){return class{static format(e,...t){if(!e)return e;let i=e;for(let e=0;e<t.length;e++){const n=new RegExp("\\{"+e+"\\}","gi");i=i.replace(n,()=>t[e])}return i}static getDuplicateItemName(e){const t=e.match(/(.*)\(([0-9]+)\)$/i),i=(e,t)=>e.trim()+` (${t})`;return t?i(t[1],parseInt(t[2])+1):i(e,2)}}.format(e,...t)}localizedDateString(e){return this.formatDate(e,0)}localizedDateStringMedium(e){return this.formatDate(e,1)}localizedDateStringLong(e){return this.formatDate(e,2)}localizedWeekdayDate(e){return this.formatDate(e,3)}localizedWeekdayDateLong(e){return this.formatDate(e,4)}localizedMonthDate(e){return this.formatDate(e,5)}localizedWeekday(e){return this.formatDate(e,6)}formatTimeFromDate(e){return this.intlSupported&&this.intlDateFormatterMap&&(this.intlDateFormatterMap.has(7)||this.tryInitializeIntlFormatter(7))?this.intlDateFormatterMap.get(7).format(e):this.supportsLocaleSpecifiers&&this.dateFormatOptionsMap?e.toLocaleTimeString(this.officeMarket,this.dateFormatOptionsMap.get(7)):e.toTimeString()}localizedNumberString(e){return this.intlNumberFormatter?this.intlNumberFormatter.format(e):this.supportsLocaleSpecifiers?e.toLocaleString(this.officeMarket):e.toString()}appName(e){switch(e){case n.b.Word:return this.WordName;case n.b.Excel:return this.ExcelName;case n.b.PowerPoint:return this.PowerPointName;case n.b.Sway:return this.SwayName;case n.b.OneNote:return this.OneNoteName;case n.b.Visio:return this.VisioName;case n.b.Forms:case n.b.FormsQuiz:return this.FormsName}return""}tryInitializeIntlFormatter(e){if(!this.intlSupported)return!1;try{if("Intl"in this.windowService.nativeWindow)return e?(this.intlDateFormatterMap.set(e,new Intl.DateTimeFormat(this.officeMarket,this.dateFormatOptionsMap.get(e))),this.dateFormatOptionsMap.delete(e),0===this.dateFormatOptionsMap.size&&(this.dateFormatOptionsMap=null)):(this.intlDateFormatterMap.set(0,new Intl.DateTimeFormat(this.officeMarket)),this.intlNumberFormatter=new Intl.NumberFormat(this.officeMarket)),!0}catch(e){}return this.intlSupported=!1,this.intlDateFormatterMap=null,this.intlNumberFormatter=null,this.dateFormatOptionsMap=null,!1}formatDate(e,t){if(this.intlSupported&&this.intlDateFormatterMap&&(this.intlDateFormatterMap.has(t)||this.tryInitializeIntlFormatter(t)))return this.intlDateFormatterMap.get(t).format(e);if(this.supportsLocaleSpecifiers){if(0===t)return e.toLocaleDateString(this.officeMarket);if(this.dateFormatOptionsMap){const i=this.dateFormatOptionsMap.get(t);return e.toLocaleDateString(this.officeMarket,i)}}return e.toDateString()}setSupportsLocaleSpecifiers(){this.supportsLocaleSpecifiers=(()=>{try{(0).toLocaleString("i")}catch(e){return"RangeError"===e.name}return!1})()}}return e.ɵprov=r.bc({factory:function(){return new e(r.cc(s.a),r.cc(o.a),r.cc(a.b))},token:e,providedIn:"root"}),e})()},PZOQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e){this.locService=e}transform(e){return this.formatDataSize(e)}formatDataSize(e){let t=4,i=0;for(;i<1&&t>=0;)i=e/Math.pow(1024,t),t--;const n=i<10&&i%1>=.1?10:1;i=Math.round(i*n)/n;const r=this.locService.localizedNumberString(i);let s="";switch(t){case 3:s=this.locService.Terabytes;break;case 2:s=this.locService.Gigabytes;break;case 1:s=this.locService.Megabytes;break;case 0:s=this.locService.Kilobytes;break;case-1:s=this.locService.Bytes}return`${r} ${s}`}}},PkQn:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("Mlb/"),r=i("A/um");let s=(()=>{class e{static getCssClass(t,i){return e.getCssClassFromGlyphName(r.a[t],i)}static getCssClassFromGlyphName(t,i){let n=e.iconTypeToCssClass[t];return i&&(n=`${n} ${e.SvgIconCssClass}`),n||"ms-Icon--placeholder"}}return e.FluentIconCssClass="ms-ohp-Icon",e.SvgIconCssClass="ms-ohp-svg-Icon",e.iconTypeToCssClass={Accepted:"ms-ohp-Icon--accepted",Add:"ms-ohp-Icon--add",AddTo:"ms-ohp-Icon--addTo",Alert:"ms-ohp-Icon--alert",ArrowLeft:"ms-ohp-Icon--back",ArrowRight:"ms-ohp-Icon--forward",At:"ms-ohp-Icon--accounts",Calendar:"ms-ohp-Icon--calendar",Chat:"ms-ohp-Icon--chatSolid",CheckMark:"ms-ohp-Icon--checkMark",ChevronDown:"ms-ohp-Icon--chevronDown",ChevronLeft:"ms-ohp-Icon--chevronLeft",ChevronRight:"ms-ohp-Icon--chevronRight",ChevronUp:"ms-ohp-Icon--chevronUp",CircleInfo:"ms-ohp-Icon--circleInfo",Comment:"ms-ohp-Icon--chat",Compass:"ms-ohp-Icon--compassNW",Copy:"ms-ohp-Icon--copy",Declined:"ms-ohp-Icon--declined",Delete:"ms-ohp-Icon--delete",Diamond:"ms-ohp-Icon--diamond",Document:"ms-ohp-Icon--page",Download:"ms-ohp-Icon--download",Ellipsis:"ms-ohp-Icon--moreVertical",Excel:"ms-ohp-Icon--excelLogo",Filter:"ms-ohp-Icon--filter",FilterSolid:"ms-ohp-Icon--filterSolid",Folder:"ms-ohp-Icon--folder",FolderOpen:"ms-ohp-Icon--openFolderHorizontal",Glimmer:"ms-ohp-Icon--glimmer",Group:"ms-ohp-Icon--group",Home:"ms-ohp-Icon--home",Link:"ms-ohp-Icon--link",ListBullets:"ms-ohp-Icon--list",Location:"ms-ohp-Icon--location",Mail:"ms-ohp-Icon--mail",Minus:"ms-ohp-Icon--remove",Move:"ms-ohp-Icon--moveToFolder",News:"ms-ohp-Icon--newsfeedLogo",OfficeForms:"ms-ohp-Icon--formsLogo",Office:"ms-ohp-Icon--officeLogo",OfficeStore:"ms-ohp-Icon--officeStore",OfficeThreshold:"ms-Icon--officeThreshold",OneDrive:"ms-ohp-Icon--oneDriveLogo",Outlook:"ms-ohp-Icon--outlookLogo",Onenote2:"ms-ohp-Icon--onenoteLogo",Page:"ms-ohp-Icon--page",Pencil:"ms-ohp-Icon--edit",PencilSolid:"ms-ohp-Icon--editSolid",People2:"ms-ohp-Icon--people",Person:"ms-ohp-Icon--person",PhotoVideoMedia:"ms-ohp-Icon--photoVideoMedia",PinDown:"ms-ohp-Icon--pinned",PowerPoint:"ms-ohp-Icon--powerpointLogo",Preview:"ms-ohp-Icon--preview",PreviewLink:"ms-ohp-Icon--previewLink",Question:"ms-ohp-Icon--question",RedEye:"ms-ohp-Icon--redEye",Restore:"ms-ohp-Icon--revToggleKey",Save:"ms-ohp-Icon--save",Search:"ms-ohp-Icon--search",Share2:"ms-ohp-Icon--share",SkypeForBusiness:"ms-ohp-Icon--skypeForBusinessLogo",SortDown:"ms-ohp-Icon--sortDown",SortUp:"ms-ohp-Icon--sortUp",Sync:"ms-ohp-Icon--sync",Sway:"ms-ohp-Icon--swayLogo",Teams:"ms-ohp-Icon--teamsLogo",TentativelyAccepted:"ms-ohp-Icon--tentativelyAccepted",TextDocument:"ms-ohp-Icon--textDocument",ToDo:"ms-ohp-Icon--toDoLogoInverse",TileView:"ms-ohp-Icon--viewAll",Trending:"ms-ohp-Icon--trending12",Unpin:"ms-ohp-Icon--unpin",Upload:"ms-ohp-Icon--upload",Video:"ms-ohp-Icon--video",Waffle:"ms-ohp-Icon--waffle",Word:"ms-ohp-Icon--wordLogo",X:"ms-ohp-Icon--cancel",X2:"ms-ohp-Icon--cancel"},e})();class o{constructor(e){this.capabilitiesService=e,this.iconClicked=new n.n}ngOnInit(){this.classAttrValue=this.getClasses(),this.styleAttrValue=this.getStyle()}ngOnChanges(e){(e.hasOwnProperty("iconFontCssClass")||e.hasOwnProperty("iconFontType")||e.hasOwnProperty("iconFontName")||e.hasOwnProperty("cssClass"))&&(this.classAttrValue=this.getClasses()),(e.hasOwnProperty("size")||e.hasOwnProperty("color"))&&(this.styleAttrValue=this.getStyle())}handleClick(){this.iconClicked.emit()}getClasses(){let e=this.iconFontCssClass?this.iconFontCssClass:s.FluentIconCssClass;const t=this.capabilitiesService.capabilities.svgAppIconsEnabled;return this.iconFontCssClass||(this.iconFontName?e+=" "+s.getCssClassFromGlyphName(this.iconFontName,t):void 0!==this.iconFontType&&(e+=" "+s.getCssClass(this.iconFontType,t))),this.cssClass&&(e+=" "+this.cssClass),this.isThirdParty&&(e+=" ms-ohp-Icon"),e}getStyle(){const e=this.style?this.style:{};return this.size&&(e["font-size"]=this.size+"px"),this.color&&(e.color=this.color),e}}},QOOv:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("dFxn");let s=(()=>{class e{constructor(e){this.config=e.parse("mruConfig")||{activityEnabled:!1,activityStrings:{},addWacParams:!1,analyticsCachingEnabled:!1,analyticsEnabled:!1,clickableFolderEnabled:!1,copyLinkEnabled:!1,deferFeedWrite:!1,infiniteShowMoreEnabled:!1,isNewLifecycleEventEnabled:!1,isNewTimeWindowInHours:0,logThumbnailLoadSuccess:!1,maxInitialListItems:0,maxTotalListItems:0,mobileShareAndActivityEnabled:!1,mruActivityEnabled:!1,mruNumItemsToRequest:0,mruPinEnabled:!1,mruServiceRoot:null,newMruActions:!1,numRecommendedToRequest:0,officeFeedApiRootPath:"",officeFeedControlEnabled:!1,officeFeedFlightEnabled:!1,officeFeedFlightName:"",officeFeedFlightControlName:"",officeFeedExperimentName:"",officeFeedExperimentControlName:"",oneDriveDiscoverViewId:null,oneDriveRecentViewId:null,oneDriveSharedViewId:null,onlyMruActivityEnabled:!1,permissionsEnabled:!1,recommendedApiDismissedDocumentsPath:"",recommendedB2ApiRootPath:"",recommendedB2ApiFilesPath:"",recommendedB2EndpointEnabled:!1,recommendedCalloutEnabled:!1,recommendedEnabled:!1,recommendedFluidEnabled:!1,recommendedMotionEnabled:!1,recommendedNewCardsEnabled:!1,recommendedPdfEnabled:!1,recommendedRemoveItemEnabled:!1,recommendedVisioEnabled:!1,shareApiEndpoint:null,shareControlEnabled:!1,sharedAttachmentsEnabled:!1,sharedWithMeV2Enabled:!1,sharedWithMeViewEnabled:!1,sharingStatusEnabled:!1,showDownloadAction:!1,showZeroExperience:!1,substrateApiEndpoint:null,supportedFileTypes:[],supportedFileTypesSwM:[],swayTransformedFromWordAttributionEnabled:!1,tileViewEnabled:!1,thumbnailSWEnabled:!1,trendingDocsEnabled:!1,webUrlMruConsumerEnabled:!1,wordIconFontClass:"",excelIconFontClass:"",visioIconFontClass:"",powerPointIconFontClass:"",oneNoteIconFontClass:"",swayIconFontClass:"",formsIconFontClass:"",powerBIIconFontClass:"",silentS2SFlow:!1,upcomingMeetingAttendeeDisplayMax:0,upcomingMeetingEnabled:!1}}}return e.unpinnedListId="unpinned-mru",e.pinnedListId="pinned-mru",e.sharedListId="shared-mru",e.trendingListId="trending-docs",e.classNoteBookListId="classNotebook-mru",e.appItemListId="app-items-mru",e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a))},token:e,providedIn:"root"}),e})()},QhWD:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("bb6g"),r=i("CCRL"),s=i("Mlb/");class o{shouldLoad(){return Object(n.b)(this,void 0,void 0,(function*(){}))}}class a{constructor(e,t){this.scheduler=e,this.modulePriorityService=t}shouldLoad(e){const t=this.modulePriorityService.getSchedulePriority(e);return new Promise(e=>this.scheduler.scheduleWork(e,t))}}var l=i("cgnd"),c=i("casz"),u=i("RsrG");let h=(()=>{class e{}return e.ɵprov=s.bc({factory:function(){return((e,t,i)=>{try{switch(e.config.chunkLoadStrategy){case"idle-callback":return new a(t,i);case"noop":default:return new o}}catch(e){return new o}})(s.cc(l.b),s.cc(c.a),s.cc(u.a))},token:e,providedIn:"root"}),e})(),d=(()=>{class e{constructor(e,t,i){this.ngModuleLoader=e,this.injector=t,this.downloadStrategy=i,this.ngModuleCache=new Map}loadLazyViewFromModule(e){return Object(n.b)(this,void 0,void 0,(function*(){let t=this.ngModuleCache.get(e);t||(yield this.downloadStrategy.shouldLoad(e),t=(yield this.ngModuleLoader.load(e)).create(this.injector),this.ngModuleCache.set(e,t));const{injector:i,componentFactoryResolver:n}=t,s=i.get(r.a);return n.resolveComponentFactory(s)}))}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(s.w),s.cc(s.o),s.cc(h))},token:e,providedIn:"root"}),e})()},R0N1:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e){this.contextService=e}ngOnInit(){this.target=this.contextService.sharedContext.defaultLinkTarget}}},R4AA:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("BMb5");let s=(()=>{class e{constructor(e){this.windowService=e,this.ntpApi=this.windowService.nativeWindow.chrome&&this.windowService.nativeWindow.chrome.embeddedSearch&&this.windowService.nativeWindow.chrome.embeddedSearch.newTabPage}isAvailable(){return!!this.ntpApi}logHistogram(e){return!!this.ntpApi&&(this.ntpApi.logEvent(e),!0)}isDarkMode(){return this.ntpApi&&this.ntpApi.themeBackgroundInfo&&this.ntpApi.themeBackgroundInfo.isNtpBackgroundDark}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.b))},token:e,providedIn:"root"}),e})()},R7NL:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("nTqU"),r=i("9W+p"),s=i("Ft/N"),o=i("3GGT"),a=i("Uqr9"),l=i("hhzZ"),c=i("Mlb/"),u=i("/I02"),h=i("cgnd"),d=i("BMb5"),m=i("wwmn"),p=i("JWB6"),f=i("+2OL"),g=i("5MEU");class b{constructor(e){this.promise=e}get[Symbol.toStringTag](){return"Promise"}instrument(e){return this.instrumentCallback=e,this}then(e,t){return this.promise.then(e,t)}catch(e){return this.promise.catch(e)}finally(e){return this.promise.finally(e)}}let v=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l){this.httpClient=e,this.contextService=t,this.startupConfigService=i,this.instrumentationService=n,this.windowService=r,this.serviceWorkerStateService=o,this.serviceWorkerConfigService=a,this.workloadQueryParameterValue=l,this.officeHomeApiConfig=s.config}request(t,i,s,c,u,h,d){const m=a.a.now();let p=0;const f="cache-only"===s,g=new Promise((t,a)=>{if(f){const t=this.serviceWorkerConfigService.config.enabled;if(!t||"Controlled"!==this.serviceWorkerStateService.currentState)return void a(e.failedResponseWithCode(o.a.NotImplemented,i,f,`Cache is not available. Service Worker is in ${t?this.serviceWorkerStateService.currentState:"disabled"} state`))}this.prepareRequest(i,s);const l={};i.headers&&i.headers.forEach((e,t)=>{l[t]=e});const m=!!c||!!u,p=m?"events":"response",g={headers:new n.i(l),params:new n.j({fromObject:i.params}),method:i.method,reportProgress:m,responseType:i.responseType,observe:p},b=new n.k(i.method,i.url,i.body,g),v=e=>{let t;return e instanceof n.l?t=e.body:e instanceof n.f&&(t=e.error),{data:t,status:e.status,headers:e.headers,config:i,ok:e.ok,statusText:e.statusText,fromCache:f}},S=this.httpClient.request(b).pipe(Object(r.a)(d||this.officeHomeApiConfig.defaultTimeoutInMs)).subscribe(e=>{e instanceof n.l?t(v(e)):e.type===n.g.UploadProgress&&c?c(e):e.type===n.g.DownloadProgress&&u&&u(e)},t=>{if("TimeoutError"===t.name)return void a(e.failedResponseWithCode(o.a.Timeout,i,f));const n=this.windowService.nativeWindow.navigator;a(!n||"boolean"!=typeof n.onLine||n.onLine?v(t):e.failedResponseWithCode(o.a.Offline,i,f))});h&&h.onCancel(()=>S.unsubscribe())}),v=new b(g),S=i=>{if(i.fromCache&&!i.ok&&i.status===o.a.NotImplemented)return;p=Math.ceil(a.a.now()-m);let n=i.status;null==n&&(n=e.unknownStatusCode);const r=i.statusText;let s;s=null==r?e.unknownError:"ok"===r.toLowerCase()?r:new l.d(r);const c=this.instrumentationService.generateRequestEvent(t,n,p,s,i.fromCache);v.instrumentCallback&&v.instrumentCallback(i,c),c.record()},y=h?h.onCancel(()=>Promise.resolve(e.failedResponseWithCode(o.a.Cancelled,i,f))):new Promise(()=>{});return Promise.race([g,y]).then(S,S),v}get(e,t,i,n,r,s,o){const a=Object.assign({},i);return a.url=t,a.method="GET",this.request(e,a,n,null,r,s,o)}post(e,t,i,n={},r,s,o,a,l){const c=Object.assign({},n);return c.url=t,c.method="POST",c.body=i,this.request(e,c,l||"network-only",r,s,o,a)}put(e,t,i,n={},r,s,o,a){const l=Object.assign({},n);return l.url=t,l.method="PUT",l.body=i,this.request(e,l,"network-only",r,s,o,a)}delete(e,t,i,n={},r,s){const o=Object.assign({},n);return o.url=t,o.method="DELETE",o.body=i,this.request(e,o,"network-only",null,null,r,s)}patch(e,t,i,n={},r,s,o,a){const l=Object.assign({},n);return l.url=t,l.method="PATCH",l.body=i,this.request(e,l,"network-only",r,s,o,a)}static failedResponseWithCode(e,t,i,r){return{data:null,status:e,headers:new n.i,config:t,ok:!1,statusText:r||o.a[e],fromCache:i}}prepareRequest(e,t){if("Controlled"===this.serviceWorkerStateService.currentState&&this.serviceWorkerConfigService.config.enabled&&(e.headers?e.headers.forEach((t,i)=>{if(void 0===t){e.headers.set(i,"");const t={ItemCategory:"Malformed Request"};t.Error="Undefined header passed to Service Worker: "+i,this.instrumentationService.logGenericEvent("Unhandled_Exception",t)}}):e.headers=new Map,e.headers.set(s.a,t)),0===e.url.lastIndexOf(this.contextService.sharedContext.officeHomeApiRoot+"/",0)){e.headers||(e.headers=new Map);const t=this.officeHomeApiConfig,i=this.startupConfigService.config;t.correlationIdHeader&&i.sharedClientStartupContext.correlationId&&e.headers.set(t.correlationIdHeader,i.sharedClientStartupContext.correlationId),t.userIdHeader&&i.puid&&e.headers.set(t.userIdHeader,i.puid),t.tenantIdHeader&&i.tenantId&&e.headers.set(t.tenantIdHeader,i.tenantId),t.authTypeHeader&&i.authTypeString&&e.headers.set(t.authTypeHeader,i.authTypeString),e.params||(e.params={}),t.workloadQueryParameter&&(e.params[t.workloadQueryParameter]=this.workloadQueryParameterValue),i.sharedClientStartupContext.testTraffic&&t.testTrafficHeader&&e.headers.set(t.testTrafficHeader,"1"),!i.sharedClientStartupContext.corpNet&&t.externalTrafficHeader&&e.headers.set(t.externalTrafficHeader,"1"),(t.flightOverridesParamName&&t.flightOverrides||t.featureOverridesParamName&&t.featureOverrides)&&(t.flightOverridesParamName&&t.flightOverrides&&!e.params.hasOwnProperty(t.flightOverridesParamName)&&(e.params[t.flightOverridesParamName]=t.flightOverrides),t.featureOverridesParamName&&t.featureOverrides&&!e.params.hasOwnProperty(t.featureOverridesParamName)&&(e.params[t.featureOverridesParamName]=t.featureOverrides))}}}return e.unknownError="NotAvailable",e.unknownStatusCode=-1,e.ɵprov=c.bc({factory:function(){return new e(c.cc(n.c),c.cc(u.a),c.cc(h.b),c.cc(l.a),c.cc(d.b),c.cc(m.a),c.cc(p.a),c.cc(f.a),c.cc(g.a))},token:e,providedIn:"root"}),e})()},"RR/o":function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return u}));var n=i("kaEK"),r=i("BaAg"),s=i("pOWU"),o=i("CVeG"),a=i("oAX+"),l=i("OyI4"),c=function(e){return e[e.Default=0]="Default",e[e.FrequentlyOpen=1]="FrequentlyOpen",e[e.RecentlyOpen=2]="RecentlyOpen",e[e.WeeklyOpen=3]="WeeklyOpen",e[e.SingleEditYou=4]="SingleEditYou",e[e.MultipleEditYouAndOthers=5]="MultipleEditYouAndOthers",e[e.SingleCommentYou=6]="SingleCommentYou",e[e.MultipleCommentYouAndOthers=7]="MultipleCommentYouAndOthers",e[e.CommentReplyYou=8]="CommentReplyYou",e[e.SharedWithMe=9]="SharedWithMe",e[e.EmailAttachment=10]="EmailAttachment",e[e.SingleMentionYou=11]="SingleMentionYou",e[e.MultipleMentionYouAndOthers=12]="MultipleMentionYouAndOthers",e[e.CommentReplyOthers=13]="CommentReplyOthers",e[e.SnoozeExpiry=14]="SnoozeExpiry",e[e.CommentReplyToYou=15]="CommentReplyToYou",e[e.SingleEditOthers=16]="SingleEditOthers",e[e.MultipleEditOthers=17]="MultipleEditOthers",e[e.SingleCommentOthers=18]="SingleCommentOthers",e[e.MultipleCommentOthers=19]="MultipleCommentOthers",e[e.SingleMentionOthers=20]="SingleMentionOthers",e[e.MultipleMentionOthers=21]="MultipleMentionOthers",e[e.Trending=22]="Trending",e[e.Meeting=23]="Meeting",e[e.PeakMoment=24]="PeakMoment",e[e.HighEngagement=25]="HighEngagement",e[e.SingleMentionedYou=26]="SingleMentionedYou",e[e.MultipleMentionedYou=27]="MultipleMentionedYou",e}({});let u=(()=>{class e extends l.a{constructor(e,t,i,n,r,s,o,a,l,c,u,h,d,m,p,f){super(e,t,i,n,r,o,a,l,c,"v2/recent",o.config.supportedFileTypes,d),this.userContextService=s,this.mruConfigService=o,this.performanceService=u,this.updateContentService=h,this.windowService=m,this.capabilitiesService=p,this.urlAuthenticatorService=f,this.fetchRequestIndex=0,this.mruDataStreams=new Map,this.windowService=m}static convertMruActivityToActivityDescription(t){let i=t.badge.message_format,n=null;for(;null!==(n=e.activityRegex.exec(i));){const e=n[1];i=i.replace(n[0],()=>`<c${e}>${t.badge.users[e].display_name}</c${e}>`)}return{formatString:i,plainText:o.a.stripTags(i),people:(t.badge.users||[]).map((function(e,t){return{upn:e.upn,tag:"c"+t,name:e.display_name}})),reasonType:e.convertMruReasonTypeToActivityReason(t.badge.type),timestamp:t.badge.timestamp?new Date(t.badge.timestamp):null}}static convertMruReasonTypeToActivityReason(e){switch(e){case c.FrequentlyOpen:case c.RecentlyOpen:case c.WeeklyOpen:return n.a.Open;case c.SingleEditYou:case c.MultipleEditOthers:case c.MultipleEditYouAndOthers:case c.SingleEditOthers:return n.a.Edit;case c.SingleCommentYou:case c.SingleCommentOthers:case c.MultipleCommentOthers:case c.MultipleCommentYouAndOthers:case c.CommentReplyYou:case c.CommentReplyOthers:case c.CommentReplyToYou:return n.a.Comment;case c.SharedWithMe:return n.a.Share;case c.EmailAttachment:return n.a.Attachment;case c.SingleMentionYou:case c.MultipleMentionYouAndOthers:case c.SingleMentionOthers:case c.MultipleMentionOthers:case c.SingleMentionedYou:case c.MultipleMentionedYou:return n.a.Mention;case c.SnoozeExpiry:return n.a.SnoozeExpiry;case c.Trending:case c.PeakMoment:case c.HighEngagement:return n.a.Trending;case c.Meeting:return n.a.Meeting;default:return n.a.Default}}getMruDocuments(t){const i=this.getUrl(t),n=!(!t||!t.size);if(this.mruDataStreams.has(i))return this.mruDataStreams.get(i);let s;n&&this.mostRecentUnfilteredDocs&&this.mostRecentUnfilteredDocs.items&&(s=this.mostRecentUnfilteredDocs.items.filter(e=>t.has(r.a.fileTypeNameToFileType(e.FileType))));const o=s&&s.length?Promise.resolve({items:s,impressionId:e.mruPlusPlusV2ImpressionId,fromCache:!0}):this.fetchMru(i,"cache-only",n),l=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchMru(n,i):this.fetchMru(i,"network-first",n),c=this.updateContentService.getOrAddUpdateStream(this.getUpdateStreamKey(i),()=>this.fetchMru(i,"network-first",n)),u=a.a.createResultsWithCacheObservable(o,l,c,e=>this.mruDataStreams.delete(i));if(this.mruDataStreams.set(i,u),this.mruConfigService.config.silentS2SFlow){const e=this.getS2SUrl(t);this.fetchMru(e,"network-only",n,!0)}return u}updateMruDocuments(e){return this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e)))}removeDocument(e){return new Promise((t,i)=>{this.delete("Mru_Delete",this.serviceBaseUrl,{category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url},e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(()=>t(null))},i,this.getNewRequestConfig(!0))})}updatePinnedState(e){return new Promise((t,i)=>{this.post("Mru_Update_Pin",this.serviceBaseUrl,{category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url,is_pinned:e.IsPinned},e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(()=>t(null))},i,this.getNewRequestConfig(!0))})}writeMruDocument(e){return new Promise((t,i)=>{const n={category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url,extension:r.a.getFileExtensionFromUrl(e.Url),title:e.Title,onedrive_info:{drive_id:e.DriveId,item_id:e.DocId}};this.post("Mru_Write",this.serviceBaseUrl,n,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(()=>t(null))},i,this.getNewRequestConfig(!0))})}handleQueryParam(e,t,i){"mockmru"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}isAuthError(e){return super.isAuthError(e)||-1===e}static isPwaProject(e){return e.meta_data&&"PJO"===e.meta_data.type&&e.app.toLowerCase()===r.b[r.b.Project].toLowerCase()}static fileType(e){let t=r.a.fileTypeFromExtension(e.extension);return t&&t!==r.b.None||(t=r.a.fileTypeNameToFileType(e.app)),t}getUrl(e){if(this.startupConfigService.config.sharedClientStartupContext.useMruS2SFlow)return this.getS2SUrl(e);const t=this.requestParams(this.mruConfigService.config.mruNumItemsToRequest,e);return`${this.serviceBaseUrl}/docs?${t}`}getS2SUrl(e){const t=this.requestParams(this.mruConfigService.config.mruNumItemsToRequest,e);return`${this.contextService.sharedContext.officeHomeApiRoot}/api/mru?${t}`}getUpdateStreamKey(e){return"mruplusplusv2-"+e}fetchMru(t,i,n,o=!1){return new Promise((a,l)=>{if(!this.userContextService.user.mruAvailable)return void l(new s.b(null,"User does not have an MRU"));let c,u,h;this.startupConfigService.config.sharedClientStartupContext.useMruS2SFlow||o?(c="None",u={},h="Mru_S2S_Request"):(c="MruPlusPlus",u=this.getNewRequestConfig(!1),h="Mru_Request"),this.get(h,t,i=>{i.instrument((i,n)=>{n.params.RequestId=this.getRequestIdFromResponse(i),n.params.Index=(this.fetchRequestIndex++).toString(),n.params.ImpressionId=e.mruPlusPlusV2ImpressionId;const s=i.headers;s&&(n.params.PartnerGeo=s.get("X-OfficeCluster")),i.data&&i.data.diagnostics_data&&void 0!==i.data.diagnostics_data.total_duration&&(n.params.MruDuration=i.data.diagnostics_data.total_duration.toString());const o=this.performanceService.getResourceTimingEntries(t);if(o&&o.length){const e=o[o.length-1];e.workerStart&&e.responseStart&&(n.params.ServiceWorkerProcessingLatency=Math.ceil(e.responseStart-e.workerStart).toFixed())}if(i.ok&&i.data){let t;t=i.data.documents&&i.data.documents.items?i.data.documents.items:[];const s=t.length;this.mruConfigService.config.mruPinEnabled&&this.mruConfigService.config.recommendedEnabled&&t.sort((e,t)=>new Date(t.time_stamp).getTime()-new Date(e.time_stamp).getTime()),n.params.ActualSize=s.toString(),n.params.Distribution=r.a.distributionFromFileTypes(t.map(t=>e.fileType(t))),n.params.MruPlusPlusV2MetaDataDistribution=t.map(e=>this.checkMetaData(e)?1:0).toString(),this.mruConfigService.config.recommendedEnabled&&(n.params.ResourceIdDistribution=t.slice(0,12).map(e=>e.resource_id).toString())}}).then(({data:e,fromCache:t})=>{if(o)a();else{const i=this.processMruData(e,n,t);a(i)}}).catch(e=>{this.globalErrorHandler.handleError(e,"hJU2J")})},l,u,i,null,null,null,c)})}prefetchMru(e,t){return this.windowService.nativeWindow.prefetchMruDataPromise?new Promise(t=>{this.windowService.nativeWindow.prefetchMruDataPromise.then(i=>{const n=this.processMruData(i,e,!1);t(n)}).catch(e=>{this.globalErrorHandler.handleError(e,"hJU2J")})}):this.fetchMru(t,"network-first",e)}checkMetaData(e){return e.onedrive_info&&!!e.onedrive_info.drive_id&&!!e.onedrive_info.item_id&&e.creation_info&&!!e.creation_info.timestamp&&e.sharepoint_info&&!!e.sharepoint_info.site_url}mruItemFromMruPlusPlusV2Item(t){const i=this.mruConfigService.config,n=new Date(t.time_stamp),s=i.swayTransformedFromWordAttributionEnabled;t.onedrive_info=t.onedrive_info||{},t.sharepoint_info=t.sharepoint_info||{},t.creation_info=t.creation_info||{},t.meta_data=t.meta_data||{};const o={DriveId:t.onedrive_info.drive_id,ItemId:t.onedrive_info.item_id,CreatedByUserEmail:t.creation_info.user_info&&t.creation_info.user_info.upn,CreatedByUserName:t.creation_info.user_info&&t.creation_info.user_info.display_name,CreatedDate:t.creation_info.timestamp,SPListId:t.sharepoint_info.list_id,SPListItemUniqueId:t.sharepoint_info.list_item_unique_id,SPSiteId:t.sharepoint_info.site_id,SPSiteUrl:t.sharepoint_info.site_url,SPWebId:t.sharepoint_info.web_id,SwayMetaData:{ThumbnailId:t.meta_data.SwayThumbnail,IsTransformedFromWord:s&&!!t.meta_data.SwayIsTransformedFromWord&&"true"===t.meta_data.SwayIsTransformedFromWord.toString().toLowerCase()},FormsMetaData:{category:t.meta_data.category,form_type:t.meta_data.form_type,owner_id:t.meta_data.owner_id,owner_name:t.meta_data.owner_name,owner_tenant_id:t.meta_data.owner_tenant_id,owner_type:t.meta_data.owner_type,primary_color:t.meta_data.primary_color,background_image:t.meta_data.background_image},PowerBIMetaData:{breadcrumb_url:t.meta_data.breadcrumb_url}},a=i.mruActivityEnabled,l=t.service_info?t.service_info.friendly_service_name:"";return l&&(t.display_path=t.display_path||[],t.display_path.unshift(l)),{DocId:o.ItemId,DriveId:o.DriveId,Extension:t.extension,FileName:t.title,Title:t.title,Url:t.url,WebUrl:t.web_url,LastAccessedTime:n,FileType:r.b[e.fileType(t)],Provenance:r.c[r.c.OfficeMru],PathArray:t.display_path,IsPinned:t.is_pinned,Application:t.app,ResourceId:t.resource_id,Category:t.category,MruV2Type:t.type,MruId:t.mru_id,UrlAlreadyEncoded:!0,MetaData:o,Activity:t.activity_info&&a?e.convertMruActivityToActivityDescription(t.activity_info):void 0,Sharing:t.sharing_info&&a?t.sharing_info.state:void 0,LifecycleInfo:t.lifecycle_info&&a?!!t.lifecycle_info.flags:void 0,ServiceId:t.service_info?t.service_info.service_id:"",ServerDocId:t.server_doc_id}}convertToMruData(t,i=!1){let n;n=t.documents&&t.documents.items?t.documents.items:[];const s=n.filter(t=>("Sway"===t.app||"Portfolio"===t.app||"Project"===t.app||"Forms"===t.app||"Bohemia"===t.app||"Fluid"===t.app||"PowerBI"===t.app||-1===t.url.lastIndexOf("?"))&&!e.isPwaProject(t)).map(e=>this.mruItemFromMruPlusPlusV2Item(e));return s.forEach(e=>{r.b[e.FileType]===r.b.Forms&&(e.Url=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.Url))}),this.mruConfigService.config.mruPinEnabled&&s.sort((e,t)=>t.LastAccessedTime.getTime()-e.LastAccessedTime.getTime()),{items:s,impressionId:e.mruPlusPlusV2ImpressionId,fromCache:i}}processMruData(e,t,i=!1){const n=this.convertToMruData(e,i);return t||(this.mostRecentUnfilteredDocs=n),n}}return e.mruPlusPlusV2ImpressionId="MruPlusPlusV2Impression",e.activityRegex=new RegExp("{([0-9]+)}"),e})()},RZcl:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n=i("aZf6"),r=i("EYJY"),s=i("HbWZ"),o=i("GAcG"),a=i("WKA6"),l=i("BaAg"),c=function(e){return e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode",e}({}),u=i("oAX+"),h=i("ZBli"),d=i("Brer"),m=i("EUVs"),p=i("Mlb/"),f=i("4/We"),g=i("cgnd"),b=i("/I02"),v=i("hZW2"),S=i("hhzZ"),y=i("Uqr9"),w=i("idgT"),C=i("Ax7d"),I=i("BMb5");let T=(()=>{class e{constructor(t,i,n,r,s,o,a,l,c,u){this.capabilitiesService=t,this.clientStartupConfigService=i,this.contextService=n,this.documentService=r,this.instrumentationService=s,this.performanceService=o,this.templatesConfigService=a,this.vroomService=l,this.webPwaService=c,this.windowService=u,this.index=0,this.uih=e.uihOfficeComWeb,this.bootstrappersLoaded=new Map,this.bootstrapperDiagnostics=new Map,this.applicationUrls=new Map,this.performanceMarker=new Map,this.bootstrappedDocuments=new Map,this.webPwaService.isStandalone.subscribe(t=>this.uih=t?e.uihOfficeComPwa:e.uihOfficeComWeb)}loadBootstrapper(e,t,i){if(this.bootstrappersLoaded.has(e))return this.bootstrappersLoaded.get(e);const n=new Promise((t,n)=>{this.bootstrapperDiagnostics.set(e,{startTime:Date.now()}),this.documentService.addScriptToPage(e,()=>{this.bootstrapperDiagnostics.get(e).endTime=Date.now(),t()},n,!1,l.b[i]+"_bootstrapper")});return this.templatesConfigService.prefetchStaticResources(i),this.bootstrappersLoaded.set(e,n),this.applicationUrls.set(i,{bootstrapperUrl:e,applicationUrl:t}),n}convertMruInflationPromise(e,t,i){return e.then(e=>{const n=m.a.getDocumentInfoForMruFileItem(e,t);return{fetchDiagnostics:{startTime:i,endTime:Date.now()},wopiHostData:e.wopiData,fetchedDocumentInfo:n.docId&&n.driveId?this.getDocumentInfoWithSharingLink(n):this.getWopiData(n,!1,!1,!0).then(e=>e.fetchedDocumentInfo)}})}bootstrapItem(e,t,i){const[r,s]=this.generateCorrelationAndBootId();this.logPerformanceBootStart(s,r,e.wdOrigin,e.fileType);const o=new n.a;this.logPerformanceEventFromClick(s,"WacContent_Document_Wopi_Fetch_Start",e.fileType);const a=i||this.getWopiData(e,!1,!1,!0);a.then(i=>{this.logPerformanceEventFromClick(s,"WacContent_Document_Wopi_Fetch_End",e.fileType),this.bootstrapFile(o,s,e,i.wopiHostData,r,t,i.fetchDiagnostics,!0)}).catch(e=>{this.sendBootError("WacDocument_Vroom_Error",e,o)});const{fileName:c}=e,u={correlationId:r,bootstrapperObservable:o.asObservable(),fileNamePromise:c?Promise.resolve(l.a.fileNameWithoutExtension(c)):a.then(e=>l.a.fileNameWithoutExtension(e.wopiHostData.fileName)),documentIdentifierPromise:a.then(e=>e.fetchedDocumentInfo)},h={correlationId:r,bootedDocumentInfo:{bootId:s,documentInfo:e},data:u};return this.bootstrappedDocuments.set(s,h),h}bootstrapZeroByteDocument(e,t,i){const[r,s]=this.generateCorrelationAndBootId();this.logPerformanceBootStart(s,r,e.wdOrigin,e.fileType);const o=new n.a,a=i.then(t=>(this.logPerformanceEventFromClick(s,"WacContent_Document_Wopi_Fetch_Start",e.fileType),this.getWopiData(t,!0,!1,!0).then(e=>[e,t])));a.then(([i,n])=>{this.logPerformanceEventFromClick(s,"WacContent_Document_Wopi_Fetch_End",e.fileType),this.bootstrapFile(o,s,n,i.wopiHostData,r,t,Object.assign(Object.assign({},i.fetchDiagnostics),{endTime:Date.now()}))}).catch(e=>{this.sendBootError("WacDocument_Vroom_Error",e,o)});const c={correlationId:r,bootstrapperObservable:o.asObservable(),fileNamePromise:i.then(e=>l.a.fileNameWithoutExtension(e.fileName)),documentIdentifierPromise:a.then(([e])=>e.fetchedDocumentInfo)},u={bootId:s,documentInfo:Object.assign(Object.assign({},e),{newFile:!0})},h={correlationId:r,bootedDocumentInfo:u,data:c};return this.bootstrappedDocuments.set(s,h),h}generateCorrelationAndBootId(e){const t=null!=e?e:this.index++;return[this.getCorrelationIdForBootId(t),t]}getWopiData(e,t=!1,i=!1,n=!1){const r=Date.now(),[s,o]=this.getDriveItemWithWacData(e,t,i);return s.then(t=>{var i,s,a,l;if(t){const o={startTime:r,endTime:Date.now()},c=d.a.getWopiHostDataFromItem(t),u=Object.assign(Object.assign({},e),{docUrl:null!==(i=t.webUrl)&&void 0!==i?i:e.docUrl,driveId:null!==(a=null===(s=null==t?void 0:t.parentReference)||void 0===s?void 0:s.driveId)&&void 0!==a?a:e.driveId,docId:null!==(l=null==t?void 0:t.id)&&void 0!==l?l:e.docId}),h=n?this.getDocumentInfoWithSharingLink(u):Promise.resolve(u);return Promise.resolve({wopiHostData:c,fetchDiagnostics:o,fetchedDocumentInfo:h})}return o.then(e=>Promise.reject(e)).catch(e=>Promise.reject(e))}).catch(e=>(this.logError("Wopi_Data_Fetch_Failed",e),Promise.reject(e)))}logPerformanceEventFromClick(e,t,i){var n;const{clickTimeMarker:r,instrumentationParams:s}=null!==(n=this.performanceMarker.get(e))&&void 0!==n?n:{clickTimeMarker:1,instrumentationParams:{WacHostEntry:this.contextService.getWdOrigin("DIRECT"),ResourceId:this.getCorrelationIdForBootId(e),FileFormat:l.a.fileTypeNameFromType(i)}};this.performanceService.mark(`${t}.${e}`,r,void 0,s)}logPerformanceBootStart(e,t,i,n){const r={WacHostEntry:i,ResourceId:t,FileFormat:l.a.fileTypeNameFromType[n]},s=this.performanceService.mark("WacContentPerformanceMarker.DocumentLoadStart."+e,0,void 0,r);this.performanceMarker.set(e,{clickTimeMarker:s,instrumentationParams:r})}getDriveItemWithWacData(e,t,i){const{docId:n,driveId:o,docUrl:l,fileType:c}=e,h=t?"editnew":"open",d=o&&n?e=>this.vroomService.getItemWithWacData(l,o,n,e,h,i):e=>this.vroomService.getSharedItemWithoutThumbnail(l,c,null,e,!0,h,i),m=new r.a;return[(i?Object(s.a)(d("network-only")):u.a.createResultsWithCacheObservable(d("cache-only"),d("network-first"),void 0,e=>m.error(e)).results).pipe(Object(a.a)(1)).toPromise(),m.toPromise()]}getDocumentInfoWithSharingLink(e){return this.capabilitiesService.capabilities.wacSharingLinkEnabled?this.vroomService.createSharingLink(e.driveId,e.docId).then(t=>{let i;try{i=decodeURIComponent(t)}catch(t){return e}return Object.assign(Object.assign({},e),{docUrl:null!=i?i:e.docUrl})}).catch(()=>e):Promise.resolve(e)}bootstrapFile(e,t,i,n,r,s,a,l=!0){const{fileType:c}=i;if(!n||!n.wac||!n.wac.bootstrapperUrl)return void(l?this.getWopiData(i).then(n=>{n?this.bootstrapFile(e,t,i,n.wopiHostData,r,s,n.fetchDiagnostics,!1):this.sendBootError("WacDocument_Generic_Boot_Error","Error occurred while trying to fetch wopi data",e)}).catch(t=>{this.sendBootError("WacDocument_Vroom_Error",t,e)}):this.sendBootError("WacDocument_Vroom_Error","Failed to get wopi data for the item",e));const u=n.wac.bootstrapperUrl,h=n.wac.applicationUrl;this.logPerformanceEventFromClick(t,"WacContent_Document_Bootstrapper_Load_Start",c),this.loadBootstrapper(u,h,c).then(()=>{const[l,h]=this.getOfficeBootstrapper(c);if(h)return void this.sendBootError("WacHost_Bootstrapper_Load_Error",h,e);this.logPerformanceEventFromClick(t,"WacContent_Document_Bootstrapper_Load_End",c);const d=this.getWopiInfo(n.wac);e.next(({container:e,flushTime:h,loadCorrelationId:m})=>new o.a(o=>{const p=setTimeout(()=>{this.sendBootError("WacDocument_JsApi_Timeout","",o)},15e4),f=this.getInitParams(i.fileType,m,i.wdOrigin,e.nativeElement,r!==m?h:s,h,e=>{clearTimeout(p),this.logPerformanceEventFromClick(t,"WacContent_Document_Load_End",c),o.next({wopiHostData:n,officeApplication:e}),o.complete()},e=>{clearTimeout(p),this.sendBootError("WacDocument_JsApi_Error",e,o)},i.docId,n,d,u,a,i.applicationUrlParams,i.rebootOverrideData);this.logPerformanceEventFromClick(t,"WacContent_Document_InitializeWopiPending",c);const g=l.Application.InitializeWopiPending(f,void 0,void 0,void 0,this.getFeatureManager());g?g.Complete(d):this.sendBootError("Initialize_Wopi_Pending_Failed",fail,o)})),e.complete()}).catch(()=>{this.sendBootError("WacHost_Bootstrapper_Load_Error","Failed to load the bootstrapper",e)})}getOfficeBootstrapper(e){const t=this.windowService.nativeWindow.Microsoft;if(void 0===t)return[null,"Microsoft is undefined"];const i=t.Office,n=l.b[e];return i&&i[n]?[i[n],null]:[null,"Failed to find bootstrapper for app: "+n]}getCorrelationIdForBootId(e){return`${this.clientStartupConfigService.config.sharedClientStartupContext.correlationId}.${e}`}getSessionContext(){return{pmo:this.windowService.nativeWindow.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:this.windowService.nativeWindow.location.href}}getSessionInformation(e,t,i={}){const n=this.contextService.sharedContext.officeMarket,r=this.capabilitiesService.capabilities;return{HostName:"office.com",HostSessionId:t,UserId:e,OwnerId:void 0,UiLocale:n,DataLocale:n,DisableChat:!0,CookieCompliant:!0,WdParams:i,DisableFocusOnBoot:!1,SessionContext:JSON.stringify(this.getSessionContext()),HideHeader:this.capabilitiesService.capabilities.wacHeaderDisabled,SupportsDocReboot:r.wacHostDocRebootEnabled?c.AnyDoc|c.OtherMode:c.AnyDoc,SupportsCreateNewDocument:r.wacHostCreateNewEnabled}}getWopiPrecheckInfo(e,t){return Object.assign({FileName:e.fileName,FileGetUrl:e.downloadUrl||e.wac.fileGetUrl,FileSize:e.fileSize,BundleInfo:{Url:e.bundleUrl,MajorVersion:e.bundleVersion},ReadOnly:e.readOnly,IrmEnabled:e.irmEnabled,ETag:e.eTag,IsNewFile:e.isNewFile},t&&{DocUniqueId:t})}getWopiInfo(e){return{WopiSrc:e.wopiSrc,AccessToken:e.accessToken,AccessTokenExpiry:new Date(parseInt(e.accessTokenExpiry))}}getDiagnostics(e,t,i,n={startTime:0,endTime:0},r){const s=r?this.bootstrapperDiagnostics.get(r):{startTime:0,endTime:0},o=Math.max(this.performanceService.navigationStart,e),a=Math.max(n.startTime?n.startTime:0,o),l=Math.max(n.endTime?n.endTime:0,a),c=Math.max(t,l),u=Math.max(s?s.startTime:0,c);return{entryPoint:i,userClickTime:e,hostPageNavigationStartTime:o,hostPageFetchStartTime:a,hostPageFetchEndTime:l,hostPageFirstFlushTime:c,officeBootstrapperStartTime:u,officeBootstrapperEndTime:Math.max(s?s.endTime:0,u),officeInitializationTime:Date.now()}}getInitParams(e,t,i,n,r,s,o,a,l,c,u,d,m,p,f){const{bootstrapperUrl:g,applicationUrl:b}=this.applicationUrls.get(e),v=c?c.wac.applicationUrl||c.wac.editUrl:h.a.removeQueryParams(b,["wopisrc"],!1),S=Object.assign(Object.assign({},p),{uiEmbed:1,uih:this.uih}),y=h.a.appendQueryParams(v,S);return Object.assign({BootstrapperUrl:d||g,Container:n,SessionInformation:this.getSessionInformation(c?c.wac.userId:this.clientStartupConfigService.config.puid,t),ApplicationUrl:y,WopiPrecheckInfo:this.getWopiPrecheckInfo(c,l),ApplicationCustomSettings:{HostUIControls:[{id:"close",visibility:0},{id:"share",visibility:1}]},Diagnostics:this.getDiagnostics(r,s,i,m,g),FnOnInitializeSuccess:o,FnOnInitializeFailure:a,RebootOverrideData:f},u?{WopiInfo:u}:{})}getFeatureManager(){return{isFeatureEnabled:e=>{switch(e){case"OfficeComUiHost":return!0;default:return!1}}}}logError(e,t,i){this.instrumentationService.logErrorEvent(e,{Error:t,ResourceId:i})}sendBootError(e,t,i){i.error({instrumentationEvent:e,error:t})}}return e.uihOfficeComWeb="officecom",e.uihOfficeComPwa="officecompwa",e.ɵprov=p.bc({factory:function(){return new e(p.cc(f.a),p.cc(g.b),p.cc(b.a),p.cc(v.a),p.cc(S.a),p.cc(y.b),p.cc(w.a),p.cc(d.a),p.cc(C.a),p.cc(I.b))},token:e,providedIn:"root"}),e})()},RitX:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return u}));var n=i("Mlb/"),r=i("vk2e"),s=(i("mu6k"),i("W3Zz"),i("hZW2"),i("PBJH"),i("BMb5"),n.wb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"openAndClose",definitions:[{type:1,expr:"* => openMobile",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{transform:"translate3d(0, 100%, 0)"},offset:null},{type:4,styles:{type:6,styles:{transform:"translate3d(0, 0, 0)"},offset:null},timings:"{{ slideDuration }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:{params:{slideDuration:"300ms"}}},options:null},options:null},{type:1,expr:"* => open",animation:[{type:6,styles:{height:0},offset:null},{type:4,styles:{type:6,styles:{height:"*"},offset:null},timings:"300ms cubic-bezier(.1,.9,.2,1)"}],options:null},{type:1,expr:"open => closing",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:1},offset:null},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"100ms"}}},options:null},options:null}],options:{}}]}}));function o(e){return n.ac(0,[(e()(),n.hb(0,null,null,0))],null,null)}function a(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),n.hb(16777216,null,null,2,null,o)),n.xb(2,540672,null,0,r.o,[n.O],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),n.Qb(3,{item:0,index:1}),(e()(),n.hb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,3,0,t.parent.context.$implicit,t.parent.context.index);e(t,2,0,n,i.menuItemTemplate)}),null)}function l(e){return n.ac(0,[(e()(),n.yb(0,0,[[2,0],["menuItem",1]],null,4,"li",[["role","listitem"],["tabindex","-1"]],[[8,"id",0],[1,"aria-label",0],[1,"aria-describedby",0],[1,"data-clicklog",0],[1,"data-area",0],[1,"aria-posinset",0],[1,"aria-setsize",0],[1,"aria-selected",0]],[[null,"click"],[null,"mouseenter"],[null,"keydown"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onSelectItem(e.context.$implicit,e.context.index,i)&&n),"mouseenter"===t&&(n=!1!==r.setActiveIndex(e.context.index)&&n),"keydown"===t&&(n=!1!==r.handleKey(i)&&n),n}),null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"menu-item--mobile":0}),(e()(),n.hb(16777216,null,null,1,null,a)),n.xb(4,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,r=n.Fb(1,"menu-item ms-bgc-g40-h ms-bgc-w ms-bgc-g40-f ms-bgc-g40-a ",t.context.$implicit.cssClass,""),s=e(t,2,0,i.mobileMenu);e(t,1,0,r,s),e(t,4,0,i.menuItemTemplate)}),(function(e,t){var i=t.component;e(t,0,0,i.getIdForItem(t.context.$implicit),t.context.$implicit.ariaLabel,t.context.$implicit.ariaDescribedBy,i.menuModel.customLogging?"custom":"",i.menuModel.customLogging?"":i.menuModel.hostComponentArea,t.context.index+1,i.menuModel.items.length,i.menuModel.announceItemIsSelected&&t.context.$implicit.ariaSelected)}))}function c(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,5,"div",[["role","listbox"]],[[1,"aria-label",0],[24,"@openAndClose",0]],[[null,"@openAndClose.done"]],(function(e,t,i){var n=!0;return"@openAndClose.done"===t&&(n=!1!==e.component.onAnimationCompleted(i)&&n),n}),null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"menu--right":0,"menu--center":1,"menu--bottom":2,"context-menu--mobile":3}),(e()(),n.yb(3,0,null,null,2,"ul",[["aria-haspopup","true"],["class","officeHome-callout-main menu__content ms-bgc-w"],["role","option"]],[[8,"id",0]],null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,l)),n.xb(5,278528,null,0,r.j,[n.O,n.L,n.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(e,t){var i=t.component,r=n.Fb(1,"menu officeHome-callout ",i.menuModel.cssClass,""),s=e(t,2,0,i.menuModel.rightAligned&&!i.leftAlignedCard,i.menuModel.centerAligned,i.menuModel.bottomAligned,i.mobileMenu);e(t,1,0,r,s),e(t,5,0,i.menuModel.items,i.trackById)}),(function(e,t){var i=t.component;e(t,0,0,i.menuAriaLabel,i.animationState),e(t,3,0,n.Fb(1,"",i.menuModel.id,"-dropdown"))}))}function u(e){return n.ac(0,[n.Tb(671088640,1,{menuWrapper:0}),n.Tb(671088640,2,{dropdownItems:1}),(e()(),n.hb(16777216,null,null,1,null,c)),n.xb(3,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,3,0,t.component.open)}),null)}},RsrG:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Mlb/");let r=(()=>{class e{getSchedulePriority(e){switch(e){case"mru#MruModule":case"edgeworth#EdgeworthModule":case"recommended-react#RecommendedReactModule":case"left-nav-react#LeftNavReactModule":case"workspace-nav#WorkspaceNavModule":return 0;case"auto-suggest#AutoSuggestModule":case"install#InstallModule":case"create-menu#CreateMenuModule":case"first-run#FirstRunModule":case"places#PlacesModule":case"upload-button#UploadButtonModule":return 1;case"upload-dialog#UploadDialogModule":case"banner#BannerModule":case"fluid-content#FluidContentModule":case"wac-content#WacContentModule":return 2;default:return 3}}}return e.ɵprov=n.bc({factory:function(){return new e},token:e,providedIn:"root"}),e})()},Ry9Z:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("BaAg"),r=i("Mlb/"),s=i("QOOv"),o=i("m+UP");let a=(()=>{class e{constructor(e,t){this.mruConfigService=e,this.swayService=t}getAnalytics(t,i){return"cache-only"===i&&!this.mruConfigService.config.analyticsCachingEnabled||t.fileType!==n.b.Sway?Promise.resolve(void 0):this.swayService.getAnalytics(t.url,i).then(t=>e.convertFromSwayAnalytics(t))}prefetchAnalytics(e,t){if(t&&!this.mruConfigService.config.analyticsCachingEnabled)return;const i=e.filter(e=>e.fileType===n.b.Sway).map(e=>e.url);this.swayService.prefetchAnalytics(i,t?"cache-only":"network-first")}static convertFromSwayAnalytics(e){if(e)return{viewCount:e.viewCount,averageTimeSpentMs:e.averageTimeSpent,averageCompletionRatio:e.AverageScrollDistance,glancedReads:e.glancedReads,quickReads:e.quickReads,deepReads:e.deepReads}}}return e.ɵprov=r.bc({factory:function(){return new e(r.cc(s.a),r.cc(o.a))},token:e,providedIn:"root"}),e})()},"SGS+":function(e,t,i){},"T/SX":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},T6pR:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},TDzr:function(e,t,i){"use strict";i.d(t,"a",(function(){return F}));class n{constructor(e,t,i,n,r,s=!1,o,a,l,c){this.announcementType=e,this.title=t,this.subTitle=i,this.iconClass=n,this.dismissCookieName=r,this.alignBottom=s,this.cssClass=o,this.fontCssClass=a,this.dismissObservable=l,this.dismissible=c,this.importance=1}isValid(){return this.title.length>0}}var r=i("H90i"),s=i("JT1q"),o=i("fKR7");class a{static objectToArrayHelper(e){return Array.isArray(e)?e:e?[e]:[]}}var l=i("uUrA"),c=i("pjz5"),u=i("BaAg"),h=i("4ach"),d=i("oAX+"),m=i("ZBli"),p=i("pOWU"),f=i("Mlb/"),g=i("kpuN"),b=i("7Gwk"),v=i("hhzZ"),S=i("R7NL"),y=i("/I02"),w=i("PBJH"),C=i("wwmn"),I=i("dFxn");let T=(()=>{class e{constructor(e){this.config=e.parse("formsConfig")||{formsApiPath:null,formsProAddress:null,formsCdnPath:null,defaultThumbnailColor:null,defaultImagesAvailable:null,formsThumbnailImagesUrl:null,formsThemingConfigUrl:null}}}return e.ɵprov=f.bc({factory:function(){return new e(f.cc(I.a))},token:e,providedIn:"root"}),e})();var k=i("Z0U4"),E=i("vk2e"),A=i("casz"),P=i("cgnd"),x=i("xoWf"),D=i("BJbw"),M=i("W3Zz");let F=(()=>{class e extends p.a{constructor(t,i,n,r,s,o,a,l,c,u,h,d,m,p,f,g){super(t,n,r,"Forms",s,a,u,h),this.eventService=i,this.locService=o,this.formsConfigService=l,this.officeRouteService=c,this.startupConfigService=d,this.clientStartupConfigService=m,this.userDataStorageService=p,this.urlAuthenticatorService=f,this.deviceDetector=g,this.formsLastAnnouncement=null,this.SHARED_FORMS_PATH=e.BASE_URL+"/me/sharedWithMeForms",this.getFormDataStreamCache={},this.getSharedFormsDataStreamCache=null,this.getMyFormsDataStreamCache=null,this.getMyFormsResponsesCache=null,this.getFormsThemeMappingSetCache=null,this.getFormsGroupsDataStreamCache=null,this.getUserExperienceTypeDataStreamCache=null,this.getFormsGroupMembersStreamCache={},this.getFormsInGroupDataStreamCache={}}getForm(t,i,n,r){if(!r&&this.getFormDataStreamCache[t])return this.getFormDataStreamCache[t];const s=r=>new Promise((s,o)=>{this.get("Get_Form",this.formsConfigService.config.formsApiPath+e.GET_FORM(this.clientStartupConfigService.config.tenantId,i,n,t),e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{if(e&&e.data&&e.data.id){const t=this.getFormUrl(e.data.id);e.data=Object.assign(Object.assign({},e.data),{fromCache:e.fromCache}),e.data.url=t,e.data.ownerPrincipalType=i,e.data.otherInfo&&(e.data.otherInfo=JSON.parse(e.data.otherInfo)),s(e.data)}})},e=>{o(e)},this.getRequestConfig(),r)}),o=s("cache-only"),a=s("network-first"),l=d.a.createResultsWithCacheObservable(o,a,null,e=>{this.getFormDataStreamCache[t]=null});return this.getFormDataStreamCache[t]=l,this.getFormDataStreamCache[t]}unpinSharedForm(t){return new Promise((i,n)=>{this.delete("Forms_Shared_UnpinRequest",this.formsConfigService.config.formsApiPath+e.SHARED_FORM(t),null,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{i(e.data)})},e=>{n(e)},this.getRequestConfig())})}postCopyForm(t,i,n,r,s){const o="groups"===s;return new Promise((a,l)=>{this.post("Forms_Copy_Request",this.formsConfigService.config.formsApiPath+e.COPY_FORMS_PATH(this.clientStartupConfigService.config.tenantId,r,i,t),{newOwnerId:n,newTenantId:this.clientStartupConfigService.config.tenantId,isNewOwnerGroup:o},e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{const t=e.data;t.url=this.getFormUrl(t.id),this.clearCache(s,n),a(e.data)})},e=>{l(e)},this.getRequestConfig())})}createForm(e,t){return new Promise((i,n)=>{const r=t||{type:"users"};switch(r.type){case"users":i(this.getCreateFormsLink(e));break;case"groups":this.createGroupForm(r.identifier,e).then(e=>{i(this.appendQueryInformation(this.getFormUrl(e.id),!0))}).catch(n)}})}postMoveForms(t,i,n,r,s){return new Promise((o,a)=>{this.post("Recycle_Form_Request",this.formsConfigService.config.formsApiPath+e.MOVE_FORM_PATH(this.clientStartupConfigService.config.tenantId,i,n,t),{isNewOwnerGroup:"groups"===r,newOwnerId:s},e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(()=>{this.clearCache(i,n),this.clearCache(r,s),o()})},e=>{a(e)},this.getRequestConfig())})}createGroupForm(t,i){const n=(e,t,n,r,s)=>({ownerId:this.clientStartupConfigService.config.objectId,ownerTenantId:this.clientStartupConfigService.config.tenantId,settings:`{"RequiresUniqueResponse":${e},"IsAnonymous":${t},"ShowGradedScores":${n},"IsQuizMode":${r}}`,title:i===u.b.Forms?this.locService.NewFormsSurveyFileName:this.locService.NewFormsQuizFileName,xlWorkbookId:s===u.b.Forms?"WaitingForExport":void 0});let r=null;switch(i){case u.b.Forms:r=n(!1,!1,!1,!1,i);break;case u.b.FormsQuiz:r=n(!0,!1,!0,!0,i)}return new Promise((i,n)=>{this.post("Group_Forms_Create_Request",this.formsConfigService.config.formsApiPath+e.CREATE_FORM(this.clientStartupConfigService.config.tenantId,"groups",t),r,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{i(e.data)})},e=>{n(e)},this.getRequestConfig())})}getFormAuthenticatedCdn(){let t=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.formsConfigService.config.formsCdnPath+(this.deviceDetector.isMobileDevice()?e.DESIGNER_MOBILE_URL:e.DESIGNER_URL));return t=m.a.appendAndReplaceQueryParams(t,{origin:r.a,lang:this.contextService.sharedContext.officeMarket},!1,!0),t}getFormGroupThumbnailUrl(t){return this.getImage(this.formsConfigService.config.formsApiPath+e.MY_FORMS_GROUP_THUMBNAIL_PATH(t),"Forms_Group_Thumbnail_Fetch")}getFormsInGroup(t,i){if(i&&(this.getFormsInGroupDataStreamCache[t]=null),this.getFormsInGroupDataStreamCache[t])return this.getFormsInGroupDataStreamCache[t];const n=i=>new Promise((n,r)=>{this.get("Forms_From_Group_Request",this.formsConfigService.config.formsApiPath+e.FORMS_FROM_GROUP(this.clientStartupConfigService.config.tenantId,t),e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{e&&e.data&&e.data.value&&(e.data=Object.assign(Object.assign({},e.data),{fromCache:e.fromCache}),e.data.value=a.objectToArrayHelper(e.data.value),e.data.value.forEach(e=>{e.otherInfo&&(e.otherInfo=JSON.parse(e.otherInfo)),e.ownerPrincipalType="groups",e.url=this.getFormUrl(e.id)}),n(e.data))})},e=>{r(e)},this.getRequestConfig(),i)}),r=n("cache-only"),s=n("network-first"),o=d.a.createResultsWithCacheObservable(r,s,null,e=>{this.getFormsInGroupDataStreamCache[t]=null});return this.getFormsInGroupDataStreamCache[t]=o,this.getFormsInGroupDataStreamCache[t]}getFormsGroupMembers(t){if(this.getFormsGroupMembersStreamCache[t])return this.getFormsGroupMembersStreamCache[t];const i=i=>new Promise((n,r)=>{this.get("Forms_Group_Members_Request",this.formsConfigService.config.formsApiPath+e.FORMS_GROUP_MEMBERS(t),e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{n(e.data)})},e=>{r(e)},this.getRequestConfig(),i)}),n=i("cache-only"),r=i("network-first"),s=d.a.createResultsWithCacheObservable(n,r,null,e=>this.getFormsGroupMembersStreamCache[t]=null);return this.getFormsGroupMembersStreamCache[t]=s,s}getFormsGroups(){if(this.getFormsGroupsDataStreamCache)return this.getFormsGroupsDataStreamCache;const t=t=>new Promise((i,n)=>{this.get("Forms_Groups_Request",this.formsConfigService.config.formsApiPath+e.MY_FORMS_GROUPS,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{i(e.data)})},e=>{n(e)},this.getRequestConfig(),t)}),i=t("cache-only"),n=t("network-first"),r=d.a.createResultsWithCacheObservable(i,n,null,e=>this.getFormsGroupsDataStreamCache=null);return this.getFormsGroupsDataStreamCache=r,r}setFormsRecycleState(t,i,n,r){const s=r?"Recycle_Form_Request":"Restore_Form_Request";return new Promise((o,a)=>{this.patch(s,this.formsConfigService.config.formsApiPath+e.DELETE_FORM_PATH(this.clientStartupConfigService.config.tenantId,n,i,t),{softDeleted:r?1:0},e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(()=>{o()})},e=>{a(e)},this.getRequestConfig())})}hardDeleteForm(t,i,n){return new Promise((r,s)=>{this.delete("Forms_Delete_Request",this.formsConfigService.config.formsApiPath+e.DELETE_FORM_PATH(this.clientStartupConfigService.config.tenantId,n,i,t),{},e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(()=>{this.clearCache(n,i),r()})},e=>{s(e)})})}getCreateFormsLink(e){const t=(e,t)=>`Action=${t}&Title=${e}`;let i=this.getFormAuthenticatedCdn();const n={Action:null,Fragment:null};if(e===u.b.Forms)n.Fragment=t(this.locService.NewFormsSurveyFileName,"Create"),n.Action="Create";else{if(e!==u.b.FormsQuiz)return null;n.Fragment=t(this.locService.NewFormsQuizFileName,"CreateQuiz"),n.Action="CreateQuiz"}return i=m.a.appendAndReplaceQueryParams(i,n,!0),this.appendQueryInformation(i,!0)}getFormGroupMemberThumbnailUrl(t,i){return this.getImage(this.formsConfigService.config.formsApiPath+e.FORMS_MEMBER_THUMBNAIL_PATH(t,i),"Forms_Members_Thumbnail_Fetch")}getMyFormsResponses(){if(this.getMyFormsResponsesCache)return this.getMyFormsResponsesCache;const t=t=>new Promise((i,n)=>{this.get("Forms_Responses",this.formsConfigService.config.formsApiPath+e.FORMS_RESPONSE_COUNT_PATH,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{e&&e.data?(e.data.value=a.objectToArrayHelper(e.data.value),i(e.data)):n()})},e=>{n(e)},this.getRequestConfig(),t)}),i=t("cache-only"),n=t("network-first"),r=d.a.createResultsWithCacheObservable(i,n,null,e=>this.getMyFormsResponsesCache=null);return this.getMyFormsResponsesCache=r,r}getSharedForms(){if(this.getSharedFormsDataStreamCache)return this.getSharedFormsDataStreamCache;const e=e=>new Promise((t,i)=>{this.get("Shared_Forms_Request",this.formsConfigService.config.formsApiPath+this.SHARED_FORMS_PATH,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{e&&e.data&&e.data.value?(e.data.value.sort((e,t)=>e.modifiedDate===t.modifiedDate?0:e.modifiedDate<t.modifiedDate?1:-1),e.data.value.forEach(e=>{e.id&&(e.url=this.getFormUrl(e.id),e.ownerPrincipalType=h.a.getOwnerPrincipalTypeToFormType(e.ownerType||e.ownerPrincipalType||e.OwnerPrincipalType))}),t(e.data)):i()})},e=>{i(e)},this.getRequestConfig(),e)}),t=e("cache-only"),i=e("network-first"),n=d.a.createResultsWithCacheObservable(t,i,null,e=>this.getSharedFormsDataStreamCache=null);return this.getSharedFormsDataStreamCache=n,n}setFormsQuotaAnnouncements(){const e=this.getMyForms(!0);let t,i=!1,n=null;e.initialCompletion.then(()=>{this.pushFormsAnnouncements(n),t&&t.unsubscribe()}),t=e.results.subscribe(e=>{!i&&e.fromCache?n=e.value:e.fromCache||(i=!0,n=e.value)})}pushFormsAnnouncements(e){if(e)if(e.length>=150&&e.length<200){if("FormsNearLimit"===this.formsLastAnnouncement)return;this.eventService.broadcastEvent({name:"newAnnouncement",args:[new n("FormsNearLimit",this.locService.format(this.locService.FormsQuotaApproachingWarning,"200"),null,"","",!1,"announcement-background-color-wrapper--alert","announcement-section__title--black announcement-close__button--black")]}),this.formsLastAnnouncement="FormsNearLimit"}else if(e.length>=200){if("FormsMaxLimit"===this.formsLastAnnouncement)return;this.eventService.broadcastEvent({name:"newAnnouncement",args:[new n("FormsMaxLimit",this.locService.format(this.locService.FormsQuotaReachedWarning,"200"),null,"","",!1,"announcement-background-color-wrapper--error","announcement-section__title--black announcement-close__button--black")]}),this.formsLastAnnouncement="FormsMaxLimit"}}getMyForms(t){if(t&&(this.getMyFormsDataStreamCache=null),this.getMyFormsDataStreamCache)return this.getMyFormsDataStreamCache;const i=t=>new Promise((i,n)=>{this.get("My_Forms_Request",this.formsConfigService.config.formsApiPath+e.MY_FORMS_PATH,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{e.data=Object.assign(Object.assign({},e.data),{fromCache:e.fromCache}),e&&e.data&&e.data.value&&(e.data.value=a.objectToArrayHelper(e.data.value),e.data.value.forEach(e=>{e.ownerPrincipalType="users",e.otherInfo&&(e.otherInfo=JSON.parse(e.otherInfo)),e.url=this.getFormUrl(e.id)}),e.data.value=e.data.value.sort((e,t)=>new Date(t.modifiedDate).getTime()-new Date(e.modifiedDate).getTime())),i(e.data)})},e=>{n(e)},this.getRequestConfig(),t)}),n=i("cache-only"),r=i("network-first"),s=d.a.createResultsWithCacheObservable(n,r,null,e=>{this.getMyFormsDataStreamCache=null});return this.getMyFormsDataStreamCache=s,this.getMyFormsDataStreamCache}getFormUrl(e){return`${this.getFormAuthenticatedCdn()}#FormId=${e}`}fetchFormThumbnail(t){const i=()=>this.inMockMode?`${location.origin}${e.FORMS_THUMBNAIL_MOCK_PATH}`:""+this.formsConfigService.config.formsApiPath,n=e=>({defaultImage:`${e}/Images/Theme/${this.getFormsDefaultImageName(t.fileName)}`,defaultColor:this.formsConfigService.config.defaultThumbnailColor}),r=e=>{t.thumbnails.backgroundColor=e},a=e=>{t.thumbnails.small=e,t.thumbnails.medium=e,t.thumbnails.large=e,t.thumbnails.recommendedThumbnail=e},l=()=>new Promise(s=>{const l=i(),u=n(l);let h=t.metaData&&t.metaData.background_image?this.inMockMode?`${l}${c.a.getLocation(t.metaData.background_image).path}`:t.metaData.background_image:u.defaultImage,d=t.metaData&&t.metaData.primary_color?t.metaData.primary_color:u.defaultColor;if(t.format===o.a.Recent)return r(d),a(h),void s();t.thumbnailInfo&&t.thumbnailInfo.thumbnailFillColor&&(d=t.thumbnailInfo.thumbnailFillColor),t.thumbnailInfo&&t.thumbnailInfo.thumbnailUrl?(h=t.thumbnailInfo.thumbnailUrl,r(d),a(h),s()):t.thumbnailInfo&&t.thumbnailInfo.thumbnailId?this.getFormsThemingData().then(i=>{const n=i[t.thumbnailInfo.thumbnailId];n&&(n.SecondaryColor&&(d=n.SecondaryColor),n.BackgroundImage&&(h=this.inMockMode?`${location.origin}${e.FORMS_THUMBNAIL_MOCK_PATH}${n.BackgroundImage}`:`${this.formsConfigService.config.formsApiPath}${n.BackgroundImage}`)),r(d),a(h),s()}).catch(()=>{r(d),a(h),s()}):(r(d),a(h),s())});return t.format===o.a.SharedForm?new Promise(e=>{const o=this.getForm(t.serverDocId,t.ownerType,t.ownerId);this.getForm(t.serverDocId,t.ownerType,t.ownerId).results.subscribe(i=>{if(!i.fromCache){const n=Object(s.b)(i,null,null,null,this.clientStartupConfigService.config.authType,i.fromCache);t.thumbnailInfo=n.thumbnailInfo,l().then(e).catch(e)}}),o.initialCompletion.then(t=>{if(t&&t.networkError){const t=n(i());r(t.defaultColor),a(t.defaultImage),e()}})}):l()}deleteFromRecentService(t){return new Promise((i,n)=>{this.delete("Forms_Delete_Recent_Request",this.formsConfigService.config.formsApiPath+e.DELETE_FORM_RECENT(t),null,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(()=>{i()})},e=>{n(e)},this.getRequestConfig())})}getUserExperienceType(){if(this.getUserExperienceTypeDataStreamCache)return this.getUserExperienceTypeDataStreamCache;const t=t=>new Promise((i,n)=>{"cache-only"===t&&this.userDataStorageService.get("Forms_User_Experience",0).then(e=>{e&&"FormsPro"!==e.experience&&i({formsExperienceType:h.a.getFormsUserExperienceType(e.experience),fromCache:!0})}),this.get("Forms_Get_User_Experience_Type",this.formsConfigService.config.formsApiPath+e.USER_EXPERIENCE_TYPE,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{if(e&&e.data){e.fromCache||this.userDataStorageService.set("Forms_User_Experience",{experience:e.data});const t=h.a.getFormsUserExperienceType(e.data);e.fromCache&&"FormsPro"===t||i({formsExperienceType:t,fromCache:e.fromCache})}else n()})},e=>{n(e)},this.getRequestConfig(),t)}),i=t("cache-only"),n=t("network-first"),r=d.a.createResultsWithCacheObservable(i,n,null,e=>this.getUserExperienceTypeDataStreamCache=null);return this.getUserExperienceTypeDataStreamCache=r,r}getImage(e,t){return new Promise((i,n)=>{this.get(t,e,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{if(e&&e.data){const t=new FileReader;t.addEventListener("load",()=>{i(t.result.toString())},!1),t.readAsDataURL(e.data)}})},e=>{n(e)},{responseType:"blob"},"network-only")})}appendQueryInformation(e,t){const i=this.officeRouteService.getCurrentRoute();return m.a.appendAndReplaceQueryParams(e,{route:i&&i.route?i.route:void 0},t)}getRequestConfig(){return{headers:new Map([["Accept","application/json"],["x-ms-form-request-source","ms-startpage"],["x-usersessionid",this.startupConfigService.config.sharedClientStartupContext.sessionId],["x-correlationid",l.a.createGuid()]])}}clearCache(e,t){switch(e){case"groups":if(!t)break;this.getFormsInGroupDataStreamCache[t]=null;break;case"users":this.getMyFormsDataStreamCache=null}}getFormsDefaultImageName(e){const t=this.formsConfigService.config.defaultImagesAvailable;return`default-${Math.abs(class{static toHash(e){let t,i,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)i=e.charCodeAt(t),n=(n<<5)-n+i,n|=0;return n}}.toHash(e))%t+1}.png`}getFormsThemingData(){return this.getFormsThemeMappingSetCache||(this.getFormsThemeMappingSetCache=new Promise((t,i)=>{this.get("Forms_Theme_Request",this.formsConfigService.config.formsApiPath+""+(this.inMockMode?e.FORMS_THEMES_MOCK:e.FORMS_THEMES),e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e)}).then(e=>{t(e.data)})},e=>{this.getFormsThemeMappingSetCache=null,i(e)},this.getRequestConfig(),"network-first",null,null,null,"None")})),this.getFormsThemeMappingSetCache}handleQueryParam(e,t){"mockformsservicemode"===e&&this.mockRequestHeader&&this.getRequestConfig().headers.set(this.mockRequestHeader,t.toString())}getRequestIdFromResponse(e){return this.getHeaderValue(e.headers,"x-correlationid")}}return e.BASE_URL="/formapi/api",e.DESIGNER_MOBILE_URL="/Pages/MobileDesignPage.aspx",e.DESIGNER_URL="/Pages/DesignPage.aspx",e.USER_EXPERIENCE_TYPE=e.BASE_URL+"/me/GetUserExperienceType",e.MY_FORMS_PATH=e.BASE_URL+"/me/light/forms?$select=id,title,modifiedDate,settings,xlWorkbookId,ownerId,ownerTenantId,category,background,otherInfo,softDeleted,status,version",e.FORMS_RESPONSE_COUNT_PATH=e.BASE_URL+"/light/GetRespCounts()",e.FORMS_THUMBNAIL_MOCK_PATH="/content/mockData/shared/services/mockData/form/thumbnails",e.FORMS_THEMES_MOCK="/Themes",e.FORMS_THEMES="/Themes.json",e.MY_FORMS_GROUPS=e.BASE_URL+"/groups",e.GET_FORM=(t,i,n,r)=>`${e.BASE_URL}/${t}/${i}/${n}/light/forms('${r}')?$select=id,rowCount,background,otherInfo,settings`,e.CREATE_FORM=(t,i,n)=>`${e.BASE_URL}/${t}/${i}/${n}/forms`,e.COPY_FORMS_PATH=(t,i,n,r)=>`${e.BASE_URL}/${t}/${i}/${n}/light/forms('${r}')/CopyToUser`,e.MOVE_FORM_PATH=(t,i,n,r)=>`${e.BASE_URL}/${t}/${i}/${n}/light/forms('${r}')/MoveForm`,e.FORMS_MEMBER_THUMBNAIL_PATH=(t,i)=>`${e.BASE_URL}/groups('${t}')/members('${i}')/photo/$value`,e.FORMS_GROUP_MEMBERS=t=>`${e.BASE_URL}/groups('${t}')/members`,e.DELETE_FORM_PATH=(t,i,n,r)=>`${e.BASE_URL}/${t}/${i}/${n}/forms('${r}')`,e.DELETE_FORM_RECENT=t=>`${e.BASE_URL}/recent/forms/${t}`,e.FORMS_FROM_GROUP=(t,i)=>`${e.BASE_URL}/${t}/groups/${i}/light/forms?$select=id,title,modifiedDate,ownerId,ownerTenantId,softDeleted,category,rowCount,background,otherInfo`,e.MY_FORMS_GROUP_THUMBNAIL_PATH=t=>`${e.BASE_URL}/groups('${t}')/photo/$value`,e.SHARED_FORM=t=>`${e.BASE_URL}/light/sharedWithMeForms('${t}')`,e.ɵprov=f.bc({factory:function(){return new e(f.cc(g.a),f.cc(b.a),f.cc(v.a),f.cc(S.a),f.cc(y.a),f.cc(w.a),f.cc(C.a),f.cc(T),f.cc(k.a),f.cc(E.q),f.cc(A.a),f.cc(P.b),f.cc(P.b),f.cc(x.a),f.cc(D.a),f.cc(M.b))},token:e,providedIn:"root"}),e})()},TIi1:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},Uqr9:function(e,t,i){"use strict";i.d(t,"a",(function(){return b})),i.d(t,"b",(function(){return v}));var n=i("70cc"),r=i("WKA6"),s=i("BaAg"),o=i("MFXD"),a=i("Mlb/"),l=i("qfyf"),c=i("AXqk"),u=i("7Gwk"),h=i("re3B"),d=i("hhzZ"),m=i("BMb5"),p=i("cgnd"),f=i("Z0U4"),g=i("4/We");class b{static now(){const e=window.performance;return e&&e.now?e.now():(void 0===this.nowOffset&&(this.nowOffset=e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:Date.now()),Date.now()-this.nowOffset)}}let v=(()=>{class e{constructor(t,i,s,a,l,c,u,h,d){if(this.queuedMarks=t,this.dataSecurityService=i,this.instrumentationService=l,this.windowService=c,this.clientStartupConfigService=u,this.capabilities=d,this.dumpedMeasures=new Set,this.dumpedBrowserMarkers=!1,this.recordedMarkers=new Map,this.recordedMeasures=new Map,this.paramsForAppMeasures=new Map,this.globalStateParamsForBrowserMeasures=null,this._marks=new o.a,this.loggingEnabled=e.performanceLoggingSupported(this.windowService.nativeWindow),!this.loggingEnabled)return;s.events.withScope(0).pipe(Object(n.a)(e=>"shellPlusLoaded"===e.name),Object(r.a)(1)).toPromise().then(()=>{setTimeout(()=>this.log(),1e3)}),this.capabilities.capabilities.antpLoaded&&s.events.withScope(0).pipe(Object(n.a)(e=>"antpReady"===e.name),Object(r.a)(1)).toPromise().then(()=>{setTimeout(()=>this.log(),0)}),a.addUnloadEvent(()=>{this.mark("App_Unloaded",1),this.log()});const m=e=>{this.currentRoute=e,this.mark("App_Navigation_Start",this.lastRecordedRouteNavigationStartMarker?0:this.windowService.nativeWindow.measureAppFrom||"responseStart")};h.subscribeToRouteChangeStart(e=>{e.currentRoute&&e.currentRoute.route&&m(e.currentRoute)}),h.subscribeToRouteChangeEnd(e=>{e.currentRoute&&e.currentRoute.route&&!this.currentRoute&&m(e.currentRoute),null===this.globalStateParamsForBrowserMeasures&&(this.globalStateParamsForBrowserMeasures={},this.instrumentationService.applyGlobalStateParams(this.globalStateParamsForBrowserMeasures,!0))}),this.drainQueuedMarks()}static performanceLoggingSupported(e){const t=e.performance;return!!(t&&t.now&&t.mark&&t.timing&&t.timing.navigationStart&&t.measure&&t.getEntriesByType)}static getBrowserTimingMeasures(t,i,n,r){const s=new Array;if(!e.performanceLoggingSupported(t))return s;for(const o in t.performance.timing){const a=e.globalWhitelistedMarkers.get(o);if(!a)continue;const l=t.performance.timing[o],c=t.performance.timing[a];if("number"!=typeof l||"number"!=typeof c){i(o,`Failed to calculate measure for <${o}> starting from <${a}> due to unexpected value type: <${o}> value type is ${typeof l}; <${a}> value type is ${typeof c}`);continue}if(0===l||0===c){"unloadEventStart"!==o&&"unloadEventEnd"!==o&&i(o,`Failed to calculate measure for <${o}> starting from <${a}> due to unexpected zero values: <${o}>=${l}; <${a}>=${c}`);continue}if(l<c){i(o,`Failed to calculate measure for <${o}> starting from <${a}> due to relative marker value being greater than marker value: <${o}>=${l}; diff from <${a}>=${l-c}`);continue}if(l<t.performance.timing.navigationStart){i(o,`Failed to calculate measure for <${o}> starting from <${a}> due to marker value being less than <navigationStart> marker value: <${o}>=${l}; diff from <navigationStart}>=${l-t.performance.timing.navigationStart}`);continue}if(c<t.performance.timing.navigationStart){i(o,`Failed to calculate measure for <${o}> starting from <${a}> due to relative marker value being less than <navigationStart> marker value: <${o}>=${l}; <${a}>=${c}; diff from <navigationStart}>=${c-t.performance.timing.navigationStart}`);continue}const u=Math.ceil(l-c);s.push({name:o,duration:u,params:n?Object.assign({},n):{}});const h=o+"_ohp_measure";r&&r(o,h);try{t.performance.measure(h,a,o)}catch(e){i(o,`Failed to record measure for <${o}> starting from <${a}>: exception is thrown`)}}return s}mark(e,t=2,i=0,n){if(!this.loggingEnabled)return;if(i>this.dataSecurityService.securityLevel)return;let r=e;this.currentRoute&&this.currentRoute.route&&(r=`${e}_${this.currentRoute.route}${this.currentRoute.app?s.b[this.currentRoute.app]:""}`);let o=r;if(this.recordedMarkers.has(o)){const e=this.recordedMarkers.get(o)+1;this.recordedMarkers.set(o,e),o=`${r}.${e}`}else this.recordedMarkers.set(o,1);this.windowService.nativeWindow.performance.mark(o);const a=this.lastRecordedRouteNavigationStartMarker||"navigationStart";"App_Navigation_Start"===e&&(this.lastRecordedRouteNavigationStartMarker=o);let l="navigationStart";return 2===t?l=a:0===t?l="":"string"==typeof t&&(l=t),this.addMeasure(r,o,l,e,n),this.drainQueuedMarks(),o}getResourceTimingEntries(e){try{return this.windowService.nativeWindow.performance.getEntriesByType("resource").filter(t=>t.name.lastIndexOf(e)>=0)}catch(e){return[]}}get marks(){return this._marks.asScopableObservable()}get navigationStart(){return this.getPerformanceTimingMember("navigationStart")}get fetchStart(){return this.getPerformanceTimingMember("fetchStart")}getPerformanceTimingMember(e){const t=this.windowService.nativeWindow.performance;return t&&t.timing&&t.timing[e]?t.timing[e]:0}drainQueuedMarks(){this.queuedMarks&&this.queuedMarks.splice(0,this.queuedMarks.length).forEach(e=>this.addMeasure(e.markName,e.markName,e.measureFrom||"navigationStart",e.markName,e.eventParams))}addMeasure(e,t,i,n,r){const s=this.windowService.nativeWindow,o=s.performance.getEntriesByType("mark").find(e=>e.name===t);if(o&&this._marks.next(o),i&&!this.recordedMeasures.has(e)){this.recordedMeasures.set(e,n||e);try{s.performance.measure(e,i,t)}catch(n){return void this.logError(e,`Failed to record <${e}> for <${t}> starting from <${i}>: exception is thrown`)}this.dumpedBrowserMarkers?(r&&this.paramsForAppMeasures.set(e,r),this.log(e)):(this.instrumentationService.applyGlobalStateParams(r=r||{},!1),this.paramsForAppMeasures.set(e,r))}}log(e){this.getPerformanceDump(e).forEach(e=>{this.instrumentationService.logPerformanceEvent(e.name,e.duration,e.params)})}getPerformanceDump(e){const t=new Map;if(!e&&this.dumpedBrowserMarkers)return t;const i=this.windowService.nativeWindow;let n;if(e){const r=i.performance.getEntriesByName(e,"measure");if(!r)return t;n=r}else n=i.performance.getEntriesByType("measure").filter(e=>!this.dumpedMeasures.has(e.name)&&this.recordedMeasures.has(e.name));return n.forEach(e=>{const i=Math.ceil(e.duration);let n={};this.paramsForAppMeasures.has(e.name)&&(n=this.paramsForAppMeasures.get(e.name));const r=this.recordedMeasures.get(e.name);t.set(e.name,{name:r,duration:i,params:n}),this.dumpedMeasures.add(e.name)}),e||this.dumpBrowserMarkers(t),t}dumpBrowserMarkers(t){if(this.dumpedBrowserMarkers)return;const i=this.windowService.nativeWindow;if(this.clientStartupConfigService.config.resourceLoggingEnabled&&this.clientStartupConfigService.config.cdnDomain){const e=new RegExp(`https://${this.clientStartupConfigService.config.cdnDomain}.*`,"i"),n=i.performance.getEntriesByType("resource").filter(t=>e.test(t.name)&&("script"===t.initiatorType||"link"===t.initiatorType)).filter(e=>e.hasOwnProperty("transferSize")?e.transferSize>0:e.responseEnd-e.responseStart>20);let r,s=0;for(const e of n){const t=e.responseEnd;"number"==typeof t&&t>0&&t>s&&(s=t,r=e)}if(r){const e=r.name.split("/").pop(),i="Last_CDN_Script_Downloaded",n=r.responseEnd,s=null===this.globalStateParamsForBrowserMeasures?{}:Object.assign({},this.globalStateParamsForBrowserMeasures);s.Filename=e,t.set(i,{name:i,duration:n,params:s}),this.dumpedMeasures.add(i)}}e.getBrowserTimingMeasures(i,(e,t)=>{this.logError(e,t)},this.globalStateParamsForBrowserMeasures,(e,t)=>{this.dumpedMeasures.add(t),this.recordedMeasures.set(t,e)}).forEach(e=>{t.set(e.name,e)}),this.dumpedBrowserMarkers=!0}logError(e,t){this.instrumentationService.logGenericEvent("Performance_Mark_Failure",{Error:e,DebugInfo:t})}}return e.globalWhitelistedMarkers=new Map([["fetchStart","navigationStart"],["unloadEventStart","navigationStart"],["unloadEventEnd","unloadEventStart"],["domainLookupEnd","domainLookupStart"],["connectEnd","connectStart"],["requestStart","navigationStart"],["responseStart","requestStart"],["responseEnd","responseStart"],["domLoading","responseStart"],["domInteractive","domLoading"],["domComplete","domLoading"]]),e.ɵprov=a.bc({factory:function(){return new e(a.cc(l.a,8),a.cc(c.a),a.cc(u.a),a.cc(h.a),a.cc(d.a),a.cc(m.b),a.cc(p.b),a.cc(f.a),a.cc(g.a))},token:e,providedIn:"root"}),e})()},VY7U:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("PZOQ"),r=i("1Bt+");class s{static forRoot(){return{ngModule:s,providers:[n.a,r.a]}}}},W3Zz:function(e,t,i){"use strict";i.d(t,"d",(function(){return s})),i.d(t,"a",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return c}));var n=i("Mlb/"),r=i("BMb5"),s=function(e){return e[e.PC=0]="PC",e[e.Mac=1]="Mac",e[e.WindowsPhone=2]="WindowsPhone",e[e.iPad=3]="iPad",e[e.iPhone=4]="iPhone",e[e.AndroidPhone=5]="AndroidPhone",e[e.AndroidTablet=6]="AndroidTablet",e[e.Linux=7]="Linux",e[e.Chromebook=8]="Chromebook",e[e.Other=9]="Other",e}({}),o=function(e){return e[e.IE=0]="IE",e[e.Edge=1]="Edge",e[e.Chrome=2]="Chrome",e[e.Firefox=3]="Firefox",e[e.Safari=4]="Safari",e[e.PhantomJS=5]="PhantomJS",e[e.Other=6]="Other",e}({}),a=function(e){return e[e.Slow2g=0]="Slow2g",e[e.Standard2g=1]="Standard2g",e[e.Standard3g=2]="Standard3g",e[e.Standard4g=3]="Standard4g",e[e.Unknown=4]="Unknown",e}({});class l{constructor(e,t,i){this.major=this.normalize(e),this.minor=this.normalize(t),this.build=this.normalize(i)}compareTo(e){return this.major===e.major&&this.minor===e.minor&&this.build===e.build?0:this.major>e.major||this.major===e.major&&this.minor>e.minor||this.major===e.major&&this.minor===e.minor&&this.build>e.build?1:-1}toString(){return`${this.major}_${this.minor}_${this.build}`}normalize(e){if("number"==typeof e)return e;if("string"==typeof e){const t=parseInt(e);return isNaN(t)?0:t}return 0}}let c=(()=>{class e{constructor(e){this.windowService=e,this.platforms=[{keyword:"Windows NT",platformType:s.PC},{keyword:"Windows XP",platformType:s.PC},{keyword:"Macintosh",platformType:s.Mac},{keyword:"Windows Phone",platformType:s.WindowsPhone,pageName:"windows-phone"},{keyword:"iPad",platformType:s.iPad,pageName:"ipad"},{keyword:"iPhone",platformType:s.iPhone,pageName:"iphone"},{keyword:"Android",platformType:s.AndroidPhone,pageName:"android-phone"},{keyword:"Linux",platformType:s.Linux},{keyword:"CrOS",platformType:s.Chromebook}],this.browsers=[{keyword:"PhantomJS",browserType:o.PhantomJS},{keyword:"Edge",browserType:o.Edge},{keyword:"MSIE",browserType:o.IE},{keyword:"Trident",browserType:o.IE},{keyword:"Chrome",browserType:o.Chrome},{keyword:"CriOS",browserType:o.Chrome},{keyword:"Firefox",browserType:o.Firefox},{keyword:"Safari",browserType:o.Safari}],this.networkTypes=[{keyword:"slow-2g",networkType:a.Slow2g},{keyword:"2g",networkType:a.Standard2g},{keyword:"3g",networkType:a.Standard3g},{keyword:"4g",networkType:a.Standard4g}],this.userAgent=this.windowService.nativeWindow.navigator.userAgent}getDeviceInfo(){if(this.deviceInfo)return this.deviceInfo;const e=this.userAgent.toLowerCase();let t={keyword:"Other",platformType:s.Other};this.platforms.some(i=>-1!==e.indexOf(i.keyword.toLowerCase())&&(t=i,!0)),t.platformType===s.AndroidPhone&&-1===e.indexOf("mobile")&&(t={keyword:"Android",platformType:s.AndroidTablet,pageName:"android-tablet"});let i=new l(0,0,0);if(t.platformType===s.Mac){const e=/Mac OS X (\d+)(_|\.)(\d+)([_\.]?)(\d*)/i.exec(this.userAgent);e.length>=6&&(i=new l(e[1],e[3],e[5]))}else if(t.platformType===s.PC||t.platformType===s.WindowsPhone)if(-1!==e.indexOf("windows xp"))i=new l(5,1,0);else{const e=/Windows (NT|Phone) (OS )?(\d+)\.(\d+)/i.exec(this.userAgent);e.length>=5&&(i=new l(e[3],e[4],0))}else if(t.platformType===s.iPad||t.platformType===s.iPhone){const t=e.match(/os (\d+)_(\d+)(_(\d+))?/);i=new l(t[1]||0,t[2]||0,t[4]||0)}let n={keyword:"Other",browserType:o.Other};return this.browsers.some(t=>-1!==e.indexOf(t.keyword.toLowerCase())&&(n=t,!0)),this.deviceInfo={platform:t,platformVersion:i,browser:n},this.deviceInfo}getNetworkInfo(){if(this.networkType)return this.networkType;const e=this.windowService.nativeWindow.navigator.connection,t=e&&e.effectiveType?e.effectiveType:"Unknown";let i={keyword:"Unknown",networkType:a.Unknown};return this.networkTypes.some(e=>-1!==t.toLowerCase().indexOf(e.keyword)&&(i=e,!0)),this.networkType=i.networkType,this.networkType}isDesktopDevice(){const e=this.getDeviceInfo().platform.platformType;return e===s.PC||e===s.Mac||e===s.Linux||e===s.Chromebook}isMobileDevice(){const e=this.getDeviceInfo().platform.platformType;return e===s.iPhone||e===s.AndroidPhone||e===s.WindowsPhone}isTabletDevice(e=null){const t=this.getDeviceInfo().platform.platformType;return null!==e?t===e:t===s.iPad||t===s.AndroidTablet}isUwp(){return this.userAgent.toLowerCase().indexOf("msapphost/")>-1&&"undefined"!=typeof Windows}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.b))},token:e,providedIn:"root"}),e})()},WFKr:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("CVeG");class r{constructor(e,t){this.Finished=e,this.Value=t}static Finished(e){return new r(!0,e)}static Unfinished(e){return new r(!1,e)}}class s{constructor(...e){this.Pipeline=e}Run(e){if(!this.Pipeline||0===this.Pipeline.length)return e;let t=null;for(let i=0;i<this.Pipeline.length;i++){if(t=this.Pipeline[i](e),t.Finished)return t.Value;e=t.Value}return t?t.Value:e}}class o{static get MetacharactersMatch(){return/[\\^$*+?.()|[\]{}]/g}static get MetacharactersReplacement(){return"\\$&"}static escape(e){return e.replace(o.MetacharactersMatch,o.MetacharactersReplacement)}}let a=(()=>{class e{static Format(t,i,n){return e.FormatWithSeparator(t,e.DefaultSeparator(i),n)}static FormatWithSeparator(t,i,r){const s=[],a=e.FormatterPipeline.Run({PathArray:t,Formatted:"",Separator:i,MaxLength:r||e.DefaultMaxLength}).Formatted;s.push(a);const l=n.a.escapeHtml(i),c=`${e.PathSegmentPostfix}${e.PathSegmentPrefix}${l}${e.PathSegmentPostfix}${e.PathSegmentPrefix}`,u=e.GetRegExp(o.escape(l),"g");return s.push(`${e.PathSegmentPrefix}${n.a.escapeHtml(a).replace(u,c)}${e.PathSegmentPostfix}`),s}static DefaultSeparator(t){return t?e.DefaultPathSepRtl:e.DefaultPathSepLtr}static ZeroElements(e){return e.PathArray&&0!==e.PathArray.length?r.Unfinished(e):(e.Formatted="",r.Finished(e))}static TopTooLong(t){const i=t.PathArray[0].trim();return i.length>t.MaxLength?(t.Formatted=i.substr(0,t.MaxLength-1).trim()+e.Ellipsis,r.Finished(t)):r.Unfinished(t)}static SingleElement(e){return 1===e.PathArray.length?(e.Formatted=e.PathArray[0].trim(),r.Finished(e)):r.Unfinished(e)}static TopTooLongForSingleFollower(t){const i=t.PathArray[0].trim();return i.length+t.Separator.length+e.Ellipsis.length>t.MaxLength?(t.Formatted=i,r.Finished(t)):r.Unfinished(t)}static TopTooLongForMultipleFollowers(t){const i=t.PathArray[0].trim();return t.PathArray.length>2&&i.length+2*(t.Separator.length+e.Ellipsis.length)>t.MaxLength?(t.Formatted=i,r.Finished(t)):r.Unfinished(t)}static TopAndBottomTooLongAndOnlyElements(t){if(2===t.PathArray.length){const i=t.PathArray[0].trim(),n=t.PathArray[1].trim(),s=i.length+n.length+t.Separator.length+1-t.MaxLength;if(s>1)return t.Formatted=e.Join(i,e.Ellipsis+n.substr(s).trim(),t.Separator),r.Finished(t)}return r.Unfinished(t)}static TopAndBottomTooLongAndOtherElements(t){if(t.PathArray.length>2){const i=t.PathArray[0].trim();let n=t.PathArray[t.PathArray.length-1].trim();const s=i.length+n.length+2*(t.Separator.length+1)-t.MaxLength;if(s>1)return n=n.substr(s).trim(),t.Formatted=e.Join(i,e.Ellipsis,t.Separator),n.length>0&&(t.Formatted=e.Join(t.Formatted,e.Ellipsis+n,t.Separator)),r.Finished(t)}return r.Unfinished(t)}static MultipleElements(t){return t.Formatted=t.PathArray.reduce((i,n)=>e.Join(i,n,t.Separator)),t.Formatted.length<=t.MaxLength?r.Finished(t):r.Unfinished(t)}static CollapseFirst(t){const i=e.GetRegExp(t.Separator+".*?"+t.Separator);return t.Formatted=t.Formatted.replace(i,t.Separator+e.Ellipsis+t.Separator),t.Formatted.length<=t.MaxLength?r.Finished(t):r.Unfinished(t)}static CollapseRemaining(t){const i=e.GetRegExp(t.Separator+".*?"+t.Separator+".*?"+t.Separator);for(;t.Formatted.length>t.MaxLength;){const n=t.Formatted;if(t.Formatted=t.Formatted.replace(i,t.Separator+e.Ellipsis+t.Separator),n===t.Formatted)break}return r.Finished(t)}static Join(e,t,i){return 0===t.length?e:e.trim()+i+t.trim()}static GetRegExp(t,i=""){const n=`${t}/${i}`;if(e.RegExpCache.has(n))return e.RegExpCache.get(n);const r=new RegExp(t,i);return e.RegExpCache.set(n,r),r}}return e.DefaultMaxLength=60,e.DefaultPathSepLtr=" » ",e.DefaultPathSepRtl=" « ",e.Ellipsis="…",e.PathSegmentPrefix='<span dir="auto">',e.PathSegmentPostfix="</span>",e.FormatterPipeline=new s(e.ZeroElements,e.TopTooLong,e.SingleElement,e.TopTooLongForSingleFollower,e.TopTooLongForMultipleFollowers,e.TopAndBottomTooLongAndOnlyElements,e.TopAndBottomTooLongAndOtherElements,e.MultipleElements,e.CollapseFirst,e.CollapseRemaining),e.RegExpCache=new Map,e})()},WJRI:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return a}));var n=i("Mlb/"),r=i("vk2e"),s=(i("kVgv"),n.wb({encapsulation:2,styles:[],data:{}}));function o(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["aria-live","assertive"],["class","title-announcement"],["tabindex","-1"]],null,null,null,null,null)),(e()(),n.Xb(1,null,[" ","\n"]))],null,(function(e,t){e(t,1,0,t.component.announcement)}))}function a(e){return n.ac(2,[(e()(),n.hb(16777216,null,null,1,null,o)),n.xb(1,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.component.announcement)}),null)}},WLAd:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("hZW2");let s=(()=>{class e{constructor(e){this.documentService=e}addOnVisibilityChanged(e){const t=this.documentService.nativeDocument;t.addEventListener("visibilitychange",()=>e(t.visibilityState))}getVisibilityState(){return this.documentService.nativeDocument.visibilityState}isVisible(){return"visible"===this.getVisibilityState()}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a))},token:e,providedIn:"root"}),e})()},XV2T:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));let n=(()=>{class e{constructor(t,i){if(this.userId=t||e.unknownUserId,this.nativeStorage=i,this.nativeStorage){const e=this.getUserBasedKey("_"+Math.round(1e6*Math.random()));try{this.nativeStorage.setItem(e,e),this.nativeStorage.removeItem(e)}catch(e){this.nativeStorage=null}}}get(e){return this.getItem(this.getUserBasedKey(e))}set(e,t){this.setItem(this.getUserBasedKey(e),t)}remove(e){this.removeItem(this.getUserBasedKey(e))}getGlobal(e){return this.getItem(e)}setGlobal(e,t){this.setItem(e,t)}removeGlobal(e){this.removeItem(e)}findKeys(e){if(!this.nativeStorage||!e)return null;const t=[];for(let i=0;i<this.nativeStorage.length;i++){const n=this.nativeStorage.key(i);n.indexOf(e)>=0&&t.push(n)}return t}getItem(e){if(!this.nativeStorage)return null;const t=this.nativeStorage.getItem(e);return"string"==typeof t?JSON.parse(t):void 0}setItem(e,t){if(this.nativeStorage)try{const i=void 0===t?void 0:JSON.stringify(t);this.nativeStorage.setItem(e,i)}catch(e){}}removeItem(e){this.nativeStorage&&this.nativeStorage.removeItem(e)}getUserBasedKey(t){return`${e.officeHomeStorageKeyPrefix}-${this.userId}${t}`}}return e.officeHomeStorageKeyPrefix="officeHome",e.unknownUserId="Unknown",e})()},Z0U4:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("qk26"),r=i("6UlS"),s=i("S5zL"),o=i("70cc"),a=i("BaAg"),l=i("Mlb/"),c=i("4/We"),u=i("hhzZ"),h=i("uzn7"),d=i("vk2e"),m=i("BMb5"),p=i("5aVq");let f=(()=>{class e{constructor(t,i,n,o,a,l,c,u,h){this.activatedRoute=t,this.capabilitiesService=i,this.instrumentationService=n,this.localStorageService=o,this.locationStrategy=a,this.platformLocation=l,this.router=c,this.windowService=u,this.shellShimService=h;const d=this.windowService.nativeWindow.history;if(this.historyEnabled=!!d&&!!d.go,this.historyEnabled)try{this.lastPoppedState=this.parseState(d.state),this.windowService.nativeWindow.addEventListener("popstate",e=>{this.lastPoppedState=this.parseState(e.state)})}catch(e){this.historyEnabled=!1}this.historyEnabled||this.instrumentationService.logGenericEvent("History_Disabled"),this.initialRoute=this.currentRouteFromPath(this.platformLocation.pathname),this._routes=new r.a({currentRoute:this.initialRoute,type:0}),this.routes=this._routes.asObservable().pipe(Object(s.a)((t,i)=>t.type===i.type&&e.areRoutesEqual(t.currentRoute,i.currentRoute))),this.nativeSearchEnabled=this.capabilitiesService.capabilities.nativeSearchInHeaderEnabled}static areRoutesEqual(e,t){return e&&t&&e.route===t.route&&e.app===t.app}start(){this.router.events.pipe(Object(o.a)(e=>e instanceof n.e||e instanceof n.d)).subscribe(t=>{const i=t.url?t.url.split("?")[0]:null,r=this.currentRouteFromPath(i),s={currentRoute:r,type:t instanceof n.e?0:1},o=!this.ignoreNextNavigation&&(!this.currentRouteState||!e.areRoutesEqual(r,this.currentRouteState.routeItem)||this.rewriteInProgress);if(this.isRouteChangeEndEvent(s)){if(this.ignoreNextNavigation)return void(this.ignoreNextNavigation=!1);let t={routeItem:r,index:this.historyEnabled?this.windowService.nativeWindow.history.length:-1,backRouteItem:null,backIndex:-1,version:e.officeRouteStateVersion};if(this.lastPoppedState&&e.areRoutesEqual(this.lastPoppedState.routeItem,r))t=this.lastPoppedState;else if(this.historyEnabled&&this.currentRouteState){if(t.index!==this.currentRouteState.index+1){const e={};e.Index=t.index.toString(),r&&(e.State=r.route,e.DocumentType=r.app?a.b[r.app]:""),e.Error=this.versionMismatch?"Version":"Index",e.DebugInfo=`new: ${JSON.stringify(t)}, current: ${JSON.stringify(this.currentRouteState)}, previous: ${JSON.stringify(this.previousRouteState)}`,this.instrumentationService.logGenericEvent("Unexpected_History_State",e),this.previousRouteState||this.currentRouteState.routeItem&&"OfficeHome"===this.currentRouteState.routeItem.route||(this.historyEnabled=!1,t.index=-1)}if(this.historyEnabled){t.index=this.currentRouteState.index+1;const i=e.areRoutesEqual(this.currentRouteState.routeItem,r);t.backRouteItem=i?this.currentRouteState.backRouteItem:this.currentRouteState.routeItem,t.backIndex=i?this.currentRouteState.backIndex:this.currentRouteState.index}}this.updateState(t),this.lastPoppedState=null,this.previousRouteState=this.currentRouteState,this.currentRouteState=t,this.rewriteInProgress=!1,s.previousRoute=this.previousRouteState?this.previousRouteState.routeItem:null,s.backRoute=t.backRouteItem}o&&this._routes.next(s)})}hasNavigated(){return this.router.navigated}back(e=null){if(!this.currentRouteState)return void(e&&this.navigateTo(e));this.nativeSearchEnabled&&this.currentRouteState.routeItem&&"Search"===this.currentRouteState.routeItem.route&&this.shellShimService.getShellShim().then(e=>{e.Search.SetSearchText("")});const t=this.currentRouteState.backIndex-this.currentRouteState.index;this.historyEnabled&&this.currentRouteState.backIndex>=0&&t<0?this.windowService.nativeWindow.history.go(t):e?this.navigateTo(e):this.platformLocation.back()}navigateTo(e,t=!1,i=null,n){if(!e)return;let r=Object.assign({},this.activatedRoute.snapshot.queryParams);"Search"!==e.route&&this.currentRouteState&&this.currentRouteState.routeItem&&"Search"===this.currentRouteState.routeItem.route&&(delete r.q,delete r.p,delete r.e,delete r.s),this.currentRouteState&&this.currentRouteState.routeItem&&"Content"===this.currentRouteState.routeItem.route&&(delete r.item,delete r.drive,delete r.file,delete r.action,delete r.siteUrl,delete r.abpId,delete r.t),i&&(r=Object.assign(Object.assign({},r),i));const s=[];switch(e.route){case"AppGallery":s.push("apps");break;case"Search":case"SearchSiteScoped":s.push("search");break;case"Start":s.push(this.capabilitiesService.capabilities.startPageRootPath);break;case"Templates":s.push(this.capabilitiesService.capabilities.templatePageRootPath);break;case"Pwa":s.push("pwa");break;case"Content":case"AppItems":case"GroupItems":s.push(this.capabilitiesService.capabilities.startPageRootPath);break;case"M365Apps":s.push(this.capabilitiesService.capabilities.m365AppsPageRootPath);break;default:s.push("home")}e.app&&s.push(a.b[e.app]),"AppItems"===e.route&&s.push("appitems"),"GroupItems"===e.route&&s.push("groupitems"),"Content"===e.route&&s.push(this.capabilitiesService.capabilities.wacHostPagePath.replace("/","")),t&&(this.currentRouteState=this.previousRouteState,this.rewriteInProgress=!0),n&&s.length&&this.localStorageService.set(n,s[0]),this.router.navigate(s.map(e=>e.toLowerCase()),{queryParams:r,replaceUrl:t})}updateQueryParams(e){this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:e,queryParamsHandling:"merge",replaceUrl:!0})}navigateToAuxilaryRoute(e,t){const i={};i[e]=t?[t]:null,this.ignoreNextNavigation=!0,this.router.navigate([{outlets:i}],{queryParamsHandling:"preserve",skipLocationChange:!0})}redirectAndRewrite(e="/",...t){this.currentRouteState=this.previousRouteState,this.rewriteInProgress=!0;const i=[e].concat(t);this.router.navigate(i,{queryParamsHandling:"preserve",replaceUrl:!0})}subscribeToRouteChangeStart(e){return this.routes.pipe(Object(o.a)(this.isRouteChangeStartEvent)).subscribe(e)}subscribeToRouteChangeEnd(e){return this.routes.pipe(Object(o.a)(this.isRouteChangeEndEvent)).subscribe(e)}getRouteChangeStartObservable(){return this.routes.pipe(Object(o.a)(this.isRouteChangeStartEvent))}getRouteChangeEndObservable(){return this.routes.pipe(Object(o.a)(this.isRouteChangeEndEvent))}isOnRoute(e){return this.currentRouteState.routeItem.route===e}getCurrentRoute(){return this.currentRouteState?this.currentRouteState.routeItem:null}getRouteItemForCurrentLocation(){return this.currentRouteFromPath(this.platformLocation.pathname)}isRouteChangeStartEvent(e){return 0===e.type}isRouteChangeEndEvent(e){return 1===e.type}currentRouteFromPath(e){if(!e)return null;if("/"===(e=e.toLowerCase())||0===e.indexOf("/home"))return{route:this.capabilitiesService.capabilities.pwaEnabled?"Pwa":"OfficeHome"};if(0===e.indexOf("/apps"))return{route:"AppGallery"};if(0===e.indexOf("/search"))return{route:this.isScopedSearchRoute(e)?"SearchSiteScoped":"Search"};if(0===e.indexOf("/pwa"))return{route:"Pwa"};if(0===e.indexOf("/m365apps"))return{route:"M365Apps"};const t=0===e.indexOf(this.capabilitiesService.capabilities.templatePageRootPath.toLowerCase()),i=0===e.indexOf(this.capabilitiesService.capabilities.startPageRootPath.toLowerCase()),n=e.indexOf(this.capabilitiesService.capabilities.wacHostPagePath.toLowerCase())>=0&&i,r=e.toLocaleLowerCase().indexOf("/appitems")>=0&&i,s=e.toLocaleLowerCase().indexOf("/groupitems")>=0&&i;if(t||i||n||r||s){const i=e.split("/");return{route:t?"Templates":n?"Content":r?"AppItems":s?"GroupItems":"Start",app:a.a.fileTypeNameToFileType(i[n||r||s?i.length-2:i.length-1])}}return null}parseState(t){const i=t?t.ohpState:null;return i&&i.version!==e.officeRouteStateVersion&&(this.versionMismatch=!0),this.versionMismatch?null:i}updateState(e){if(this.historyEnabled){const t=this.windowService.nativeWindow.history.state?Object.assign({},this.windowService.nativeWindow.history.state):{};t.ohpState=e,this.locationStrategy.replaceState(t,"",this.platformLocation.pathname,this.platformLocation.search)}}isScopedSearchRoute(e){return e.startsWith("/search/siteall")||e.startsWith("/search/sitenews")||e.startsWith("/search/sitesites")||e.startsWith("/search/sitefiles")}}return e.officeRouteStateVersion=1,e.ɵprov=l.bc({factory:function(){return new e(l.cc(n.a),l.cc(c.a),l.cc(u.a),l.cc(h.a),l.cc(d.h),l.cc(d.q),l.cc(n.m),l.cc(m.b),l.cc(p.a))},token:e,providedIn:"root"}),e})()},ZBli:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("pjz5");class r{static appendQueryParam(e,t,i){if(!e||!t)return e;const n={};return n[t]=i,r.appendQueryParams(e,n)}static appendQueryParams(e,t,i){return e?r.appendQuery(e,r.buildQueryPath(t,i)):e}static appendQuery(e,t){if(!e||!t)return e;const{protocol:i,hostname:r,port:s,path:o,search:a,hash:l}=n.a.getLocation(e);return`${i}//${r}${s?":"+s:""}${o}${a?a+"&":"?"}${t}${l}`}static appendAndReplaceQueryParams(e,t,i,s){if(!e||!t)return e;const o={},{protocol:a,hostname:l,path:c,search:u,hash:h}=n.a.getLocation(e);"?"===u[0]&&u.substring(1).split("&").forEach(e=>{const t=e.split("=");i?o[decodeURIComponent(t[0])]=decodeURIComponent(t[1]):o[t[0]]=t[1]});for(const e in t)o[e]=t[e];return r.appendQueryParams(a+"//"+l+c+h,o,s)}static removeQueryParams(e,t,i){if(!e||!t)return e;const s={},{protocol:o,hostname:a,path:l,search:c,hash:u}=n.a.getLocation(e);return"?"===c[0]&&c.substring(1).split("&").forEach(e=>{const n=e.split("="),r=i?decodeURIComponent(n[0]):n[0];t.some(e=>e.toLowerCase()===r.toLowerCase())||(s[r]=i?decodeURIComponent(n[1]):n[1])}),r.appendQueryParams(o+"//"+a+l+u,s,!1)}static buildQueryPath(e,t){if(!e)return"";let i="";for(const n in e){const r=i?"&":"";let s;s=t?e[n]?""+e[n]:"":e[n]?""+encodeURIComponent(e[n]):"",i=`${i}${r}${n}=${s}`}return i}static replacePathAndAddParams(e,t,i){const s=i?r.appendAndReplaceQueryParams(e,i,!1):e,{protocol:o,hostname:a,port:l,search:c,hash:u}=n.a.getLocation(s);return`${o}//${a}${l?":"+l:""}${t}${c}${u}`}}},ZJrL:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static parseJsonElementWithId(e){const t=document.getElementById(e),i=t&&t.textContent;return i?JSON.parse(i):null}static decodeJsonString(e){const t=e.split('"');return t.forEach((e,t,i)=>{const n=decodeURIComponent(e);i[t]=n.replace(/"/g,'\\"')}),t.join('"')}}},ZtId:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},aQ3G:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("3GGT"),r=i("uUrA"),s=i("Uqr9"),o=i("pOWU");class a{}class l{constructor(){this.cachedResponsePromises=new Map}set(e,t,i,n){const r=this.key(t,i,n);this.cachedResponsePromises.set(r,e)}has(e,t,i){const n=this.key(e,t,i);return this.cachedResponsePromises.has(n)}get(e,t,i){const n=this.key(e,t,i);return this.cachedResponsePromises.get(n)}delete(e,t,i){const n=this.key(e,t,i);return this.cachedResponsePromises.delete(n)}key(e,t,i){return`${t?"beta":"v1.0"}/${i}/${e}`}}let c=(()=>{class e extends o.a{constructor(e,t,i,n,r,s,o,a){super(e,t,i,"Graph",n,r,s,a),this.globalErrorHandler=o,this.cachedResponsePromises=new l;const{officeHomeApiRoot:c,graphApiRoot:u}=n.sharedContext;this.graphServiceHost=this.inMockMode?c:u,this.requestConfig={headers:new Map}}getGraph(e,t,i,n,r=!1,s,a,l,c=!1,u,h=null,d=!1){if(!d&&this.cachedResponsePromises.has(t,c,i))return this.cachedResponsePromises.get(t,c,i);const m=new Promise((d,m)=>{const p=this.getGraphServiceEndpoint(t,c);p||m(new o.b(null,"Graph service endpoint url is not defined"));const f=Object.assign({},this.requestConfig);f.responseType=void 0!==u?u:"json",super.get(e,p,e=>{e.instrument((e,t)=>{t.params.RequestId=this.getRequestIdFromResponse(e),n&&n(e,t)}).then(e=>d(e)).catch(e=>{this.globalErrorHandler.handleError(e,"XDHsY")})},e=>{r&&this.cachedResponsePromises.delete(t,c,i),m(e)},f,i,s,a,l,void 0,void 0,h)});return r&&this.cachedResponsePromises.set(m,t,c,i),m}postGraph(e,t,i,n,r,s,o,a,l,c=!1,u=!1,h=null){const d=this.getGraphServiceEndpoint(t,c);return super.post(e,d,i,n,r,this.requestConfig,s,o,a,l,void 0,null,null,null,u,h)}putGraph(e,t,i,n,r,s,o,a,l,c=!1){const u=this.getGraphServiceEndpoint(t,c);return super.put(e,u,i,n,r,this.requestConfig,s,o,a,l)}batchGraph(e,t){const i=this.contextService.sharedContext.graphMaxBatchSize,n=[];for(let r=0;r<e.length;r+=5)n.push(this.batchGraphMaxSize(e.slice(r,r+i),t));return Promise.all(n).then(e=>[].concat(...e))}patchGraph(e,t,i,n,r,s,o,a,l,c,u,h,d=!1){const m=this.getGraphServiceEndpoint(t,d);return super.patch(e,m,i,n,r,s||this.requestConfig,o,a,l,c,u,h)}handleQueryParam(t,i){"mockgraph"===t&&this.requestConfig.headers.set(e.mockGraphHeader,i)}batchGraphMaxSize(e,t){const i=this.contextService.sharedContext.graphMaxBatchSize;if(e.length>i)return Promise.reject(new o.b(null,`Batch requests limited to ${i} items`));const n="network-only",r=e=>e.cacheResult&&"GET"===e.method,s=e.filter(e=>!r(e)||!this.cachedResponsePromises.has(e.endpoint,!0,n)),l=this.batchGraphUncached(s,t);let c=0;const u=e.map(e=>{const t=r(e);if(t&&this.cachedResponsePromises.has(e.endpoint,!0,n))return this.cachedResponsePromises.get(e.endpoint,!0,n);const i=c,s=l.then(r=>{if(r&&r.length>i){const s=r[i];return!t||s&&s.ok||this.cachedResponsePromises.delete(e.endpoint,!0,n),s}throw new a}).catch(i=>(i instanceof a||this.globalErrorHandler.handleError(i,"ioc6B"),t&&this.cachedResponsePromises.delete(e.endpoint,!0,n),null));return t&&this.cachedResponsePromises.set(s,e.endpoint,!0,n),c++,s});return Promise.all(u)}batchGraphUncached(t,i){return new Promise((n,a)=>{const l=i||"Graph_Batch_Request",c=this.getGraphServiceEndpoint(e.graphBatchEndpoint,!0),u=t.map((e,t)=>{let i=void 0;return e.headers&&(i={},e.headers.forEach((e,t)=>i[t]=e)),{id:t,method:e.method.toUpperCase(),url:e.endpoint,headers:i,body:e.body}}),h=u.length,d={requests:u},m=r.a.createGuid(),p=s.a.now(),f=(e,i,r)=>{e.instrument((e,t)=>{if(t.params.RequestId=this.getRequestIdFromResponse(e),t.params.Index=r.toString(),t.params.BatchId=m,t.params.BatchSize=h.toString(),e.ok){const i=e.data.responses||[],n=i.length,r=i.filter(e=>e.status>=200&&e.status<300).length;t.params.ItemCount=n.toString(),t.params.SuccessCount=r.toString(),t.params.ErrorCount=(n-r).toString()}}).then(e=>{const r=e.data;if(r&&(r.responses||r.nextLink)){const o=i.concat(r.responses||[]),a=Math.ceil(s.a.now()-p),l=this.orderAndInstrumentBatchResponses(t,o,e.config,e.fromCache,m,h,a);n(l)}else a(new o.b(e,"Could not parse graph batch response"))}).catch(e=>{this.globalErrorHandler.handleError(e,"wFM08")})};super.post(l,c,d,e=>f(e,[],1),e=>{a(e)},this.requestConfig)})}orderAndInstrumentBatchResponses(e,t,i,r,s,o,a){return e.map((e,l)=>{const c=t.find(e=>e.id===l),u=c.status.toString(),h=c?{data:c.body,status:c.status,headers:c.headers,config:i,ok:c.status>=200&&c.status<300,statusText:u,fromCache:r}:null,d=this.instrumentationService.generateRequestEvent(e.eventName+"_Batched",c?c.status:n.a.UnexpectedResponse,a,h?null:"Response missing from batch",h.fromCache);return d.params.BatchId=s,d.params.BatchSize=o.toString(),d.params.Index=l.toString(),e.instrumentCallback&&h&&h.ok&&e.instrumentCallback(h,d),d.record(),h})}getGraphServiceEndpoint(t,i=!1){return this.graphServiceHost?`${this.graphServiceHost}/${i?e.graphBeta:e.graphV1}/${t}`:""}}return e.graphV1="v1.0",e.graphBeta="beta",e.graphBatchEndpoint="$batch",e.mockGraphHeader="ohp-mock-graph",e})()},aXuH:function(e,t,i){},casz:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("bb6g"),r=i("5f+/"),s=i("Mlb/"),o=i("x+6c"),a=i("lrJm"),l=i("WLAd"),c=i("BMb5"),u=i("Uqr9");let h=(()=>{class e{constructor(e,t,i,n,s){this.idleCallbackService=e,this.errorHandler=t,this.pageVisibilityService=i,this.windowService=n,this.performanceService=s,this.heap=new r.a([],(e,t)=>this.compare(e,t)),this.isProcessing=!1,this.loggedFirstIdle=!1,this.loggedFirstSchedule=!1,this.setOnVisibilityChange(),this.setOnGlobalWindow()}scheduleWork(e,t){0!==t?(this.loggedFirstSchedule||(this.loggedFirstSchedule=!0,this.performanceService.mark("First_Schedule")),this.heap.push({work:e,priority:t}),this.dequeueWhenIdle()):e()}hasTasks(){return!!this.heap.peek()}dequeueWhenIdle(){this.pageVisibilityService.isVisible()?this.idleCallbackHandle||(this.idleCallbackHandle=this.idleCallbackService.runWhenIdle(e=>{this.loggedFirstIdle||(this.loggedFirstIdle=!0,this.performanceService.mark("First_Idle")),this.idleCallbackHandle=null,this.doWork(e)})):this.doWork()}doWork(e){return Object(n.b)(this,void 0,void 0,(function*(){if(!this.isProcessing){for(this.isProcessing=!0;!this.pageVisibilityService.isVisible()||e&&e.timeRemaining()>0;){const e=this.heap.pop();if(!e)break;try{yield e.work()}catch(e){this.errorHandler.handleError(e,"DXUlK")}}this.isProcessing=!1,this.heap.peek()&&this.dequeueWhenIdle()}}))}compare(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}setOnGlobalWindow(){this.windowService.nativeWindow.scheduler=this}setOnVisibilityChange(){this.pageVisibilityService.addOnVisibilityChanged(e=>{"hidden"===e&&(this.idleCallbackHandle&&this.idleCallbackService.cancelIdleCallback(this.idleCallbackHandle),this.doWork())})}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(o.a),s.cc(a.b),s.cc(l.a),s.cc(c.b),s.cc(u.b))},token:e,providedIn:"root"}),e})()},cgnd:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return u}));var n=i("lrJm"),r=i("ZJrL"),s=i("Mlb/"),o=i("dFxn"),a=function(e){return e[e.MSA=0]="MSA",e[e.OrgId=1]="OrgId",e[e.Unknown=-1]="Unknown",e}({});let l,c,u=(()=>{class e{constructor(e){this.config=function(e){if(!l){l=!0;try{c=e?e.parse("clientStartupConfiguration"):r.a.parseJsonElementWithId("clientStartupConfiguration")}catch(e){throw new n.a("Failure to parse clientStartupConfiguration from response",e)}if(!c)throw new n.a("clientStartupConfiguration is not present in response");const t=c.authTypeString;"MSA"===t?(c.authType=a.MSA,window.pwaCurrentUserId&&0===window.pwaCurrentUserId.indexOf("consumers_")&&(c.puid=window.pwaCurrentUserId.substring("consumers_".length)),window.userPrincipalName&&(c.userPrincipalName=window.userPrincipalName)):c.authType="OrgId"===t?a.OrgId:a.Unknown}return function(e){let t;t=e.length?"https://"+e:window.location.origin,t+="/bundles/",i.p=t}(c.cdnDomain),c}(e)}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(o.a))},token:e,providedIn:"root"}),e})()},ci1G:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},cxfp:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},dFxn:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("lrJm"),r=i("ZJrL"),s=i("Mlb/");let o=(()=>{class e{constructor(e){this.globalErrorHandler=e}parse(e){try{return r.a.parseJsonElementWithId(e)}catch(t){const i=new n.a(`Failure to parse ${e} from response`,t);this.globalErrorHandler.handleError(i)}return null}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(s.m))},token:e,providedIn:"root"}),e})()},dOgD:function(e,t,i){"use strict";i.d(t,"a",(function(){return D}));var n=i("Mlb/"),r=i("kaEK"),s=i("9260"),o=i("hhzZ"),a=i("BaAg"),l=i("RR/o"),c=i("pOWU"),u=i("uUrA"),h=i("CVeG"),d=i("oAX+");let m=(()=>{class e extends c.a{constructor(e,t,i,n,r,s,o,a,l,c,u,h,d,m,p){super(e,n,r,"Substrate",i,o,l,d),this.capabilitiesService=t,this.locService=s,this.mruConfigService=a,this.globalErrorHandler=c,this.startupConfigService=u,this.updateContentService=h,this.dateService=m,this.windowService=p,this.fetchRequestIndex=0;const f=this.capabilitiesService.capabilities;this.scenario=f.antpLoaded?"OfficeComANTP":f.pwaEnabled?"OfficeComApp":"OfficeComHome",this.baseUrl=this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:""+this.mruConfigService.config.substrateApiEndpoint,this.officeFeedDataStreams=new Map,this.regExp=new RegExp("{([0-9]+)}"),this.feedFlight=this.mruConfigService.config.officeFeedFlightEnabled}getOfficeFeed(){var t,i;let n=`${this.baseUrl}/PeoplePredictionsB2/MicrosoftFeed?section=OfficeComHome&scenario=${this.scenario}&${e.locParam}${this.contextService.sharedContext.officeMarket}`;const r=this.startupConfigService.config.sharedClientStartupContext.flights.toLowerCase();if(r.includes(this.mruConfigService.config.officeFeedFlightControlName.toLowerCase())?n+="&experiment="+(null===(t=this.mruConfigService.config.officeFeedExperimentControlName)||void 0===t?void 0:t.toLowerCase()):r.includes(this.mruConfigService.config.officeFeedFlightName.toLowerCase())&&(n+="&experiment="+(null===(i=this.mruConfigService.config.officeFeedExperimentName)||void 0===i?void 0:i.toLowerCase())),this.officeFeedDataStreams.has(n))return this.officeFeedDataStreams.get(n);const s=this.updateContentService.getOrAddUpdateStream("officefeed-"+n,()=>this.fetchOfficeFeed("network-first",n)),o=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchOfficeFeed(n):this.fetchOfficeFeed("network-first",n),a=d.a.createResultsWithCacheObservable(this.fetchOfficeFeed("cache-only",n),o,s,e=>this.officeFeedDataStreams.delete(n));return this.officeFeedDataStreams.set(n,a),a}prefetchOfficeFeed(e){return this.windowService.nativeWindow.prefetchRecommendedDataPromise?this.windowService.nativeWindow.prefetchRecommendedDataPromise.then(e=>e?{items:e.map(e=>this.convertItemToMruDataItem(e)).filter(e=>{var t;return e&&(null===(t=e.Activity)||void 0===t?void 0:t.formatString)}),impressionId:e.recommendedRequestId||"",fromCache:!1}:Promise.reject("Prefetch failed")):this.fetchOfficeFeed("network-first",e)}fetchOfficeFeed(e,t){return new Promise((i,n)=>{const r=u.a.createGuid(),a=this.createRequestConfig(r);this.get("OfficeFeedRequest",t,n=>{n.instrument((i,n)=>{if(n.params.RequestId=this.getRequestIdFromResponse(i),n.params.Index=(this.fetchRequestIndex++).toString(),n.params.ImpressionId=!!i.headers&&i.headers.get(s.a.clientRequestIdHeader)||r,i.ok&&i.data){let e=0;e=i.data.length,n.params.ResourceIdDistribution=i.data.map(e=>e.sharePointIds&&e.sharePointIds.listItemUniqueId?e.sharePointIds.listItemUniqueId:"").toString(),n.params.OfficeFeedCategoryDistribution=i.data.map(e=>e.category).toString(),n.params.ActualSize=e.toString()}else"cache-only"===e&&401===i.status&&(n.params.OfficeFeedUrl=o.a.filterPii(t),n.params.OfficeFeedAuthenticateHeader=i.headers.get("WWW-Authenticate"))}).then(t=>{const n=(t&&t.data||[]).map(e=>this.convertItemToMruDataItem(e)).filter(e=>{var t;return e&&(null===(t=e.Activity)||void 0===t?void 0:t.formatString)});i({items:n,impressionId:!!t.headers&&t.headers.get(s.a.clientRequestIdHeader)||r,fromCache:"cache-only"===e})}).catch(e=>{this.globalErrorHandler.handleError(e,"AfEUN")})},n,a,e)})}logInstrumentation(e,t,i,n){return new Promise((r,s)=>{const o=(this.inMockMode?this.contextService.sharedContext.officeHomeApiRoot:this.mruConfigService.config.substrateApiEndpoint)+"/peoplepredictionsb2/Feedback",a=[];for(let r=0;r<e.length;r++)a.push({FeedbackId:e[r],Action:t[r],ItemSource:i[r],Target:n?n[r]:"",Timestamp:new Date(Date.now()).toISOString()});const l={Actions:a},c=this.createRequestConfig(this.startupConfigService.config.sharedClientStartupContext.correlationId);this.post("OfficeFeedInstrumentation",o,l,e=>{e.instrument((e,t)=>{t.params.ItemCategory=a.map(e=>e.Action).join(",")}).then(()=>r(null))},s,c,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.mruConfigService.config.deferFeedWrite?4:0)})}getStreamsThumbnail(e){const t=new FileReader;return new Promise((i,n)=>{const r=this.createRequestConfig(this.startupConfigService.config.sharedClientStartupContext.correlationId,"blob");this.get("OfficeFeed_Stream_Thumbnail_Request",e,e=>{e.then(e=>{e&&e.data?(t.onloadend=()=>{const e=t.result&&"string"==typeof t.result&&t.result||"";i(e.length>0?e:null)},t.onerror=()=>i(null),t.onabort=()=>i(null),t.readAsDataURL(e.data)):i(null)}).catch(e=>{this.globalErrorHandler.handleError(e,"AfEUN")})},n,r,"network-only")})}handleQueryParam(e,t,i){"mockofficefeed"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}createRequestConfig(e,t){const i={headers:new Map([["ScenarioTag",this.scenario],["Content-Type","application/json"],["X-OfficeFeedFlight",this.feedFlight?"experiment":"evaluation"],[s.a.clientRequestIdHeader,e]])};return t&&(i.responseType=t),i}convertItemToMruDataItem(e){return"file"===e.category.toLowerCase()||"video"===e.category.toLowerCase()?this.convertFileToMruDataItem(e):"newsarticle"===e.category.toLowerCase()?this.convertNewsItemToMruDataItem(e):"upcomingmeeting"===e.category.toLowerCase()&&this.mruConfigService.config.upcomingMeetingEnabled?this.convertUpcomingMeetingToMruDataItem(e):null}convertUpcomingMeetingToMruDataItem(e){var t,i,n,s,o,l,c,u;const h=null!==(i=new Date(null===(t=e.upcomingMeetingInfo)||void 0===t?void 0:t.start))&&void 0!==i?i:null,d=this.dateService.timespanInSeconds(h),m=null!==(n=new Date(e.expiresAt))&&void 0!==n?n:null,p=new Date;if(m&&p>m)return null;const f=d>0;let g=f?this.locService.OfficeFeedYourUpcomingMeetingStarted:this.locService.OfficeFeedYourUpcomingMeeting;!f&&d>-60&&(g=this.locService.OfficeFeedYourUpcomingMeetingHappeningNow);const b=this.locService.JoinTeamsMeeting,v={formatString:g,plainText:g,people:null,reasonType:r.a.Meeting,timestamp:null!==(o=new Date(null===(s=e.upcomingMeetingInfo)||void 0===s?void 0:s.start))&&void 0!==o?o:null};return{Application:null,Category:e.category,DocId:null,DriveId:null,FileName:null,Title:null===(l=e.previewInfo)||void 0===l?void 0:l.text,Url:e.webUrl,WebUrl:e.webUrl,LastAccessedTime:h,FileType:"UpcomingMeeting",PathArray:null,Provenance:a.c[a.c.Substrate],UrlAlreadyEncoded:!0,Activity:v,FeedbackId:e.feedbackId,Attendees:e.upcomingMeetingInfo.attendees,Subject:e.upcomingMeetingInfo.subject,JoinUrl:null===(c=e.upcomingMeetingInfo.onlineMeeting)||void 0===c?void 0:c.joinUrl,MeetingStart:this.locService.formatTimeFromDate(new Date(e.upcomingMeetingInfo.start)),MeetingEnd:this.locService.formatTimeFromDate(new Date(e.upcomingMeetingInfo.end)),Location:null===(u=e.upcomingMeetingInfo.location)||void 0===u?void 0:u.displayName,Organizer:e.upcomingMeetingInfo.organizer,JoinMeetingText:b}}convertNewsItemToMruDataItem(e){const t=this.locService.format(this.locService.OfficeFeedPostedBy,e.newsArticleInfo&&e.newsArticleInfo.byLine||""),i=this.locService.format(this.locService.OfficeFeedPostedBy,`<c0>${e.newsArticleInfo&&e.newsArticleInfo.byLine||""}</c0>`),n=e.createdBy&&e.createdBy.User||{},s={formatString:i,plainText:t,people:[{upn:n.Id,tag:"c0",name:n.DisplayName}],reasonType:r.a.News,timestamp:e.newsArticleInfo.firstPublishedDateTime?new Date(e.newsArticleInfo.firstPublishedDateTime):null},o=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null;return{Application:null,Category:e.category,DocId:e.oneDriveItemInfo&&e.oneDriveItemInfo.itemId,DriveId:e.oneDriveItemInfo&&e.oneDriveItemInfo.driveId,FileName:e.name,Title:e.name,Url:e.uri,WebUrl:e.webUrl,LastAccessedTime:o,FileType:"NewsArticle",PathArray:null,Provenance:a.c[a.c.Substrate],ResourceId:e.sharePointIds?e.sharePointIds.listItemUniqueId:"",UrlAlreadyEncoded:!0,Activity:s,ThumbnailUrl:e.previewInfo.image,FeedbackId:e.feedbackId}}convertOfficeFeedActivityToActivityDescription(e){let t=e.reason||"",i=null;for(;null!==(i=this.regExp.exec(t));){const n=i[1];t=t.replace(i[0],()=>`<c${n}>${e.actors[n].User.DisplayName}</c${n}>`)}return{formatString:t,plainText:h.a.stripTags(t),people:(e.actors||[]).map((function(e,t){return{upn:e&&e.User.email,tag:"c"+t,name:e.User.DisplayName}})),reasonType:"popularVideoInclusionReason"===e.kind?r.a.Trending:"meetingRecordingInclusionReason"===e.kind?r.a.Video:this.convertReasonTypeToActivityReason(e.inclusionKind),timestamp:e.dateTime?new Date(e.dateTime):null}}convertReasonTypeToActivityReason(e){return l.b.convertMruReasonTypeToActivityReason(l.a[e])}convertFileToMruDataItem(e){var t;const i=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null,n=e.sharePointIds,r=n&&{list_id:n.listId,list_item_unique_id:n.listItemUniqueId,site_id:n.siteId,site_url:null,web_id:n.webId},s=e.inclusionReasons&&e.inclusionReasons[0];let o=void 0,l=void 0,c=void 0,u=!1;s&&(c=this.convertOfficeFeedActivityToActivityDescription(s),u="EmailAttachment"===s.inclusionKind,this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled&&(o=s.sharingWebUrl),this.capabilitiesService.capabilities.recommendedDeepLinkEnabled&&(l=s.navigationId));const h="video"===e.category.toLowerCase()?"StreamsVideo":"Document",d="StreamsVideo"===h?null===(t=e.video)||void 0===t?void 0:t.mediaDuration:void 0;return{Application:a.b[this.fileType(e)],Category:h,DocId:e.oneDriveItemInfo&&e.oneDriveItemInfo.itemId,DriveId:e.oneDriveItemInfo&&e.oneDriveItemInfo.driveId,FileName:e.name,Title:e.name,Url:u?e.webUrl:e.uri,WebUrl:e.webUrl,LastAccessedTime:i,FileType:a.b[this.fileType(e)],PathArray:null,Provenance:a.c[a.c.Substrate],ResourceId:e.sharePointIds?e.sharePointIds.listItemUniqueId:"",UrlAlreadyEncoded:!0,Activity:c,SharepointInfo:r,IsEmailAttachment:u,IsCollab:e.is_collab,FeedbackId:e.feedbackId,NavigationId:l,TeamsDeepLink:o,ThumbnailUrl:e.previewInfo.image,MediaDuration:d}}fileType(e){let t=a.a.fileTypeNameToFileType(e.subCategory);return t&&t!==a.b.None||(t=a.b.Unknown),t}}return e.locParam="rs=",e})();var p=i("kpuN"),f=i("R7NL"),g=i("/I02"),b=i("wwmn"),v=i("QOOv"),S=i("vk2e"),y=i("lrJm"),w=i("cgnd"),C=i("Z0U4"),I=i("ZtId"),T=i("casz"),k=i("4/We"),E=i("PBJH"),A=i("pd4Y"),P=i("BMb5");let x=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c,u,h,d,p,f,g){this.officefeedService=new m(e,d,n,i,t,p,r,s,o,a,l,u,h,f,g),c.subscribeToRouteChangeStart(e=>{e.currentRoute&&(s.config.officeFeedControlEnabled||s.config.officeFeedFlightEnabled)&&this.warmDocumentCache(e.currentRoute)})}getOfficeFeedService(){return this.officefeedService}warmDocumentCache(e){switch(e.route){case"OfficeHome":case"Pwa":this.officefeedService.getOfficeFeed()}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(p.a),n.cc(f.a),n.cc(o.a),n.cc(g.a),n.cc(b.a),n.cc(v.a),n.cc(S.q),n.cc(y.b),n.cc(w.b),n.cc(C.a),n.cc(I.a),n.cc(T.a),n.cc(k.a),n.cc(E.a),n.cc(A.a),n.cc(P.b))},token:e,providedIn:"root"}),e})(),D=(()=>{class e{}return e.ɵprov=n.bc({factory:function(){return(e=>e.getOfficeFeedService())(n.cc(x))},token:e,providedIn:"root"}),e})()},dx17:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("kaEK"),r=i("L/Tc"),s=i("CVeG"),o=i("Mlb/"),a=i("cgnd"),l=i("uH9+"),c=i("PBJH"),u=i("QOOv"),h=i("pd4Y");let d=(()=>{class e{constructor(e,t,i,n,r){this.timestampFormatService=t,this.locService=i,this.mruConfigService=n,this.dateService=r,this.userEmail=e.config.userPrincipalName}activityDescription(e,t,i,n=!1){if(!e||0===e.length)return null;e=this.filterActivities(e,t);const s=new Map;for(let t=0;t<e.length;t++){const i=e[t],n=i.action.type;s.has(n)?s.get(n).push(i):s.set(n,[i])}return s.has(r.a.Mention)?this.createMentionDescription(s.get(r.a.Mention),i,n):s.has(r.a.Comment)?this.createCommentDescription(s.get(r.a.Comment),i,n):s.has(r.a.Edit)?this.createEditDescription(s.get(r.a.Edit),i,n):null}displayedActivityType(e,t,i){if(!e||0===e.length)return r.a.None;i&&(e=this.filterActivities(e,t));let n=0,s=0,o=0;for(let t=0;t<e.length;t++){const i=e[t].action.type;i===r.a.Mention?n++:i===r.a.Comment?s++:i===r.a.Edit&&o++}return n>0?r.a.Mention:s>0?r.a.Comment:o>0?r.a.Edit:r.a.None}filterActivities(e,t){return e?e.filter(e=>{if(e&&e.action&&e.timestamp&&e.actor&&e.actor.user&&e.actor.user.email&&e.actor.user.displayName){const i=e.action;if(t&&e.timestamp<t)return!1;if(this.isCurrentUser(e.actor.user))return!1;if(i.type===r.a.Mention&&i.data){const e=i.data.mentionees;return e&&e.filter(e=>e&&e.user&&this.isCurrentUser(e.user)).length>0}return i.type!==r.a.Unknown}return!1}):[]}isCurrentUser(e){return e&&(!!e.self||e.userPrincipalName===this.userEmail)}createMentionDescription(e,t,i){if(!e||!e.length)return null;const r=e[0],o=this.numDistinctActors(e),a=r.actor.user,l=r.timestamp,c=this.formatStringWithTime(l,"Mentioned",t,i,[a.displayName],o-1);return{formatString:c,plainText:s.a.stripTags(c),people:[{upn:a.email,tag:"c0",name:a.displayName},{upn:this.userEmail,tag:"c1",name:this.userEmail}],reasonType:n.a.Mention,timestamp:l}}createCommentDescription(e,t,i){if(0===e.length)return null;const r=e[0],o=r.action.data,a=r.actor.user,l=r.timestamp;let c="",u=null;if(e.length>1){const n=this.numDistinctActors(e);c=this.formatStringWithTime(l,"Commented",t,i,[a.displayName],n-1),u=[{upn:a.email,tag:"c0",name:a.displayName}]}else if(o&&o.isReply&&o.parentAuthor&&o.parentAuthor.user.displayName&&o.parentAuthor.user.email){const e=o.parentAuthor.user;this.isCurrentUser(e)?(c=this.formatStringWithTime(l,"RepliedYourComment",t,i,[a.displayName],0),u=[{upn:a.email,tag:"c0",name:a.displayName},{upn:this.userEmail,tag:"c1",name:this.userEmail}]):(c=this.formatStringWithTime(l,"RepliedOtherComment",t,i,[a.displayName,e.displayName],0),u=[{upn:a.email,tag:"c0",name:a.displayName},{upn:e.email,tag:"c1",name:e.displayName}])}else c=this.formatStringWithTime(l,"Commented",t,i,[a.displayName],0),u=[{upn:a.email,tag:"c0",name:a.displayName}];return{formatString:c,plainText:s.a.stripTags(c),people:u,reasonType:n.a.Comment,timestamp:l}}createEditDescription(e,t,i){if(0===e.length)return null;const r=e[0],o=this.numDistinctActors(e),a=r.actor.user,l=r.timestamp,c=this.formatStringWithTime(l,"Edited",t,i,[a.displayName],o-1);return{formatString:c,plainText:s.a.stripTags(c),people:[{upn:a.email,tag:"c0",name:a.displayName}],reasonType:n.a.Edit,timestamp:l}}formatStringWithTime(e,t,i,n,r,s){const o=s<=0?"":1===s?"OneOther":"Others";let a=t+o;const l=n?"NoDate":this.getActivityTimestampType(e,i);a+="FullDateThisYear"===l?"FullDate":l;const c=this.getTimestampPlaceholders(e,l),u=this.mruConfigService.config.activityStrings[a];return"OneOther"===o||""===o||r.push(this.locService.localizedNumberString(s)),r=r.concat(c),this.locService.format(u,...r)}getActivityTimestampType(e,t){switch(this.timestampFormatService.getTimestampType(e)){case 0:return"NoDate";case 1:return"JustNow";case 2:return"MinAgo";case 3:return"HoursAgo";case 4:return t?"Yesterday":"YesterdayAt";case 5:return t?"DayOfWeek":"DayAndTimeOfWeek";case 6:return"FullDateThisYear";case 7:return"FullDate"}}getTimestampPlaceholders(e,t){const i=this.dateService.timespanInSeconds(e);switch(t){case"NoDate":case"JustNow":case"Yesterday":return null;case"MinAgo":return[this.locService.localizedNumberString(Math.round(i/60))];case"HoursAgo":return[this.locService.localizedNumberString(Math.round(i/3600))];case"YesterdayAt":return[this.locService.formatTimeFromDate(e)];case"DayOfWeek":return[this.locService.localizedWeekday(e)];case"DayAndTimeOfWeek":return[this.locService.localizedWeekday(e),this.locService.formatTimeFromDate(e)];case"FullDateThisYear":return[this.locService.localizedMonthDate(e)];case"FullDate":return[this.locService.localizedDateStringMedium(e)]}}numDistinctActors(e){return new Set(e.map(e=>e.actor.user.email)).size}}return e.ɵprov=o.bc({factory:function(){return new e(o.cc(a.b),o.cc(l.a),o.cc(c.a),o.cc(u.a),o.cc(h.a))},token:e,providedIn:"root"}),e})()},ej7j:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},fKR7:function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return d}));var n=i("aZf6"),r=i("hhzZ"),s=i("BaAg"),o=i("p6Zr"),a=i("cgnd"),l=i("lwM0"),c=i("pjz5"),u=i("L/Tc"),h=function(e){return e[e.Recent=0]="Recent",e[e.Shared=1]="Shared",e[e.Trending=2]="Trending",e[e.Recommended=3]="Recommended",e[e.ClassNoteBook=4]="ClassNoteBook",e[e.News=5]="News",e[e.NoteBook=6]="NoteBook",e[e.Form=7]="Form",e[e.OfficeFeedDocument=8]="OfficeFeedDocument",e[e.EdgeworthDocument=9]="EdgeworthDocument",e[e.SharedForm=10]="SharedForm",e[e.StreamsVideo=11]="StreamsVideo",e[e.UpcomingMeeting=12]="UpcomingMeeting",e}({});class d extends s.a{constructor(e,t,i,r,d,m,p,f,g,b,v,S,y,w,C,I,T,k,E,A,P,x,D,M=!1,F=!1,L=null,O=null,R=null,_=null,U=null,N=null,W=!1,B=!1,H=null,q=null,V,$,z,j,G,Q,K,Z,J,X,Y,ee,te,ie,ne,re,se,oe,ae,le,ce=!1,ue,he,de,me,pe,fe,ge,be,ve,Se){if(super(t,i,r,d,m,p,f,g,b,v,S,y,w,I,T,k,M,L,O,W,z?z.AttachmentType:void 0,B,ce),this.format=e,this.sharingType=C,this.fromCache=A,this.application=P,this.resourceId=x,this.storageHost=D,this.isPinned=F,this.mruV2Category=R,this.mruV2Type=_,this.mruV2Id=U,this.activity=N,this.isEmailAttachment=W,this.createdDate=H,this.sharepointIds=q,this.sharing=V,this.isNew=$,this.emailReference=z,this.sharedByUsername=j,this.sharedByEmail=G,this.sharedById=Q,this.thumbnailInfo=K,this.spoId=J,this.isCollab=X,this.navigationId=ee,this.thumbnails=te,this.feedbackId=ie,this.serverDocId=ne,this.createdBy=re,this.teamsDeepLink=se,this.ownerType=oe,this.ownerId=ae,this.isDeleted=le,this.isSafeLink=ce,this.streamsThumbnailUrl=ue,this.startTime=he,this.endTime=de,this.location=me,this.locations=pe,this.attendees=fe,this.joinUrl=ge,this.organizer=be,this.joinMeetingText=ve,this.mediaDuration=Se,this.mediaDurationRegex=new RegExp(/PT(\d+H)?(\d+M)?(\d*).*S?/),q||(this.sharepointIds={listId:null,listItemId:null,listItemUniqueId:null,siteId:null,siteUrl:null,webId:null}),this.documentUrl=f,e===h.Trending){const e=this.url.match(/file=([\S]+?)(&|$)/i);if(e&&e.length>=2){const t=e[1];this.canonicalUrl=`${l.a.encodeUrl(O)}/${t}`}else this.canonicalUrl=this.url;this.sharing={shared:!0}}else this.canonicalUrl=this.url,e===h.Shared&&(this.sharing={shared:!0});if(this.format===h.StreamsVideo){const e=this.mediaDurationRegex.exec(this.mediaDuration);let t=e[1],i=e[2],n=e[3];t&&t.length<3&&(t="0"+t),i&&i.length<3&&(i="0"+i),n&&n.length<2&&(n="0"+n),this.mediaDuration=`${t?t.substring(0,t.length-1)+":":""}${i?i.substring(0,i.length-1)+":":""}${n||""}`}if(f){if(!this.sharepointIds.siteUrl){const e=f.match(/https?:\/\/.*?\.sharepoint(-df)?\.com\/.*?\/.*?\//);e&&e.length&&(this.sharepointIds.siteUrl=e[0])}this.isMsftDogfood=f.lastIndexOf("microsoft-my.sharepoint-df.com")>-1||f.lastIndexOf("microsoft.sharepoint-df.com")>-1}if(s.a.referralFromFileLocation(this.url)===o.a.SharePoint&&(this.sharing={shared:!0}),this.lastModifiedBy&&this.lastModifiedBy.fullName&&this.lastModifiedBy.email&&this.lastModifiedTime&&(this.lastModifiedActivity=[{action:{type:u.a.Edit,data:{}},actor:{user:{displayName:this.lastModifiedBy.fullName,email:this.lastModifiedBy.email,userPrincipalName:this.lastModifiedBy.email},id:null},timestamp:this.lastModifiedTime}]),this._initialInflationCompleted=new n.a,this.initialInflationCompleted=this._initialInflationCompleted.asObservable(),"string"==typeof Z&&(this.attribution=Z),E===a.a.MSA)this.isOnPremOrVanity=!1;else if(Y&&Y.lastIndexOf("ONPREM")>=0)this.isOnPremOrVanity=!0;else if(Y&&Y.lastIndexOf("O365")>=0||this.fileType===s.b.Sway||this.fileType===s.b.Forms)this.isOnPremOrVanity=!1;else{const e=c.a.getHostName(this.url);this.isOnPremOrVanity=!(!e||-1!==e.lastIndexOf("sharepoint.com")||this.isMsftDogfood)}}getClickData(e,t,i){const n=super.getClickData(e,t,i);return n&&n.params&&(n.params.Area="Recommended_Click"===e?r.b.Recommended:r.b.Documents,"boolean"==typeof this.isPinned&&(n.params.Pinned=this.isPinned.toString()),"boolean"==typeof this.isNew&&(n.params.ItemIsNew=this.isNew.toString()),this.sharing&&"boolean"==typeof this.sharing.shared&&(n.params.ItemIsShared=this.sharing.shared.toString())),n}getClickDataForPath(e,t,i){const n=super.getClickDataForPath(e,t,i);return n&&n.params&&(n.params.Area=r.b.Documents),n}copyInflationData(e,t=!1){e.activities&&!t&&(this.activities=e.activities.slice()),e.driveId&&(this.driveId=e.driveId),void 0===e.isNew||t||(this.isNew=e.isNew),e.sharepointIds.siteUrl&&(this.sharepointIds.siteUrl=e.sharepointIds.siteUrl),e.sharing&&!t&&(this.sharing=Object.assign({},e.sharing)),e.thumbnails&&(this.thumbnails=Object.assign({},e.thumbnails)),e.wopiData&&(this.wopiData=Object.assign({},e.wopiData))}inflationCompleted(){this._initialInflationCompleted.next(!0),this._initialInflationCompleted.complete()}}},"g/dT":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("W3Zz");class r{constructor(e,t){this.deviceDetector=e,this.instrumentationService=t}ngOnInit(){const e={};e.DevicePlatform=n.d[this.deviceDetector.getDeviceInfo().platform.platformType],this.instrumentationService.logGenericEvent(this.pageName,e,[this.pageName])}}},g0MB:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t,i){this.elementReference=e,this.renderer=t,this.themingService=i,this.toolTipSpan=null}ngAfterViewInit(){this.elementReference.nativeElement.onfocus=()=>{this.onEvent()},this.elementReference.nativeElement.onblur=()=>{this.toolTipSpan&&this.renderer.removeChild(this.elementReference.nativeElement,this.toolTipSpan),this.toolTipDelayTimeout&&(clearTimeout(this.toolTipDelayTimeout),this.toolTipDelayTimeout=null)}}onEvent(){this.toolTipDelay().then(()=>{this.toolTipSpan=document.createElement("span"),this.toolTipSpan.classList.add("ohp-keyboardfocus-tooltip"),this.toolTipSpan.classList.add("ohpAppTheme"),this.toolTipSpan.classList.add("ms-fcl-nd"),this.toolTipSpan.classList.add("ms-bgc-w"),this.toolTipSpan.innerText=this.elementReference.nativeElement.title,this.renderer.appendChild(this.elementReference.nativeElement,this.toolTipSpan)})}toolTipDelay(){return new Promise(e=>{this.toolTipDelayTimeout=setTimeout(()=>{e()},1e3)})}}},hZW2:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("Mlb/"),r=i("dFxn");let s=(()=>{class e{constructor(e){this.configParserService=e}getConfig(){return this.config||(this.config=this.configParserService.parse("documentConfig")),this.config||{mockUploadFile:null}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a))},token:e,providedIn:"root"}),e})(),o=(()=>{class e{constructor(e){this.documentConfigService=e}addScriptToPage(e,t,i,n=!1,r,s=!1){const o=this.getDocument();if(!o)return;if(this.findScript(r))return void(t&&t());const a=o.createElement("script");if(a.src=e,a.id=r,t&&(a.onload=t),i&&(a.onerror=i),n){const e=o.getElementsByTagName("script")[0];if(e&&e.parentNode)return void e.parentNode.insertBefore(a,e)}s&&(a.crossOrigin="anonymous"),o.body.appendChild(a)}addIframeToPage(e,t){if(!e&&!t)return;const i=this.getDocument();if(!i||t&&i.getElementById(t)||i.querySelector(`iframe[src="${e}"]`))return;const n=i.createElement("iframe");e&&n.setAttribute("src",e),t&&(n.id=t),n.style.display="none",i.body.appendChild(n)}selectFile(t){this.selectFilePromiseRejector&&this.selectFilePromiseRejector();const i=this.getDocument();this.fileInputElement&&i.body.removeChild(this.fileInputElement);const n=this.documentConfigService.getConfig().mockUploadFile;if(n){const e=this.createMockFileList(n.name,n.size);return Promise.resolve(e)}return this.fileInputElement=i.createElement("input"),this.fileInputElement.type="file",this.fileInputElement.id=e.fileInputId,this.fileInputElement.accept=t.join(","),i.body.appendChild(this.fileInputElement),new Promise((e,t)=>{this.selectFilePromiseRejector=t;const n=r=>{const s=r.target.files;s&&s.length?e(s):t(),this.selectFilePromiseRejector=null,this.fileInputElement&&(this.fileInputElement.removeEventListener("change",n),i.body.removeChild(this.fileInputElement),this.fileInputElement=null)};this.fileInputElement.addEventListener("change",n),this.fileInputElement.click()})}updateFavicon(e){this.addOrUpdateLink(e,"shortcut icon","image/x-icon",'link[rel="shortcut icon"]')}addOrUpdateStylesheet(e,t){this.addOrUpdateLink(e,"stylesheet","text/css","#"+t,t)}addCssClassToElement(e,t){e&&e.classList.add(t)}removeCssClassFromElement(e,t){e&&e.classList.remove(t)}addOrUpdateStyleTag(e,t){const i=this.getDocument();if(!i)return;let n=i.getElementById(e);n&&n.parentNode&&n.parentNode.removeChild(n),n=i.createElement("style"),n.id=e,n.type="text/css",n.styleSheet?n.styleSheet.cssText=t:n.appendChild(i.createTextNode(t)),i.head.appendChild(n)}addLinkTag(e){const t=this.getDocument();if(!t)return;const i=t.createElement("link");e.forEach((e,t)=>i.setAttribute(t,e)),t.head.appendChild(i)}appendHTMLToElement(e,t){e&&t&&e.insertAdjacentHTML("beforeend",t)}getOffset(e){const t=(e instanceof n.l?e.nativeElement:e).getBoundingClientRect();return{top:t.top+this.nativeDocument.body.scrollTop,left:t.left+this.nativeDocument.body.scrollLeft}}disableTouchMove(){this.getDocument().addEventListener("touchmove",this.preventDefault,{passive:!1})}enableTouchMove(){this.getDocument().removeEventListener("touchmove",this.preventDefault)}updateThemeColor(e){const t=this.getDocument();if(!t)return;const i=t.querySelector('meta[name="theme-color"]');if(i)return void(i.content!==e&&(i.content=e));const n=t.createElement("meta");n.name="theme-color",n.content=e,t.head.appendChild(n)}preventDefault(e){e.preventDefault()}get nativeDocument(){return this.getDocument()}getDocument(){return document}findScript(e){if(!e)return!1;const t=this.getDocument();return!!t&&!!t.getElementById(e)}addOrUpdateLink(e,t,i,n,r){if(!e)return;const s=this.getDocument();if(!s)return;let o=s.querySelector(n);o?o.href!==e&&(o.href=e):(o=s.createElement("link"),o.rel=t,o.type=i,o.href=e,r&&(o.id=r),s.head.appendChild(o))}createMockFileList(e,t){const i=new Blob([new Uint8Array(t)],{type:""});return i.name=e,[i]}}return e.fileInputId="select-file",e.ɵprov=n.bc({factory:function(){return new e(n.cc(s))},token:e,providedIn:"root"}),e})()},hhzZ:function(e,t,i){"use strict";i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return s})),i.d(t,"d",(function(){return o})),i.d(t,"a",(function(){return a}));var n=i("31lE");let r=(()=>{class e{}return e.FirsttimeReferral="First time",e.ResurrectedReferral="Resurrected",e.RepeatReferral="Repeat",e.NotDetected="NotDetected",e})(),s=(()=>{class e{}return e.AppCategory="AppCategory",e.AppGalleryHero="AppGalleryHero",e.AppList="AppList",e.AppTiles="AppTiles",e.Banner="Banner",e.Calendar="Calendar",e.Concierge="Concierge",e.CreateFlyOut="CreateFlyOut",e.CreateModal="CreateModal",e.Documents="Documents",e.ErrorDialog="ErrorDialog",e.InputDialog="InputDialog",e.FeaturedDocs="FeaturedDocs",e.Feedback="Feedback",e.FirstRun="FirstRun",e.Folders="Folders",e.FormsGroups="FormsGroups",e.Hero="Hero",e.Incremental="Incremental",e.InstallWizard="InstallWizard",e.LeftNav="LeftNav",e.MobileAppBanner="MobileAppBanner",e.PeopleCard="PeopleCard",e.PwaDialog="PwaDialog",e.Recommended="Recommended",e.SearchResults="SearchResults",e.SearchSuggestions="SearchSuggestions",e.Shell="Shell",e.Sites="Sites",e.SideMenu="SideMenu",e.Templates="Templates",e.UploadDialog="UploadDialog",e.Upsell="Upsell",e})();class o{constructor(e,t=n.AWTPiiKind.GenericData){this.value=e,this.kind=t}}let a=(()=>{class e{static filterPii(e){return e?e.replace(this.emailRegex,"email_removed").replace(this.localFileRegex,"file_removed").replace(this.searchQueryRegex,"$1query_removed"):e}}return e.emailRegex=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","gm"),e.localFileRegex=new RegExp("file(:|%3A|%253A).*","gim"),e.searchQueryRegex=new RegExp("([&?]q=)(.+?)(?=[&].*| |, |$)","gmi"),e})()},hjJp:function(e,t,i){"use strict";i.d(t,"a",(function(){return D})),i.d(t,"b",(function(){return ie}));var n=i("Mlb/"),r=i("vk2e"),s=i("WJRI"),o=i("kVgv"),a=i("pzhl"),l=i("PkQn"),c=i("4/We"),u=i("tuJr"),h=i("s+Eq"),d=i("5FMq"),m=i("lrJm"),p=i("W3Zz"),f=i("1ygu");class g{constructor(e){this.templateRef=e}}class b{constructor(e,t,i,r,s,o){this.capabilitiesService=e,this.contextService=t,this.locService=i,this.instrumentationService=r,this.changeDetectorRef=s,this.deviceDetector=o,this.listStateChange=new n.n}set listState(e){this.isListOpen=e===f.a.Open,this._listState=e}get listState(){return this._listState}ngAfterViewInit(){if(1!==this.expandableListItems.length)throw new m.a("Must have exactly 1 *ohpListItem in an ExpandableList as a child");if(!this.listId)throw new m.a('Must include input "listId"');if(!this.area)throw new m.a('Must include input "area"');this.listItemTemplate=this.expandableListItems.first.templateRef,this.changeDetectorRef.detectChanges()}ngOnInit(){this.listModel&&(this.isSmallMobileCards=this.listModel.isSmallMobileCards,this.isEvenPadding=this.listModel.isEvenPadding),this.showMoreButtonTextDefault=this.locService.ShowMoreResults,this.showLessButtonTextDefault=this.locService.ShowLessResults,this.showMoreButtonAriaLabelDefault=this.locService.ShowMoreResults,this.showLessButtonAriaLabelDefault=this.locService.ShowLessResults,this.animationState="viewRendered"+(!this.listModel||this.deviceDetector.deviceInfo.browser.browserType===p.a.Safari&&"FadeAndScale"===this.listModel.animationOnLoad?"None":this.listModel.animationOnLoad),this.mobileMenusEnabled=this.capabilitiesService.capabilities.mobileContextMenusEnabled,this.isMobile=this.deviceDetector.isMobileDevice()}ngOnChanges(e){e.hasOwnProperty("selectedTab")&&(this.animationState=this.contextService.isRtl?"animateTabEntranceRTL":"animateTabEntrance"),e.hasOwnProperty("itemView")&&(this.isCardView="Card"===this.itemView,this.isTileView="Tile"===this.itemView,this.isTileOrCardView=this.isCardView||this.isTileView,this.isListColView="ListCol"===this.itemView),e.hasOwnProperty("listId")&&(this.seeMoreLinkId="see-more-items-"+this.listId)}toggleShowMore(e){const t=this.isListOpen;this.collapsing=t,this.updateAnnouncement=t?this.listModel.showLessUpdateAriaLabel:this.listModel.showMoreUpdateAriaLabel,this.listModel.infiniteShowMoreEnabled&&this.listModel.infiniteShowMore(),setTimeout(()=>this.animate(t,e),0)}toggleShowMoreKeyboard(e){13===e.keyCode&&(e.preventDefault(),this.toggleShowMore(!0))}animate(e,t){this.listState=e?f.a.Closed:f.a.Open;const i=this.getDisplayedItemCount();this.listStateChange.emit(this.listState),t&&this.listState===f.a.Open&&(this.expandedFromKeyboard=!0),this.listState===f.a.Closed&&(this.expandedFromKeyboard=!1),this.listModel.onImpression(i,this.itemView),this.instrumentToggle()}onAnimationCompleted(e){e.toState===this.animationState&&(this.animationState="viewRendered")}trackById(e,t){return t.getId()}getDisplayedItemCount(){return this.listModel.itemsShown(this.isListOpen,this.isTileOrCardView)}currentState(){return this.animationState}shouldFocusOnLoad(e){return this.expandedFromKeyboard&&(this.isTileOrCardView?this.listModel.initialListItemCount:this.listModel.initialTileItemCount)===e}instrumentToggle(){const e={};e.Action=f.a[this.listState],this.instrumentationService.logClickEvent("Expandable_List_Toggle",this.seeMoreLinkId,this.area,null,null,e)}}var v=i("/I02"),S=i("PBJH"),y=i("hhzZ"),w=n.wb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeInOut",definitions:[{type:1,expr:"viewRendered => animateTabEntrance",animation:[{type:6,styles:{opacity:0,transform:"translateX(30px)"},offset:null},{type:4,styles:{type:6,styles:{opacity:1,transform:"translateX(0)"},offset:null},timings:"250ms 67ms cubic-bezier(0.26,1.00,0.48,1.00)"}],options:null},{type:1,expr:"viewRendered => animateTabEntranceRTL",animation:[{type:6,styles:{opacity:0,transform:"translateX(-30px)"},offset:null},{type:4,styles:{type:6,styles:{opacity:1,transform:"translateX(0)"},offset:null},timings:"250ms 67ms cubic-bezier(0.26,1.00,0.48,1.00)"}],options:null},{type:1,expr:"void => viewRenderedSlide",animation:[{type:6,styles:{opacity:0,height:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1,height:"*"},offset:null},timings:"200ms 10ms ease-out"}],options:null},{type:1,expr:"void => viewRenderedFadeAndScale",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0,transform:"scale(1.15)"},offset:null},{type:3,steps:[{type:4,styles:{type:6,styles:{opacity:1},offset:null},timings:"{{ fadeDuration }} {{ delay }}"},{type:4,styles:{type:6,styles:{transform:"scale(1)"},offset:null},timings:"{{ scaleDuration }} {{ delay }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:null}],options:{params:{fadeDuration:"100ms",scaleDuration:"400ms",delay:"50ms"}}},options:{params:{delay:"98ms"}}},options:null}],options:{}}]}});function C(e){return n.ac(0,[(e()(),n.hb(0,null,null,0))],null,null)}function I(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,5,"div",[["class","expandable-list__item"]],[[2,"expandable-list__item--tile",null],[2,"list-item--tile--even-padding",null],[2,"ms-Grid-row",null]],null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"expandable-list__item--bordered":0,"list-item--shadowed ms-bgc-w-h":1,"expandable-list-col__item expandable-list-col__item--bordered":2,"ms-bclt-g40":3,"ms-bclt-g50":4,"ms-bclb-g40":5}),(e()(),n.hb(16777216,null,null,2,null,C)),n.xb(4,540672,null,0,r.o,[n.O],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),n.Qb(5,{item:0,index:1,itemView:2,focusOnLoad:3})],(function(e,t){var i=t.component,n=e(t,2,0,i.listModel.bordered&&!i.isTileOrCardView&&!i.isListColView&&0!==t.context.index,!i.isTileOrCardView&&i.listModel.highlightOnHover&&!i.mobileMenusEnabled,i.isListColView,0!==t.context.index,0===t.context.index,t.context.index===i.getDisplayedItemCount()-1);e(t,1,0,"expandable-list__item",n);var r=e(t,5,0,t.context.$implicit,t.context.index,i.itemView,i.shouldFocusOnLoad(t.context.index));e(t,4,0,r,i.listItemTemplate)}),(function(e,t){var i=t.component;e(t,0,0,i.isTileOrCardView,i.isEvenPadding,!i.isTileOrCardView&&!i.isListColView)}))}function T(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,5,"div",[],null,null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(2,{"section-list__table ms-Grid":0,"generic-tile-container":1,"generic-tile-container--doc-tile":2,"generic-tile-container--card":3,"generic-tile-container--mobile":4,"generic-row-container--row":5,"generic-tile-container--card--small":6}),(e()(),n.hb(16777216,null,null,2,null,I)),n.xb(4,278528,null,0,r.j,[n.O,n.L,n.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),n.Pb(0,r.r,[])],(function(e,t){var i=t.component,r=e(t,2,0,!i.isTileOrCardView&&!i.isListColView,i.isTileOrCardView&&i.listModel.items.length,i.isTileView,i.isCardView,i.isTileView&&i.smallMobileTiles&&i.isMobile,i.isListColView,i.isSmallMobileCards);e(t,1,0,r),e(t,4,0,n.Yb(t,4,0,n.Nb(t,5).transform(i.listModel.items,0,i.getDisplayedItemCount())),i.trackById)}),null)}function k(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),n.Xb(2,null,["",""])),(e()(),n.yb(3,0,null,null,1,"ohp-icon-font",[["cssClass","see-more-items__icon--fluent"],["iconFontName","ChevronDown"]],null,null,null,a.b,a.a)),n.xb(4,638976,null,0,l.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,4,0,"see-more-items__icon--fluent","ChevronDown",8)}),(function(e,t){var i=t.component;e(t,2,0,i.listModel.showMoreText||i.showMoreButtonTextDefault)}))}function E(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),n.Xb(2,null,["",""])),(e()(),n.yb(3,0,null,null,1,"ohp-icon-font",[["cssClass","see-more-items__icon--fluent"]],null,null,null,a.b,a.a)),n.xb(4,638976,null,0,l.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,4,0,"see-more-items__icon--fluent",t.component.isListOpen?"ChevronUp":"ChevronDown",8)}),(function(e,t){var i=t.component;e(t,2,0,i.isListOpen?i.listModel.showLessText||i.showLessButtonTextDefault:i.listModel.showMoreText||i.showMoreButtonTextDefault)}))}function A(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,5,"button",[["class","see-more-items ms-fcl-ns"],["data-clicklog","custom"],["role","button"]],[[8,"id",0],[1,"aria-label",0]],[[null,"keydown"],[null,"click"]],(function(e,t,i){var n=!0,r=e.component;return"keydown"===t&&(n=!1!==r.toggleShowMoreKeyboard(i)&&n),"click"===t&&(n=!1!==r.toggleShowMore()&&n),n}),null,null)),(e()(),n.yb(1,0,null,null,4,"div",[["class","flex-container"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,k)),n.xb(3,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,E)),n.xb(5,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,3,0,i.listModel.infiniteShowMoreEnabled&&i.listModel.infiniteShowMoreEnabledAndVisible(i.isTileOrCardView)),e(t,5,0,!i.listModel.infiniteShowMoreEnabled)}),(function(e,t){var i=t.component;e(t,0,0,i.seeMoreLinkId,i.isListOpen?i.listModel.showLessAriaLabel||i.showLessButtonAriaLabelDefault:i.listModel.showMoreAriaLabel||i.showMoreButtonAriaLabelDefault)}))}function P(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","section-list expandable-list"]],[[8,"id",0],[24,"@fadeInOut",0]],[[null,"@fadeInOut.done"]],(function(e,t,i){var n=!0;return"@fadeInOut.done"===t&&(n=!1!==e.component.onAnimationCompleted(i)&&n),n}),null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"border-bottom ms-bclb-g40":0}),(e()(),n.hb(16777216,null,null,1,null,T)),n.xb(4,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(5,0,null,null,1,"ohp-title-announcer",[],null,null,null,s.b,s.a)),n.xb(6,49152,null,0,o.a,[],{announcement:[0,"announcement"]},null),(e()(),n.hb(16777216,null,null,1,null,A)),n.xb(8,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,(null==i.listModel||null==i.listModel.items?null:i.listModel.items.length)&&i.isTileOrCardView);e(t,1,0,"section-list expandable-list",n),e(t,4,0,null==i.listModel||null==i.listModel.items?null:i.listModel.items.length),e(t,6,0,i.updateAnnouncement),e(t,8,0,null==i.listModel?null:i.listModel.showMoreVisible(i.isTileOrCardView||i.isListColView))}),(function(e,t){var i=t.component;e(t,0,0,"expandable-list-"+i.listId,i.currentState())}))}var x=i("R0N1"),D=(i("345u"),i("xoWf"),i("cgnd"),n.wb({encapsulation:2,styles:[],data:{}}));function M(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,6,"div",[],null,null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(2,{"tab-display__item--selected ms-bcl-tda":0}),(e()(),n.yb(3,0,null,null,3,"a",[["class","tab-display__item__link ms-fcl-ns"],["data-clicklog","custom"],["href","javascript:void(0);"],["role","tab"]],[[8,"id",0],[1,"aria-label",0],[1,"aria-selected",0],[1,"data-text",0],[8,"title",0]],[[null,"click"]],(function(e,t,i){var n=!0;return"click"===t&&(n=!1!==e.component.selectTab(i,e.parent.context.index)&&n),n}),null,null)),n.xb(4,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(5,{"tab-display__item--selected__link  ms-fcl-nd":0}),(e()(),n.Xb(6,null,[" "," "]))],(function(e,t){var i=t.component,n=e(t,2,0,t.parent.context.index===i.selectedTab);e(t,1,0,n);var r=e(t,5,0,t.parent.context.index===i.selectedTab);e(t,4,0,"tab-display__item__link ms-fcl-ns",r)}),(function(e,t){var i=t.component;e(t,3,0,n.Fb(1,"tab-list-header-link-",t.parent.context.$implicit.id,""),i.model.headerText?i.model.headerText+", "+t.parent.context.$implicit.ariaLabel:t.parent.context.$implicit.ariaLabel,t.parent.context.index===i.selectedTab,t.parent.context.$implicit.title,t.parent.context.$implicit.title),e(t,6,0,t.parent.context.$implicit.title)}))}function F(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["class","list-header__title ms-fcl-nd"]],null,null,null,null,null)),(e()(),n.Xb(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.parent.context.$implicit.title)}))}function L(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"h3",[["class","list-header__title tab-display__item"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,M)),n.xb(2,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,F)),n.xb(4,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.model.tabs.length>1),e(t,4,0,1===i.model.tabs.length)}),null)}function O(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["role","tablist"]],[[8,"className",0]],null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,L)),n.xb(2,278528,null,0,r.j,[n.O,n.L,n.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.model.tabs,i.trackByIndex)}),(function(e,t){e(t,0,0,n.Fb(1,"tab-display responsive-width--inner ",t.component.model.tabClass,""))}))}function R(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["class","tab-list-header__custom-button"]],null,null,null,null,null)),n.Mb(null,0)],null,null)}function _(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-title-announcer",[],null,null,null,s.b,s.a)),n.xb(1,49152,null,0,o.a,[],{announcement:[0,"announcement"]},null)],(function(e,t){e(t,1,0,t.component.toggleAnnouncement)}),null)}function U(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"button",[["class","icon-button tab-list-header__spacer ms-fcl-ns ms-bgc-g40-h ms-fcl-nd-f ms-fcl-nd-h ms-fcl-nd-a"]],[[8,"id",0],[1,"data-area",0],[1,"aria-label",0],[8,"title",0]],[[null,"click"]],(function(e,t,i){var n=!0;return"click"===t&&(n=!1!==e.component.toggleTileView()&&n),n}),null,null)),(e()(),n.yb(1,0,null,null,1,"ohp-icon-font",[["cssClass","tile-toggle__icon tile-toggle__icon--centered"],["size","16"]],null,null,null,a.b,a.a)),n.xb(2,638976,null,0,l.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){e(t,2,0,"tile-toggle__icon tile-toggle__icon--centered",t.component.showingTiles()?"ListBullets":"TileView","16",!0)}),(function(e,t){var i=t.component;e(t,0,0,"tile-toggle-"+i.model.tabs[i.selectedTab].id,i.model.area,i.showingTiles()?i.showAsListAriaLabel:i.showAsTilesAriaLabel,i.showingTiles()?i.listViewText:i.tileViewText)}))}function N(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-icon-font",[["class","tiles-list-checkmark__icon-wrapper"],["cssClass","tiles-list-checkmark__icon ms-fcl-tda"],["iconFontName","CheckMark"],["size","16"]],null,null,null,a.b,a.a)),n.xb(1,638976,null,0,l.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){e(t,1,0,"tiles-list-checkmark__icon ms-fcl-tda","CheckMark","16")}),null)}function W(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,8,"div",[["class","tiles-list-menu-item ms-fcl-np"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,N)),n.xb(2,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(3,0,null,null,3,"ohp-icon-font",[["cssClass","tiles-list-menu-item__icon"],["size","16"]],null,null,null,a.b,a.a)),n.xb(4,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(5,{"tiles-list-menu-item__spacer":0}),n.xb(6,638976,null,0,l.a,[c.a],{cssClass:[0,"cssClass"],iconFontType:[1,"iconFontType"],size:[2,"size"]},null),(e()(),n.yb(7,0,null,null,1,"div",[["class","tiles-list-menu-item__text"]],null,null,null,null,null)),(e()(),n.Xb(8,null,["",""]))],(function(e,t){var i=t.component;e(t,2,0,t.context.item.view===i.itemView||t.context.item.view===i.tileView&&i.itemView===i.cardView&&i.model.tabs[i.selectedTab].showCardsInTileView);var n=e(t,5,0,!(t.context.item.view===i.itemView||t.context.item.view===i.tileView&&i.itemView===i.cardView&&i.model.tabs[i.selectedTab].showCardsInTileView));e(t,4,0,n),e(t,6,0,"tiles-list-menu-item__icon",t.context.item.icon,"16")}),(function(e,t){e(t,8,0,t.context.item.title)}))}function B(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,10,"ohp-dropdown-menu",[],null,[[null,"toggleMenu"],[null,"selectItem"]],(function(e,t,i){var n=!0,r=e.component;return"toggleMenu"===t&&(n=!1!==r.onToggleTilesListMenu(i)&&n),"selectItem"===t&&(n=!1!==r.onSelectTilesListMenuItem(i)&&n),n}),u.b,u.a)),n.xb(1,4440064,null,1,h.a,[n.h,d.a],{menuModel:[0,"menuModel"]},{toggleMenu:"toggleMenu",selectItem:"selectItem"}),n.Tb(603979776,1,{menuItems:1}),(e()(),n.yb(3,0,null,0,5,"div",[["ohpMenuLinkContent",""]],null,null,null,null,null)),n.xb(4,16384,null,0,h.c,[],null,null),(e()(),n.yb(5,0,null,null,1,"ohp-icon-font",[["cssClass","tile-toggle__icon"],["size","16"]],null,null,null,a.b,a.a)),n.xb(6,638976,null,0,l.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null),(e()(),n.yb(7,0,null,null,1,"ohp-icon-font",[["cssClass","tiles-list-toggle__down-icon"],["iconFontName","ChevronDown"],["size","8"]],null,null,null,a.b,a.a)),n.xb(8,638976,null,0,l.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null),(e()(),n.hb(0,null,null,1,null,W)),n.xb(10,16384,[[1,4]],0,h.b,[n.L],null,null)],(function(e,t){var i=t.component;e(t,1,0,i.tilesListMenuModel),e(t,6,0,"tile-toggle__icon",i.showingTiles()?"TileView":"ListBullets","16",!0),e(t,8,0,"tiles-list-toggle__down-icon","ChevronDown","8")}),null)}function H(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["class","tab-list-header__timestamp tab-list-header__spacer"]],null,null,null,null,null)),(e()(),n.Xb(1,null,[" "," "]))],null,(function(e,t){var i=t.component;e(t,1,0,i.model.tabs[i.selectedTab].timestampHeader)}))}function q(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,12,"div",[["class","tab-list-header__right"]],null,null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"tab-list-header__right--float":0}),(e()(),n.hb(16777216,null,null,1,null,R)),n.xb(4,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,_)),n.xb(6,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,U)),n.xb(8,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,B)),n.xb(10,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,H)),n.xb(12,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!i.columnsEnabled&&!i.flexHeader);e(t,1,0,"tab-list-header__right",n),e(t,4,0,i.customButtonEnabled),e(t,6,0,i.showTileToggle()),e(t,8,0,i.showTileToggle()&&!i.tilesListMenuEnabled),e(t,10,0,i.showTileToggle()&&i.tilesListMenuEnabled),e(t,12,0,i.showTimestampHeader())}),null)}function V(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,9,"div",[["class","list-header"]],null,null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"tab-list-header--flex":0,"tab-list-header--tiles":1,"tab-list-header--buttons":2,"ms-u-hiddenLgDown":3,"tiles-list-menu-header":4,"list-header--small":5}),(e()(),n.yb(3,0,null,null,4,"div",[["class","responsive-width--outer"]],null,null,null,null,null)),n.xb(4,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(5,{"tab-wrapper":0}),(e()(),n.hb(16777216,null,null,1,null,O)),n.xb(7,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,q)),n.xb(9,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.columnsEnabled||i.flexHeader,i.showingTiles(),i.tileViewEnabled,i.leftAlignedZeroExperience&&i.model.tabs[i.selectedTab].showZeroExperience&&1===i.model.tabs.length&&i.model.tabs[i.selectedTab].loaded&&!i.model.tabs[i.selectedTab].hasError&&!(null!=i.model.tabs[i.selectedTab].listModel&&null!=i.model.tabs[i.selectedTab].listModel.items&&i.model.tabs[i.selectedTab].listModel.items.length),i.tilesListMenuEnabled&&i.tileViewEnabled,i.smallTitles);e(t,1,0,"list-header",n);var r=e(t,5,0,i.columnsEnabled||i.flexHeader);e(t,4,0,"responsive-width--outer",r),e(t,7,0,i.model.tabs.length),e(t,9,0,i.showTileToggle()||i.showTimestampHeader()||i.customButtonEnabled)}),null)}function $(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["class","tab-spinner-container"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),n.yb(2,0,null,null,0,"div",[["class","ms-Spinner-circle ms-Spinner--medium"]],null,null,null,null,null))],null,null)}function z(e){return n.ac(0,[(e()(),n.hb(0,null,null,0))],null,null)}function j(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,"div",[],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,2,null,z)),n.xb(2,540672,null,0,r.o,[n.O],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),n.Qb(3,{item:0,index:1,itemView:2,listId:3,focusOnLoad:4})],(function(e,t){var i=t.component,n=e(t,3,0,t.context.item,t.context.index,t.context.itemView,i.model.tabs[i.selectedTab].id,t.context.focusOnLoad);e(t,2,0,n,i.listItemTemplate)}),null)}function G(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"ohp-expandable-list",[],null,[[null,"listStateChange"]],(function(e,t,i){var n=!0;return"listStateChange"===t&&(n=!1!==(e.component.listState=i)&&n),n}),P,w)),n.xb(1,4833280,null,1,b,[c.a,v.a,S.a,y.a,n.h,p.b],{listId:[0,"listId"],area:[1,"area"],listModel:[2,"listModel"],itemView:[3,"itemView"],smallMobileTiles:[4,"smallMobileTiles"],listState:[5,"listState"],selectedTab:[6,"selectedTab"]},{listStateChange:"listStateChange"}),n.Tb(603979776,2,{expandableListItems:1}),(e()(),n.hb(0,null,null,1,null,j)),n.xb(4,16384,[[2,4]],0,g,[n.L],null,null)],(function(e,t){var i=t.component;e(t,1,0,i.model.tabs[i.selectedTab].id,i.model.area,i.model.tabs[i.selectedTab].listModel,i.itemView,i.smallMobileTiles,i.listState,i.selectedTab)}),null)}function Q(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[],null,null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Ob(2,2)],(function(e,t){var i=t.component,n=e(t,2,0,i.model.tabs[i.selectedTab].hasError?i.model.tabs[i.selectedTab].errorImage:i.model.tabs[i.selectedTab].zeroExperienceImage,i.leftAlignedZeroExperience?"default-state__image--left":"");e(t,1,0,n)}),null)}function K(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["class","default-state__subtitle ms-fcl-nd"]],null,null,null,null,null)),(e()(),n.Xb(1,null,["",""]))],null,(function(e,t){var i=t.component;e(t,1,0,i.model.tabs[i.selectedTab].hasError?i.model.tabs[i.selectedTab].errorSubtitle:i.model.tabs[i.selectedTab].zeroExperienceSubtitle)}))}function Z(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,8,"div",[["class","default-state__text"]],null,null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"default-state__text--middle":0,"default-state__text--left":1}),(e()(),n.yb(3,0,null,null,3,"div",[["class","default-state__title ms-fcl-ns"]],null,null,null,null,null)),n.xb(4,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(5,{"default-state__title--left":0}),(e()(),n.Xb(6,null,["",""])),(e()(),n.hb(16777216,null,null,1,null,K)),n.xb(8,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!i.leftAlignedZeroExperience,i.leftAlignedZeroExperience);e(t,1,0,"default-state__text",n);var r=e(t,5,0,i.leftAlignedZeroExperience);e(t,4,0,"default-state__title ms-fcl-ns",r),e(t,8,0,i.model.tabs[i.selectedTab].hasError?i.model.tabs[i.selectedTab].errorSubtitle:i.model.tabs[i.selectedTab].zeroExperienceSubtitle)}),(function(e,t){var i=t.component;e(t,6,0,i.model.tabs[i.selectedTab].hasError?i.model.tabs[i.selectedTab].errorTitle:i.model.tabs[i.selectedTab].zeroExperienceTitle)}))}function J(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,6,"div",[],null,null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(2,{"default-state--middle":0,"default-state--left":1,"default-state--middle--padded":2,"default-state--middle--min-height":3}),(e()(),n.hb(16777216,null,null,1,null,Q)),n.xb(4,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Z)),n.xb(6,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,!i.leftAlignedZeroExperience,i.leftAlignedZeroExperience,!i.leftAlignedZeroExperience,!i.defaultStateNoMinHeight&&!i.leftAlignedZeroExperience);e(t,1,0,n),e(t,4,0,i.model.tabs[i.selectedTab].hasError?i.model.tabs[i.selectedTab].errorImage:i.model.tabs[i.selectedTab].zeroExperienceImage),e(t,6,0,i.model.tabs[i.selectedTab].hasError?i.model.tabs[i.selectedTab].errorTitle:i.model.tabs[i.selectedTab].zeroExperienceTitle)}),null)}function X(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),n.yb(1,0,null,null,0,"hr",[["class","ms-bclt-g40"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,J)),n.xb(3,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(0,null,null,0))],(function(e,t){var i=t.component;e(t,3,0,(null==i.model.tabs[i.selectedTab]?null:i.model.tabs[i.selectedTab].showZeroExperience)||i.model.tabs[i.selectedTab].hasError)}),null)}function Y(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["class","tab-list-footer__middle ms-fcl-np"]],null,null,null,null,null)),(e()(),n.Xb(1,null,[" "," "]))],null,(function(e,t){var i=t.component;e(t,1,0,i.model.tabs[i.selectedTab].footerText)}))}function ee(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,8,"div",[["class","widget-attribution"]],null,null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"widget-attribution--left":0,"widget-attribution--right":1,"widget-attribution--middle":2}),(e()(),n.yb(3,0,null,null,5,"a",[["class","widget-attribution__link ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"id",0],[1,"href",4],[1,"data-referral",0],[1,"data-area",0],[1,"aria-label",0],[1,"title",0],[8,"target",0]],[[null,"click"]],(function(e,t,i){var n=!0;return"click"===t&&(n=!1!==e.component.widgetAttributionClick(i)&&n),n}),null,null)),n.xb(4,81920,null,0,x.a,[v.a],null,null),(e()(),n.yb(5,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),n.Xb(6,null,["",""])),(e()(),n.yb(7,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,a.b,a.a)),n.xb(8,638976,null,0,l.a,[c.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.model.tabs[i.selectedTab].attribution.leftAligned,!i.model.tabs[i.selectedTab].attribution.leftAligned,i.leftAlignedZeroExperience&&i.model.tabs[i.selectedTab].loaded&&(i.model.tabs[i.selectedTab].hasError||(null==i.model.tabs[i.selectedTab]?null:i.model.tabs[i.selectedTab].showZeroExperience)&&!(null!=i.model.tabs[i.selectedTab].listModel&&null!=i.model.tabs[i.selectedTab].listModel.items&&i.model.tabs[i.selectedTab].listModel.items.length)));e(t,1,0,"widget-attribution",n),e(t,4,0),e(t,8,0,"link-arrow","ArrowRight","14")}),(function(e,t){var i=t.component;e(t,3,0,n.Fb(1,"attribution-",i.model.tabs[i.selectedTab].id,""),i.model.tabs[i.selectedTab].attribution.url||"javascript:void(0)",i.model.tabs[i.selectedTab].attribution.referral,i.model.area,i.model.tabs[i.selectedTab].attribution.ariaLabel,i.model.tabs[i.selectedTab].attribution.tooltip,n.Nb(t,4).target),e(t,6,0,i.model.tabs[i.selectedTab].attribution.zeroTitle&&(i.model.tabs[i.selectedTab].hasError||i.model.tabs[i.selectedTab].showZeroExperience&&(null==i.model.tabs[i.selectedTab].listModel||null==i.model.tabs[i.selectedTab].listModel.items||!i.model.tabs[i.selectedTab].listModel.items.length))?i.model.tabs[i.selectedTab].attribution.zeroTitle:i.model.tabs[i.selectedTab].attribution.title)}))}function te(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,17,"div",[["class","tab-list"]],[[8,"id",0]],null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"tab-list--show-more-visible":0}),(e()(),n.yb(3,0,null,null,10,"div",[],null,null,null,null,null)),n.xb(4,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(5,{"tab-list__height-restrictor":0,"height-restrictor--one-item":1,"height-restrictor--two-items":2}),(e()(),n.hb(16777216,null,null,1,null,V)),n.xb(7,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,$)),n.xb(9,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,G)),n.xb(11,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,X)),n.xb(13,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Y)),n.xb(15,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,ee)),n.xb(17,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,2,0,i.model.tabs[i.selectedTab].loaded&&!i.model.tabs[i.selectedTab].hasError&&(null==i.model.tabs[i.selectedTab].listModel?null:i.model.tabs[i.selectedTab].listModel.showMoreVisible(i.showingTiles())));e(t,1,0,"tab-list",n);var r=e(t,5,0,i.restrictHeight,1===i.numItems,2===i.numItems);e(t,4,0,r),e(t,7,0,!i.hideHeader),e(t,9,0,!i.model.tabs[i.selectedTab].loaded),e(t,11,0,i.itemViewExists()),e(t,13,0,i.model.tabs[i.selectedTab].loaded&&(i.model.tabs[i.selectedTab].hasError||i.model.tabs[i.selectedTab].showZeroExperience&&!(null!=i.model.tabs[i.selectedTab].listModel&&null!=i.model.tabs[i.selectedTab].listModel.items&&i.model.tabs[i.selectedTab].listModel.items.length))),e(t,15,0,i.model.tabs[i.selectedTab].loaded&&!i.model.tabs[i.selectedTab].hasError&&(null==i.model.tabs[i.selectedTab].listModel||null==i.model.tabs[i.selectedTab].listModel.items?null:i.model.tabs[i.selectedTab].listModel.items.length)&&i.model.tabs[i.selectedTab].footerText),e(t,17,0,((null==i.model.tabs[i.selectedTab].attribution?null:i.model.tabs[i.selectedTab].attribution.url)||(null==i.model.tabs[i.selectedTab].attribution?null:i.model.tabs[i.selectedTab].attribution.onClick))&&i.model.tabs[i.selectedTab].loaded)}),(function(e,t){e(t,0,0,n.Fb(1,"tab-list-",t.component.model.id,""))}))}function ie(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-title-announcer",[],null,null,null,s.b,s.a)),n.xb(1,49152,null,0,o.a,[],{announcement:[0,"announcement"]},null),(e()(),n.hb(16777216,null,null,1,null,te)),n.xb(3,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.tabAnnouncement),e(t,3,0,i.model.tabs[i.selectedTab])}),null)}},hoyd:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},idgT:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("70cc"),r=i("WKA6"),s=i("BaAg");class o{static fullPageReady(){return o.readyPromise||(o.readyPromise=o.createListener("FullAuthPageRendered")),o.readyPromise}static shellAndConfigsReady(){return o.shellAndConfigsReadyPromise||(o.shellAndConfigsReadyPromise=o.createListener("ShellInfoLoaded")),o.shellAndConfigsReadyPromise}static createListener(e){return new Promise(t=>{const i=()=>{/^(?:interactive|complete)$/.test(document.readyState)&&(document.removeEventListener("readystatechange",i),document.getElementById(e)&&t())};document.addEventListener("readystatechange",i),i()})}}var a=i("ZBli"),l=i("Mlb/"),c=i("dFxn"),u=i("/I02"),h=i("hZW2"),d=i("7Gwk");let m=(()=>{class e{constructor(t,i,n,r){this.configParserService=t,this.contextService=i,this.documentService=n,this.eventService=r;const o=this.configParserService.parse(e.configElementId);this.config=o||{createLcidEnabled:!1,enterpriseTemplatesEnabled:!1,exploreTemplatesUrlFormat:null,numTemplates:0,premiumTemplatesDiamondCorner:null,premiumTemplatesUpsellEnabled:!1,sharePointAuthFrameUrl:null,templatesApiEndpoint:null,excelOrgTemplatesEnabled:!1,templatesFormsEnabled:!1,createTemplatesEnabled:!1,wordOrgTemplatesEnabled:!1},this.commonResources=o&&o.appResources?o.appResources.common:{},this.resourceVariants=new Map,o&&o.appResources&&o.appResources.variants&&o.appResources.variants.forEach(e=>{const t=s.a.fileTypeNameToFileType(e.app);t&&this.resourceVariants.set(t,e.resources)}),this.resourceMap=new Map}resources(e=s.b.Word){if(this.resourceMap.has(e))return this.resourceMap.get(e);if(!this.resourceVariants.has(e))return this.commonResources;const t=this.resourceVariants.get(e),i=Object.assign(Object.assign({},this.commonResources),t);return this.resourceMap.set(e,i),i}getTemplatesInfoPromise(){if(!this.templatesInfoPromise){const e=this.eventService.events.withScope(0).pipe(Object(n.a)(e=>"primaryTokensLoaded"===e.name),Object(r.a)(1)).toPromise(),t=o.fullPageReady();this.templatesInfoPromise=Promise.race([e,t]).then(()=>this.configParserService.parse("templatesInfo"))}return this.templatesInfoPromise}prefetchStaticResources(e){const t=this.resources(e);(null==t?void 0:t.PrefetchUrl)&&this.documentService.addIframeToPage(a.a.appendQueryParam(t.PrefetchUrl,"ui",this.contextService.sharedContext.officeMarket))}}return e.configElementId="templatesPageConfig",e.ɵprov=l.bc({factory:function(){return new e(l.cc(c.a),l.cc(u.a),l.cc(h.a),l.cc(d.a))},token:e,providedIn:"root"}),e})()},izKO:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},jCfB:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e.ItemId="item",e.DriveId="drive",e.DocUrl="file",e.ContentUri="contenturi",e.NewFile="newfile",e.BootId="bootid",e.Nav="nav",e}({})},"k+kJ":function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return l})),i.d(t,"d",(function(){return c}));var n=i("6UlS"),r=i("Uqr9"),s=i("IAGz");class o extends class{constructor(e,t,i,o=null,l=0,c=a.Started,u=null,h=null){this.sessionId=e,this.file=t,this.uploadSource=i,this.cancellationToken=o,this.bytesUploaded=l,this.state=c,this.error=u,this.sessionUrl=h,this.startTime=r.a.now(),this.fileSize=t.size,this.lastLoaded=l,this.progress=new n.a(this.progressState()),this.cancellationToken=o||new s.a}finished(){return this.state===a.Completed||this.state===a.Cancelled||this.state===a.Failed}updateProgress(e){void 0!==e&&(this.lastLoaded=Math.min(Math.max(this.lastLoaded,e),this.fileSize),this.progress.next(this.progressState()))}getProgress(){return this.progress.asObservable()}get duration(){return r.a.now()-this.startTime}progressState(){return{percentage:Math.floor(100*this.lastLoaded/this.fileSize),loaded:this.lastLoaded,total:this.fileSize}}}{}var a=function(e){return e[e.Unknown=0]="Unknown",e[e.Started=1]="Started",e[e.Completed=2]="Completed",e[e.Cancelled=3]="Cancelled",e[e.Failed=4]="Failed",e}({}),l=function(e){return e[e.Unknown=0]="Unknown",e[e.FileTooLarge=1]="FileTooLarge",e[e.OutOfSpace=2]="OutOfSpace",e[e.InvalidFileType=3]="InvalidFileType",e[e.BadConnection=4]="BadConnection",e[e.Timeout=5]="Timeout",e[e.Auth=6]="Auth",e[e.MultipleFiles=7]="MultipleFiles",e}({}),c=function(e){return e[e.Button=0]="Button",e[e.DragAndDrop=1]="DragAndDrop",e[e.CreateMenu=2]="CreateMenu",e}({})},kJkW:function(e,t,i){var n={"./app-items/app-items.module.ngfactory":["DHP4",3],"./fluid-unsupported-page/fluid-unsupported-page.module.ngfactory":["OZAL",5],"./group-items/group-items.module.ngfactory":["hsXR",0,6],"./m365-apps/m365-apps.module.ngfactory":["S91J",13,7],"./odsp-start/onedrive-start/onedrive-start.module.ngfactory":["1TjK",9],"./odsp-start/sharepoint-start/sharepoint-start.module.ngfactory":["MxpO",10],"./wac-content/wac-content.module.ngfactory":["005W",0,14],"context-menu.ngfactory":["aBzG",4],"mru.ngfactory":["GHXR",0,8],"share-control.ngfactory":["Uv8L",11]};function r(e){if(!i.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return Promise.all(t.slice(1).map(i.e)).then((function(){return i(r)}))}r.keys=function(){return Object.keys(n)},r.id="kJkW",e.exports=r},kS0f:function(e,t,i){"use strict";i.r(t),i("IcVw");var n=i("Mlb/"),r=i("bb6g"),s=i("6cfW"),o=i("+2OL");const a=new n.q("SERVICE_WORKER_ENABLED");var l=i("511z"),c=i("BMb5"),u=i("cgnd"),h=i("lrJm"),d=i("5MEU"),m=i("wwmn"),p=i("JWB6"),f=i("hZW2");const g=new n.q("SERVICE_WORKER_REGISTRATION_HANDLERS"),b=new n.q("SERVICE_WORKER_GET_REGISTRATION_BY_SCOPE");let v=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c,u,h){this.serviceWorkerConfigService=e,this.serviceWorkerEnabled=t,this.hasServiceWorkerApi=i,this.windowService=n,this.startupConfigService=r,this.globalErrorHandler=s,this.workloadQueryParameterValue=o,this.officeHomeApiConfig=a,this.serviceWorkerStateService=l,this.documentService=c,this.registrationHandlers=u,this.getRegistrationByScope=h}initialize(){return Object(r.b)(this,void 0,void 0,(function*(){if(this.hasServiceWorkerApi){this.serviceWorkerContainer=this.windowService.nativeWindow.navigator.serviceWorker;try{let e;if("Controlled"===this.serviceWorkerStateService.currentState){const t=this.getRegistrationByScope?this.serviceWorkerConfigService.config.scope:void 0;e=yield this.serviceWorkerContainer.getRegistration(t)}if(this.serviceWorkerEnabled){const{scriptUrl:t,scope:i}=this.serviceWorkerConfigService.config,n=new URLSearchParams;if(n.append("cdnDomain",this.startupConfigService.config.cdnDomain),n.append(this.officeHomeApiConfig.config.workloadQueryParameter,this.workloadQueryParameterValue),"antp"===this.workloadQueryParameterValue){const e=new URLSearchParams(this.windowService.nativeWindow.location.search),t=e.get("locale"),i=e.get("flight");t&&n.append("locale",t),i&&n.append("flight",i)}const r=this.getFlightsForRegistrationUrl();for(const e of r)n.append("serviceWorkerFlight",e);this.startupConfigService.config.automatedTestRunning&&n.append("envType","cloudtest");const s=`${t}?${n.toString()}`;if(e){const t=this.windowService.nativeWindow.location.origin,n=e.active.scriptURL.toLowerCase()!==(t+s).toLowerCase(),r=e.scope.toLowerCase()!==(t+i).toLowerCase();(n||r)&&(e=yield this.registerServiceWorker(s,i))}else e=yield this.registerServiceWorker(s,i)}e&&this.registrationHandlers&&(yield Promise.all(this.registrationHandlers.map(t=>t.handleRegistration(e))))}catch(e){if(Object(s.a)(e))return;this.globalErrorHandler.handleError(e,"qKgQM")}}}))}registerServiceWorker(e,t){return new Promise(i=>{const n=()=>{i(this.serviceWorkerContainer.register(e,{scope:t})),this.windowService.nativeWindow.removeEventListener("load",n)};"complete"===this.documentService.nativeDocument.readyState?n():this.windowService.nativeWindow.addEventListener("load",n)})}getFlightsForRegistrationUrl(){const e=this.startupConfigService.config.sharedClientStartupContext.flights,{serviceWorkerAllowedFlights:t,pilotFlights:i}=this.serviceWorkerConfigService.config,n=new Set([...e.split(","),...i]);return t.filter(e=>n.has(e))}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(o.a),n.cc(a),n.cc(l.a),n.cc(c.b),n.cc(u.b),n.cc(h.b),n.cc(d.a),n.cc(m.a),n.cc(p.a),n.cc(f.a),n.cc(g,8),n.cc(b,8))},token:e,providedIn:"root"}),e})();var S=i("31lE"),y=i("Uqr9"),w=i("hhzZ"),C=i("4/We"),I=i("JH4S"),T=i("uUrA"),k=i("/I02"),E=i("re3B"),A=i("C0xW");let P=(()=>{class e{constructor(e,t,i){this.contextService=e,this.unloadEventService=t,this.eventManager=i,this.currentSessionIndex=0,this.currentSessionId=null,this.currentSessionStartTime=0,this.currentSessionClickCount=0,this.inactivityStartTime=0,this.inactivityTrackerStartTime=0,this.cumulativeDurationOfActivitySessions=0,this.cumulativeDurationBetweenActivitySessions=0,this.cumulativeClickCount=0}initialize(e){if(!this.contextService.sharedContext.activityTrackingEnabled)return;this.instrumentationService=e;const t=()=>{this.startSession(),this.trackInactivity()};t(),this.mousedownListener=this.eventManager.addGlobalEventListener("document","mousedown",t),this.mousemoveListener=this.eventManager.addGlobalEventListener("document","mousemove",t),this.keypressListener=this.eventManager.addGlobalEventListener("document","keypress",t),this.unloadEventService.addUnloadEvent(()=>{this.mousedownListener&&this.mousedownListener(),this.mousemoveListener&&this.mousemoveListener(),this.keypressListener&&this.keypressListener(),clearTimeout(this.inactivityTrackerTimeout),this.endSession(this.inactivityTrackerStartTime?y.a.now()-this.inactivityTrackerStartTime:0)})}startSession(){if(!this.contextService.sharedContext.activityTrackingEnabled)return null;if(this.currentSessionId)return this.currentSessionId;this.currentSessionStartTime=y.a.now(),this.currentSessionId=T.a.createGuid(),this.currentSessionIndex++,this.currentSessionClickCount=0;const e={};if(e.ActivitySessionId=this.currentSessionId,e.Index=this.currentSessionIndex.toString(),this.currentSessionIndex>1){if(this.inactivityStartTime<=0)throw new h.a("Logical error in ActivitySessionService: inactivityStartTime must be set to valid value when startSession() is called");const t=this.currentSessionStartTime-this.inactivityStartTime;this.cumulativeDurationBetweenActivitySessions+=t,e.Latency=Math.ceil(t).toString()}return this.instrumentationService.logGenericEvent("Activity_Session_Started",e),this.currentSessionId}endSession(e=0){if(!this.contextService.sharedContext.activityTrackingEnabled)return null;if(!this.currentSessionId)return this.getCurrentStats();this.inactivityStartTime=y.a.now()-e;const t={};t.ActivitySessionId=this.currentSessionId,t.Index=this.currentSessionIndex.toString(),t.ClickCount=this.currentSessionClickCount.toString();const i=this.inactivityStartTime-this.currentSessionStartTime;return this.cumulativeDurationOfActivitySessions+=i,t.Latency=Math.ceil(i).toString(),this.instrumentationService.logGenericEvent("Activity_Session_Finished",t),this.currentSessionId=null,this.getCurrentStats()}incrementClick(){this.startSession(),this.currentSessionClickCount++,this.cumulativeClickCount++}getCurrentStats(){return{activitySessionsCount:this.currentSessionIndex,cumulativeClickCount:this.cumulativeClickCount,cumulativeDurationOfActivitySessions:this.cumulativeDurationOfActivitySessions,cumulativeDurationBetweenActivitySessions:this.cumulativeDurationBetweenActivitySessions,inactivityStartTime:this.inactivityStartTime}}trackInactivity(){clearTimeout(this.inactivityTrackerTimeout),this.inactivityTrackerStartTime=y.a.now(),this.inactivityTrackerTimeout=setTimeout(()=>this.endSession(y.a.now()-this.inactivityTrackerStartTime),1e3*this.contextService.sharedContext.inactivityTimeoutInSeconds)}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(k.a),n.cc(E.a),n.cc(A.d))},token:e,providedIn:"root"}),e})();var x=i("uzn7"),D=i("W3Zz"),M=i("xoWf");let F=(()=>{class e{constructor(t,i,n,r,s,o,a){this.clientStartupConfigService=t,this.localStorageService=i,this.userDataStorageService=s,this.instrumentationService=o,this.globalErrorHandler=a,this.scheduledSavePromise=null,this.pendingFirstTimeMetrics={},this.firstTimeUser=this.userDataStorageService.isFirstUse(),this.firstVisitTimestamp=this.userDataStorageService.getFirstUseTimestamp(),this.bufferingTimeoutInSeconds=r.isMobileDevice()?e.BufferingTimespanInSecondsForMobile:e.BufferingTimespanInSecondsForDesktop,this.localStorageProfileDataKey=".Full_Metrics.v"+e.LocalStorageSchemaVersion,this.fullMetrics=this.localStorageService.get(this.localStorageProfileDataKey),this.fullMetrics&&this.fullMetrics.metrics?this.firstTimeUser&&(this.firstTimeUser=!1,this.firstVisitTimestamp=this.fullMetrics.created):this.fullMetrics=e.createEmptySnapshot(),this.onLoadMetrics=this.fullMetrics.metrics,this.localStorageUnsavedDataKey=".Unsaved_Metrics.v"+e.LocalStorageSchemaVersion,this.unsavedMetrics=this.localStorageService.get(this.localStorageUnsavedDataKey),this.unsavedMetrics&&this.unsavedMetrics.metrics?this.firstTimeUser&&(this.firstTimeUser=!1,this.firstVisitTimestamp=this.unsavedMetrics.created):this.unsavedMetrics=null,this.inMemoryProfile={metrics:this.fullMetrics.metrics},this.roamingStorageProfileDataKey="User_Profile.Metrics.v"+e.LocalStorageSchemaVersion,this.loadFromUserStorage(),this.forceImmediateSave=this.firstTimeUser||!!this.unsavedMetrics,n.addUnloadEvent(()=>this.flush())}incrementMetric(t,i){const n=e.createTimestamp();e.applyIncrement(t,n,this.fullMetrics.metrics);const r=this.fullMetrics.metrics[t];r&&1===r.count&&(this.loadingMetricsFromRoamingStorage?this.pendingFirstTimeMetrics[t]=r.firstOccurrence:this.logMetricRecordedForFirstTime(t)),this.unsavedMetrics||(this.unsavedMetrics=e.createEmptySnapshot()),e.applyIncrement(t,n,this.unsavedMetrics.metrics),this.scheduleSave(i)}flush(){this.scheduledSavePromise&&this.forceSave()}get(){return this.pendingLoad}isFirstVisit(){return this.firstTimeUser}getInitialMetric(e){return this.onLoadMetrics[e]}doesMetricExist(e,t){return Object(r.b)(this,void 0,void 0,(function*(){const i=(yield this.get()).metrics;for(const n in i)if(t?n===e:n.includes(e))return!0;return!1}))}fullDaysSinceFirstVisit(){if(this.firstTimeUser)return 0;if(void 0===this.firstVisitTimestamp||this.firstVisitTimestamp<0)return-1;const t=e.createTimestamp()-this.firstVisitTimestamp;return Math.floor(t/e.MillisecondsInDay)}static createTimestamp(){return Date.now()}static createEmptySnapshot(){return{metrics:{},created:e.createTimestamp(),saved:-1}}static applyIncrement(e,t,i){if(i.hasOwnProperty(e)){const n=i[e];n.count++,n.lastOccurrence=t}else i[e]={count:1,firstOccurrence:t,lastOccurrence:t}}static mergeMetrics(t,i){for(const n in i)e.applyMetric(t,n,i[n])}static applyMetric(e,t,i){if(e.hasOwnProperty(t)){const n=e[t];n.count+=i.count,n.firstOccurrence>i.firstOccurrence&&(n.firstOccurrence=i.firstOccurrence),n.lastOccurrence<i.lastOccurrence&&(n.lastOccurrence=i.lastOccurrence)}else e[t]=Object.assign({},i)}static sanitizeMetrics(t){if(!t.hasOwnProperty(e.MetricPresentInSetThatHasToBeSanitized))return t;const i={};for(const e in t){if(e.indexOf("_Request")>0)continue;if(e.indexOf("_Impression")>0)continue;let n=!1;if(e.startsWith("Referral."))n=!0;else if(e.indexOf("_PageView")>0)n=!0;else if(e.indexOf("_Click")>0||e.indexOf("_Toggle")>0){const t=e.split(".");3===t.length&&w.b.hasOwnProperty(t[1])&&(n=!0)}else"Upload_Completed"===e&&(n=!0);n&&(i[e]=t[e])}return i}resetScheduledSave(){this.scheduledSavePromise&&(clearTimeout(this.scheduledSaveTimeoutId),this.scheduledSaveTimeoutId=null,this.scheduledSavePromise=null,this.scheduledSaveEstimatedTime=null)}scheduleSave(e){if(this.forceImmediateSave)return this.forceImmediateSave=!1,void this.forceSave();if(this.scheduledSavePromise&&(!e||Date.now()+1e3*e>=this.scheduledSaveEstimatedTime))return;this.resetScheduledSave();const t=1e3*(e?Math.min(e,this.bufferingTimeoutInSeconds):this.bufferingTimeoutInSeconds);this.scheduledSaveEstimatedTime=Date.now()+t,this.scheduledSavePromise=new Promise(e=>{this.scheduledSaveTimeoutId=setTimeout(()=>{this.forceSave(),e()},t)})}forceSave(){if(this.resetScheduledSave(),this.clientStartupConfigService.config.sanitizeMetrics&&(this.unsavedMetrics&&(this.unsavedMetrics.metrics=e.sanitizeMetrics(this.unsavedMetrics.metrics)),this.fullMetrics.metrics=e.sanitizeMetrics(this.fullMetrics.metrics)),this.fullMetrics.saved=e.createTimestamp(),this.localStorageService.set(this.localStorageProfileDataKey,this.fullMetrics),this.unsavedMetrics&&this.localStorageService.set(this.localStorageUnsavedDataKey,this.unsavedMetrics),this.loadingMetricsFromRoamingStorage)this.scheduleSave();else{const t=this.unsavedMetrics;this.unsavedMetrics=null,this.userDataStorageService.set(this.roamingStorageProfileDataKey,this.fullMetrics).then(()=>{this.unsavedMetrics?this.localStorageService.set(this.localStorageUnsavedDataKey,this.unsavedMetrics):this.localStorageService.remove(this.localStorageUnsavedDataKey)}).catch(i=>{this.globalErrorHandler.handleError(i,"SxWjc"),this.unsavedMetrics&&t&&e.mergeMetrics(t.metrics,this.unsavedMetrics.metrics),this.unsavedMetrics=t,this.unsavedMetrics&&this.localStorageService.set(this.localStorageUnsavedDataKey,this.unsavedMetrics)})}}loadFromUserStorage(){this.pendingLoad=new Promise(t=>{this.loadingMetricsFromRoamingStorage=!0,this.userDataStorageService.get(this.roamingStorageProfileDataKey,e.LoadFromUserStorageRemoteAttempts).then(t=>{t&&t.metrics&&(this.unsavedMetrics&&t.saved<this.unsavedMetrics.created&&e.mergeMetrics(t.metrics,this.unsavedMetrics.metrics),this.fullMetrics=t,this.inMemoryProfile.metrics=this.fullMetrics.metrics)}).catch(e=>{this.globalErrorHandler.handleError(e,"QN0a5")}).then(()=>{this.loadingMetricsFromRoamingStorage=!1;for(const e in this.pendingFirstTimeMetrics){const t=this.fullMetrics.metrics[e];t&&this.pendingFirstTimeMetrics[e]!==t.firstOccurrence||this.logMetricRecordedForFirstTime(e)}this.pendingFirstTimeMetrics={},t(this.inMemoryProfile)})})}logMetricRecordedForFirstTime(e){const t={};t.MetricName=e,this.instrumentationService.logGenericEvent("First_Time_Metric",t)}}return e.BufferingTimespanInSecondsForDesktop=30,e.BufferingTimespanInSecondsForMobile=5,e.LoadFromUserStorageRemoteAttempts=2,e.LocalStorageSchemaVersion=1,e.MillisecondsInDay=864e5,e.MetricPresentInSetThatHasToBeSanitized="Site_Visit",e.ɵprov=n.bc({factory:function(){return new e(n.cc(u.b),n.cc(x.a),n.cc(E.a),n.cc(D.b),n.cc(M.a),n.cc(w.a),n.cc(h.b))},token:e,providedIn:"root"}),e})();const L=new n.q("WRAPPER_VERSION");let O=(()=>{class e{constructor(t,i,n,r,s,o,a){this.clientStartupConfigService=i,this.activitySessionService=r,this.sessionActive=!1,this.ariaLogger=e.createAriaLogger(i.config,n,s,a,t),this.ariaLogger&&(this.sessionActive=!0,o.addUnloadEvent(()=>{this.endAppSession(!t.capabilities.pwaEnabled)},!0))}static createAriaLogger(t,i,n,r,s){if(!t.sharedClientStartupContext.ariaTenant||!t.sharedClientStartupContext.ariaCollectorUrl)return null;const o=e.initializeAriaLogManager(t.sharedClientStartupContext.ariaTenant,t.sharedClientStartupContext.ariaCollectorUrl,!1);let a=t.puid,l=S.AWTUserIdType.Unknown;if(a?t.authType===u.a.OrgId?l=S.AWTUserIdType.OrgIdPUID:t.authType===u.a.MSA&&(l=S.AWTUserIdType.MSAPUID):a=e.unknownUserId,o.getSemanticContext().setUserId(a,S.AWTPiiKind.NotSet,l),o.setContext("UserInfo.OMSTenantId",t.tenantId),o.setContext("AuthType",t.authTypeString),o.setContext("CorpNet",t.sharedClientStartupContext.corpNet),o.setContext("CorrelationId",t.sharedClientStartupContext.correlationId),o.setContext("DevEnvironment",t.sharedClientStartupContext.devEnvironment),o.setContext("DeploymentEnvironment",t.sharedClientStartupContext.deploymentEnvironment),o.setContext("Geo",t.sharedClientStartupContext.geoName),o.setContext("RequestOrigin",t.sharedClientStartupContext.requestOrigin),o.setContext("SessionId",t.sharedClientStartupContext.sessionId),o.setContext("TestTraffic",t.sharedClientStartupContext.testTraffic),o.setContext("ServerBuildDate",t.sharedClientStartupContext.buildDateUtc),o.setContext("ServerBuildId",t.sharedClientStartupContext.buildId),o.setContext("BundleBuildDate","2020-07-07 10:16:33.704"),o.setContext("BundleBuildId","8ae885ca-313e-613a-f100-a0c56f93e214"),o.setContext("Flights",t.sharedClientStartupContext.flights+(t.sharedClientStartupContext.flights&&t.features?",":"")+t.features),i&&(o.setContext("Admin",i.user.isAdmin),o.setContext("IsSmb",i.user.isSmb),o.setContext("IsIw",i.user.isIw),o.setContext("IsEdu",i.user.isEdu),o.setContext("IsEduStudent",i.user.isEduStudent),o.setContext("IsEduFaculty",i.user.isEduFaculty),o.setContext("IsDynamics",i.user.isDynamics),o.setContext("ThemeId",i.user.themeId),o.setContext("IsFirstRelease",i.user.isFirstRelease)),n&&(o.setContext("FirstVisit",n.isFirstVisit()),o.setContext("FirstVisitAgeInDays",n.fullDaysSinceFirstVisit())),r&&o.setContext("WrapperVersion",`${r.major}.${r.minor}.${r.build}.${r.revision}`),s&&s.capabilities.antpLoaded){const e=navigator.userAgent.match(new RegExp("Edg/([\\d,.]+)"));e&&(S.AWTLogManager.getSemanticContext().setDeviceBrowserName("Edg"),S.AWTLogManager.getSemanticContext().setDeviceBrowserVersion(e[1])),o.setContext("Channel",window.channel)}return e.startSession(o),o}static endSession(t,i,n){window.disableLogs||(n=n||new S.AWTEventProperties,e.populateSessionProperties(n),t.logSession(S.AWTSessionState.Ended,n)),i?S.AWTLogManager.flushAndTeardown():S.AWTLogManager.flush(null)}trackEvent(t,i){if(!this.ariaLogger)return;this.sessionActive||(e.startSession(this.ariaLogger),this.sessionActive=!0);const n=this.clientStartupConfigService.config,r=new S.AWTEventProperties;r.setName(t);for(const e in i)if(i.hasOwnProperty(e)){const t=i[e];t instanceof w.d?n.logPiiAllowed&&(n.logPiiInClearText?r.setProperty(e,t.value):r.setPropertyWithPii(e,t.value,t.kind)):r.setProperty(e,t)}this.ariaLogger.logEvent(r)}endAppSession(t){if(!this.ariaLogger||!this.sessionActive)return;const i=new S.AWTEventProperties,n=this.activitySessionService.endSession();if(n){const e=y.a.now()-n.inactivityStartTime;i.setProperty("ActivityDuration",Math.ceil(n.cumulativeDurationOfActivitySessions/1e3).toString()),i.setProperty("InactivityDuration",Math.ceil((n.cumulativeDurationBetweenActivitySessions+e)/1e3).toString()),i.setProperty("ItemCount",n.activitySessionsCount.toString()),i.setProperty("ClickCount",n.cumulativeClickCount.toString())}e.endSession(this.ariaLogger,t,i),this.sessionActive=!1}static startSession(t){if(window.disableLogs)return;const i=new S.AWTEventProperties;e.populateSessionProperties(i),t.logSession(S.AWTSessionState.Started,i)}static populateSessionProperties(e){e.setProperty("LoggerId","Angular"),window.prelaunchMode&&e.setProperty("PrelaunchMode","true")}static initializeAriaLogManager(e,t,i){return S.AWTLogManager.initialize(e,{collectorUri:t,enableAutoUserSession:!1,propertyStorageOverride:null,disableCookiesUsage:i})}}return e.unknownUserId="Unknown",e.ɵprov=n.bc({factory:function(){return new e(n.cc(C.a),n.cc(u.b),n.cc(I.a),n.cc(P),n.cc(F),n.cc(E.a),n.cc(L,8))},token:e,providedIn:"root"}),e})();class R{constructor(e,t,i,n){this.ariaService=e,this.streamName=t,this.params=i,this.metrics=n}record(){const e={};for(const t in this.params)e[t]=this.params[t];this.ariaService.trackEvent(this.streamName,e)}}let _=(()=>{class e{constructor(e){this.ariaService=e}createEvent(e,t,i){return new R(this.ariaService,e,t,i)}flush(){this.ariaService.endAppSession(!0)}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(O))},token:e,providedIn:"root"}),e})(),U=(()=>{class e{static setup(t){if(document.body&&document.body.addEventListener){const i=-1!==navigator.appVersion.toUpperCase().indexOf("MSIE")?"click":"mousedown";document.body.addEventListener(i,(function(i){e.processClick(i,t)}))}}static processClick(t,i){let n=t.srcElement||t.target;for(;n&&(!n.tagName||!e.supportedClickTargets.hasOwnProperty(n.tagName.toUpperCase()));)n=n.parentElement||n.parentNode;if(!n)return;const r=n.getAttribute("data-clicklog");if(r&&"CUSTOM"===r.toUpperCase())return;const s=n.id||"Unknown";let o=n.getAttribute("data-referral");null!=o&&0!==o.length||(o=e.referralFromElement(n));const a=n.getAttribute("data-referral-platform");let l=n.getAttribute("data-area");null!=l&&0!==l.length||(l=e.areaFromElement(n));const c=!!n.getAttribute("data-nav");e.logGenericClick(s,l,o,a,c,i)}static logGenericClick(e,t,i,n,r,s){s.logClickEvent("Generic_Click",e,t,i,n,void 0,void 0,void 0,r)}static areaFromElement(e){const t=e.id||null;if(t&&t.length){const e="O365_";if(0===t.lastIndexOf(e,e.length))return w.b.Shell;const i="obf-";if(0===t.lastIndexOf(i,i.length))return w.b.Feedback}const i=e.classList||null;if(i&&i.length){const e="o365cs-";for(let t=0;t<i.length;t++)if(0===i.item(t).lastIndexOf(e,e.length))return w.b.Shell}return null}static referralFromElement(e){const t=e.id||null;if(t&&t.length){const i="O365_AppTile_";if(0===t.lastIndexOf(i,i.length)){let e=t.substring(i.length);const n="Shell";return 0===e.lastIndexOf(n,n.length)&&(e=e.substring(n.length)),e}const n=e.classList||null;if(n&&n.length&&n.contains("o365cs-nav-appTile"))return t}return null}}return e.supportedClickTargets={A:!0,IMG:!0,AREA:!0,INPUT:!0,BUTTON:!0},e})();var N=i("p6wn"),W=i("7Gwk"),B=i("Z0U4");i("72nV");class H{constructor(e){this.ngZone=e}runWhenIdle(e){return requestIdleCallback(t=>this.ngZone.run(()=>e(t)))}cancelIdleCallback(e){cancelIdleCallback(e)}}class q{runWhenIdle(e){const t=y.a.now();return setTimeout(()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(y.a.now()-t))})},1)}cancelIdleCallback(e){clearTimeout(e)}}const V=function(e){return()=>e.getShellAndConfigPromise()},$=function(){return window.queuedEvents||[]},z=function(){return window.queuedMarks||[]},j=function(e,t,i){return e.config.automatedTestRunning||t.deviceInfo.browser.browserType===D.a.Safari?new q:new H(i)};class G{}var Q=i("70cc"),K=i("w1PR"),Z=i("6Po3");let J=(()=>{class e{get domParser(){return this._parser||(this._parser=new DOMParser),this._parser}parseHtml(e){return this.domParser.parseFromString(e,"text/html")}}return e.ɵprov=n.bc({factory:function(){return new e},token:e,providedIn:"root"}),e})();const X=new n.q("DOM_SNAPSHOT_HANDLERS");let Y=(()=>{class e{constructor(e,t,i){this.browserPaintService=e,this.domParserService=t,this.domSnapshotHandlers=i}takeSnapshot(e,t){return Object(r.b)(this,void 0,void 0,(function*(){if(this.domSnapshotHandlers)return new Promise((i,n)=>{this.browserPaintService.runAfterPaint(()=>Object(r.b)(this,void 0,void 0,(function*(){try{const n=this.domParserService.parseHtml(e.nativeElement.innerHTML);for(const e of this.domSnapshotHandlers)yield e.handleSnapshot(n,t);i()}catch(e){n(e)}})))})}))}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(Z.a),n.cc(J),n.cc(X))},token:e,providedIn:"root"}),e})(),ee=(()=>{class e{constructor(e,t,i){this.themingService=e,this.domSnapshotService=t,this.documentService=i}observe(){this.themingService.themeShades.pipe(Object(Q.a)(e=>e.userSelected)).subscribe(()=>{const e=this.documentService.nativeDocument.getElementById("ohp-app-theme");this.domSnapshotService.takeSnapshot(new n.l(e),"ohp-app-theme")})}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(K.a),n.cc(Y),n.cc(f.a))},token:e,providedIn:"root"}),e})();var te=i("dFxn");let ie=(()=>{class e{constructor(e){this.config=e.parse("antpConfig")||{antpEnabled:!1,antpViewCacheEnabled:!1,shellAndConfigApiEndpoint:null,resourceUrlMap:null}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(te.a))},token:e,providedIn:"root"}),e})(),ne=(()=>{class e{constructor(e){this.config=e.parse("antpSharedConfig")||{maxTilesEnabled:!1,topSitesMaxTiles:8,settingsEnabled:!1,waffleEnabled:!1,renderCacheEnabled:!1}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(te.a))},token:e,providedIn:"root"}),e})();i("porp"),i("OMbk"),i("36QD"),i("P9EA"),i("tnOy");class re{constructor(e,t,i,n,r,s,o){this.elementRef=e,this.eventService=t,this.injector=i,this.viewCacheService=n,this.clientStartupConfigService=r,this.navBarDataConfigService=s,this.localStorageService=o}ngOnInit(){return Object(r.b)(this,void 0,void 0,(function*(){this.viewCacheService.onInteractiveTreeVisibilityChange("ohp-antp-app-view-cache",e=>{this.displayAngularBootstrap=e}),yield this.eventService.whenEventFired("appInitialized",0);const e=this.injector.get(ne);if(this.localStorageService.set("AntpSharedConfig.v1",JSON.stringify(e.config)),this.legalLink=this.navBarDataConfigService.config.LegalLink,this.privacyLink=this.navBarDataConfigService.config.PrivacyLink,this.injector.get(ie).config.antpViewCacheEnabled){this.clientStartupConfigService.config.automatedTestRunning&&(yield this.eventService.whenEventFired("beginAutomatedTestViewCacheSwap",0)),this.injector.get(ee).observe();const e=Promise.all([this.eventService.whenEventFired("mruReady",0),this.eventService.whenEventFired("recommendedReady",0),this.eventService.whenEventFired("sharePointReady",0)]);yield this.viewCacheService.swapAndUpdateCache(e,this.elementRef,"ohp-antp-app-view-cache")}}))}}var se=i("fYis"),oe=i("R0N1"),ae=i("g/dT"),le=i("vk2e"),ce=i("pzhl"),ue=i("PkQn"),he=i("9gjh"),de=i("2lMP"),me=i("kpuN"),pe=i("dx17"),fe=i("pd4Y"),ge=i("DQbD"),be=i("Bc8L"),ve=i("PBJH"),Se=i("QOOv"),ye=i("kfAr"),we=i("7Rc8"),Ce=i("dOgD"),Ie=i("EqbI"),Te=i("1Bt+"),ke=i("OPwp"),Ee=i("55A9"),Ae=i("uNUv"),Pe=i("6u39"),xe=i("TIi1"),De=i("RZcl"),Me=i("EUVs"),Fe=i("gZ+X"),Le=i("mOWz"),Oe=i("5WpM"),Re=i("WJRI"),_e=i("kVgv");class Ue{constructor(e,t,i){this.resizeObserverService=e,this.elementRef=t,this.browserPaintService=i,this.resize=new n.n}ngOnInit(){this.resizeObserver=this.resizeObserverService.createAndObserve(e=>this.onResize(e[0]),this.elementRef.nativeElement)}ngAfterViewInit(){this.browserPaintService.runAfterPaint(()=>{this.resize.emit(this.elementRef.nativeElement.getBoundingClientRect())})}ngOnDestroy(){this.resizeObserver.disconnect()}onResize(e){e&&this.resize.emit(e.contentRect)}}var Ne=i("iXzu");let We=(()=>{class e{constructor(e){this.ngZone=e}createAndObserve(e,t){const i=new Ne.a(e);return this.ngZone.runOutsideAngular(()=>{i.observe(t)}),i}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(n.z))},token:e,providedIn:"root"}),e})();var Be=i("O6Zd"),He=i("S5zL"),qe=i("DCBR");class Ve extends Le.d{constructor(e){super(qe.a.cardMinWidth,2*qe.a.cardMinWidth,4*qe.a.cardMinWidth),this.eventService=e,this.eventService.events.withScope(0).pipe(Object(Q.a)(e=>"recommendedCardSize"===e.name),Object(Be.a)(e=>({size:e.args[0],num:e.args[1]})),Object(He.a)((e,t)=>e.size===t.size&&e.num===t.num)).subscribe(({size:e,num:t})=>{this.updateItemAndBufferSize(e,e*(t+1),e*(t+3))})}}var $e=i("Eup2"),ze=i("9260"),je=i("R7NL"),Ge=i("ZtId"),Qe=i("casz");const Ke=new n.q("AAD_APP_ID",{providedIn:"root",factory:()=>{const e=Object(n.U)(C.a);return e.capabilities.antpLoaded||e.capabilities.pwaEnabled?"0ec893e0-5785-4de6-99da-4ed124e5296c":"4345a7b9-9a63-4910-a426-35363201d503"}});let Ze=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c,u,h,d,m){this.recommendedDataService=new ze.a(e,t,i,n,r,s,o,a,l,c,u,h,d,m)}getRecommendedService(){return this.recommendedDataService}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(me.a),n.cc(C.a),n.cc(k.a),n.cc(w.a),n.cc(je.a),n.cc(Se.a),n.cc(m.a),n.cc(le.q),n.cc(h.b),n.cc(u.b),n.cc(Ge.a),n.cc(Qe.a),n.cc(c.b),n.cc(Ke))},token:e,providedIn:"root"}),e})(),Je=(()=>{class e{}return e.ɵprov=n.bc({factory:function(){return(e=>e.getRecommendedService())(n.cc(Ze))},token:e,providedIn:"root"}),e})();var Xe=i("BaAg");let Ye=(()=>{class e{constructor(e){this.config=e.parse("feedbackConfig")}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(te.a))},token:e,providedIn:"root"}),e})();var et=i("5aVq");let tt=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c,u,h){this.capabilitiesService=e,this.deviceDetector=t,this.documentService=i,this.feedbackConfigService=n,this.instrumentationService=r,this.routeService=s,this.startupConfigService=o,this.userContextService=a,this.scheduler=l,this.windowService=c,this.shellShimService=u,this.contextService=h,this.feedbackScript="feedback-script",this.scriptLoadStarted=!1,this.initialize()}getOCVTelemetryData(e){return{applicationGroup:{appData:JSON.stringify({userCategories:this.getUserCategories(),latency:e,tenant:this.startupConfigService.config.tenantId})},telemetryGroup:{deviceType:this.getDeviceType(),flights:this.startupConfigService.config.sharedClientStartupContext.flights,platform:this.deviceDetector.getDeviceInfo().platform.keyword,audienceGroup:"Production",officeBuild:this.startupConfigService.config.sharedClientStartupContext.buildId},webGroup:{browser:this.deviceDetector.getDeviceInfo().browser.keyword,sourcePageName:this.getSourcePageName()}}}loadOCVFeedback(e){"undefined"!=typeof OfficeBrowserFeedback&&(OfficeBrowserFeedback.initOptions.appId=this.getOcvAppId(),OfficeBrowserFeedback.initOptions.onDismiss=t=>{this.logDismissOCVFeedback(t),e&&e()},OfficeBrowserFeedback.multiFeedback||this.scriptLoadStarted?this.displayOCVFeedback("0"):this.addOCVScriptToPage(e=>{this.displayOCVFeedback(e.toString())}))}addOCVScriptToPage(e){const t=this.feedbackConfigService.config;return!!t&&(this.scriptLoadStarted||(this.scriptLoadStarted=!0,this.scheduler.scheduleWork(()=>{const i=y.a.now();this.documentService.addScriptToPage(t.scriptUrl,()=>{const t=Math.ceil(y.a.now()-i);e(t)},()=>{},!0,this.feedbackScript,!0)},4)),!0)}getOcvAppId(){return this.getSourcePageName()===this.feedbackConfigService.config.fluidContentPage?this.feedbackConfigService.config.fluidAppId:this.feedbackConfigService.config.appId}initialize(){return Object(r.b)(this,void 0,void 0,(function*(){if(this.currentPageView=this.getCurrentPageView(this.routeService.getCurrentRoute()),this.routeService.subscribeToRouteChangeStart(e=>this.currentPageView=this.getCurrentPageView(e.currentRoute)),"undefined"!=typeof OfficeBrowserFeedback&&!OfficeBrowserFeedback.initOptions){const{stylesUrl:e,intlUrl:t,environment:i,screenshotEnabled:n,autopopulateEmail:r}=this.feedbackConfigService.config,{buildId:s,correlationId:o}=this.startupConfigService.config.sharedClientStartupContext;OfficeBrowserFeedback.initOptions={appId:void 0,stylesUrl:e,intlUrl:t,environment:i,sessionId:o,build:s,locale:this.contextService.sharedContext.officeMarket,screenshot:n,userEmail:r?this.startupConfigService.config.userPrincipalName:""}}if(this.capabilitiesService.capabilities.shellFeedbackEnabled){const e=this.getOCVTelemetryData("0"),t=this;(yield this.shellShimService.getShellShim()).NFD.OnFeedbackMetadataRequested((i,n)=>{t.windowService.nativeWindow.OfficeBrowserFeedback.html2canvas(this.documentService.nativeDocument.body,{background:"#ffffff"})().then((function(e){n(e.toDataURL("image/jpeg"))}));const r=(i=i||{options:{telemetryGroup:{}}}).options;r.appId=this.getOcvAppId(),r.userVoiceEnabled=!1,r.applicationGroup.appData=e.applicationGroup.appData,r.disableIncludeScreenshot=!1;const s=r.telemetryGroup;return s.audienceGroup=e.telemetryGroup.audienceGroup,s.featureArea="",s.flights=e.telemetryGroup.flights,s.processSessionId=t.startupConfigService.config.sharedClientStartupContext.correlationId,i})}}))}logDismissOCVFeedback(e){this.instrumentationService.logGenericEvent(e?"Feedback_OCV_Submitted":"Feedback_OCV_Dismissed",{})}displayOCVFeedback(e){return Object(r.b)(this,void 0,void 0,(function*(){const t={};if(t.Latency=e,this.capabilitiesService.capabilities.shellFeedbackEnabled)(yield this.shellShimService.getShellShim()).NFD.OpenFeedback();else{const i=this.getOCVTelemetryData(e);OfficeBrowserFeedback.multiFeedback(i).then(()=>{},e=>{t.Error=e,this.instrumentationService.logGenericEvent("Feedback_OCV_Error",t)})}this.instrumentationService.logGenericEvent("Feedback_OCV_Click",t)}))}getDeviceType(){return this.deviceDetector.isDesktopDevice()?"Desktop":this.deviceDetector.isTabletDevice()?"Tablet":this.deviceDetector.isMobileDevice()?"Phone":"Laptop"}getSourcePageName(){return this.currentPageView}getUserCategories(){const e=[];return this.startupConfigService.config.authType===u.a.OrgId?e.push("Commercial"):this.startupConfigService.config.authType===u.a.MSA&&e.push("Consumer"),this.userContextService.user.isAdmin&&e.push("Admin"),this.userContextService.user.isEdu&&e.push("Edu"),this.userContextService.user.isEduStudent&&e.push("EduStudent"),this.userContextService.user.isEduFaculty&&e.push("EduFaculty"),this.userContextService.user.isSmb&&e.push("Smb"),this.userContextService.user.isDynamics&&e.push("Dynamics365"),e}getCurrentPageView(e){if(!e||!e.route)return"Unknown";switch(e.route){case"OfficeHome":return"Home_PageView";case"AppGallery":return"AppGallery_PageView";case"Search":case"SearchSiteScoped":return"Search_PageView";default:return`${e.app?Xe.b[e.app]:""}${e.route}`}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(C.a),n.cc(D.b),n.cc(f.a),n.cc(Ye),n.cc(w.a),n.cc(B.a),n.cc(u.b),n.cc(I.a),n.cc(Qe.a),n.cc(c.b),n.cc(et.a),n.cc(k.a))},token:e,providedIn:"root"}),e})(),it=(()=>{class e{constructor(e,t){this.capabilitiesService=e,this.feedbackService=t,this.capabilitiesService.capabilities.showFloodgate&&(this.floodgateInitPromise=new Promise((e,t)=>{this.feedbackService.addOCVScriptToPage(t=>{const i=this.feedbackService.getOCVTelemetryData(t.toString());OfficeBrowserFeedback.initOptions.applicationGroup=i.applicationGroup,OfficeBrowserFeedback.initOptions.telemetryGroup=i.telemetryGroup,OfficeBrowserFeedback.initOptions.webGroup=i.webGroup,OfficeBrowserFeedback.initOptions.appId=this.feedbackService.getOcvAppId(),OfficeBrowserFeedback.floodgate.initialize().then(e)})||t()}))}recordFloodgate(e){this.floodgateInitPromise.then(()=>{OfficeBrowserFeedback.floodgate.start().then(()=>{const t=OfficeBrowserFeedback.floodgate.getEngine().getActivityListener();e.forEach(e=>t.logActivity(e)),OfficeBrowserFeedback.floodgate.stop()})})}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(C.a),n.cc(tt))},token:e,providedIn:"root"}),e})();var nt=i("rBEp"),rt=i("7wk3"),st=i("n826"),ot=i("AXqk"),at=i("6UlS");let lt=(()=>{class e{constructor(e){this.localStorageService=e,this._callouts=new at.a([]),this.callouts=this._callouts.asObservable()}addCallout(e){e.isValid()&&!this.calloutDismissed(e)&&(!e.completed&&this.calloutCompleted(e)&&(e.completed=!0),this._callouts.next(this._callouts.getValue().concat(e)))}addCallouts(e){const t=e.filter(e=>!(!e.isValid()||this.calloutDismissed(e)||(!e.completed&&this.calloutCompleted(e)&&(e.completed=!0),0)));this._callouts.next(this._callouts.getValue().concat(t))}clearCallouts(){this._callouts.next([])}dismissCallout(e){e.persistCompletion&&this.localStorageService.set(this.getCompletedKey(e.calloutType),!0),e.persistDismissal&&this.localStorageService.set(this.getDismissKey(e.calloutType),!0)}calloutDismissed(e){if(!e.persistDismissal)return!1;const t=this.getDismissKey(e.calloutType);return!!this.localStorageService.get(t)}calloutCompleted(e){if(!e.persistCompletion)return!1;const t=this.getCompletedKey(e.calloutType);return!!this.localStorageService.get(t)}getDismissKey(t){return`${e.calloutDismissedKeyPrefix}_${t}`}getCompletedKey(t){return`${e.calloutCompletedKeyPrefix}_${t}`}}return e.calloutDismissedKeyPrefix="_FeatureCalloutDismissed",e.calloutCompletedKeyPrefix="_FeatureCalloutCompleted",e.ɵprov=n.bc({factory:function(){return new e(n.cc(x.a))},token:e,providedIn:"root"}),e})();var ct=n.wb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:1,expr:":enter",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:{type:6,styles:{opacity:"{{ opacity }}"},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"150ms",opacity:.5}}},options:{params:{fadeInDuration:"500ms",opacity:1}}},options:null}],options:{}},{type:7,name:"recommendedMotionTrigger",definitions:[{type:0,name:"moving",styles:{type:6,styles:{transform:"{{ translationParam }}"},offset:null},options:{params:{translationParam:"translateX(0)"}}},{type:1,expr:"*=>moving",animation:{type:4,styles:null,timings:"400ms ease-in-out"},options:null}],options:{}}]}});function ut(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,10,"div",[["class","carousel-nav"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,4,"button",[["class","icon-button first-arrow ms-bgc-g40-h ms-fcl-nd-h"],["data-clicklog","custom"],["id","recommended-nav-left"]],[[1,"aria-label",0],[8,"title",0],[1,"aria-disabled",0],[8,"tabIndex",0]],[[null,"click"]],(function(e,t,i){var n=!0;return"click"===t&&(n=!1!==e.component.navigateCards(-1)&&n),n}),null,null)),n.xb(2,278528,null,0,le.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(3,{"icon-button--disabled ms-fcl-nta":0,"ms-fcl-ns":1}),(e()(),n.yb(4,0,null,null,1,"ohp-icon-font",[["cssClass","carousel-nav__arrow"],["iconFontName","ChevronLeft"],["size","16"]],null,null,null,ce.b,ce.a)),n.xb(5,638976,null,0,ue.a,[C.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null),(e()(),n.yb(6,0,null,null,4,"button",[["class","icon-button ms-bgc-g40-h ms-fcl-nd-h"],["data-clicklog","custom"],["id","recommended-nav-right"]],[[1,"aria-label",0],[8,"title",0],[1,"aria-disabled",0],[8,"tabIndex",0]],[[null,"click"]],(function(e,t,i){var n=!0;return"click"===t&&(n=!1!==e.component.navigateCards(1)&&n),n}),null,null)),n.xb(7,278528,null,0,le.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(8,{"icon-button--disabled ms-fcl-nta":0,"ms-fcl-ns":1}),(e()(),n.yb(9,0,null,null,1,"ohp-icon-font",[["cssClass","carousel-nav__arrow"],["iconFontName","ChevronRight"],["size","16"]],null,null,null,ce.b,ce.a)),n.xb(10,638976,null,0,ue.a,[C.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"],ariaVisible:[3,"ariaVisible"]},null)],(function(e,t){var i=t.component,n=e(t,3,0,0===i.currentCarouselPage,0!==i.currentCarouselPage);e(t,2,0,"icon-button first-arrow ms-bgc-g40-h ms-fcl-nd-h",n),e(t,5,0,"carousel-nav__arrow","ChevronLeft","16",!0);var r=e(t,8,0,i.currentCarouselPage+i.cardIncrement>=i.cards.length,i.currentCarouselPage+i.cardIncrement<i.cards.length);e(t,7,0,"icon-button ms-bgc-g40-h ms-fcl-nd-h",r),e(t,10,0,"carousel-nav__arrow","ChevronRight","16",!0)}),(function(e,t){var i=t.component;e(t,1,0,i.previousPage,i.previousPage,0===i.currentCarouselPage,0===i.currentCarouselPage?-1:0),e(t,6,0,i.nextPage,i.nextPage,i.currentCarouselPage+i.cardIncrement>=i.cards.length,i.currentCarouselPage+i.cardIncrement>=i.cards.length?-1:0)}))}function ht(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"div",[["class","carousel-card-container carousel-card--peek"]],null,null,null,null,null)),n.xb(1,278528,null,0,le.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(2,{"carousel-card--hidden":0,"carousel-card--display-none":1}),(e()(),n.yb(3,0,null,null,1,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,i){var n=!0;return"deleteItem"===t&&(n=!1!==e.component.onDeleteRecommendedItem(i)&&n),n}),he.b,he.a)),n.xb(4,770048,null,0,de.a,[me.a,pe.a,C.a,u.b,k.a,fe.a,D.b,f.a,W.a,ge.a,w.a,be.a,ve.a,Se.a,ye.a,we.a,Ce.a,B.a,Ie.a,n.D,Te.a,ke.b,Ee.a,Ae.a,Pe.a,xe.a,De.a,Me.a,c.b],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem"})],(function(e,t){var i=t.component,n=e(t,2,0,"moving"!==i.motionState&&t.context.index<i.currentCarouselPage,"moving"!==i.motionState&&t.context.index>i.currentCarouselPage+i.cardIncrement);e(t,1,0,"carousel-card-container carousel-card--peek",n),e(t,4,0,t.context.$implicit,t.context.index,t.context.index,i.recommendedDocView,i.listId,i.showActivity,i.showSharing,i.showAnalytics,i.fileType)}),null)}function dt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,ht)),n.xb(2,278528,null,0,le.j,[n.O,n.L,n.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(e()(),n.hb(0,null,null,0))],(function(e,t){var i=t.component;e(t,2,0,i.recommendedMotionList,i.trackByIndex)}),null)}function mt(e){return n.ac(0,[(e()(),n.yb(0,0,[[3,0],["virtualCard",1]],null,2,"div",[["class","carousel-card-container carousel-card--virtual-touch"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,i){var n=!0;return"deleteItem"===t&&(n=!1!==e.component.onDeleteRecommendedItem(i)&&n),n}),he.b,he.a)),n.xb(2,770048,null,0,de.a,[me.a,pe.a,C.a,u.b,k.a,fe.a,D.b,f.a,W.a,ge.a,w.a,be.a,ve.a,Se.a,ye.a,we.a,Ce.a,B.a,Ie.a,n.D,Te.a,ke.b,Ee.a,Ae.a,Pe.a,xe.a,De.a,Me.a,c.b],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"]},{deleteItem:"deleteItem"})],(function(e,t){var i=t.component;e(t,2,0,t.context.$implicit,t.context.index+i.currentCarouselPage,t.context.index,i.recommendedDocView,i.listId,i.showActivity,i.showSharing,i.showAnalytics,i.fileType)}),null)}function pt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),n.yb(1,0,null,null,4,"cdk-virtual-scroll-viewport",[["class","virtual-scroll-cards cdk-virtual-scroll-viewport"],["orientation","horizontal"]],[[2,"cdk-virtual-scroll-orientation-horizontal",null],[2,"cdk-virtual-scroll-orientation-vertical",null]],null,null,Fe.b,Fe.a)),n.Sb(6144,null,Le.a,null,[Le.c]),n.xb(3,245760,null,0,Le.c,[n.l,n.h,n.z,[2,Le.g],[2,Oe.b],Le.e,[2,Le.h]],{orientation:[0,"orientation"]},null),(e()(),n.hb(16777216,null,0,1,null,mt)),n.xb(5,409600,null,0,Le.b,[n.O,n.L,n.s,[1,Le.c],n.z],{cdkVirtualForOf:[0,"cdkVirtualForOf"],cdkVirtualForTrackBy:[1,"cdkVirtualForTrackBy"]},null)],(function(e,t){var i=t.component;e(t,3,0,"horizontal"),e(t,5,0,i.cards,i.trackByIndex)}),(function(e,t){e(t,1,0,"horizontal"===n.Nb(t,3).orientation,"horizontal"!==n.Nb(t,3).orientation)}))}function ft(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["class","carousel-card-container carousel-card--desktop"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"ohp-mru-item",[],null,[[null,"deleteItem"]],(function(e,t,i){var n=!0;return"deleteItem"===t&&(n=!1!==e.component.onDeleteRecommendedItem(i)&&n),n}),he.b,he.a)),n.xb(2,770048,null,0,de.a,[me.a,pe.a,C.a,u.b,k.a,fe.a,D.b,f.a,W.a,ge.a,w.a,be.a,ve.a,Se.a,ye.a,we.a,Ce.a,B.a,Ie.a,n.D,Te.a,ke.b,Ee.a,Ae.a,Pe.a,xe.a,De.a,Me.a,c.b],{item:[0,"item"],index:[1,"index"],relativeIndex:[2,"relativeIndex"],view:[3,"view"],listId:[4,"listId"],showActivity:[5,"showActivity"],showSharing:[6,"showSharing"],showAnalytics:[7,"showAnalytics"],mruAppType:[8,"mruAppType"],leftAlignActionsMenu:[9,"leftAlignActionsMenu"]},{deleteItem:"deleteItem"})],(function(e,t){var i=t.component;e(t,2,0,t.context.$implicit,t.context.index+i.currentCarouselPage,t.context.index,i.recommendedDocView,i.listId,i.showActivity,i.showSharing,i.showAnalytics,i.fileType,i.isAntpExperience&&t.context.index!==i.cardIncrement-1)}),null)}function gt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),n.hb(16777216,null,null,2,null,ft)),n.xb(2,278528,null,0,le.j,[n.O,n.L,n.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),n.Pb(0,le.r,[]),(e()(),n.hb(0,null,null,0))],(function(e,t){var i=t.component;e(t,2,0,n.Yb(t,2,0,n.Nb(t,3).transform(i.cards,i.currentCarouselPage,i.currentCarouselPage+i.cardIncrement)),i.trackByIndex)}),null)}function bt(e){return n.ac(0,[n.Tb(671088640,1,{carouselElement:0}),n.Tb(671088640,2,{carouselContainer:0}),n.Tb(671088640,3,{virtualCards:1}),(e()(),n.yb(3,0,null,null,1,"ohp-title-announcer",[],null,null,null,Re.b,Re.a)),n.xb(4,49152,null,0,_e.a,[],{announcement:[0,"announcement"]},null),(e()(),n.yb(5,0,[[2,0],["carouselContainer",1]],null,25,"div",[["class","carousel"]],[[8,"hidden",0],[24,"@fadeIn",0],[24,"@.disabled",0],[1,"aria-label",0]],null,null,null,null)),n.xb(6,278528,null,0,le.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Pb(131072,le.b,[n.h]),n.Qb(8,{"recommended--antp":0,"width-restrictor--backplate":1}),(e()(),n.yb(9,0,null,null,6,"div",[["class","list-header list-header--carousel"]],null,null,null,null,null)),n.xb(10,278528,null,0,le.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(11,{"list-header--carousel--motion":0}),(e()(),n.yb(12,0,null,null,1,"h3",[["class","list-header__title list-header__title--carousel ms-fcl-nd"]],null,null,null,null,null)),(e()(),n.Xb(13,null,["",""])),(e()(),n.hb(16777216,null,null,1,null,ut)),n.xb(15,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(16,0,null,null,14,"div",[],null,null,null,null,null)),n.xb(17,278528,null,0,le.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(18,{"carousel--outer carousel--virtual-outer":0,"recommended-container__motion":1,"recommended-container__motion--hidden":2}),(e()(),n.yb(19,0,[[1,0],["carouselElement",1]],null,11,"div",[],[[24,"@recommendedMotionTrigger",0]],[[null,"ohpResize"],[null,"@recommendedMotionTrigger.done"]],(function(e,t,i){var n=!0,r=e.component;return"ohpResize"===t&&(n=!1!==r.updateCarouselCardData()&&n),"@recommendedMotionTrigger.done"===t&&(n=!1!==r.recommendedMotionDone()&&n),n}),null,null)),n.xb(20,278528,null,0,le.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Qb(21,{"carousel--inner":0,"generic-tile-container generic-tile-container--card card__content":1,"recommended-inner__motion":2}),n.xb(22,4407296,null,0,Ue,[We,n.l,Z.a],null,{resize:"ohpResize"}),n.Qb(23,{translationParam:0}),n.Qb(24,{value:0,params:1}),(e()(),n.hb(16777216,null,null,1,null,dt)),n.xb(26,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,pt)),n.xb(28,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,gt)),n.xb(30,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,4,0,i.statusAnnouncement);var r=e(t,8,0,i.isAntpExperience,n.Yb(t,6,1,n.Nb(t,7).transform(i.backplatesEnabled)));e(t,6,0,"carousel",r);var s=e(t,11,0,i.recommendedMotion);e(t,10,0,"list-header list-header--carousel",s),e(t,15,0,i.cards&&!i.canSwipeRecommended&&!(0===i.currentCarouselPage&&i.currentCarouselPage+i.cardIncrement>=i.cards.length));var o=e(t,18,0,i.canSwipeRecommended,i.recommendedMotion,"moving"===i.motionState);e(t,17,0,o);var a=e(t,21,0,i.canSwipeRecommended,!i.canSwipeRecommended&&!i.recommendedMotion,i.recommendedMotion);e(t,20,0,a),e(t,22,0),e(t,26,0,i.recommendedMotion),e(t,28,0,i.canSwipeRecommended),e(t,30,0,!i.canSwipeRecommended&&!i.recommendedMotion)}),(function(e,t){var i=t.component;e(t,5,0,!i.cards||!i.cards.length,void 0,i.disableAnimation,i.recommendedTitle),e(t,13,0,i.recommendedTitle);var n=e(t,24,0,i.motionState,e(t,23,0,i.translateX));e(t,19,0,n)}))}var vt=i("7IJ8"),St=i("QhWD"),yt=i("RsrG"),wt=i("WLAd"),Ct=i("uH9+"),It=i("xSeq");class Tt{constructor(e,t){this.instrumentationService=e,this.element=t}onClick(e){!e.defaultPrevented&&this.clickData&&this.instrumentationService.logClickEvent(this.clickData.eventName,this.clickData.params.ElementId||"Unknown",this.clickData.params.Area,this.clickData.params.Referral,"Web",this.clickData.params,this.clickData.metrics)}ngOnInit(){this.element.nativeElement.setAttribute("data-clicklog","custom")}}i("SGS+");class kt{constructor(e,t,i,n,r,s,o){this.capabilitiesService=e,this.eventService=t,this.locService=i,this.responsiveRelativeDatePipe=n,this.sharePointConfigService=r,this.windowService=s,this.changeDetectorRef=o,this.iconLoading=!0}ngOnInit(){return Object(r.b)(this,void 0,void 0,(function*(){this.capabilities=this.capabilitiesService.capabilities,this.groupLabel=this.sharePointConfigService.config.resources.sharePointGroupLabel,this.isAntpExperience=this.capabilities.antpLoaded,this.shortDate=this.windowService.innerWidth<640,this.locService.supportsLocaleSpecifiers&&(this.widthSubscription=this.eventService.events.withScope(1).pipe(Object(Q.a)(e=>"contentWidthChanged"===e.name)).subscribe(e=>{const t=e.args[0]<640;t!==this.shortDate&&(this.shortDate=t,this.changeDetectorRef.markForCheck())}))}))}ngOnChanges(e){if(e.site){const t=e.site.currentValue;if(t){const e=this.sharePointConfigService.config.resources;if(this.clickData=t.getClickData(this.index,this.listId),this.iconExists=!!t.bannerImageUrl,this.descriptiveAriaLabel=this.locService.format(e.descriptiveAriaLabelTitle,t.title),t.time){const t=this.locService.format(e.descriptiveAriaLabelLastVisited,this.responsiveRelativeDatePipe.transform(this.site.time,!1));this.descriptiveAriaLabel=this.descriptiveAriaLabel+" "+t}}}}ngOnDestroy(){this.widthSubscription&&this.widthSubscription.unsubscribe()}onIconLoad(){this.iconLoading=!1}onIconError(){this.iconExists=!1}}let Et=(()=>{class e{constructor(e){this.config=e.parse("sharePointConfig")}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(te.a))},token:e,providedIn:"root"}),e})();var At=n.wb({encapsulation:2,styles:[],data:{}});function Pt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,"img",[["class","list-item--site__icon"]],[[8,"hidden",0],[8,"src",4],[8,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,i){var n=!0,r=e.component;return"load"===t&&(n=!1!==r.onIconLoad()&&n),"error"===t&&(n=!1!==r.onIconError()&&n),n}),null,null))],null,(function(e,t){var i=t.component;e(t,0,0,i.iconLoading,n.Fb(1,"",i.site.bannerImageUrl,""),n.Fb(1,"",i.site.title,""))}))}function xt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"div",[["class","list-item--site__acronym-icon"]],[[4,"background-color",null]],null,null,null,null)),(e()(),n.Xb(1,null,["",""]))],null,(function(e,t){var i=t.component;e(t,0,0,i.site.bannerColor),e(t,1,0,i.site.acronym)}))}function Dt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["class","list-item-column places-column--timestamp ms-fcl-np"]],null,null,null,null,null)),(e()(),n.Xb(1,null,["",""])),n.Rb(2,2)],null,(function(e,t){var i=t.component,r=n.Yb(t,1,0,e(t,2,0,n.Nb(t.parent,0),i.site.time,i.shortDate));e(t,1,0,r)}))}function Mt(e){return n.ac(2,[n.Pb(0,Te.a,[fe.a,ve.a,Ct.a]),(e()(),n.yb(1,0,null,null,15,"a",[["class","list-item__body list-item__body--padded"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"click"]],(function(e,t,i){var r=!0;return"click"===t&&(r=!1!==n.Nb(e,3).onClick(i)&&r),r}),null,null)),n.xb(2,4210688,null,0,It.a,[n.l,n.h],{focusOnLoad:[0,"focusOnLoad"]},null),n.xb(3,81920,null,0,Tt,[w.a,n.l],{clickData:[0,"clickData"]},null),n.xb(4,81920,null,0,oe.a,[k.a],null,null),(e()(),n.yb(5,0,null,null,11,"div",[["class","centered-flex-container list-item__height-restrictor"]],null,null,null,null,null)),(e()(),n.yb(6,0,null,null,8,"div",[["class","centered-flex-container list-item-column places-column--name"]],null,null,null,null,null)),(e()(),n.yb(7,0,null,null,4,"div",[["class","list-item__icon list-item--site__icon-container"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,Pt)),n.xb(9,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,xt)),n.xb(11,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(12,0,null,null,2,"div",[["class","list-item__flex-grow"]],null,null,null,null,null)),(e()(),n.yb(13,0,null,null,1,"div",[["class","list-item__text--large list-item__title list-item__text--limited-width list-item--site--no-group ms-fcl-bl ms-fcl-nd"]],null,null,null,null,null)),(e()(),n.Xb(14,null,["",""])),(e()(),n.hb(16777216,null,null,1,null,Dt)),n.xb(16,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,i.focusOnLoad),e(t,3,0,i.clickData),e(t,4,0),e(t,9,0,i.iconExists&&!i.isAntpExperience),e(t,11,0,!i.iconExists||i.isAntpExperience),e(t,16,0,i.site.time)}),(function(e,t){var i=t.component;e(t,1,0,n.Fb(1,"",i.site.url,""),i.descriptiveAriaLabel,n.Nb(t,4).target),e(t,14,0,i.site.title)}))}class Ft{constructor(e,t,i,r,s,o){this.eventService=e,this.documentService=t,this.instrumentationService=i,this.shellHeight=r,this.windowService=s,this.element=o,this.elementInViewport=new n.n,this.viewed=!1}ngOnInit(){const e=new Set(["contentScrolled","contentHeightChanged","windowResized"]),t=()=>{this.startListener&&(this.startListener.unsubscribe(),this.startListener=null),this.checkAndInstrumentView()||(this.actionListener=this.eventService.events.withScope(1).pipe(Object(Q.a)(t=>e.has(t.name))).subscribe(()=>this.checkAndInstrumentView()))};this.startEvent?this.startListener=this.eventService.events.withScope(1).pipe(Object(Q.a)(e=>e.name===this.startEvent)).subscribe(t):t()}ngOnDestroy(){this.startListener&&this.startListener.unsubscribe(),this.actionListener&&this.actionListener.unsubscribe()}checkAndInstrumentView(){if(this.viewed)return!1;const e=this.windowService.nativeWindow.innerHeight,t=this.element.nativeElement,i=t.getBoundingClientRect(),n=this.documentService.getOffset(t).top;if(n+i.height>this.shellHeight&&n<e){this.viewed=!0,this.actionListener&&this.actionListener.unsubscribe();const e=this.data?this.data.params:{};return e.ElementId=e.ElementId||t.id,this.instrumentationService.logGenericEvent(this.data&&this.data.eventName||e.EventName||"Element_In_Viewport",e,this.data?this.data.metrics:[]),this.elementInViewport.emit(),!0}return!1}}var Lt=i("vW6f"),Ot=i("hjJp"),Rt=i("345u"),_t=i("wHld");class Ut{constructor(e){this.eventService=e,this.initiallyExpanding=!0}onAnimationEnd(e){this.handleEvent(e)}onWebkitAnimationEnd(e){this.handleEvent(e)}onOAnimationEnd(e){this.handleEvent(e)}ngOnInit(){this.initiallyExpanding?this.expanding=!0:this.finishLoading()}handleEvent(e){"section-expand"===e.animationName&&this.finishLoading()}finishLoading(){this.expanding=!1,this.endEvent&&this.eventService.broadcastEvent({name:this.endEvent,args:[]})}}var Nt=i("WKA6"),Wt=i("rmEM"),Bt=i("CC5A"),Ht=i("p6Zr"),qt=i("Eu1D");let Vt=(()=>{class e{constructor(t,i,n,r,s,o,a,l){this.id=t,this.type=i,this.acronym=n,this.bannerImageUrl=r,this.bannerColor=s,this.time=o,this.url=a,this.title=l,this.isGroup=e.groupReference===this.type}static distributionFromSiteTypes(e){return e?e.reduce((e,t,i)=>e+(0===i?"":";")+t,""):""}static distributionFromSiteItems(t){return t?e.distributionFromSiteTypes(t.map(e=>e.type)):""}getId(){return this.id}getClickData(e,t){const i={};return i.ElementId=`${t}_${e}`,i.ItemId=this.id,i.Index=e.toString(),i.ItemCategory=this.type,i.Referral=Ht.a.SharePoint,i.Area=w.b.Sites,i.ListId=t,{eventName:"SharePoint_Site_Click",params:i,metrics:[]}}}return e.groupReference="GroupReference",e})(),$t=(()=>{class e{constructor(e,t,i,r,s,o,a,l,c,u){this.capabilitiesService=e,this.eventService=t,this.instrumentationService=i,this.locService=r,this.performanceService=s,this.sharepointConfigService=o,this.sharepointSitesService=a,this.globalErrorHandler=l,this.browserPaintMeasurementService=c,this.themingService=u,this.animationEndEvent="sharePointReady",this.config=this.sharepointConfigService.config,this.stateChanged=new n.n}ngOnInit(){const e=this.capabilitiesService.capabilities,t=this.config.resources;this.emitState(qt.a.Loading),this.isAntpExperience=e.antpLoaded,this.hasIntersectedViewport=this.isAntpExperience,this.bottomTrayEnabled=e.bottomTrayEnabled,this.sectionTitle=t.sharePointSectionTitleShort,this.tabListModel=new Bt.b({id:"sites",area:w.b.Sites,tabs:[],logImpression:(e,t,i,n,r,s)=>this.logImpression(e,t,i,r),tabClass:"tab-display--places",headerText:this.sectionTitle,tabActivationAriaLabel:this.locService.SharePointTabActivationAriaLabel}),this.selectedTab=0;const i=()=>this.eventService.broadcastEvent({name:"sharePointReady",args:[]}),n=this.sharepointSitesService.getSharePointSites(),r=n.results;this.recentSitesStream=r.subscribe(e=>this.processRecentSitesTask(e)),n.initialCompletion.then(t=>{t&&(this.globalErrorHandler.handleCacheObservableError(t,"XdAOZ","obOVw"),this.loadState===qt.a.Loading&&(this.emitState(qt.a.Failed),e.antpLoaded&&(i(),t.cacheError&&t.networkError&&this.eventService.broadcastEvent({name:"sharePointFailed",args:[]}))))}),e.antpLoaded&&(r?r.pipe(Object(Nt.a)(1)).toPromise().then(i):i()),e.darkModeEnabled&&e.reactShellEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe(e=>{this.darkMode=e,this.updateSharepointEmptyState()}))}ngOnDestroy(){this.recentSitesStream&&this.recentSitesStream.unsubscribe(),this.themeShadesSubscription&&this.themeShadesSubscription.unsubscribe()}onTabClicked(e){this.selectedTab=e}onIntersectionChange(e){e&&!this.isAntpExperience&&(this.hasIntersectedViewport=!0)}updateSharepointEmptyState(){this.frequentTab&&(this.frequentTab.zeroExperienceImage=this.darkMode?"emptystate-icons-sprite-darkmode emptystate-sites-darkmode":"emptystate-icons-sprite emptystate-sharepoint",this.tabListModel.updateOrAddTab(this.frequentTab))}processRecentSitesTask(e){if(!(e&&e.FrequentSites&&e.FollowingSites||this.loadState!==qt.a.Loading))return this.emitState(qt.a.Failed),void this.eventService.broadcastEvent({name:"sharePointFailed",args:[]});let t;this.processSharePointData(e),this.performanceService.mark(e.fromCache?"Cached_SharePoint_Ready":"SharePoint_Ready"),this.browserPaintMeasurementService.recordWhenPainted("SharePoint"),t=e.FrequentSites&&0!==e.FrequentSites.length?Math.max(e.FrequentSites.length,e.FollowingSites?e.FollowingSites.length:0):0,this.emitState(qt.a.Displayed,t)}processSharePointData(t){const i=this.createListModel(e.frequentListId,t.FrequentSites?t.FrequentSites.map(this.processSharePointSite):[],t.fromCache),n=this.createListModel(e.followingListId,t.FollowingSites?t.FollowingSites.map(this.processSharePointSite):[],t.fromCache),r=this.config.showFollowingFirst,s=this.config.resources,o=this.createAttribution(),a={id:e.followingListId,title:s.sharePointFollowingSectionTitleLowercase,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,s.sharePointFollowingSectionTitleLowercase),listModel:n,zeroExperienceTitle:s.sharePointZeroFollowingExperienceTitle,zeroExperienceSubtitle:s.sharePointZeroFollowingExperienceSubtitle,showZeroExperience:!0,errorTitle:null,attribution:o,loaded:!0,fromCache:t.fromCache};let l;this.frequentTab={id:e.frequentListId,title:s.sharePointFrequentSitesSectionTitle,ariaLabel:this.locService.format(this.locService.DocumentTabAriaLabelFormat,s.sharePointFrequentSitesSectionTitle),listModel:i,zeroExperienceTitle:this.locService.FluentNoSharepointTitle,zeroExperienceSubtitle:this.locService.FluentNoSharepointSubtitle,zeroExperienceImage:this.darkMode?"emptystate-icons-sprite-darkmode emptystate-sites-darkmode":"emptystate-icons-sprite emptystate-sharepoint",showZeroExperience:!0,errorTitle:null,attribution:o,loaded:!0,fromCache:t.fromCache},l=a.listModel.items.length>0?r?[a,this.frequentTab]:[this.frequentTab,a]:[this.frequentTab],l.forEach(e=>this.tabListModel.updateOrAddTab(e))}processSharePointSite(e){const t=e.Time?new Date(e.Time):null;return new Vt(e.ItemReference.IndexId,e.ItemReference.Type,e.Acronym,e.BannerImageUrl,e.BannerColor,t,e.Url,e.Title)}logImpression(e,t,i,n){const r=e.slice(0,i),s=Vt.distributionFromSiteItems(r),o={};o.RenderSize=i.toString(),o.Distribution=s,o.ElementId=t,o.TotalSize=e.length.toString(),o.FromServiceWorkerCache=(!!n).toString(),this.instrumentationService.logImpressionEvent("SharePoint_Sites_Impression",o)}createListModel(e,t,i){return new Wt.a(t,this.config.resources.showMoreSharePointSitesAriaLabel,this.config.resources.showLessSharePointSitesAriaLabel,null,null,this.config.maxInitialSharePointSites,this.config.maxTotalSharePointSites,n=>this.logImpression(t,e,n,i),!0,!0,this.capabilitiesService.capabilities.disableAnimation?"None":"Slide")}createAttribution(){return{title:this.config.resources.goToSharePoint,url:this.config.sharePointUrl,ariaLabel:this.config.resources.openSharePointAriaLabel,referral:Ht.a.SharePoint,leftAligned:!this.isAntpExperience}}emitState(e,t){this.loadState=e,this.stateChanged.emit({state:e,numItems:t})}}return e.frequentListId="frequent-sharepoint",e.followingListId="following-sharepoint",e})();var zt=i("jV/k"),jt=i("pOWU"),Gt=i("oAX+");let Qt=(()=>{class e extends jt.a{constructor(t,i,n,r,s,o,a,l,c,u,h,d,m,p){super(t,r,s,"MruPlusPlus",n,o,l,d),this.clientStartupConfigService=i,this.globalErrorHandler=c,this.updateContentService=h,this.windowService=m,this.capabilitiesService=p,this.requestIndex=0;const f=u.config;if(!(this.inMockMode||f&&f.sharePointServiceRoot))return;const g=n.sharedContext,b=g.officeMarketLcid;this.sitesUrl=this.inMockMode?`${g.officeHomeApiRoot}/${e.sharepointPath}`:`${f.sharePointServiceRoot}/${e.sharepointPath}?lcid=${b}&uilcid=${b}&syslcid=${b}&lists=frequent,followed&items=${f.maxTotalSharePointSites}`,!this.inMockMode&&f.forceSharePointRefresh&&(this.sitesUrl+=e.forceRefreshParam),a.subscribeToRouteChangeStart(e=>{!e.currentRoute||"OfficeHome"!==e.currentRoute.route&&"Pwa"!==e.currentRoute.route||this.getSharePointSites()})}getSharePointSites(){if(this.sharepointDataStream)return this.sharepointDataStream;if(this.sitesUrl){const e=this.sitesFetch("cache-only"),t=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchSitesData():this.sitesFetch("network-first"),i=this.updateContentService.getOrAddUpdateStream("sharepointsites",()=>this.sitesFetch("network-first"));this.sharepointDataStream=Gt.a.createResultsWithCacheObservable(e,t,i,e=>this.sharepointDataStream=null)}else this.sharepointDataStream={results:Object(zt.a)(null),initialCompletion:Promise.resolve(null)};return this.sharepointDataStream}handleQueryParam(e,t,i){"mocksharepoint"===e&&this.mockRequestHeader&&i.headers.set(this.mockRequestHeader,t)}sitesFetch(t){return new Promise((i,n)=>{this.get("SharePoint_Sites_Request",this.sitesUrl,t=>{t.instrument((t,i)=>{if(i.params.RequestId=t.headers&&t.headers.get("X-CorrelationId"),i.params.PartnerGeo=t.headers&&t.headers.get("X-OfficeCluster"),i.params.Index=(this.requestIndex++).toString(),i.params.SharePointSiteLists=t.ok&&t.data?t.data.Sites&&t.data.Sites.length?t.data.Sites.map(e=>e?`${e.Title||"NULLTITLE"}:${e.Sites?"SOME":"NULLSITES"}`:"NULLLIST").join(","):"NONE":"ERROR",t.ok&&t.data.Sites&&2===t.data.Sites.length&&t.data.Sites[0]&&t.data.Sites[1]){const n=t.data.Sites[e.frequentIndex].Sites,r=t.data.Sites[e.followingIndex].Sites;if(n&&r){const e=(n?n.length:0)+(r?r.length:0),s=n.filter(e=>r.filter(t=>t.ItemReference.SiteId===e.ItemReference.SiteId).length>0),o=t.data.Sites.map(e=>e.Sites.map(e=>e.ItemReference.Type)).reduce((e,t)=>e.concat(t),[]);i.params.ActualSize=e.toString(),i.params.SharePointFrequentSitesCount=n.length.toString(),i.params.SharePointFollowingSitesCount=r.length.toString(),i.params.SharePointFollowingAndFrequentCount=s.length.toString(),i.params.Distribution=Vt.distributionFromSiteTypes(o)}}else t.data&&t.data.Error&&(i.params.Error=JSON.stringify(t.data.Error))}).then(({data:e,fromCache:t})=>i(this.convertRawData(e,t))).catch(e=>{this.globalErrorHandler.handleError(e,"ZvxNn")})},n,this.getNewRequestConfig(),t)})}prefetchSitesData(){return this.windowService.nativeWindow.prefetchSharepointSitesDataPromise?new Promise(e=>{this.windowService.nativeWindow.prefetchSharepointSitesDataPromise.then(t=>{e(this.convertRawData(t,!1))}).catch(e=>{this.globalErrorHandler.handleError(e,"ZvxNn")})}):this.sitesFetch("network-first")}convertRawData(t,i=!1){let n=[],r=[];return t.Sites&&(n=t.Sites[e.frequentIndex].Sites,r=t.Sites[e.followingIndex].Sites),{Title:t.Title,User:t.User,TenantThumbnails:t.TenantThumbnails,DefaultSitesThumbnails:t.DefaultSitesThumbnails,SitesThumbnailBackgroundColor:t.SitesThumbnailBackgroundColor,ExpiresInMinutes:t.ExpiresInMinutes,FrequentSites:n,FollowingSites:r,Analytics:t.Analytics,fromCache:i}}getNewRequestConfig(){return{headers:this.requestHeaders(T.a.createGuid())}}requestHeaders(e){return new Map([["Accept","application/json"],["X-CorrelationId",e],["X-Office-Platform","Web"],["X-Office-Application",this.contextService.sharedContext.iceApplicationId.toString()],["X-Office-Version",this.clientStartupConfigService.config.sharedClientStartupContext.buildId]])}}return e.forceRefreshParam="&forcerefresh=1",e.sharepointPath="sites",e.frequentIndex=0,e.followingIndex=1,e.ɵprov=n.bc({factory:function(){return new e(n.cc(me.a),n.cc(u.b),n.cc(k.a),n.cc(w.a),n.cc(je.a),n.cc(m.a),n.cc(B.a),n.cc(le.q),n.cc(h.b),n.cc(Et),n.cc(Ge.a),n.cc(Qe.a),n.cc(c.b),n.cc(C.a))},token:e,providedIn:"root"}),e})();var Kt=n.wb({encapsulation:2,styles:[],data:{}});function Zt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["class","section-header section-title--small"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"h2",[["class","heading2 ms-fcl-nd"]],null,null,null,null,null)),(e()(),n.Xb(2,null,["",""]))],null,(function(e,t){e(t,2,0,t.component.sectionTitle)}))}function Jt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,1,"ohp-sharepoint-site",[],null,null,null,Mt,At)),n.xb(2,770048,null,0,kt,[C.a,W.a,ve.a,Te.a,Et,c.b,n.h],{site:[0,"site"],index:[1,"index"],listId:[2,"listId"],focusOnLoad:[3,"focusOnLoad"]},null)],(function(e,t){e(t,2,0,t.context.item,t.context.index,t.context.listId,t.context.focusOnLoad)}),null)}function Xt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,8,"div",[["id","sharepoint-content"],["ohpInstrumentElementInViewport",""]],null,null,null,null,null)),n.xb(1,212992,null,0,Ft,[W.a,f.a,w.a,Lt.a,c.b,n.l],{data:[0,"data"],startEvent:[1,"startEvent"]},null),(e()(),n.hb(16777216,null,null,1,null,Zt)),n.xb(3,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(4,0,null,null,4,"ohp-tab-list",[],null,[[null,"tabClicked"]],(function(e,t,i){var n=!0;return"tabClicked"===t&&(n=!1!==e.component.onTabClicked(i)&&n),n}),Ot.b,Ot.a)),n.xb(5,4308992,null,1,Rt.b,[D.b,w.a,ve.a,M.a,C.a,n.h,u.b,h.b],{model:[0,"model"],columnsEnabled:[1,"columnsEnabled"],leftAlignedZeroExperience:[2,"leftAlignedZeroExperience"],restrictHeight:[3,"restrictHeight"],numItems:[4,"numItems"],smallTitles:[5,"smallTitles"]},{tabClicked:"tabClicked"}),n.Tb(603979776,1,{tabListItems:1}),(e()(),n.hb(0,null,null,1,null,Jt)),n.xb(8,16384,[[1,4]],0,Rt.c,[n.L],null,null)],(function(e,t){var i=t.component;e(t,1,0,"",i.animationEndEvent),e(t,3,0,!i.isAntpExperience),e(t,5,0,i.tabListModel,!0,!i.isAntpExperience,!i.fullWidth,i.numItems,!0)}),null)}function Yt(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,0,"div",[["class","places-placeholder"]],null,null,null,null,null))],null,null)}function ei(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,8,"div",[["class","sharepoint-section section--fluent"],["inViewport",""],["role","region"]],[[1,"aria-label",0],[2,"section--expanding",null]],[[null,"inViewportAction"],[null,"animationend"],[null,"webkitAnimationEnd"],[null,"oanimationend"]],(function(e,t,i){var r=!0,s=e.component;return"animationend"===t&&(r=!1!==n.Nb(e,4).onAnimationEnd(i)&&r),"webkitAnimationEnd"===t&&(r=!1!==n.Nb(e,4).onWebkitAnimationEnd(i)&&r),"oanimationend"===t&&(r=!1!==n.Nb(e,4).onOAnimationEnd(i)&&r),"inViewportAction"===t&&(r=!1!==s.onIntersectionChange(i.visible)&&r),r}),null,null)),n.xb(1,4341760,null,0,_t.a,[n.B,n.l,_t.c],{options:[0,"options"]},{inViewportAction:"inViewportAction"}),n.Ob(2,1),n.Qb(3,{threshold:0}),n.xb(4,81920,null,0,Ut,[W.a],{endEvent:[0,"endEvent"],initiallyExpanding:[1,"initiallyExpanding"]},null),(e()(),n.hb(16777216,null,null,1,null,Xt)),n.xb(6,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,Yt)),n.xb(8,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,3,0,e(t,2,0,0));e(t,1,0,n),e(t,4,0,i.animationEndEvent,!i.bottomTrayEnabled),e(t,6,0,i.hasIntersectedViewport),e(t,8,0,!i.hasIntersectedViewport)}),(function(e,t){e(t,0,0,t.component.sectionTitle,n.Nb(t,4).expanding)}))}function ti(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"div",[["class","sharepoint-component"]],null,null,null,null,null)),(e()(),n.hb(16777216,null,null,1,null,ei)),n.xb(2,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,2,0,null==i.tabListModel||null==i.tabListModel.tabs?null:i.tabListModel.tabs.length)}),null)}let ii=(()=>{class e{constructor(e,t){this.windowService=e,this.serviceWorkerApiAvailable=t}sendTransactionalMessage(e,t){return Object(r.b)(this,void 0,void 0,(function*(){if(this.serviceWorkerApiAvailable&&"undefined"!=typeof MessageChannel)return(t=t||(yield this.getServiceWorker()))?new Promise(i=>{const n=new MessageChannel;n.port1.onmessage=e=>{i(e),n.port1.close(),n.port2.close()},t.postMessage(e,[n.port2])}):void 0}))}sendUnidirectionMessage(e,t){return Object(r.b)(this,void 0,void 0,(function*(){this.serviceWorkerApiAvailable&&(t=t||(yield this.getServiceWorker()))&&t.postMessage(e)}))}getServiceWorker(){return Object(r.b)(this,void 0,void 0,(function*(){try{const e=this.windowService.nativeWindow.navigator.serviceWorker;return(yield e.ready).active}catch(e){return null}}))}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(c.b),n.cc(l.a))},token:e,providedIn:"root"}),e})();var ni=i("CAen");let ri=(()=>{class e{constructor(e,t,i,n,r,s){this.documentService=e,this.browserPaintService=t,this.instrumentationService=i,this.domSnapshotService=n,this.serviceWorkerMessageService=r,this.eventReplayer=s,this.callbacks=new Map}onInteractiveTreeVisibilityChange(e,t){this.callbacks.set(e,t);const i=!this.isViewCacheInDOM(e);this.notifyInteractiveDisplay(e,i)}swapAndUpdateCache(e,t,i,n=5e3){return Object(r.b)(this,void 0,void 0,(function*(){try{yield function(e,t){const i=new Promise((t,i)=>{setTimeout(()=>i(new Error("Timeout")),e)});return Promise.race([i,t])}(n,e)}catch(e){this.logViewCacheSwapTimeout()}finally{yield this.removeViewCache(i),yield this.domSnapshotService.takeSnapshot(t,i),this.eventReplayer&&this.eventReplayer.replayAll()}}))}removeViewCache(e){return Object(r.b)(this,void 0,void 0,(function*(){if(this.isViewCacheInDOM(e))return new Promise(t=>{this.browserPaintService.runBeforeLayout(()=>{this.getViewCache(e).remove(),this.notifyInteractiveDisplay(e,!0),t()})})}))}isViewCacheInDOM(e){const t=this.getViewCache(e);return t&&t.childElementCount>0}clearListeners(){this.callbacks.clear()}deleteViewCache(e){return Object(r.b)(this,void 0,void 0,(function*(){yield this.serviceWorkerMessageService.sendUnidirectionMessage({type:"view-cache",meta:"delete-cache",payload:{elementId:e}})}))}getViewCache(e){return this.documentService.nativeDocument.getElementById(e)}logViewCacheSwapTimeout(){this.instrumentationService.logErrorEvent("View_Cache_Swap_Timeout")}notifyInteractiveDisplay(e,t){const i=this.callbacks.get(e);i&&i(t)}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(f.a),n.cc(Z.a),n.cc(w.a),n.cc(Y),n.cc(ii),n.cc(ni.a,8))},token:e,providedIn:"root"}),e})(),si=(()=>{class e{constructor(e){this.config=e.parse("navBarData")||{LegalLink:null,PrivacyLink:null,TenantLogoUrl:null}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(te.a))},token:e,providedIn:"root"}),e})();var oi=n.wb({encapsulation:2,styles:[],data:{}});function ai(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,8,"div",[["id","footer"]],null,null,null,null,null)),(e()(),n.yb(1,0,null,null,7,"span",[["class","links__footer ms-fcl-ns"]],null,null,null,null,null)),(e()(),n.yb(2,0,null,null,2,"a",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[8,"title",0],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),n.xb(3,81920,null,0,oe.a,[k.a],null,null),(e()(),n.Xb(4,null,["",""])),(e()(),n.Xb(-1,null,[" | "])),(e()(),n.yb(6,0,null,null,2,"a",[["class","ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a ms-fcl-ns"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[8,"title",0],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),n.xb(7,81920,null,0,oe.a,[k.a],null,null),(e()(),n.Xb(8,null,["",""]))],(function(e,t){e(t,3,0),e(t,7,0)}),(function(e,t){var i=t.component;e(t,2,0,i.legalLink.Url,i.legalLink.Title,i.legalLink.Title,n.Nb(t,3).target),e(t,4,0,i.legalLink.Text),e(t,6,0,i.privacyLink.Url,i.privacyLink.Title,i.privacyLink.Title,n.Nb(t,7).target),e(t,8,0,i.privacyLink.Text)}))}function li(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,16,"div",[["class","ohpAppTheme"],["id","officeHomeRoot"],["ohpInstrumentPageView","AntpHome_PageView"]],null,null,null,null,null)),n.xb(1,81920,null,0,ae.a,[D.b,w.a],{pageName:[0,"pageName"]},null),(e()(),n.yb(2,0,null,null,12,"div",[["class","ms-bgc-nla"]],null,null,null,null,null)),(e()(),n.yb(3,0,null,null,11,"div",[["class","width-restrictor width-restrictor--responsive--antp antp"],["id","officeHomeAntp"]],null,null,null,null,null)),n.xb(4,278528,null,0,le.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(5,{"antp-content--show":0,"antp-content--hide":1}),(e()(),n.yb(6,0,null,null,2,"ohp-recommended",[],null,null,null,bt,ct)),n.Sb(4608,null,Le.g,Ve,[W.a]),n.xb(8,8634368,null,0,$e.a,[C.a,n.h,Je,k.a,it,h.b,y.b,nt.a,rt.a,st.a,Se.a,D.b,ve.a,f.a,w.a,ot.a,W.a,M.a,lt,F,Ce.a,u.b,K.a,c.b],null,null),(e()(),n.yb(9,16777216,null,null,1,null,null,null,null,null,null,null)),n.xb(10,475136,null,0,vt.a,[St.a,n.O,h.b,u.b,Qe.a,yt.a,Z.a,n.z,wt.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),n.yb(11,0,null,null,1,"ohp-sharepoint-component",[],null,null,null,ti,Kt)),n.xb(12,245760,null,0,$t,[C.a,W.a,w.a,ve.a,y.b,Et,Qt,h.b,rt.a,K.a],null,null),(e()(),n.hb(16777216,null,null,1,null,ai)),n.xb(14,16384,null,0,le.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.yb(15,16777216,null,null,1,null,null,null,null,null,null,null)),n.xb(16,475136,null,0,vt.a,[St.a,n.O,h.b,u.b,Qe.a,yt.a,Z.a,n.z,wt.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){var i=t.component;e(t,1,0,"AntpHome_PageView");var n=e(t,5,0,i.displayAngularBootstrap,!i.displayAngularBootstrap);e(t,4,0,"width-restrictor width-restrictor--responsive--antp antp",n),e(t,8,0),e(t,10,0,"mru#MruModule"),e(t,12,0),e(t,14,0,i.legalLink&&i.privacyLink),e(t,16,0,"context-menu#ContextMenuModule")}),null)}function ci(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,1,"ohp-antp-root",[],null,null,null,li,oi)),n.xb(1,114688,null,0,re,[n.l,W.a,n.r,ri,u.b,si,x.a],null,null)],(function(e,t){e(t,1,0)}),null)}var ui=n.ub("ohp-antp-root",re,ci,{},{},[]);const hi=new n.q("INSTRUMENTATION_QUEUE");class di extends ot.a{get securityLevel(){return 3}}var mi=i("3GGT");class pi extends me.a{constructor(e,t,i,n,r,s){super(),this.clientStartupConfigService=e,this.contextService=i,this.instrumentationService=n,this.windowService=r,this.antpConfigService=s,this.init(t,"JWT","WAM"),this.resourceMap=this.antpConfigService.config.resourceUrlMap?new Map(Object.entries(this.antpConfigService.config.resourceUrlMap)):new Map}hasPermanentAuthError(){throw new Error("Method not implemented.")}hasOneDriveToken(){return!0}hasCAPError(e,t){return!1}getAccessTokenResponse(e,t,i){return this.getAccessTokenPromise(e,i).catch(t=>{throw this.instrumentRequestState(e,mi.a.TokenUnavailable,t),t})}getAccessTokenPromise(e,t){const i=e,n=this.clientStartupConfigService.config.authType===u.a.MSA?"RPSCompact":"JWT";let r;return r=t||this.resourceMap.get(i),r?this.contextService.sharedContext.inMockMode?Promise.resolve({success:!0,token:"mock token",format:n,source:"WAM"}):this.windowService.nativeWindow.getAccessTokenAntp(r,i):Promise.reject("Invalid resource")}instrumentRequestState(e,t,i){const n={ResourceUrl:e,Error:i?new w.d(JSON.stringify(i)):""};this.instrumentationService.logRequestEvent("WAM_Token_Request",t,-1,"",!1,n)}}var fi=i("ZJrL");class gi{constructor(e,t){this.apiConfigurationDataService=e,this.globalErrorHandler=t,this.configMap=new Map(Object.entries(this.apiConfigurationDataService.shellAndConfigData))}parse(e,t=!1){try{if(this.configMap.has(e)){if(t){const t=fi.a.decodeJsonString(this.configMap.get(e));return JSON.parse(t)}return JSON.parse(this.configMap.get(e))}}catch(t){const i=new h.a(`Failure to parse ${e} from ShellConfig response`,t);this.globalErrorHandler.handleError(i)}}}let bi=(()=>{class e{constructor(e){this.windowService=e,this.initialize()}getShellAndConfigPromise(){return window.queuedMarks=window.queuedMarks||[],window.performance&&window.performance.mark&&window.performance.mark("App_Initialization_Complete"),window.queuedMarks.push({markName:"App_Initialization_Complete",measureFrom:"App_Begin_Bootstrap"}),this.shellAndConfigResponse}reset(){this.setShellAndConfigPromise()}initialize(){this.initialized||(this.initialized=!0,this.setShellAndConfigPromise())}fetchShellAndConfig(){return Object(r.b)(this,void 0,void 0,(function*(){const e=yield this.windowService.nativeWindow.shellAndConfigResponse;if(e)try{this.shellAndConfigData=JSON.parse(e)}catch(t){this.shellAndConfigData=e}}))}setShellAndConfigPromise(){this.shellAndConfigResponse=this.fetchShellAndConfig()}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(c.b))},token:e,providedIn:"root"}),e})(),vi=(()=>{class e{constructor(e){this.config=e.parse("authStateConfig")||{authTicketExpiryIntervalInMinutes:0,checkAuthStateEnabled:!1,checkAuthStateEndpoint:null,checkAuthStateIntervalInSeconds:0,reauthenticationForAccessTokenPermanentErrorIntervalInMinutes:0}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(te.a))},token:e,providedIn:"root"}),e})();var Si=i("qk26"),yi=function(e){return e[e.SignedIn=0]="SignedIn",e[e.SignedOut=1]="SignedOut",e[e.SignedOutBasedOnActivity=2]="SignedOutBasedOnActivity",e[e.Expired=3]="Expired",e[e.ReauthenticationRequired=4]="ReauthenticationRequired",e[e.PolicyCheckFailed=5]="PolicyCheckFailed",e}({});let wi=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c){this.contextService=e,this.configService=t,this.officeHomeApiConfigService=i,this.instrumentationService=n,this.instrumentedHttp=r,this.eventService=s,this.pageVisibilityService=o,this.route=a,this.globalErrorHandler=l,this.windowService=c,this.currentState=yi.SignedIn,this.initialized=!1,this.checkAuthStateTimeout=null,this.accessTokenService=null}initialize(e){if(this.initialized)throw new h.a("Not allowed to call AuthStateService.initialize() more than once");this.initialized=!0,this.accessTokenService=e;const t=this.configService.config;if(!t.checkAuthStateEnabled||!t.checkAuthStateEndpoint)return;const i=this.contextService.sharedContext;this.checkAuthStateEndpoint=`${i.officeHomeApiRoot}/${t.checkAuthStateEndpoint}`,this.checkAuthStateRequestOptions={headers:new Map},this.queryParamProcessor=new Promise((e,t)=>{i.inMockMode||e(),this.officeHomeApiConfigService.config.mockRequestHeader||e(),this.route.queryParams.pipe(Object(Q.a)(e=>Object.keys(e).length>0),Object(Nt.a)(1)).toPromise().then(t=>{for(const e in t)e&&t.hasOwnProperty(e)&&"mockchecklogin"===e.toLowerCase()&&this.checkAuthStateRequestOptions.headers.set(this.officeHomeApiConfigService.config.mockRequestHeader,t[e]);e()}).catch(e=>{this.globalErrorHandler.handleError(e,"Jrzf6"),t(e)})}),this.watchAuthTicketExpiry(),this.watchAccessTokenPermanentError(),this.watchPageVisibilityChanges(),this.scheduleCheckAuthState(),this.setupActivityTimeoutSignoutListener()}getCurrentState(){return this.currentState}watchAuthTicketExpiry(){this.configService.config.authTicketExpiryIntervalInMinutes>0&&this.windowService.nativeWindow.setTimeout(()=>{this.currentState===yi.SignedIn&&this.updateCurrentState(yi.Expired)},6e4*this.configService.config.authTicketExpiryIntervalInMinutes)}watchAccessTokenPermanentError(){return Object(r.b)(this,void 0,void 0,(function*(){if(yield this.accessTokenService.hasPermanentAuthError()){const e=this.configService.config.reauthenticationForAccessTokenPermanentErrorIntervalInMinutes;e>0&&this.windowService.nativeWindow.setTimeout(()=>{this.currentState===yi.SignedIn&&this.updateCurrentState(yi.ReauthenticationRequired)},6e4*e)}}))}watchPageVisibilityChanges(){this.windowService.nativeWindow.setTimeout(()=>{this.pageVisibilityService.addOnVisibilityChanged(()=>{this.pageVisibilityService.isVisible()&&this.checkAuthState()})},1e3*this.configService.config.checkAuthStateIntervalInSeconds)}scheduleCheckAuthState(){this.currentState===yi.SignedIn&&!this.checkAuthStateTimeout&&this.configService.config.checkAuthStateIntervalInSeconds>0&&(this.checkAuthStateTimeout=this.windowService.nativeWindow.setTimeout(()=>this.checkAuthState(),1e3*this.configService.config.checkAuthStateIntervalInSeconds))}checkAuthState(){this.checkAuthStateTimeout&&(this.windowService.nativeWindow.clearTimeout(this.checkAuthStateTimeout),this.checkAuthStateTimeout=null),this.queryParamProcessor.then(()=>{if(this.currentState===yi.SignedIn&&this.pageVisibilityService.isVisible())return this.instrumentedHttp.get("Check_Login_Request",this.checkAuthStateEndpoint,this.checkAuthStateRequestOptions,"network-only").then(({data:e})=>{"string"==typeof e&&this.currentState===yi.SignedIn&&this.updateCurrentState(yi[e])})}).catch(e=>{this.globalErrorHandler.handleError(e,"QGMJO")}).then(()=>this.scheduleCheckAuthState())}updateCurrentState(e){if(this.currentState===e)return;this.currentState=e;const t={};t.State=yi[this.currentState],this.instrumentationService.logGenericEvent("Auth_State_Changed",t),this.eventService.broadcastEvent({name:"authStateChanged",args:[this.currentState]})}setupActivityTimeoutSignoutListener(){this.windowService.nativeWindow.addEventListener("message",e=>{if(e&&e.data){let t;try{t=JSON.parse(e.data)}catch(e){}t&&"abtSignOutEventForHost"===t.eventId&&this.updateCurrentState(yi.SignedOutBasedOnActivity)}})}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(k.a),n.cc(vi),n.cc(m.a),n.cc(w.a),n.cc(je.a),n.cc(W.a),n.cc(wt.a),n.cc(Si.a),n.cc(h.b),n.cc(c.b))},token:e,providedIn:"root"}),e})(),Ci=(()=>{class e{constructor(e){this.config=e.parse("userStorageConfig")}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(te.a))},token:e,providedIn:"root"}),e})(),Ii=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c){this.accessTokenService=e,this.contextService=t,this.instrumentationService=i,this.instrumentedHttp=n,this.authStateService=r,this.officeHomeApiConfigService=s,this.userDataStorageConfigService=o,this.globalErrorHandler=l,this.scheduler=c,null!=t.sharedContext.officeHomeApiRoot&&o.config&&null!=o.config.userStorageEndpoint&&(this.serviceUrl=`${t.sharedContext.officeHomeApiRoot}/${o.config.userStorageEndpoint}`);const u=a.parse("userStorageCache")||{firstUse:!1,firstUseTimestamp:0,content:{}};this.firstUse=u.firstUse,this.firstUseTimestamp=u.firstUseTimestamp,this.masterCollection=u.content}get(e,t=1){return new Promise((i,n)=>{if(this.masterCollection.hasOwnProperty(e)){const t=Object.assign({},this.masterCollection[e]);return void i(t)}if(this.firstUse||t<1)return void i(void 0);if(this.authStateService.getCurrentState()!==yi.SignedIn)return void n(`User has to be signed in to access storage for <${e}> key.`);if(!this.serviceUrl)return void n("User storage does not support roaming");let r=0;const s=(o,a)=>{this.instrumentedHttp.get(o,`${this.serviceUrl}/${e}/`,a||{},"network-only").instrument((t,i)=>{i.params.ElementId=e,i.params.Retry=r.toString()}).then(e=>i(e.data)).catch(l=>{this.globalErrorHandler.handleError(l,"Bn3rc"),l&&l.status===mi.a.NotFound?i(void 0):l.status!==mi.a.Forbidden&&r<t-1?(r++,s(o,a)):n(`Failed to get value from user data storage for <${e}> key. Status code: ${l.status}`)})};this.request(s,"OfficeHomeStorage_Read_Request",n)})}set(e,t){return new Promise((i,n)=>{this.authStateService.getCurrentState()===yi.SignedIn?(this.masterCollection[e]=Object.assign({},t),this.serviceUrl?this.request((r,s)=>{if((s=s||{}).headers||(s.headers=new Map),!this.officeHomeApiConfigService.config.jwtAuthEnabled){if(!this.contextService.getCsrfToken())return this.instrumentationService.logErrorEvent("Csrf_Token_Error"),void n("CSRF token missing");s.headers.set("AjaxSessionKey",this.contextService.getCsrfToken())}const o=()=>this.instrumentedHttp.put(r,`${this.serviceUrl}/${e}/`,t,s).instrument((t,i)=>{i.params.ElementId=e}).then(()=>i(null)).catch(t=>{this.globalErrorHandler.handleError(t,"J7GBR"),n(`Failed to update or create value in roaming user data storage for <${e}> key. Status code: ${t.status}`)});this.userDataStorageConfigService.config.deferWrite?this.scheduler.scheduleWork(()=>{o()},4):o()},"OfficeHomeStorage_Write_Request",n):n("User storage does not support roaming")):n(`User has to be signed in to access storage for <${e}> key.`)})}request(e,t,i){this.officeHomeApiConfigService.config.jwtAuthEnabled?this.accessTokenService.getAccessToken("OfficeHome").then(n=>{if(!n.success)return this.instrumentationService.logRequestEvent(t,mi.a.TokenUnavailable,-1,"string"==typeof n.error?n.error:""),void i("Token Unavailable");const r={headers:new Map([["Authorization","Bearer "+n.token]])};e(t,r)}):e(t)}isFirstUse(){return this.firstUse}getFirstUseTimestamp(){return this.firstUseTimestamp}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(me.a),n.cc(k.a),n.cc(w.a),n.cc(je.a),n.cc(wi),n.cc(m.a),n.cc(Ci),n.cc(te.a),n.cc(h.b),n.cc(Qe.a))},token:e,providedIn:"root"}),e})();var Ti=i("Dpxn");function ki(e,t,i){return e.capabilities.useVroomForOneDriveApis?i:t}class Ei{}var Ai=i("Brer"),Pi=i("82rx"),xi=i("P6pJ"),Di=i("s/Ys"),Mi=i("Qo/9");const Fi=new n.q("DISK_PRELOAD_URL_PATTERNS");var Li=i("aQ3G");const Oi=window.diskPreloadRequestMap,Ri=function(e,t,i,n){var r;if(e.sharedContext.inMockMode)return[{pattern:new RegExp("/mock/v2/recent/docs","i"),markerName:"MRU"},{pattern:new RegExp("/mock/docs/recent","i"),markerName:"MRU"},{pattern:new RegExp("/mock/sites","i"),markerName:"SharePointSites"},{pattern:new RegExp("/mock/recommended/api","i"),markerName:"RecommendedDocs"},{pattern:new RegExp("/mock/(.*)/me/drive/root","i"),markerName:"OneDriveRoot"},{pattern:new RegExp("/mock/PeoplePredictionsB2/api","i"),markerName:"OfficeFeedDocs"},{pattern:new RegExp("/mock/PeoplePredictionsB2/MicrosoftFeed","i"),markerName:"OfficeFeedV2Docs"}];const s=[],o=!!(null===(r=null==n?void 0:n.capabilities)||void 0===r?void 0:r.edgeworthEnabled);if(t&&t.config){const{mruServiceRoot:e,substrateApiEndpoint:i,officeFeedApiRootPath:n,recommendedB2ApiFilesPath:r,recommendedB2ApiRootPath:a}=t.config;o||s.push({pattern:new RegExp(`^${e}/v2/recent/docs`,"i"),markerName:"MRU"}),s.push({pattern:new RegExp(`^${i}/${a}/${r}`,"i"),markerName:"RecommendedDocsV1"},{pattern:new RegExp(`^${i}/${n}/(.*)/insights/query\\(context=null,scenario='(.*)',target=null,section='(.*)'\\)`,"i"),markerName:"OfficeFeedDocs"},{pattern:new RegExp(`^${i}/PeoplePredictionsB2/MicrosoftFeed\\?section=(.*)&scenario=(.*)`,"i"),markerName:"OfficeFeedV2Docs"})}if(!o&&(i&&i.config&&s.push({pattern:new RegExp("^"+i.config.sharePointServiceRoot,"i"),markerName:"SharePointSites"}),e&&e.sharedContext)){const{graphBeta:t,graphV1:i}=Li.a;s.push({pattern:new RegExp(`^${e.sharedContext.graphApiRoot}/(${t}|${i})/${st.a.myDriveEndpoint}root$`,"i"),markerName:"OneDriveRoot"})}return s},_i=window.diskPreloadUrlStorageKey,Ui=window.diskPreloadUserIdStorageKey;class Ni{}var Wi=i("nTqU");let Bi;const Hi=function(e,t){if(!Object(le.t)(t))return!1;try{const t=e.nativeWindow,i=t.navigator;if(!("serviceWorker"in i))return!1;const{getRegistration:n,getRegistrations:r}=i.serviceWorker;return!(!n||!r)&&"URL"in t&&URL.prototype.hasOwnProperty("searchParams")}catch(e){return!1}},qi=function(e,t){return t&&e.config.enabled},Vi=function(e){return()=>(Bi||(Bi=function(e){return Object(r.b)(this,void 0,void 0,(function*(){const{tenantId:t,puid:i}=e.config;return`${t}_${i}`}))}(e)),Bi)};class $i{}const zi=new n.q("SERVICE_WORKER_USER_ID_FACTORY");var ji=i("oECA"),Gi=i("Ft/N");class Qi{constructor(e){this.serviceWorkerEnabled=e}intercept(e,t){return this.serviceWorkerEnabled&&"cache-only"===e.headers.get(Gi.a)?t.handle(e).pipe(Object(ji.a)(e=>{if(!(e instanceof Wi.f))throw e;if(e.status!==mi.a.Unknown)throw e;throw new Wi.f({error:e.error,headers:e.headers,status:mi.a.CacheMiss,statusText:mi.a[mi.a.CacheMiss],url:e.url})})):t.handle(e)}}var Ki=i("HbWZ"),Zi=i("e6ST"),Ji=i("XA6Z");class Xi{constructor(e,t,i,n){this.serviceWorkerEnabled=e,this.serviceWorkerUserIdFactory=t,this.serviceWorkerStateService=i,this.globalErrorHandler=n}intercept(e,t){if(!this.serviceWorkerEnabled)return t.handle(e);if("Controlled"!==this.serviceWorkerStateService.currentState)return t.handle(e);const i=e.headers.get(Gi.a);if(!i)return t.handle(e);if("network-only"===i)return t.handle(e.clone({headers:e.headers.delete(Gi.a)}));if(e.reportProgress){const t="Cannot report progress for non-NetworkOnly requests";throw new Wi.f({error:t,statusText:t,status:mi.a.NotImplemented,url:e.urlWithParams})}return Object(Ki.a)(this.serviceWorkerUserIdFactory()).pipe(Object(Be.a)(t=>e.clone({headers:e.headers.append("X-SW-OHP-UserCacheId",t)})),Object(ji.a)(t=>(this.globalErrorHandler.handleError(t,"j9XG4"),"cache-only"===i?Object(Zi.a)(new Wi.f({error:"Could not send CacheOnly request without a service worker user cache ID",status:mi.a.Cancelled,statusText:"CacheOnly request cancelled"})):Object(zt.a)(e.clone({headers:e.headers.delete(Gi.a)})))),Object(Ji.a)(e=>t.handle(e)))}}var Yi=i("vfyW");class en{constructor(e){this.diskPreloadService=e}intercept(e,t){return"cache-only"===e.headers.get(Gi.a)?Object(Ki.a)(this.diskPreloadService.loadPreloadResponse(e.urlWithParams)).pipe(Object(Ji.a)(i=>i?i.ok?Object(Ki.a)(this.convertToAngularHttpResponse(i,e.responseType)):Object(Zi.a)(this.convertToAngularHttpErrorResponse(i)):t.handle(e))):t.handle(e).pipe(Object(Yi.a)(t=>{t instanceof Wi.l&&t.ok&&this.diskPreloadService.tryAddToPreloadList(e.urlWithParams)}))}convertToAngularHttpResponse(e,t){return Object(r.b)(this,void 0,void 0,(function*(){let i;switch(t){case"json":i=yield e.json();break;case"text":i=yield e.text();break;case"arraybuffer":i=yield e.arrayBuffer();break;case"blob":i=yield e.blob()}return new Wi.l({body:i,headers:this.convertToAngularHeaders(e.headers),status:e.status,statusText:e.statusText,url:e.url})}))}convertToAngularHttpErrorResponse(e){return new Wi.f({error:e.statusText,status:e.status,statusText:e.statusText,headers:this.convertToAngularHeaders(e.headers),url:e.url})}convertToAngularHeaders(e){let t=new Wi.i;return e.forEach((e,i)=>{t=t.append(i,e)}),t}}const tn=new n.q("DISK_PRELOAD_USER_ID_STORAGE_KEY"),nn=new n.q("DISK_PRELOAD_STORAGE_KEY"),rn=new n.q("DISK_PRELOAD_REQUEST_MAP");let sn=(()=>{class e{constructor(e,t,i,n,r,s,o,a){this.localStorageService=e,this.userIdStorageKey=t,this.urlPatternStorageKey=i,this.urlPatternEntries=n,this.serviceWorkerUserIdFactory=r,this.diskPreloadRequestMap=s,this.serviceWorkerEnabled=o,this.serviceWorkerConfigService=a,this.diskPreloadEnabled=!0,this.diskPreloadStorageEntries=[],this.initialized=this.init()}tryAddToPreloadList(e){return Object(r.b)(this,void 0,void 0,(function*(){if(yield this.initialized,!this.diskPreloadEnabled)return;const t=this.getMarkerName(e);t&&!this.hasUrl(e)&&this.updateStorageEntries([...this.diskPreloadStorageEntries,{url:e,markerName:t}])}))}loadPreloadResponse(e){return Object(r.b)(this,void 0,void 0,(function*(){return yield this.initialized,this.diskPreloadEnabled?this.diskPreloadRequestMap.get(e):null}))}init(){return Object(r.b)(this,void 0,void 0,(function*(){if(this.initialized)throw new Error("`init()` can only be called once.");if(!this.serviceWorkerConfigService.config.diskPreloadEnabled||!this.serviceWorkerEnabled)return void(this.diskPreloadEnabled=!1);const e=this.localStorageService.getGlobal(this.userIdStorageKey),t=yield this.serviceWorkerUserIdFactory();if(e!==t)return this.diskPreloadEnabled=!1,this.localStorageService.setGlobal(this.userIdStorageKey,t),void this.updateStorageEntries([]);const i=this.localStorageService.getGlobal(this.urlPatternStorageKey);i&&this.updateStorageEntries(i.filter(e=>!!this.getMarkerName(e.url)))}))}getMarkerName(e){try{return this.urlPatternEntries.find(t=>t.pattern.test(e)).markerName}catch(e){return}}hasUrl(e){return this.diskPreloadStorageEntries.map(e=>e.url).indexOf(e)>=0}updateStorageEntries(e){this.diskPreloadStorageEntries=e,this.localStorageService.setGlobal(this.urlPatternStorageKey,this.diskPreloadStorageEntries)}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(x.a),n.cc(tn),n.cc(nn),n.cc(Fi),n.cc(zi),n.cc(rn),n.cc(a),n.cc(o.a))},token:e,providedIn:"root"}),e})();class on{}class an{getLicenses(){return null}}class ln{registerRecommendedJumpList(){}registerRecentJumpList(){}getJumpListItemById(){return null}}class cn{launchOfficeApp(e,t,i,n){return Object(r.b)(this,void 0,void 0,(function*(){return Promise.reject()}))}launchOfficeAppWithTemplate(e,t){return Object(r.b)(this,void 0,void 0,(function*(){return Promise.reject()}))}openPathInExplorer(e){return Object(r.b)(this,void 0,void 0,(function*(){return Promise.reject()}))}}class un{}class hn{isEligibleToPin(){return Object(r.b)(this,void 0,void 0,(function*(){return new Promise(e=>e(!1))}))}pinToTaskbar(){return Object(r.b)(this,void 0,void 0,(function*(){return new Promise(e=>e(!1))}))}}let dn=(()=>{class e{constructor(e,t){this.contextService=e,this.windowService=t}openUrl(e,t,i,n,s){return Object(r.b)(this,void 0,void 0,(function*(){return this.windowService.nativeWindow.open(e,i||this.contextService.sharedContext.defaultLinkTarget,"number"==typeof n&&"number"==typeof s?`width=${n},height=${s}`:""),Promise.resolve()}))}supportsProtocol(e){return Promise.reject("Method not implemented.")}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(k.a),n.cc(c.b))},token:e,providedIn:"root"}),e})();var mn=i("hoyd"),pn=i("H90i"),fn=i("ZBli");let gn=(()=>{class e extends mn.a{constructor(e,t,i,n,r,s,o,a,l,c){super(),this.appTilesConfigService=e,this.capabilitiesService=t,this.configParserService=i,this.contextService=n,this.dateService=r,this.globalErrorHandler=s,this.startupConfigService=o,this.userDataStorageService=a,this.scheduler=l,this.shellShimService=c,this.nativeWorkloads=new Array,this.allWorkloads=this.configParserService.parse("workloadsData")||{nonCoreAndSegmentApps:[],coreAndSegmentApps:[],pinnedApps:[]},this.pinnedTilesEnabled=this.appTilesConfigService.config.pinnedTilesEnabled,this.shellPinEnabled=this.capabilitiesService.capabilities.shellPinEnabled,this.allWorkloads.pinnedApps&&this.populateWorkloadFields(this.allWorkloads.pinnedApps),this.allWorkloads.coreAndSegmentApps=this.allWorkloads.coreAndSegmentApps.filter(e=>this.filterLocalOnlyApps(e)),this.usedThirdPartyWorkloads=[],this.thirdPartyWorkloads=[],this.thirdPartyWorkloadsSubject=new at.a([]),this.subscribeToThirdPartyAppUpdates(),this.getWorkloads().then(e=>{this.pinnedTilesEnabled||(this.usedThirdPartyWorkloads=e.filter(e=>e.IsThirdParty),this.cleanUnusedThirdPartyWorkloads())})}getProvisionedWorkloads(){return new Promise((e,t)=>{this.getWorkloads().then(t=>{const i=t.filter(e=>!!e.Url);i.forEach(e=>{e.IsThirdParty||(e.AppId=e.Id.slice(5),e.CollectorId="FirstParty")}),e(i)}).catch(e=>{this.globalErrorHandler.handleError(e,"Dnsgi"),t("Failed to get workloads list")})})}getCoreSegmentAndFrequentApps(){return this.coreSegmentAndOtherAppsPromise||(this.coreSegmentAndOtherAppsPromise=new Promise(e=>{const t=this.allWorkloads,i=this.getFrequentAppsWithAnyClicks(t.nonCoreAndSegmentApps),n=t.coreAndSegmentApps.concat(i);this.populateWorkloadFields(n),this.startupConfigService.config.authType===u.a.MSA?this.getMsaWorkloadsData(n).then(e):e(n)})),this.coreSegmentAndOtherAppsPromise.then(e=>[...e])}getPinnedWorkloads(){return this.allWorkloads.pinnedApps}unpinWorkload(e){return Object(r.b)(this,void 0,void 0,(function*(){if(this.allWorkloads.pinnedApps=this.allWorkloads.pinnedApps.filter(t=>!(t.AppId===e.AppId&&t.CollectorId===e.CollectorId)),this.capabilitiesService.capabilities.reactShellEnabled){const t=yield this.shellShimService.getShellShim();t&&t.Apps.Unpin(e.CollectorId,e.AppId)}}))}getWorkloads(){return this.workloadsPromise||(this.workloadsPromise=new Promise(e=>{let t,i,n;const r=this.allWorkloads;t=r.nonCoreAndSegmentApps,i=r.coreAndSegmentApps,n=i.concat(t),this.populateWorkloadFields(n),this.startupConfigService.config.authType===u.a.MSA?this.getMsaWorkloadsData(n).then(e):e(n)})),this.workloadsPromise.then(e=>[...e])}getWorkloadId(t){return e.fileTypeToIdMap.has(t)?e.fileTypeToIdMap.get(t):""}getReferralType(e){const t=this.dateService.addDays(this.dateService.getCurrentDate(),-45);return e.ClickCount?e.LastOccurrence<t.getTime()?w.c.ResurrectedReferral:e.LastOccurrence>=t.getTime()?w.c.RepeatReferral:w.c.NotDetected:w.c.FirsttimeReferral}getDisplayedApps(e){let t=e;const i=this.appTilesConfigService.config,n=i.coreAppIds&&i.segmentSpecificAppIds?i.coreAppIds.concat(i.segmentSpecificAppIds):i.coreAppIds||i.segmentSpecificAppIds,r=i.promotedAppTileId,s=new Array;if(!i.isPromotedAppTileExpired&&r&&(t=t.filter(e=>e.Id.toLowerCase()!==r.toLowerCase()),s.push(i.promotedAppTileId)),n&&n.length){const e=t.filter(e=>n.indexOf(e.Id)>-1),r=t.filter(e=>n.indexOf(e.Id)<0),o=i.coreAppIds?t.filter(e=>i.coreAppIds.indexOf(e.Id)>-1):[];if(!e.length||!r.length||o.length<3)for(const e of t)s.push(e.Id);else{const t=this.getFrequentAppsWithAnyClicks(r);for(const t of e)s.push(t.Id);if(t.length)for(const e of t)s.push(e.Id)}return s.toString()}}getFrequentAppsWithAnyClicks(e){const t=this.dateService.addDays(this.dateService.getCurrentDate(),-45);return e.filter(e=>e.ClickCount>0&&e.LastOccurrence>=t.getTime())}getThirdPartyWorkloads(){return this.thirdPartyWorkloadsSubject.asObservable()}updateUsedThirdPartyApps(e){if(this.pinnedTilesEnabled)return;const t=this.usedThirdPartyWorkloads.findIndex(t=>t.Id.toLowerCase()===e.Id.toLowerCase()),i=t>=0?this.usedThirdPartyWorkloads[t]:void 0;i?this.areThirdPartyAppsEqual(i,e)||(this.usedThirdPartyWorkloads[t]=e,this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads)):(this.usedThirdPartyWorkloads.push(e),this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads))}populateWorkloadFields(t){t.forEach(t=>{t.getId=()=>t.Id,t.Referral=t.IsThirdParty?t.Id:e.referralFromWorkloadId(t.Id),t.FileType=this.getFileType(t.Id),t.Url=this.getWorkloadCustomUrl(t.FileType,t.Url)})}getAdditionalWorkloads(){return Promise.resolve([])}pinWorkload(e){this.capabilitiesService.capabilities.reactShellEnabled&&this.shellPinEnabled&&this.shellShimService.getShellShim().then(t=>{const i=e.AppId,n=e.CollectorId;t.Apps.IsPinned(n,i)||t.Apps.Pin(n,i)})}getInAppNav(e){const t=this.allWorkloads.coreAndSegmentApps.concat(this.allWorkloads.nonCoreAndSegmentApps).concat(this.allWorkloads.pinnedApps).find(t=>t.Id===e);return!!t&&t.InAppNav}getFileType(t){return e.idToFileTypeMap.has(t)?e.idToFileTypeMap.get(t):Xe.b.Unknown}getMsaWorkloadsData(e){return this.getShellWorkloadsData().then(t=>(this.populateMSAWorkloadFields(e,t),e))}static referralFromWorkloadId(t){return t&&t.length&&0===t.lastIndexOf(e.AppTileElementIdPrefix,e.AppTileElementIdPrefixLength)?t.substring(e.AppTileElementIdPrefixLength):null}filterLocalOnlyApps(e){return!e.IsNativeClientOnlyApp||(this.nativeWorkloads.push(e),!1)}populateMSAWorkloadFields(e,t){e.forEach(e=>{const i=e.Id.toLowerCase();for(let n=0;n<t.length;n++){const r=t[n];if(r.Id.toLowerCase()===i){e.Color=r.BackgroundColor,e.FileType=this.getFileType(e.Id),e.Url&&(e.Url=this.getWorkloadCustomUrl(e.FileType,r.LaunchUrl));break}}})}getWorkloadCustomUrl(e,t){switch(e){case Xe.b.Forms:t=fn.a.appendAndReplaceQueryParams(t,{origin:pn.a,lang:this.contextService.sharedContext.officeMarket},!1,!0)}return t}getShellWorkloadsData(){return new Promise((e,t)=>Object(r.b)(this,void 0,void 0,(function*(){if(this.capabilitiesService.capabilities.reactShellEnabled){const i=yield this.shellShimService.getShellShim();i?i.Apps.OnAppsUpdated(i=>{if(i&&i.Apps){const t=i.Apps.map(e=>({BackgroundColor:e.BackgroundColor,FontIconCss:e.FontIconCss,Id:e.Id,LaunchUrl:e.LaunchFullUrl}));e(t)}else t("Shell shim apps not available.")}):t("Shell shim is not available")}else if("undefined"!=typeof NavBarDataRequest){const i=new NavBarDataRequest;i.Culture=this.contextService.sharedContext.officeMarket;const n="undefined"!=typeof ConsumerShellDataGenerator&&ConsumerShellDataGenerator.GetConsumerData(i);if(n&&n.WorkloadLinks){const t=n.WorkloadLinks.map(e=>({BackgroundColor:e.BackgroundColor,FontIconCss:e.FontIconCss,Id:e.Id,LaunchUrl:e.Url}));e(t)}else t("Legacy shell workloads not available")}else t("Legacy shell was not loaded")})))}subscribeToThirdPartyAppUpdates(){return Object(r.b)(this,void 0,void 0,(function*(){const t=yield this.shellShimService.getShellShim();yield this.shellShimService.afterShellPlusLoaded;const i=new Promise(i=>{let n=0,r=0,s=!1;t.Apps.OnAppsUpdated(o=>{if(o&&o.Apps){let a=o.Apps.filter(e=>"FirstParty"!==e.CollectorId&&!this.thirdPartyWorkloads.find(t=>t.Id===e.Id));this.pinnedTilesEnabled||(a=a.filter(e=>"LineOfBusiness"!==e.CollectorId||this.appTilesConfigService.config.customTiles)),this.capabilitiesService.capabilities.showBusinessApps||(a=a.filter(e=>"Dynamics"!==e.CollectorId)),a.forEach(e=>{const o=e.LaunchFullUrl;this.thirdPartyWorkloads.push({ChangeColorInDarkMode:"Dynamics"===e.CollectorId,Color:e.BackgroundColor,Id:e.Id,AppId:e.Id,CollectorId:e.CollectorId,Title:e.AriaLabel?e.AriaLabel:"",SubText:e.Subtitle,Text:e.Title,IsNativeClientOnlyApp:e.isNativeClientOnlyApp,Url:o?o.trim():"",IconUnicodeCodepointCssClass:"ms-fcl-tp ms-Icon ms-Icon--OfficeAddinsLogo",ThirdPartyIcon:e.IconAnonymousUrl?e.IconAnonymousUrl:null,Referral:e.Id,IsThirdParty:!0,getId:()=>e.Id}),e.IconAnonymousUrl||(++n,this.scheduler.scheduleWork(()=>{t.Apps.GetAuthenticatedAppIcon(e,t=>{if(++r,t){const i=this.thirdPartyWorkloads.findIndex(t=>t.Id.toLowerCase()===e.Id.toLowerCase());this.thirdPartyWorkloads[i]=Object.assign(Object.assign({},this.thirdPartyWorkloads[i]),{ThirdPartyIcon:`data:${t.MimeType};base64,${t.Base64EncodedImage}`}),this.thirdPartyWorkloadsSubject.next(this.thirdPartyWorkloads)}s&&n===r&&i()})},3))}),this.thirdPartyWorkloadsSubject.next(this.thirdPartyWorkloads),s=o.DataSource===e.AppsShimDataSourceAppCollectors||o.DataSource===e.AppsShimDataSourceShellDataComplete,s&&n===r&&i()}})});yield i,this.invalidateThirdPartyAppCache()}))}cleanUnusedThirdPartyWorkloads(){if(0===this.usedThirdPartyWorkloads.length)return;const e=this.dateService.addDays(this.dateService.getCurrentDate(),-45).getTime(),t=this.usedThirdPartyWorkloads.length;this.usedThirdPartyWorkloads=this.usedThirdPartyWorkloads.filter(t=>t.LastOccurrence>=e),t!==this.usedThirdPartyWorkloads.length&&this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads)}areThirdPartyAppsEqual(e,t){return e.Text===t.Text&&e.Url===t.Url&&e.ThirdPartyIcon===t.ThirdPartyIcon&&e.Title===t.Title}invalidateThirdPartyAppCache(){if(0===this.usedThirdPartyWorkloads.length)return;const e=[];let t=!1;this.usedThirdPartyWorkloads.forEach(i=>{const n=this.thirdPartyWorkloads.find(e=>e.Id===i.Id);n?this.areThirdPartyAppsEqual(n,i)||(e.push(n),t=!0):t=!0}),t&&(this.usedThirdPartyWorkloads=e,this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads))}}return e.AppTileElementIdPrefix="Shell",e.AppTileElementIdPrefixLength=e.AppTileElementIdPrefix.length,e.AppsShimDataSourceAppCollectors=3,e.AppsShimDataSourceShellDataComplete=4,e.idToFileTypeMap=new Map([["ShellWordOnline",Xe.b.Word],["ShellExcelOnline",Xe.b.Excel],["ShellPowerPointOnline",Xe.b.PowerPoint],["ShellOneNoteOnline",Xe.b.OneNote],["ShellClassNotebook",Xe.b.OneNoteClassNoteBook],["ShellVisioOnline",Xe.b.Visio],["ShellSway",Xe.b.Sway],["ShellOfficeForms",Xe.b.Forms],["ShellDocuments",Xe.b.OneDrive],["ShellSites",Xe.b.SharePoint]]),e.fileTypeToIdMap=new Map([[Xe.b.Word,"ShellWordOnline"],[Xe.b.Excel,"ShellExcelOnline"],[Xe.b.PowerPoint,"ShellPowerPointOnline"],[Xe.b.OneNote,"ShellOneNoteOnline"],[Xe.b.Visio,"ShellVisioOnline"],[Xe.b.Sway,"ShellSway"],[Xe.b.Forms,"ShellOfficeForms"],[Xe.b.OneDrive,"ShellSway"],[Xe.b.SharePoint,"ShellOfficeForms"]]),e})(),bn=(()=>{class e{constructor(e){this.config=e.parse("appTilesConfig")||{appGalleryPathAndQuery:null,coreAppIds:[],deferThirdPartyIcons:!1,expirePromotedAppTileEnabled:!1,isPromotedAppTileExpired:!1,myAccountUrl:null,promotedAppTileId:null,resources:null,segmentSpecificAppIds:[],sortMobileTiles:!1,topAppIds:[],mobileAppIds:[],customTiles:!1,pinnedTilesEnabled:!1,hoverScalingEnabled:!1}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(te.a))},token:e,providedIn:"root"}),e})();var vn=i("PZOQ");class Sn{constructor(e,t,i){this.errorHandler=e,this.contextService=t,this.serviceWorkerEnabled=i}handleRegistration(e){return Object(r.b)(this,void 0,void 0,(function*(){if(this.serviceWorkerEnabled)try{const t=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,i=()=>{e.addEventListener("updatefound",()=>{this.postAppLoadedMessage(e.installing)})};e.installing?(this.postAppLoadedMessage(e.installing),t&&i()):i()}catch(e){this.errorHandler.handleError(e,"GDHPG")}}))}postAppLoadedMessage(e){e.postMessage({type:"OFFICECOM_LOAD_COMPLETE",meta:"installation-app",payload:{success:!0,unregister:!1}})}}class yn extends class{constructor(e){this.windowService=e}addParamFromWindow(e,t){const i=new URL(this.windowService.nativeWindow.location.href).searchParams.get(t);i&&(e.apiQsParams?e.apiQsParams[t]=i:e.apiQsParams={[t]:i})}}{constructor(e,t,i,n,r,s){super(s),this.accessTokenService=e,this.errorHandler=t,this.contextService=i,this.serviceWorkerEnabled=n,this.serviceWorkerUserIdFactory=r}handleRegistration(e){return Object(r.b)(this,void 0,void 0,(function*(){if(this.serviceWorkerEnabled)try{const t=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,i=()=>{e.addEventListener("updatefound",()=>{this.postAuthorizedInstallMessage(e.installing)})};e.installing?(this.postAuthorizedInstallMessage(e.installing),t&&i()):i()}catch(e){this.errorHandler.handleError(e,"OGBGO")}}))}postAuthorizedInstallMessage(e){return Object(r.b)(this,void 0,void 0,(function*(){const t=yield this.accessTokenService.getAccessToken("OfficeHome");if(!t.success)return;const i={token:t.token,userId:yield this.serviceWorkerUserIdFactory()};this.contextService.sharedContext.inMockMode&&(this.addParamFromWindow(i,"mockauth"),this.addParamFromWindow(i,"envType")),this.addParamFromWindow(i,"flight"),this.addParamFromWindow(i,"locale"),e.postMessage({type:"OFFICECOM_AUTH_WARMUP",meta:"installation-credentials",payload:i})}))}}class wn{constructor(e,t,i,n,r){this.errorHandler=e,this.contextService=t,this.instrumentationService=i,this.serviceWorkerEnabled=n,this.serviceWorkerMessageService=r}handleRegistration(e){if(this.serviceWorkerEnabled)try{const t=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,i=()=>{e.addEventListener("updatefound",()=>{this.subscribeToInstallingServiceWorkerActivationTelemetry(e.installing)})};e.installing?(this.subscribeToInstallingServiceWorkerActivationTelemetry(e.installing),t&&i()):i()}catch(e){this.errorHandler.handleError(e)}}subscribeToInstallingServiceWorkerActivationTelemetry(e){this.serviceWorkerMessageService.sendTransactionalMessage({type:"OFFICECOM_SW_TELEMETRY",meta:"activation"},e).then(e=>{const t=e.data;"OFFICECOM_SW_TELEMETRY"===t.type&&"activation"===t.meta&&this.instrumentationService.logGenericEvent(t.payload.eventName,t.payload.params)})}}var Cn=i("qfyf"),In=i("x+6c"),Tn=i("GAcG");class kn{getOrAddUpdateStream(e,t,i,n,r,s){return Tn.a.create(e=>{e.complete()})}pushUpdate(e){return Promise.resolve()}}class En{constructor(e){this.operationParser=e,this.selector="ohp-recommended ohp-mru-item .document-card .document-card__thumbnail-container--recommended"}handleSnapshot(e){return Object(r.b)(this,void 0,void 0,(function*(){const t=Array.from(e.querySelectorAll(this.selector));for(const i of t)try{const t=this.operationParser.parseOperation(i);if("use-card-placeholder-image"===t.name){for(;i.firstChild;)i.firstChild.remove();const n=e.createElement("div");n.className="document-card__thumbnail-placeholder";const r=e.createElement("div");r.className=t.parameters[0],n.appendChild(r),i.appendChild(n)}}catch(e){}}))}}class An{constructor(){this.selector="[data-view-cache-operation=remove-node]"}handleSnapshot(e){return Object(r.b)(this,void 0,void 0,(function*(){const t=Array.from(e.querySelectorAll(this.selector));for(const e of t)try{e.remove()}catch(e){}}))}}class Pn{constructor(e,t){this.documentService=e,this.serviceWorkerMessageService=t}handleSnapshot(e,t){return Object(r.b)(this,void 0,void 0,(function*(){this.serviceWorkerMessageService.sendUnidirectionMessage({type:"view-cache",meta:"write",payload:{data:e.body.innerHTML,url:this.documentService.nativeDocument.URL,elementId:t}})}))}}let xn=(()=>{class e{parseOperation(e){const t=e.getAttribute("data-view-cache-operation");if(!t)throw new Error("Failed to parse operationName from element in ViewCache.");const i=e.getAttribute("data-view-cache-parameters");return{name:t,parameters:i?i.split(","):[]}}}return e.ɵprov=n.bc({factory:function(){return new e},token:e,providedIn:"root"}),e})();var Dn=i("xIlw"),Mn=i("lQwO"),Fn=i("+P5Z"),Ln=i("izKO"),On=i("ej7j"),Rn=i("L9A/"),_n=i("+a0u"),Un=i("VY7U"),Nn=i("T6pR"),Wn=i("up2P"),Bn=i("D8EG"),Hn=i("cxfp"),qn=i("D6F8"),Vn=i("9InZ"),$n=i("T/SX"),zn=i("upmJ"),jn=i("ApBt"),Gn=i("ci1G");class Qn{}class Kn{}var Zn=n.vb(G,[re],(function(e){return n.Kb([n.Lb(512,n.j,n.Y,[[8,[se.a,ui]],[3,n.j],n.x]),n.Lb(5120,hi,$,[]),n.Lb(4608,ot.a,di,[]),n.Lb(4608,w.a,N.a,[[2,hi],ot.a,D.b]),n.Lb(4608,me.a,pi,[u.b,h.b,k.a,w.a,c.b,ie]),n.Lb(4608,te.a,gi,[bi,n.m]),n.Lb(4608,M.a,Ii,[me.a,k.a,w.a,je.a,wi,m.a,Ci,te.a,h.b,Qe.a]),n.Lb(5120,Ti.a,ki,[C.a,st.a,Ai.a]),n.Lb(5120,n.u,n.lb,[[3,n.u]]),n.Lb(4608,le.m,le.l,[n.u]),n.Lb(5120,n.ob,n.mb,[n.z]),n.Lb(5120,n.c,n.ib,[]),n.Lb(5120,n.s,n.jb,[]),n.Lb(5120,n.t,n.kb,[]),n.Lb(4608,A.b,A.l,[le.d]),n.Lb(6144,n.G,null,[A.b]),n.Lb(4608,A.e,A.g,[]),n.Lb(5120,A.c,(function(e,t,i,n,r,s,o,a){return[new A.j(e,t,i),new A.o(n),new A.n(r,s,o,a)]}),[le.d,n.z,n.B,le.d,le.d,A.e,n.Z,[2,A.f]]),n.Lb(4608,A.d,A.d,[A.c,n.z]),n.Lb(135680,A.m,A.m,[le.d]),n.Lb(4608,A.k,A.k,[A.d,A.m,n.c]),n.Lb(5120,Pi.a,xi.e,[]),n.Lb(5120,Pi.c,xi.f,[]),n.Lb(4608,Pi.b,xi.d,[le.d,Pi.a,Pi.c]),n.Lb(5120,n.E,xi.g,[A.k,Pi.b,n.z]),n.Lb(6144,A.p,null,[A.m]),n.Lb(4608,n.M,n.M,[n.z]),n.Lb(4608,Di.b,xi.c,[n.E,le.d]),n.Lb(4608,Mi.c,Mi.c,[Mi.a,n.r]),n.Lb(5120,Fi,Ri,[k.a,Se.a,Et,C.a]),n.Lb(4608,Wi.n,Wi.t,[le.d,n.B,Wi.r]),n.Lb(4608,Wi.u,Wi.u,[Wi.n,Wi.s]),n.Lb(5120,l.a,Hi,[c.b,n.B]),n.Lb(5120,a,qi,[o.a,l.a]),n.Lb(5120,zi,Vi,[u.b]),n.Lb(5120,Wi.a,(function(e,t,i,n,r,s,o){return[e,new Qi(t),new Xi(i,n,r,s),new en(o)]}),[Wi.u,a,a,zi,p.a,h.b,sn]),n.Lb(4608,Wi.q,Wi.q,[]),n.Lb(6144,Wi.o,null,[Wi.q]),n.Lb(4608,Wi.m,Wi.m,[Wi.o]),n.Lb(6144,Wi.b,null,[Wi.m]),n.Lb(4608,Wi.h,Wi.p,[Wi.b,n.r]),n.Lb(4608,Wi.c,Wi.c,[Wi.h]),n.Lb(4608,on,an,[]),n.Lb(4608,nt.a,ln,[]),n.Lb(4608,be.a,cn,[]),n.Lb(4608,un,hn,[]),n.Lb(6144,xe.a,null,[dn]),n.Lb(4608,mn.a,gn,[bn,C.a,te.a,k.a,fe.a,h.b,u.b,M.a,Qe.a,et.a]),n.Lb(4608,ni.a,ni.a,[]),n.Lb(5120,Si.j,Si.B,[Si.z]),n.Lb(5120,n.b,(function(e,t,i,n,r,s,o){return[ni.e(e,t,i,n,r,s),o]}),[le.d,ni.d,[2,ni.b],n.B,n.g,ni.a,Si.j]),n.Lb(5120,Mi.d,Mi.e,[Mi.c]),n.Lb(5120,Si.a,Si.y,[Si.m]),n.Lb(4608,Si.f,Si.f,[]),n.Lb(6144,Si.h,null,[Si.f]),n.Lb(135680,Si.p,Si.p,[Si.m,n.w,n.i,n.r,Si.h]),n.Lb(4608,Si.g,Si.g,[]),n.Lb(5120,Si.D,Si.u,[Si.m,le.s,Si.i]),n.Lb(4608,vn.a,vn.a,[ve.a]),n.Lb(4608,Te.a,Te.a,[fe.a,ve.a,Ct.a]),n.Lb(5120,g,(function(e,t,i,n,r,s,o,a,l,c,u,h,d,m){return[new Sn(e,t,i),new yn(n,r,s,o,a,l),new wn(c,u,h,d,m)]}),[h.b,k.a,a,me.a,h.b,k.a,a,zi,c.b,n.m,k.a,w.a,a,ii]),n.Lb(5120,Cn.a,z,[]),n.Lb(5120,In.a,j,[u.b,D.b,n.z]),n.Lb(4608,Ge.a,kn,[]),n.Lb(5120,X,(function(e,t,i){return[new En(e),new An,new Pn(t,i)]}),[xn,f.a,ii]),n.Lb(1073742336,Ei,Ei,[]),n.Lb(1073742336,le.c,le.c,[]),n.Lb(1024,n.m,A.q,[]),n.Lb(1024,n.y,(function(){return[Si.t()]}),[]),n.Lb(512,Si.z,Si.z,[n.r]),n.Lb(1024,n.d,(function(e,t,i){return[A.r(e),Si.A(t),V(i)]}),[[2,n.y],Si.z,bi]),n.Lb(512,n.e,n.e,[[2,n.d]]),n.Lb(131584,n.g,n.g,[n.z,n.Z,n.r,n.m,n.j,n.e]),n.Lb(1073742336,n.f,n.f,[n.g]),n.Lb(1073742336,A.a,A.a,[[3,A.a]]),n.Lb(1073742336,xi.b,xi.b,[]),n.Lb(1073742336,Mi.b,Mi.b,[]),n.Lb(1073742336,Ni,Ni,[]),n.Lb(1073742336,Wi.e,Wi.e,[]),n.Lb(1073742336,Wi.d,Wi.d,[]),n.Lb(1073742336,Dn.a,Dn.a,[]),n.Lb(1073742336,Mn.a,Mn.a,[]),n.Lb(1073742336,Fn.a,Fn.a,[]),n.Lb(1073742336,Ln.a,Ln.a,[]),n.Lb(1073742336,On.a,On.a,[]),n.Lb(1073742336,Rn.a,Rn.a,[]),n.Lb(1073742336,_n.a,_n.a,[]),n.Lb(1024,Si.s,Si.w,[[3,Si.m]]),n.Lb(512,Si.r,Si.c,[]),n.Lb(512,Si.b,Si.b,[]),n.Lb(256,le.a,"/",[]),n.Lb(256,Si.i,{initialNavigation:"disabled"},[]),n.Lb(1024,le.h,Si.v,[le.q,[2,le.a],Si.i]),n.Lb(512,le.g,le.g,[le.h,le.q]),n.Lb(512,n.i,n.i,[]),n.Lb(512,n.w,n.J,[n.i,[2,n.K]]),n.Lb(1024,Si.k,(function(){return[[]]}),[]),n.Lb(1024,Si.m,Si.x,[Si.r,Si.b,le.g,n.r,n.w,n.i,Si.k,Si.i,[2,Si.q],[2,Si.l]]),n.Lb(1073742336,Si.n,Si.n,[[2,Si.s],[2,Si.m]]),n.Lb(1073742336,Un.a,Un.a,[]),n.Lb(1073742336,Nn.a,Nn.a,[]),n.Lb(1073742336,Wn.a,Wn.a,[]),n.Lb(1073742336,Bn.a,Bn.a,[]),n.Lb(1073742336,Hn.a,Hn.a,[]),n.Lb(1073742336,qn.a,qn.a,[]),n.Lb(1073742336,Vn.a,Vn.a,[]),n.Lb(1073742336,$n.a,$n.a,[]),n.Lb(1073742336,zn.a,zn.a,[]),n.Lb(1073742336,Oe.a,Oe.a,[]),n.Lb(1073742336,jn.b,jn.b,[]),n.Lb(1073742336,Le.f,Le.f,[]),n.Lb(1073742336,Gn.a,Gn.a,[]),n.Lb(1073742336,Qn,Qn,[]),n.Lb(1073742336,ni.c,ni.c,[]),n.Lb(1073742336,$i,$i,[]),n.Lb(1073742336,_t.b,_t.b,[]),n.Lb(1073742336,Kn,Kn,[]),n.Lb(1073742336,G,G,[]),n.Lb(256,n.k,n.nb,[]),n.Lb(256,n.bb,"root",[]),n.Lb(256,xi.a,"BrowserAnimations",[]),n.Lb(256,Mi.a,{},[]),n.Lb(256,rn,Oi,[]),n.Lb(256,nn,_i,[]),n.Lb(256,tn,Ui,[]),n.Lb(256,Wi.r,"XSRF-TOKEN",[]),n.Lb(256,Wi.s,"X-XSRF-TOKEN",[]),n.Lb(256,ni.d,{appRoot:"ohp-antp-root",replay:!1,buffer:!1},[]),n.Lb(256,Lt.a,0,[]),n.Lb(256,d.a,"antp",[])])}));let Jn,Xn;function Yn(e){window.shellAndConfigResponse.then(t=>{let i;try{i=JSON.parse(t)}catch(e){i=t}i&&i.clientStartupConfiguration&&function(e,t,i=!0){if(i&&console.error(e),!t)return;const n=O.createAriaLogger(t);if(!n)return;let r=!1;try{Zone.assertZonePatched()}catch(e){r=!0}const s=window.queuedEvents||[],o=window.queuedMarks,a="number"==typeof window.windowsDataSecuritySetting?window.windowsDataSecuritySetting:3;if(y.b.performanceLoggingSupported(window)){const e=(e,t,i)=>{(i=i||{}).Latency=t.toString(),i.ItemCategory="Bootstrapper",s.push({streamName:"Performance_Dump",eventName:e,eventParams:i,metrics:[],securityThreshold:0})},t=(e,t,i)=>{(i=i||{}).Error=e,i.DebugInfo=t,i.ItemCategory="Bootstrapper",s.push({streamName:"Generic_Event",eventName:"Performance_Mark_Failure",eventParams:i,metrics:[],securityThreshold:0})};o&&o.splice(0,o.length).forEach(i=>{const n=i.measureFrom||"navigationStart";try{window.performance.measure(i.markName,n,i.markName)}catch(e){return void t(i.markName,`Failed to record <${i.markName}> starting from <${n}>: exception is thrown`,i.eventParams)}const r=window.performance.getEntriesByName(i.markName,"measure");if(!r||!r.length)return void t(i.markName,`Failed to record <${i.markName}>: measure missing`,i.eventParams);const s=Math.ceil(r[0].duration);e(i.markName,s,i.eventParams)}),y.b.getBrowserTimingMeasures(window,(e,i)=>{t(e,i)}).forEach(t=>{e(t.name,t.duration)})}s.length>0&&(s.forEach(e=>{if((e.securityThreshold||0)>a)return;const t=new S.AWTEventProperties,i=e.eventParams;if(i)for(const e in i)i.hasOwnProperty(e)&&t.setProperty(e,i[e]);t.setName(e.streamName),t.setProperty("EventName",e.eventName),t.setProperty("AppSecurityLevel",a),n.logEvent(t)}),window.queuedEvents=[]);const l=e&&e.stack||"Browser did not provide stack trace";let c=e&&e.message||"No Error Message Provided";c.lastIndexOf(".")!==c.length-1&&(c+=".");const u=`Fatal error preventing Angular bootstrap: ${c} Zone error: ${r}`,h=e=>{const t=new S.AWTEventProperties;return t.setName(e),t.setProperty("EventName","Unhandled_Exception"),t.setProperty("ItemCategory","Bootstrap"),t.setProperty("Error",w.a.filterPii(u)),t.setProperty("AppSecurityLevel",a),t},d=h("Generic_Event");t.logPiiAllowed&&d.setPropertyWithPii("DebugInfo",l,t.logPiiInClearText?S.AWTPiiKind.NotSet:S.AWTPiiKind.GenericData),n.logEvent(d);const m=h("Generic_Debug_Cache");m.setProperty("DebugInfo",l),n.logEvent(m),O.endSession(n,!0)}(e,JSON.parse(i.clientStartupConfiguration))}).catch(()=>{}),window.chrome&&window.chrome.authPrivate&&window.chrome.authPrivate.acquireAccessTokenWithUserInteraction&&window.userInteractionNeeded&&0===document.getElementById("ohp-antp-app-view-cache").childElementCount&&function(){const e=window.matchMedia("(prefers-color-scheme: dark)"),t=e&&e.matches,i=document.getElementById("errorImage");i.classList.add(t?"emptystate-icons-sprite-darkmode":"emptystate-icons-sprite"),i.classList.add(t?"emptystate-darkmode":"emptystate"),document.getElementById("errorTitle").classList.add(t?"antp-error__title-darkmode":"antp-error__title"),document.getElementById("errorSubtitle").classList.add(t?"antp-error__subtitle-darkmode":"antp-error__subtitle"),document.getElementById("errorSignIn").classList.add(t?"antp-error__sign-in-darkmode":"antp-error__sign-in"),document.getElementById("footerText").classList.add(t?"error-footer__text-darkmode":"error-footer__text"),document.getElementById("errorSignIn").addEventListener("click",()=>{const e=window.getCommonParamsAntp();e.ElementId="errorSignIn",window.loggingUtil.LogEvent("Generic_Click","ErrorSignIn_Click",0,e,[]),window.getAccessTokenAntpViaUserInteraction("4345a7b9-9a63-4910-a426-35363201d503","OfficeHome").then(()=>{window.userInteractionNeeded=!1,window.flushLogs(!0,!1),window.location.reload(!1)})}),document.getElementById("userInteractionRequired").classList.remove("antp-token-fetch-error-content--hide"),window.loggingUtil.LogEvent("Generic_Impression","ErrorSignIn_Impression",0,window.getCommonParamsAntp(),[])}()}try{/localhost(:\d+)?$/.test(window.location.hostname)||Object(n.T)(),Promise.race([window.shouldAppBootstrapAfterScroll(),window.shouldAppBootstrapOnLayoutChangePromise]).then(()=>{Jn=y.a.now(),A.i().bootstrapModuleFactory(Zn,{preserveWhitespaces:!1}).then(e=>{Xn=y.a.now();const t=e.injector,i=t.get(u.b);i.config.sharedClientStartupContext&&(window.overrideCID&&(i.config.sharedClientStartupContext.correlationId=window.overrideCID),window.overrideSID&&(i.config.sharedClientStartupContext.sessionId=window.overrideSID)),t.get(v).initialize();const n=t.get(w.a);window.isMetricsReportingEnabled&&U.setup(n);const r=Math.ceil(Jn);if(n.logPerformanceEvent("App_Begin_Bootstrap",r),n.logPerformanceEvent("App_Complete_Bootstrap",Math.ceil(Xn)-r),n instanceof N.a){const e=t.get(B.a);n.registerOfficeRouteService(e);const i=t.get(p.a);n.registerServiceWorkerStateService(i,!1);const r=t.get(_);n.registerEventFactories([r])}window.performanceService=t.get(y.b),window.instrumentationService=n,t.get(W.a).broadcastEvent({name:"appInitialized",args:[]})}).catch(e=>{Yn(e)})})}catch(e){Yn(e)}},kVgv:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i("1A1F");class n{}},kaEK:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(e){return e[e.None=0]="None",e[e.Default=1]="Default",e[e.Open=2]="Open",e[e.Edit=3]="Edit",e[e.Comment=4]="Comment",e[e.Mention=5]="Mention",e[e.Share=6]="Share",e[e.Attachment=7]="Attachment",e[e.SnoozeExpiry=8]="SnoozeExpiry",e[e.Trending=9]="Trending",e[e.News=10]="News",e[e.Meeting=11]="Meeting",e[e.Video=12]="Video",e}({})},kfAr:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("BaAg"),r=i("fKR7"),s=i("Brer"),o=i("Mlb/"),a=i("4/We"),l=i("/I02"),c=i("pd4Y"),u=i("TDzr"),h=i("QOOv"),d=i("n826"),m=i("m+UP"),p=i("Ry9Z"),f=i("BJbw"),g=i("lrJm"),b=i("cgnd");let v=(()=>{class e{constructor(e,t,i,n,r,s,o,a,l,c,u,h){this.capabilitiesService=e,this.dateService=i,this.formsService=n,this.oneDriveGraphService=s,this.vroomService=o,this.swayService=a,this.analyticsService=l,this.urlAuthenticatorService=c,this.globalErrorHandler=u,this.clientStartupConfigService=h,this.isAntpExperience=this.capabilitiesService.capabilities.antpLoaded,this.config=r.config,this.lifecycleEventsEnabled=this.config.isNewLifecycleEventEnabled,this.inflationsInProgress=new Array,this.inMockMode=t.sharedContext.inMockMode,this.highResRecThumbnails=this.capabilitiesService.capabilities.highResRecThumbnailsEnabled}inflateItem(t,i,n,r){if(t.isLocal||e.disableInflation.has(t.fileType))return Promise.resolve(t);const s=this.fetchItemInflationData(t,t.fromCache?"cache-only":"network-first",i,n,r);return this.inflationsInProgress.push(s.then(e=>e,()=>null)),this.waitOnInflations().then(()=>this.inflationsInProgress.splice(0)),s}inflateThumbnails(t){if(!e.thumbnailFileTypes.has(t.fileType)||t.thumbnails)return Promise.resolve(t);const i=t.fromCache?"cache-only":"network-first";return new Promise(e=>{if(t.fileType!==n.b.Sway)return t.fileType===n.b.Forms?(t.thumbnails={},void this.formsService.fetchFormThumbnail(t).then(()=>e(t))):void(t.driveId&&t.docId||this.isAntpExperience?this.oneDriveGraphService.getThumbnailsForItem(t.driveId,t.docId,i,2).then(e=>{e&&e.value&&e.value.length&&this.populateThumbnails(t,e.value[0])}).catch(e=>{this.globalErrorHandler.handleError(e,"ZYaIo")}).then(()=>e(t)):this.chooseSharesCall(t,i,!0).then(e=>{e.thumbnails&&e.thumbnails.length&&this.populateThumbnails(t,e.thumbnails[0])}).catch(e=>{this.globalErrorHandler.handleError(e,"hKd6C")}).then(()=>e(t)));this.fetchSwayThumbnail(t,i).then(()=>{e(t)})})}waitOnInflations(){const e=this.inflationsInProgress.length;return Promise.all(this.inflationsInProgress).then(()=>{if(!(this.inflationsInProgress.length<=e))return this.waitOnInflations()})}fetchItemInflationData(e,t,i,o,a){return e.format===r.a.Recommended||e.format===r.a.OfficeFeedDocument||e.format===r.a.News?this.fetchRecommendedItemInflationData(e,t):new Promise(l=>{const c=[],u=this.config.shareControlEnabled&&e.fileType!==n.b.Sway,h=this.capabilitiesService.wacHostEnabledForFileType(e.fileType);if(e.format===r.a.Trending&&e.driveId&&e.docId)this.config.tileViewEnabled&&i&&c.push(h?this.chooseService(e).getItemWithWacDataAndThumbnails(e,t,!1,2).then(t=>this.populateMruItemFromDriveItem(e,t)).catch(e=>{this.globalErrorHandler.handleError(e,"WF9ix")}):this.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then(t=>{t&&t.value&&t.value.length&&this.populateThumbnails(e,t.value[0])}).catch(e=>{this.globalErrorHandler.handleError(e,"iZlQF")})),e.fileType!==n.b.OneNote&&c.push(this.setupActivity(e,t)),(u||this.lifecycleEventsEnabled)&&c.push(this.oneDriveGraphService.getItemWithIds(e.driveId,e.docId,"sharepointIds,createdDateTime",t).then(t=>{this.setupShareControl(e,t),this.setupLifecycleEvents(e,t)}).catch(e=>{this.globalErrorHandler.handleError(e,"wUAkv")}));else if((this.config.tileViewEnabled||this.config.activityEnabled||this.config.permissionsEnabled||u||h)&&s.a.sharesFileTypes.has(e.fileType)&&(1===e.sharingType||4===e.sharingType||0===e.sharingType)){const r=this.checkAllDataIsPresentForInflation(e);if(r){this.setupLifecycleEvents(e,null);const r=(e.fileType!==n.b.OneNote?this.setupActivity(e,t):Promise.resolve()).then(()=>Promise.resolve());c.push(r),i&&c.push(this.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then(t=>{t&&t.value&&t.value.length&&this.populateThumbnails(e,t.value[0])}).catch(e=>{this.globalErrorHandler.handleError(e,"iZlQF")}))}this.isAntpExperience||r||c.push(this.chooseSharesCall(e,t,i).then(i=>i?(this.populateMruItemFromDriveItem(e,i),this.setupShareControl(e,i),this.setupLifecycleEvents(e,i),e.docId=i.id,i.parentReference&&(e.driveId=i.parentReference.driveId),e.fileType!==n.b.OneNote?this.setupActivity(e,t):Promise.resolve()):Promise.resolve()).catch(e=>{this.globalErrorHandler.handleError(e,"EgyA3")}))}if(this.config.analyticsEnabled&&o){const i=this.analyticsService.getAnalytics(e,t).then(t=>{e.analytics=t}).catch(e=>{this.globalErrorHandler.handleError(e,"gBfeR")});c.push(i)}c.push(...this.setupSwayData(e,t,i)),c.push(...this.setupFormData(e,i,a)),Promise.all(c).then(()=>{e.inflationCompleted(),l(e)},()=>{e.inflationCompleted(),l(e)})})}fetchRecommendedItemInflationData(e,t){return new Promise(i=>{e.driveId&&e.docId?this.fetchAndPopulateWacDataAndThumbnails(e,t).catch(e=>{this.globalErrorHandler.handleError(e,"rm3f5")}).then(()=>i(e)):i(e)})}fetchAndPopulateWacDataAndThumbnails(e,t){return this.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&!this.inMockMode?this.chooseService(e).getItemWithWacDataAndThumbnails(e,t).then(t=>this.populateMruItemFromDriveItem(e,t)):this.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t).then(t=>{t&&t.value&&t.value.length&&this.populateThumbnails(e,t.value[0])})}populateMruItemFromDriveItem(e,t){t&&t.thumbnails&&t.thumbnails.length&&this.populateThumbnails(e,t.thumbnails[0]),t&&t.openWith&&t.openWith.wac&&this.populateWopiHostData(e,t)}populateThumbnails(e,t){e.thumbnails={small:t.small?t.small.url:null,medium:t.medium?t.medium.url:null,large:t.large?t.large.url:null,recommendedThumbnail:e.format!==r.a.Recommended&&e.format!==r.a.News&&e.format!==r.a.OfficeFeedDocument||!t.large?null:this.getRecommendedThumbnail(t.large.url)}}populateWopiHostData(e,t){e.wopiData=s.a.getWopiHostDataFromItem(t)}getRecommendedThumbnail(e){const t=this.highResRecThumbnails;return e.replace(/&width=\d+/,"&width="+(t?"999":"350")).replace(/&height=\d+/,"&height="+(t?"999":"400"))}setupActivity(e,t){return!this.config.activityEnabled||e.format===r.a.Recent&&this.config.mruActivityEnabled&&this.config.onlyMruActivityEnabled?Promise.resolve():this.vroomService.getDocumentActivity(e,t,2).then(t=>e.activities=t).catch(e=>{this.globalErrorHandler.handleError(e,"SluwI")})}chooseSharesCall(e,t,i){const n=this.chooseService(e),s=this.capabilitiesService.wacHostEnabledForFileType(e.fileType);return i?n.getSharedItemWithThumbnail(e.canonicalUrl,e.fileType,r.a[e.format],t,s,!1,2):n.getSharedItemWithoutThumbnail(e.canonicalUrl,e.fileType,r.a[e.format],t,s,void 0,!1,2)}chooseService(e){return e.isMsftDogfood?this.vroomService:this.oneDriveGraphService}setupShareControl(e,t){t&&t.sharepointIds&&t.sharepointIds.siteUrl&&(e.sharepointIds.siteUrl=t.sharepointIds.siteUrl)}setupLifecycleEvents(e,t){if(this.lifecycleEventsEnabled&&!this.config.mruActivityEnabled){let i=e.createdDate;!i&&t&&t.createdDateTime&&(i=new Date(t.createdDateTime)),i&&(e.isNew=this.dateService.addHours(this.dateService.getCurrentDate(),-1*this.config.isNewTimeWindowInHours).getTime()<=i.getTime())}}setupFormData(e,t,i){const r=[];return e.fileType!==n.b.Forms||(i===n.b.Forms&&r.push(new Promise((t,i)=>{let n=!1;const r=t=>{e.metaData||(e.metaData={}),e.metaData.formsResponseCount=t};if(e.ownerId===this.clientStartupConfigService.config.objectId){const s=this.formsService.getMyFormsResponses();s.results.subscribe(i=>{if(n)return;const s=i.value.find(t=>t.id===e.serverDocId);s&&r(s.responseCount),i.fromCache||(n=!0),t()}),s.initialCompletion.then(e=>{e&&(e.cacheError||e.networkError)&&i()})}else{const s=this.formsService.getForm(e.serverDocId,e.ownerType,e.ownerId);s.results.subscribe(e=>{n||(r(e?e.rowCount:null),e.fromCache||(n=!0),t())}),s.initialCompletion.then(e=>{e&&(e.cacheError||e.networkError)&&i()})}})),this.config.tileViewEnabled&&t&&r.push(this.inflateThumbnails(e).then(()=>{}))),r}setupSwayData(e,t,i){const r=[];return e.fileType!==n.b.Sway||(this.config.tileViewEnabled&&this.swayService.swayConfig.thumbnailsEnabled&&i&&r.push(this.fetchSwayThumbnail(e,t)),e.url=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.url)),r}fetchSwayThumbnail(e,t){return this.swayService.getThumbnail(e.url,e.thumbnailInfo?e.thumbnailInfo.thumbnailId:null,t).then(t=>{t&&(e.thumbnails={small:t,medium:t,large:t,recommendedThumbnail:t})}).catch(e=>{this.globalErrorHandler.handleError(e,"cm5b1")})}checkAllDataIsPresentForInflation(e){return!!(e.sharepointIds&&e.createdDate&&e.driveId&&e.docId)}}return e.thumbnailFileTypes=new Set([n.b.PowerPoint,n.b.Visio,n.b.Word,n.b.Sway,n.b.Pdf,n.b.Forms]),e.disableInflation=new Set([n.b.Project,n.b.Portfolio]),e.ɵprov=o.bc({factory:function(){return new e(o.cc(a.a),o.cc(l.a),o.cc(c.a),o.cc(u.a),o.cc(h.a),o.cc(d.a),o.cc(s.a),o.cc(m.a),o.cc(p.a),o.cc(f.a),o.cc(g.b),o.cc(b.b))},token:e,providedIn:"root"}),e})()},kpuN:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("bb6g");class r{init(e,t,i){this.errorHandler=e,this.defaultTokenFormat=t,this.defaultTokenSource=i}getDefaultExpiry(){return(new Date).getTime()+36e5}getAccessToken(e,t,i,r,s){return Object(n.b)(this,void 0,void 0,(function*(){return e?this.getAccessTokenResponse(e,t,i,r,s).then(e=>e&&e.token?e:{success:!1,token:"",format:this.defaultTokenFormat,source:this.defaultTokenSource,error:new Error("Empty token returned")}).catch(e=>(this.errorHandler.handleError(e,"SuNwZ"),{success:!1,token:"",format:this.defaultTokenFormat,source:this.defaultTokenSource,error:e})):Promise.resolve({success:!1,token:"",format:this.defaultTokenFormat,source:this.defaultTokenSource,error:new Error("invalid tokenConsumer")})}))}}},lQwO:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},lrJm:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return a}));var n=i("Mlb/"),r=i("hhzZ"),s=i("BMb5");class o extends Error{constructor(e,t){super(e),this.message=e,this.originalError=t,this.name="ApplicationError",Object.setPrototypeOf&&Object.setPrototypeOf(this,o.prototype)}}let a=(()=>{class e extends n.m{constructor(e,t){super(),this.instrumentationService=e,this.windowService=t,this.loggedErrors=new Map,this.unknownError="UnknownError",this.mutateGlobalWindowErrorHandler()}handleError(e,t){this.shouldSwallow(e)||(this.setErrorId(e,t),this.logError(e,"Angular2"))}handleCacheObservableError(e,t,i){e&&(e.networkError&&this.handleError(e.networkError,i),e.cacheError&&this.handleError(e.cacheError,t))}setErrorId(e,t){e&&"object"==typeof e&&t&&(e.id=t)}mutateGlobalWindowErrorHandler(){const e=this.windowService.nativeWindow,t=e.onerror,i=this;e.onerror=function(n,r,s,o,a){let l=null;if("object"==typeof n&&n.type&&"error"===n.type.toLowerCase()?l=n:a?(l=a,l.message=a.message||n,Object.assign&&Object.assign(l,{filename:r,lineno:s,colno:o})):"string"==typeof n?(l=new Error(n||i.unknownError),Object.assign&&Object.assign(l,{filename:r,lineno:s,colno:o})):(l=new Error(i.unknownError),Object.assign&&Object.assign(l,{filename:r,lineno:s,colno:o})),i.logError(l,"Global"),t)try{t.apply(e,arguments)}catch(e){i.handleError(e)}}}logError(e,t){let i="",n="";e=e||new Error(this.unknownError);let r=!1;try{let s=e.filename;s?(s=s.replace(/^.*[\\\/]/,""),i=`Error location: ${s}, line: ${e.lineno}, col: ${e.colno}`):e.id?i="Error id: "+e.id:(i="Error location: unknown",r=!0);let o=e.error||e;o.originalError?(i+="\nHandled error is a wrapper with message: "+o.message,n="Wrapper call stack: "+(o.stack||"Call stack trace is not available"),o=o.originalError,n+="\nOriginal call stack: "+(o.stack||"Call stack trace is not available")):n="Call stack: "+(o.stack||"Call stack trace is not available"),o.message&&(i+="\nError message: "+o.message,i.indexOf("Invalid calling object")>0&&(i+="\nShellver: "+window.O365ShellVerStr,r=!0))}catch(e){i="Error caught inside error logger: "+(e&&e.message||this.unknownError),n="Call stack: "+(e&&e.stack||"Call stack trace is not available"),t="Angular2",super.handleError(e)}finally{this.safeLogErrorData(i,n,t,r),super.handleError(e)}}safeLogErrorData(e,t,i,n=!1){try{const s=this.determineOccurrence(e);if(this.loggedErrors.set(e,s),this.shouldLogBasedOnOccurrence(s)){const o={Error:e,DebugInfo:new r.d(t),ItemCategory:i,ItemCount:s.toString()};this.instrumentationService.logGenericEvent("Unhandled_Exception",o),n&&(o.DebugInfo=t,this.instrumentationService.logDebugCacheEvent("Unhandled_Exception",o))}}catch(e){super.handleError(e)}}shouldSwallow(e){if(e&&e.stack&&!e.promise)return!1;if(e&&e.promise&&e.rejection){const t=e.rejection;if(t.stack&&"Error"!==t.name)return!1}return!0}determineOccurrence(e){let t=1;return this.loggedErrors.has(e)&&(t=this.loggedErrors.get(e)+1),t}shouldLogBasedOnOccurrence(e){const t=e.toString().length,i=Math.pow(10,t-1);return i<2||e%i==0}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a),n.cc(s.b))},token:e,providedIn:"root"}),e})()},lwM0:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("pjz5");class r{static encodeUrl(e,t){if(!e)return"";if(t){const t=n.a.getLocation(e),i=e=>{if(!e)return"";const t=e.substring(1).split("&");let i=0;const n=t.reduce((e,t)=>{const n=t.split("="),r=i>0?"&":"";return i++,e+r+(n[0]&&n[1]?n[0]+"="+encodeURIComponent(n[1]):n[0]+(""===n[1]?"=":""))},"");return e[0]+n};return encodeURI(t.protocol+"//"+t.host)+encodeURI(t.path)+i(t.search)+i(t.hash)}return encodeURI(e).replace(/#/g,"%23")}static decodeUrl(e){if(!e)return"";try{return decodeURIComponent(e)}catch(e){return""}}}},"m+UP":function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var n=i("6UlS"),r=i("k+kJ"),s=i("3GGT"),o=i("BaAg"),a=i("H90i"),l=i("pjz5"),c=i("pOWU"),u=i("Mlb/"),h=i("6GOa"),d=i("kpuN"),m=i("hhzZ"),p=i("R7NL"),f=i("/I02"),g=i("wwmn"),b=i("vk2e"),v=i("lrJm"),S=i("BJbw"),y=i("cgnd"),w=i("JScD"),C=i("PBJH"),I=i("PZOQ"),T=i("casz");class k{constructor(){this.cachedResponsePromises=new Map}set(e,t,i){const n=this.key(t,i);this.cachedResponsePromises.set(n,e)}has(e,t){const i=this.key(e,t);return this.cachedResponsePromises.has(i)}get(e,t){const i=this.key(e,t);return this.cachedResponsePromises.get(i)}delete(e,t){const i=this.key(e,t);return this.cachedResponsePromises.delete(i)}key(e,t){return`/${t}/${e}`}}let E=(()=>{class e extends c.a{constructor(e,t,i,n,r,s,o,a,l,c,u,h,d,m){super(t,i,n,"Sway",r,s,o,m),this.globalErrorHandler=a,this.urlAuthenticatorService=l,this.uploadConfigService=u,this.locService=h,this.localDataSizePipe=d,this.cachedResponsePromises=new k,this.swayConfig=e.config;const p=c.config;this.requestConfig={headers:new Map([["X-UserSessionId",p.sharedClientStartupContext.correlationId],["X-OHP-CorrelationId",p.sharedClientStartupContext.correlationId]])}}createNew(){const e=this.swayConfig.apiUrl+"/json/createStory";return new Promise((t,i)=>{this.post("Sway_Create_Request",e,void 0,e=>{e.instrument((e,t)=>{!e.ok||e.data&&e.data.url||(t.params.HttpCode=s.a.UnexpectedResponse.toString()),this.instrumentResponse(e.headers,t)}).then(e=>{e&&e.data?t(this.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.data.url)):i(new c.b(e,"Could not parse Sway creation response"))}).catch(e=>{this.globalErrorHandler.handleError(e,"WlqQb")})},i,this.requestConfig)})}upload(t,i){const s=new r.b(i,t,r.d.Button),o=new n.a(s),l=e=>{s.state=e,o.next(s)};return s.cancellationToken.onCancel(()=>l(r.c.Cancelled)),this.verifyFileForUpload(t).then(()=>l(r.c.Started)).then(()=>e.readBase64(t)).then(e=>this.uploadFile({docBase64:e,documentName:s.file.name,world:"VerticalWorld",enhancementId:"",otsClient:a.a},s)).then(e=>{s.result=e,l(r.c.Completed)}).catch(e=>{s.error=this.createUploadError(e),l(r.c.Failed)}),o.asObservable()}getThumbnail(t,i,n){if(!this.swayConfig.thumbnailsEnabled||!i)return Promise.resolve("");const r=`${this.swayConfig.apiUrl}/sway/v1.0/${e.extractLookupId(t)}/croppedThumbnailImage?imageId=${i}&width=198&height=111`;return new Promise((t,i)=>{this.swayGet("Sway_Get_Thumbnail_Request",r,n,"blob",!0).then(n=>{n&&n.data?e.readAsDataUrl(n.data).then(t,i):t(null)},i)})}getAnalytics(t,i){const n=e.extractLookupId(t);return this.fetchAnalyticsForBatch([n],i).then(t=>e.findAnalytics(t.data,n))}prefetchAnalytics(t,i){if(!t||0===t.length)return;const n=t.map(e.extractLookupId).sort(),r=e.splitToBatches(n,this.swayConfig.analyticsBatchSize);for(let e=0;e<r.length;e++){const t=r[e],n=this.fetchAnalyticsForBatch(t,i);for(let e=0;e<t.length;e++){const r=this.buildUrlForAnalytics([t[e]]);this.cachedResponsePromises.set(n,r,i),n.catch(()=>this.cachedResponsePromises.delete(r,i))}}}handleQueryParam(e,t){super.handleQueryParam(e,t),"mocksway"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)}static findAnalytics(e,t){if(e)for(let i=0;i<e.length;i++)if(e[i]&&e[i].id===t)return e[i].analytics}static extractLookupId(e){return l.a.getLocation(e).path.split("/").filter(e=>e)[0]}static splitToBatches(e,t){const i=[],n=e.slice();for(;n&&n.length&&t;)i.push(n.splice(0,t));return i}static readAsDataUrl(e){return new Promise((t,i)=>{const n=new FileReader;n.addEventListener("loadend",()=>{t(n.result)}),n.addEventListener("abort",()=>{i()}),n.addEventListener("error",()=>{i()}),n.readAsDataURL(e)})}static readBase64(t){return new Promise((i,n)=>{e.readAsDataUrl(t).then(e=>{const t=e.indexOf(",");t>=0?i(e.substring(t+1)):n(r.a.Unknown)}).catch(()=>n(r.a.Unknown))})}createUploadError(e){const t=this.uploadConfigService.config.swayResources;switch(e){case r.a.FileTooLarge:return{title:t.errorTitle,type:e,message:this.locService.format(t.largeFile,this.localDataSizePipe.transform(this.swayConfig.uploadMaxFileSize))};case r.a.InvalidFileType:return{title:t.errorTitle,type:e,message:t.unsupportedFile};default:return{title:t.errorTitle,type:e,message:""}}}verifyFileForUpload(e){const t=o.a.getFileExtension(e.name.toLowerCase());return-1===this.swayConfig.uploadSupportedExtensions.indexOf(t)?Promise.reject(r.a.InvalidFileType):e.size>this.swayConfig.uploadMaxFileSize?Promise.reject(r.a.FileTooLarge):Promise.resolve()}uploadFile(e,t){const i=this.swayConfig.apiUrl+"/publishtosway/createstoryandpublishdocument";return new Promise((n,o)=>{this.post("Sway_Create_Story_And_Publish_Document_Request",i,e,e=>{e.instrument((e,t)=>{!e.ok||e.data&&e.data.pollingUrl||(t.params.HttpCode=s.a.UnexpectedResponse.toString()),this.instrumentResponse(e.headers,t)}).then(e=>{e&&e.data?n(e.data):o(r.a.Unknown)})},o,this.requestConfig,e=>t.updateProgress(e.loaded),null,t.cancellationToken)})}fetchAnalyticsForBatch(e,t){return this.swayGet("Sway_Get_Analytics_Request",this.buildUrlForAnalytics(e),t,"json",!0)}swayGet(e,t,i,n,r=!1){if(r&&this.cachedResponsePromises.has(t,i))return this.cachedResponsePromises.get(t,i);const s=new Promise((s,o)=>{const a=Object.assign({},this.requestConfig);a.responseType=n,super.get(e,t,e=>{e.instrument((e,t)=>{this.instrumentResponse(e.headers,t)}).then(s).catch(e=>{this.globalErrorHandler.handleError(e,"cwHpN")})},e=>{r&&this.cachedResponsePromises.delete(t,i),o(e)},a,i)});return r&&this.cachedResponsePromises.set(s,t,i),s}buildUrlForAnalytics(e){const t=encodeURIComponent(e.join(","));return`${this.swayConfig.apiUrl}/api/v1.0/batchanalytics?ids=${t}`}instrumentResponse(e,t){e&&(t.params.RequestId=e.get("X-CorrelationId"),t.params.PartnerGeo=e.get("X-OfficeCluster"))}}return e.ɵprov=u.bc({factory:function(){return new e(u.cc(h.a),u.cc(d.a),u.cc(m.a),u.cc(p.a),u.cc(f.a),u.cc(g.a),u.cc(b.q),u.cc(v.b),u.cc(S.a),u.cc(y.b),u.cc(w.a),u.cc(C.a),u.cc(I.a),u.cc(T.a))},token:e,providedIn:"root"}),e})()},mu6k:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return a}));var n=i("Mlb/"),r=i("lrJm"),s=i("24t9");class o{constructor(e){this.templateRef=e}}let a=(()=>{class e{constructor(e,t,i,r,s,o,a){this.deviceDetector=e,this.documentService=t,this.changeDetectorRef=i,this.locService=r,this.renderer=s,this.elementRef=o,this.windowService=a,this.leftAlignedCard=!1,this.multiSelect=!1,this.contextAriaLabel="",this.selectItem=new n.n,this.closeMenu=new n.n}ngOnInit(){this.focusActive=!1,this.closeByKey=!1,this.activeIndex=-1,this.menuItemClickHandler=e=>{this.elementRef.nativeElement.contains(e.target)||(this.mobileMenu&&e.preventDefault(),this.close())},this.animationState=this.mobileMenu?"openMobile":"open",this.open=!0,this.destroyed=!1,this.menuAriaLabel=this.locService.format(this.locService.MenuAriaLabel,this.contextAriaLabel),this.mobileMenu&&this.documentService.disableTouchMove()}ngAfterViewInit(){if(1!==this.menuItems.length)throw new r.a("Must have exactly 1 *ohpMenuItemContent in a Menu as a child");this.menuItemTemplate=this.menuItems.first.templateRef,this.changeDetectorRef.detectChanges(),setTimeout(()=>{if(this.deviceDetector.isDesktopDevice()){this.setActiveIndex(0,!0);const e=this.documentService.nativeDocument.activeElement;setTimeout(()=>{const t=e.getBoundingClientRect();t.top+t.height>this.windowService.nativeWindow.innerHeight&&e.scrollIntoView()},100)}this.destroyed||(this.menuItemClickListener=this.renderer.listen(this.documentService.nativeDocument,"click",this.menuItemClickHandler),this.menuItemTouchListener=this.renderer.listen(this.documentService.nativeDocument,"touchend",this.menuItemClickHandler),this.menuItemContextListener=this.renderer.listen(this.documentService.nativeDocument,"contextmenu",this.menuItemClickHandler),this.menuItemKeyListener=this.renderer.listen(this.documentService.nativeDocument,"keydown",e=>{3===s.a.getKey(e)&&this.close(!0)}))},0)}ngOnDestroy(){this.destroyed=!0,this.menuItemClickListener&&this.menuItemClickListener(),this.menuItemTouchListener&&this.menuItemTouchListener(),this.menuItemContextListener&&this.menuItemContextListener(),this.menuItemKeyListener&&this.menuItemKeyListener(),this.documentService.enableTouchMove()}onAnimationCompleted(e){"closing"===e.toState&&this.completeClose()}onSelectItem(e,t,i){this.menuModel.announceItemIsSelected&&this.menuModel.items.forEach(t=>t.ariaSelected=e.getId()===t.getId()),this.selectItem.emit({item:e,index:t,nativeDomEvent:i}),i.preventDefault(),this.multiSelect||this.close()}close(e=!1){if(!this.closed){if(this.closed=!0,this.closeByKey=e,this.animateClose)return void(this.animationState="closing");this.completeClose()}}handleKey(t){const i=s.a.getKey(t);if(-1===e.expectedKeys.indexOf(i))return;if(t.preventDefault(),2===i&&this.activeIndex>=0)return void this.onSelectItem(this.menuModel.items[this.activeIndex],this.activeIndex,t);const n=this.menuModel.items.length-1;switch(i){case 1:case 3:this.close(!0);break;case 4:this.focusActive=!0,this.setActiveIndex(this.activeIndex>0?this.activeIndex-1:n);break;case 5:this.focusActive=!0,this.setActiveIndex((this.activeIndex+1)%(n+1))}}setActiveIndex(e,t){if(t&&(this.focusActive=!0),this.activeIndex=e,this.focusActive){const t=this.dropdownItems.find(t=>t.nativeElement.id===this.getIdForItem(this.menuModel.items[e]));t&&t.nativeElement.focus()}}getIdForItem(e){return`${this.menuModel.id}-item--${e.getId()}`}trackById(e,t){return t.getId()}completeClose(){this.open=!1,this.documentService.enableTouchMove(),this.closeMenu.emit(this.closeByKey),this.closeByKey=!1}}return e.expectedKeys=[1,2,3,4,5],e})()},n826:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n=i("WKA6"),r=i("3GGT"),s=i("hhzZ"),o=i("BaAg"),a=i("pjz5"),l=i("aQ3G"),c=i("Brer"),u=i("pOWU"),h=i("Mlb/"),d=i("4/We"),m=i("kpuN"),p=i("R7NL"),f=i("/I02"),g=i("wwmn"),b=i("vk2e"),v=i("lrJm"),S=i("pd4Y"),y=i("casz"),w=i("oAX+"),C=i("uzn7");let I=(()=>{class e{constructor(e,t){this.storageService=e,this.capabilitiesService=t}makeRequest(e,t,i,n,r,s){if(this.capabilitiesService.capabilities.limitNetworkRequests&&t){const o=this.getKey(e),a=this.storageService.get(o);let l=!0;a&&a+1e3*t>=Date.now()&&(l=!1);const c=()=>{this.storageService.set(o,Date.now())};if(l){const e=n().then(e=>(e&&c(),e));return w.a.createResultsWithCacheObservable(i(),e,r,s)}return w.a.createResultsCacheFirstObservable(i,n,c,r,s)}return w.a.createResultsWithCacheObservable(i(),n(),r,s)}getKey(e){return"network_ts_"+e}}return e.ɵprov=h.bc({factory:function(){return new e(h.cc(C.a),h.cc(d.a))},token:e,providedIn:"root"}),e})(),T=(()=>{class e extends l.a{constructor(e,t,i,n,r,s,o,a,l,c,u,h){super(t,i,n,r,s,o,a,u),this.capabilitiesService=e,this.dateService=l,this.vroomService=c,this.cachedRequestService=h,this.batchEnabled=e.capabilities.batchGraphEnabled}getItemWithIds(e,t,i,n,r,s=!1,o=!1){const a=this.getItemLocation(e,t),l=i?"?$select="+i:"",c=this.inMockMode?`${a}?currentDate=${this.dateService.getCurrentDateMinuteGranularity().toISOString()}`:`${a}${l}`;return this.getOneDriveItem("OneDrive_Graph_Item_Request",c,n,r,s,null,o)}getMyDriveRootUrl(e=0){if(!this.capabilitiesService.capabilities.oneDriveApisEnabled)return Promise.resolve(null);if(!this.myDriveRootUrlPromise){const t=new Promise((t,i)=>{const r=this.getMyDriveRootUrlStream(e);r.results.pipe(Object(n.a)(1)).toPromise().then(e=>{e&&e.userRoot?t(e):i("No/Incomplete data returned.")}),r.initialCompletion.then(e=>{e&&(this.globalErrorHandler.handleCacheObservableError(e,"Evsnp","SiCWx"),e.cacheError&&e.networkError&&i(e))})});this.myDriveRootUrlPromise=t}return this.myDriveRootUrlPromise}getMyDriveRootUrlStream(e=0){if(this.myDriveRootUrlStream)return this.myDriveRootUrlStream;const t=this.cachedRequestService.makeRequest("my-drive-root",this.contextService.sharedContext.graphApiRootRefreshIntervalInSeconds,()=>this.getMyDriveRootUrlInternal("cache-only",e),()=>this.getMyDriveRootUrlInternal("network-first",e),null,e=>{e&&e.httpResponse&&401===e.httpResponse.status||(this.myDriveRootUrlStream=null,this.myDriveRootUrlPromise=null)});return this.myDriveRootUrlStream=t,this.myDriveRootUrlStream}getSiteTitle(t){const i=`${e.sitesEndpoint}${t}`;return this.getGraph("Get_Site_Title_Request",i,"cache-only",null,!0,null,null,null,!1,"json",0).then(e=>{var t;return null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.displayName}).catch(()=>this.getGraph("Get_Site_Title_Request",i,"network-first",null,!0,null,null,null,!1,"json",0).then(e=>{var t;return null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.displayName}))}getSharedItemsWithThumbnails(e){return new Promise((t,i)=>{let n=!0;const r=e.map(e=>{let t=this.vroomService.getSharesUrl(e);return t?t=this.inMockMode?`shares?itemUrl=${encodeURIComponent(t)}&currentDate=${this.dateService.getCurrentDateMinuteGranularity().toISOString()}`:t+"?$expand=thumbnails&$select=id,sharepointIds,parentReference,createdDateTime,shared":n=!1,{eventName:"OneDrive_Graph_Shares_Request",endpoint:t,method:"GET",cacheResult:!0,instrumentCallback:(e,t)=>{if(e.ok){const i=e.data,n=(i&&i.thumbnails?i.thumbnails.length:0).toString();t.params.ItemCount=n}}}});n?this.batchGraph(r,"OneDrive_Graph_Batch_Shares_Request").then(e=>t((e||[]).map(e=>e&&e.ok?e.data:null)),i):i(new u.b(null,"Unable to parse share id"))})}getSharedItemWithThumbnail(e,t,i,n,r,s=!1,o=0){return this.getSharedItemWithParams(e,t,i,c.a.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],r,!0),n,s,o)}getSharedItemWithoutThumbnail(e,t,i,n,r,s="open",o=!1,a=0){return this.getSharedItemWithParams(e,t,i,c.a.getItemParams(["id","sharepointIds","parentReference","createdDateTime"],r,!1,"",s),n,o,a)}getSharedItemWithThumbnailAndIds(e,t,i,n,r,s=!1,o=0){return this.getSharedItemWithParams(e,t,i,c.a.getItemParams(["sharepointIds"],r,!0),n,s,o)}getItemWithWacDataAndThumbnails(e,t,i=!1,n=0){const r=this.getItemLocation(e.driveId,e.docId),s=c.a.getItemParams([],!0,!0);return this.getOneDriveItem("OneDrive_Graph_Item_With_Wac_Data_And_Thumb_Request",`${r}?${s}`,t,null,null,n,i)}getItemWithWacData(e,t,i,n,r="open",s=!1,o=0){const a=this.getItemLocation(t,i),l=c.a.getItemParams([],!0,!1,"",r);return this.getOneDriveItem("OneDrive_Graph_Item_With_Wac_Data_Request",`${a}?${l}`,n,null,null,o,s)}getThumbnailsForItem(e,t,i,n=0){const r=this.getItemLocation(e,t)+"/thumbnails";return"network-first"===i?this.getThumbnails("OneDrive_Graph_Thumbnail_Request",r,"cache-only",n).catch(()=>this.getThumbnails("OneDrive_Graph_Thumbnail_Request",r,"network-first",n)):this.getThumbnails("OneDrive_Graph_Thumbnail_Request",r,i,n)}createNewFile(t,i,n=!1){const s=`${e.myDriveEndpoint}root/children?select=webDavUrl,${n?"openwith,":""}*`,o={name:t,file:{},"@microsoft.graph.conflictBehavior":"rename"};return new Promise((e,t)=>{this.postGraph("OneDrive_Graph_Create_File_Request",s,o,i=>{i.instrument((e,t)=>{if(t.params.RequestId=this.getRequestIdFromResponse(e),e.ok){const i=e.data;i&&i.id&&i.webUrl||(t.params.HttpCode=r.a.UnexpectedResponse.toString())}}).then(i=>{const n=i.data;n&&n.id&&n.webUrl?e(n):t(new u.b(i,"Could not parse drive item from Graph response"))}).catch(e=>{this.globalErrorHandler.handleError(e,"MCFQq")})},e=>{e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()},null,null,null,null,!1,!0,{category:"CreateFile",fileType:i})})}renameFile(t,i,n){let s;s=n?this.getItemLocation(n,i):`${e.myDriveEndpoint}items/${i}`;const o={name:t},a=this.requestConfig;return a.headers.set("Content-Type","application/json"),new Promise((e,t)=>{this.patchGraph("Document_Title_Rename_File",s,JSON.stringify(o),i=>{i.instrument((e,t)=>{if(t.params.RequestId=this.getRequestIdFromResponse(e),e.ok){const i=e.data;i&&i.id&&i.webUrl||(t.params.HttpCode=r.a.UnexpectedResponse.toString())}}).then(i=>{const n=i.data;n&&n.id&&n.webUrl?e(n):t(new u.b(i,"Could not parse drive item from Graph response"))})},e=>{e&&e.httpResponse?t(e.httpResponse.data?{error:{code:""+e.httpResponse.status,data:""+e.httpResponse.data}}:{error:{code:""+e.httpResponse.status}}):t()},a,null,null,null,null,void 0,null)})}uploadFile(t,i,n,r,s,o,a){return new Promise((l,c)=>{t&&t.name||c(new u.b(null,"Invalid file"));const h=this.vroomService.getUploadLocation(e.myDriveEndpoint,t,n,r)+"content?@microsoft.graph.conflictBehavior=rename&select=webDavUrl,*";this.putGraph("OneDrive_Graph_Upload_File_Request",h,t,e=>{e.instrument((e,n)=>this.vroomService.instrumentUploadResponse(e,n,t,i)).then(e=>{const t=e.data;t&&t.id?l(t):c(new u.b(e,"Could not parse drive item from Graph response"))}).catch(e=>{this.globalErrorHandler.handleError(e,"NWgrO")})},c,s,null,o,a)})}createUploadSession(t,i,n,r,s){return new Promise((o,a)=>{t&&t.name||a(new u.b(null,"Invalid file"));const l=this.vroomService.getUploadLocation(e.myDriveEndpoint,t,n,r)+"createUploadSession";this.postGraph("OneDrive_Graph_Create_Upload_Session_Request",l,{item:{"@microsoft.graph.conflictBehavior":"rename"}},e=>{e.instrument((e,n)=>{if(this.vroomService.instrumentUploadResponse(e,n,t,i),e.ok){const t=e.data;n.params.Length=t&&t.uploadUrl?t.uploadUrl.length.toString():"0"}}).then(e=>{const t=e.data;t&&t.uploadUrl?o(t):a(new u.b(e,"Could not parse upload session from Graph response"))}).catch(e=>{this.globalErrorHandler.handleError(e,"Nt3wB")})},a,null,null,s)})}cancelUploadSession(e,t,i){return this.vroomService.cancelUploadSessionInternal(e,t,i,"Graph")}uploadFragment(e,t,i,n,r,s,o,a,l){return this.vroomService.uploadFragment(e,t,i,n,r,s,o,a,l)}getUploadSessionStatus(e,t,i){return this.vroomService.getUploadSessionStatusInternal(e,t,i,"Graph")}getMyDriveRoot(e,t=0){return this.getMyDriveItem("root",e,t)}handleQueryParam(e,t){super.handleQueryParam(e,t),"mockonedrive"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)}getSharedItemWithParams(e,t,i,n,r,l=!1,c=0){return new Promise((h,d)=>{const m=this.vroomService.getSharesUrl(e);if(!m)return void d(new u.b(null,"Unable to parse share id"));const p=this.inMockMode?`shares?itemUrl=${encodeURIComponent(m)}&currentDate=${this.dateService.getCurrentDateMinuteGranularity().toISOString()}`:`${m}${n?"?"+n:""}`,f=n.includes("openwith");this.getOneDriveItem(f?"OneDrive_Graph_Shares_With_Wac_Data_Request":"OneDrive_Graph_Shares_Request",p,r,(n,r)=>{if(n.ok){const e=n.data,t=e?e.thumbnails:null;r.params.ItemCount=(t?t.length:0).toString()}const l=a.a.getLocation(e);if(l&&l.protocol&&l.host){const e=`${l.protocol}//${l.host}`;r.params.ResourceUrl=new s.d(e),r.params.ItemIsShared=(!(e===this.contextService.sharedContext.sharePointResourceId||e===this.contextService.sharedContext.oneDriveResourceId)).toString()}r.params.ItemCategory=o.a.referralFromFileLocation(e),r.params.DocumentType=o.b[t],i&&(r.params.FileFormat=i)},this.batchEnabled,c,l).then(h,d)})}getItemLocation(t,i){return`${e.drivesEndpoint}${encodeURIComponent(t)}/items/${encodeURIComponent(i)}`}getMyDriveItem(t,i,n){return this.getOneDriveItem("OneDrive_Graph_Item_Request",`${e.myDriveEndpoint}${t}`,i,null,!1,n)}getOneDriveItem(e,t,i,n,r=!1,s=0,o=!1){return this.getGraph(e,t,i,(e,t)=>{n&&n(e,t)},!0,null,null,null,r,"json",s,o).then(e=>e.data)}getThumbnails(e,t,i,n=0){const r=this.inMockMode?"thumbnails?itemUrl="+encodeURIComponent(t):t;return this.getGraph(e,r,i,(e,t)=>{if(e.ok){const i=e.data,n=(i&&i.value?i.value.length:0).toString();t.params.ItemCount=n}},!0,null,null,null,!1,"json",n).then(e=>e.data)}getMyDriveRootUrlInternal(e,t){return this.getMyDriveRoot(e,t).then(t=>this.vroomService.getRootUrlsFromRootItem(t,e))}}return e.myDriveEndpoint="me/drive/",e.drivesEndpoint="drives/",e.sitesEndpoint="sites/",e.ɵprov=h.bc({factory:function(){return new e(h.cc(d.a),h.cc(m.a),h.cc(s.a),h.cc(p.a),h.cc(f.a),h.cc(g.a),h.cc(b.q),h.cc(v.b),h.cc(S.a),h.cc(c.a),h.cc(y.a),h.cc(I))},token:e,providedIn:"root"}),e})()},"oAX+":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("GAcG"),r=i("L0Zr"),s=i("PxQI");class o{static createResultsWithCacheObservable(e,t,i,o){let a;const l=new Promise(i=>{a=n.a.create(n=>{let r=null,s=!1,a=null,l=!1,c=!1;const u=()=>{i(a||r?{cacheError:a,networkError:r}:null),n.complete()};e&&e.then(e=>{c=!0,e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!0),n.next(e),s&&u()}).catch(e=>{a=e,l=!0,s&&u()}),t&&t.then(e=>{e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!1),n.next(e),u()}).catch(e=>{r=e,s=!0,o&&o(e),(c||l)&&u()})})});return i&&(a=a.pipe(Object(r.a)(i))),a=a.pipe(Object(s.a)(1)),{results:a,initialCompletion:l}}static createResultsCacheFirstObservable(e,t,i,o,a){let l;const c=new Promise(r=>{l=n.a.create(n=>{let s=null,o=null;const l=()=>{r(o||s?{cacheError:o,networkError:s}:null),n.complete()};e&&e().then(e=>{e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!0),n.next(e),l()}).catch(e=>{o=e,t().then(e=>{e&&e instanceof Object&&void 0===e.fromCache&&(e.fromCache=!1),i(),n.next(e),l()}).catch(e=>{s=e,a&&a(e),l()})})})});return o&&(l=l.pipe(Object(r.a)(o))),l=l.pipe(Object(s.a)(1)),{results:l,initialCompletion:c}}}},p6Zr:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));let n=(()=>{class e{}return e.Calendar="Calendar",e.Excel="ExcelOnline",e.Forms="OfficeForms",e.Mail="Mail",e.OneDrive="Documents",e.OneNote="OneNoteOnline",e.PowerPoint="PowerPointOnline",e.Project="Project",e.SharePoint="Sites",e.Skype="Skype",e.Sway="Sway",e.Visio="VisioOnline",e.Word="WordOnline",e.PowerBI="PowerBIv2",e})()},p6wn:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("lrJm"),r=i("BaAg"),s=i("W3Zz"),o=i("Uqr9"),a=i("hhzZ");class l{constructor(e,t,i,n,r){this.instrumentationService=e,this.streamName=t,this.params=i,this.metrics=n,this.securityThreshold=r}record(){this.instrumentationService.recordEvent(this)}}const c={0:"focused",1:"inspirational",2:"informational",3:"custom"};let u=(()=>{class e{constructor(e,t,i){this.queuedEvents=e,this.dataSecurityService=t,this.deviceDetector=i,this.registeredEventFactories=[],this.initialPage="Unknown",this.serviceWorkerStateService=null,this.lastPageNav={time:0,from:void 0,to:void 0}}registerServiceWorkerStateService(e,t){if(this.serviceWorkerStateService)throw new n.a("DispatcherInstrumentationService.registerServiceWorkerStateService is not allowed to be called more than once");if(!e)throw new n.a("Must specify valid ServiceWorkerStateService when calling DispatcherInstrumentationService.registerServiceWorkerStateService");this.serviceWorkerStateService=e,t&&this.queuedEvents.forEach(e=>e.eventParams.ServiceWorkerState=this.serviceWorkerStateService.currentState)}registerOfficeRouteService(e){if(this.routeSubscriptionInitialized)throw new n.a("DispatcherInstrumentationService.registerOfficeRouteService is not allowed to be called more than once");if(!e)throw new n.a("Must specify valid OfficeRouteService when calling DispatcherInstrumentationService.registerOfficeRouteService");this.routeSubscriptionInitialized=!0,e.subscribeToRouteChangeStart(e=>{const t=!!e.currentRoute&&!!e.currentRoute.route,i=t?`${e.currentRoute.app?r.b[e.currentRoute.app]:""}${e.currentRoute.route}`:"Unknown";this.lastPageNav={time:o.a.now(),from:this.lastPageNav.to,to:i},"Unknown"===this.initialPage&&"Unknown"!==i&&(this.initialPage=i),!this.queuedEventsPopulatedWithRoute&&t&&(this.queuedEvents.forEach(e=>e.eventParams.Page=i),this.queuedEvents.forEach(e=>e.eventParams.InitialPage=this.initialPage),this.queuedEventsPopulatedWithRoute=!0)})}registerEventFactories(e){if(this.registeredEventFactories.length>0)throw new n.a("DispatcherInstrumentationService.registerEventFactories is not allowed to be called more than once");if(!e||0===e.length)throw new n.a("Must specify at least one event factory when calling DispatcherInstrumentationService.registerEventFactories");this.registeredEventFactories=e.slice(),this.drainQueuedEvents()}logGenericEvent(e,t={},i=[],n=0){this.generateEvent(e,"Generic_Event",n,t,i,!0)}logImpressionEvent(e,t={},i=[],n=0){this.generateEvent(e,"Generic_Impression",n,t,i,!0)}logRequestEvent(e,t,i,n,r=!1,s={},o=[],a=0){this.generateRequestEvent(e,t,i,n,r,s,o,a).record()}logClickEvent(t,i,n,r,s,a={},l=[],c=0,u=!1){l=l||[],n&&i&&"Unknown"!==i&&l.push(`${t}.${n}.${i}`),a.ElementId=i,r&&(a.Referral=r,l.push("Referral."+r),a.ReferralPlatform=s&&this.dataSecurityService.securityLevel>=2?s:"Web"),n&&(a.Area=n),u&&this.lastPageNav&&this.lastPageNav.from&&o.a.now()-this.lastPageNav.time<e.lastPageNavTimeout&&(a.Page=this.lastPageNav.from),this.generateEvent(t,"Generic_Click",c,a,l,!0)}logErrorEvent(e,t={},i=[],n=0){this.generateEvent(e,"App_Error",n,t,i,!0)}logPerformanceEvent(e,t,i={},n=0){return i.Latency=t.toString(),this.generateEvent(e,"Performance_Dump",n,i,[],!0)}logDebugCacheEvent(e,t={},i=[],n=0){return this.generateEvent(e,"Generic_Debug_Cache",n,t,i,!0)}applyGlobalStateParams(e,t){window.prelaunchMode&&(e.PrelaunchMode="true"),!t&&e.hasOwnProperty("Page")||(e.Page=this.lastPageNav.to||"Unknown"),!t&&e.hasOwnProperty("InitialPage")||(e.InitialPage=this.initialPage),!t&&e.hasOwnProperty("ServiceWorkerState")||(e.ServiceWorkerState=this.serviceWorkerStateService?this.serviceWorkerStateService.currentState:"Unknown"),!t&&e.hasOwnProperty("AppSecurityLevel")||(e.AppSecurityLevel=this.dataSecurityService.securityLevel.toString()),!t&&e.hasOwnProperty("NetworkType")||(e.NetworkType=s.c[this.deviceDetector.getNetworkInfo()]),window.initialPageLayout&&(e.InitialPageLayout=c[window.initialPageLayout]),window.pageLayout&&(e.CurrentPageLayout=window.pageLayout)}flush(){this.drainQueuedEvents(),this.registeredEventFactories.forEach(e=>e.flush())}recordEvent(e){const t=e&&e.params&&(e.params.EventName&&e.params.EventName.indexOf("Error")>-1||e.params.Error&&"OK"!==e.params.Error);this.dataSecurityService.securityLevel<e.securityThreshold||window.disableLogs&&!t||(this.registeredEventFactories.length>0?this.registeredEventFactories.forEach(t=>t.createEvent(e.streamName,e.params,e.metrics).record()):this.queuedEvents.push({streamName:e.streamName,eventName:e.params.EventName,eventParams:e.params,metrics:e.metrics,securityThreshold:e.securityThreshold}))}generateEvent(e,t,i,n,r=[],s=!1){n.EventName=e,this.applyGlobalStateParams(n,!1);const o=n&&n.Error;o&&"string"==typeof o&&(n.Error=a.a.filterPii(o));const c=n&&n.DebugInfo;c&&"string"==typeof c&&(n.DebugInfo=a.a.filterPii(c)),"Performance_Dump"===t&&void 0!==window.startedFromServiceWorker&&(n.CachedPage=window.startedFromServiceWorker.toString()),"Generic_Click"===t&&(n.ReportingEnabled=window.isMetricsReportingEnabled?window.isMetricsReportingEnabled.toString():"false");const u=new l(this,t,n,r,i);return s&&u.record(),u}generateRequestEvent(e,t,i,n,r=!1,s={},o=[],a=0){return s.HttpCode=t.toString(),s.Latency=i.toString(),s.FromServiceWorkerCache=r.toString(),n&&(s.Error=n),this.generateEvent(e,"Generic_Request",a,s,o)}drainQueuedEvents(){this.queuedEvents&&this.queuedEvents.splice(0,this.queuedEvents.length).forEach(e=>{this.generateEvent(e.eventName,e.streamName,e.securityThreshold,e.eventParams||{},e.metrics,!0)})}}return e.lastPageNavTimeout=1e3,e})()},pOWU:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return o}));var n=i("3GGT"),r=i("pjz5");class s{constructor(e,t){this.httpResponse=e,this.clientError=t}}class o{constructor(e,t,i,n,s,o,a,l,c=""){this.accessTokenService=e,this.instrumentationService=t,this.instrumentedHttp=i,this.tokenConsumer=n,this.contextService=s,this.officeHomeApiConfigService=o,this.scheduler=l,this.rpsCompactAuthHeaderPrefix=c,this.retryIntervalsInMs=[0,11,22,33],this.inMockMode=s.sharedContext.inMockMode,this.mockRequestHeader=o.config.mockRequestHeader,this.queryParams=r.a.getQueryParams(a.search)}static getErrorTypeFromServiceError(e){switch(e&&e.httpResponse&&e.httpResponse.status){case n.a.OK:case n.a.Created:case n.a.NoContent:return"None";case n.a.Unauthorized:case n.a.Forbidden:case n.a.TokenRefreshFailed:case n.a.TokenUnavailable:return"Unauthorized";case n.a.NotFound:return"NotFound";case n.a.RequestTimeout:case n.a.GatewayTimeout:case n.a.Timeout:return"Timeout";case n.a.Offline:return"Offline"}return"Generic"}handleQueryParam(e,t,i){}get(e,t,i,n,r,s,o,a,l,c,u,h=0){"cache-only"===s&&(c="None"),this.scheduler.scheduleWork(()=>this.request(i=>this.instrumentedHttp.get(e,t,i,s,o,a,l),e,i,n,r,c,u,null,"cache-only"===s),h)}getFromCache(e,t,i,n,r={}){this.get(e,t,i,n,r,"cache-only",null,null,null,"None")}post(e,t,i,n,r,s={},o,a,l,c,u,h,d,m,p=!1,f=null,g=0){"cache-only"===m&&(u="None"),this.scheduler.scheduleWork(()=>this.request(n=>this.instrumentedHttp.post(e,t,i,n,o,a,l,c,m),e,n,r,s,u,h,d,!1,p,f),g)}put(e,t,i,n,r,s={},o,a,l,c,u,h){this.request(n=>this.instrumentedHttp.put(e,t,i,n,o,a,l,c),e,n,r,s,u,h)}delete(e,t,i,n,r,s={},o,a,l,c){this.request(n=>this.instrumentedHttp.delete(e,t,i,n,o,a),e,n,r,s,l,c)}patch(e,t,i,n,r,s={},o,a,l,c,u,h){this.request(n=>this.instrumentedHttp.patch(e,t,i,n,o,a,l,c),e,n,r,s,u,h)}isAuthError(e){return 401===e}isRetriableError(e){return!1}getRetryInterval(){const e=Math.floor(1e3*Math.random())%this.retryIntervalsInMs.length;return this.retryIntervalsInMs[e]}getRequestIdFromResponse(e,t="request-id"){return this.getHeaderValue(e.headers,t)}getHeaderValue(e,t){return e&&t&&e.get(t)}updateRequestConfig(e,t,i){t&&t.success&&e&&(this.setAuthHeader(e.headers,t),i&&i(e,t))}setAuthHeader(e,t){t&&e.set("Authorization",`${"RPSCompact"===t.format?this.rpsCompactAuthHeaderPrefix:"Bearer "}${t.token}`.trim())}request(e,t,i,r,o={},a,l,c,u=!1,h=!1,d=null){const m=void 0===a?this.tokenConsumer:a,p="None"===m||"OfficeHome"===m&&!this.officeHomeApiConfigService.config.jwtAuthEnabled,f=e=>{const i=e.status;let o=Number.NaN;!p&&this.isAuthError(i)?o=n.a.TokenRefreshFailed:this.isRetriableError(i)&&(o=n.a.RetryFailed),o!==Number.NaN&&this.logCustomError(t,o,u),r(new s(e))},g=t=>{setTimeout(()=>{const n=e(t);i(n),n.catch(f)},this.getRetryInterval())};for(const e in this.queryParams)if(e&&this.queryParams.hasOwnProperty(e)){const t=this.queryParams[e];this.handleQueryParam(e.toLowerCase(),t,o)}o.headers||(o.headers=new Map),(p?Promise.resolve(null):this.accessTokenService.getAccessToken(m,!1,l,h,d)).then(a=>{if(!p){if(!a||!a.success){const e=a?a.error:"";return this.logCustomError(t,n.a.TokenUnavailable,u,"string"==typeof e?e:""),void r(new s({data:"CAP_Error"===e?e:null,status:n.a.TokenUnavailable,headers:null,config:null,ok:!1,statusText:"Failed to fetch access token",fromCache:!1}))}this.updateRequestConfig(o,a,c)}const h=e(o);i(h),h.catch(t=>{!p&&this.isAuthError(t.status)?this.accessTokenService.getAccessToken(m,!0,l).then(n=>{if(!n.success)return void f(t);this.updateRequestConfig(o,n,c);const r=e(o);i(r),r.catch(f)}):this.isRetriableError(t.status)?g(o):r(new s(t))})})}logCustomError(e,t,i,n=""){this.instrumentationService.logRequestEvent(e,t,-1,n,i)}}},pd4Y:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("/I02");let s=(()=>{class e{constructor(e){this.contextService=e,this.startDate=new Date;const t=this.contextService.sharedContext.dateOverride;t&&(this.mockDate=new Date(t))}getCurrentDate(){if(this.mockDate){const e=(new Date).getTime()-this.startDate.getTime();return new Date(this.mockDate.getTime()+e)}return new Date}getCurrentDateMinuteGranularity(){const e=this.getCurrentDate();return e.setSeconds(0,0),e}getLocalMidnight(){const e=this.getCurrentDate();return e.setHours(0,0,0,0),e}timespanInSeconds(e){return(this.getCurrentDate().getTime()-e.getTime())/1e3}getStartOfYear(){const e=this.getCurrentDate();return new Date(e.getFullYear(),0,0,0,0,0,0)}addDays(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}addHours(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()+t,e.getMinutes(),e.getSeconds(),e.getMilliseconds())}addSeconds(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()+t,e.getMilliseconds())}}return e.DAY=864e5,e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a))},token:e,providedIn:"root"}),e})()},pjz5:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));let n=(()=>{class e{static getHostName(t){const i=e.getLocation(t);return i&&i.hostname||""}static getLocation(t){if(t&&t.length){const i=t.match(e.UrlParserRegex);return i&&{href:t,protocol:i[1],host:i[2],hostname:i[3],port:i[4],path:i[5],search:i[6],hash:i[7]}}return null}static getQueryParams(e){const t={};if(e){const i=e.split("&");for(const e of i){const[i,n]=e.split("=");t[i]=n}}return t}static getOrigin(t){const i=e.getLocation(t);return i&&i.protocol&&i.hostname?i.protocol+"//"+i.hostname:""}}return e.UrlParserRegex=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join("")),e})()},porp:function(e,t,i){},pzhl:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return c}));var n=i("Mlb/"),r=i("vk2e"),s=i("xSeq"),o=(i("PkQn"),i("4/We"),n.wb({encapsulation:2,styles:[],data:{}}));function a(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,2,"span",[],[[8,"id",0],[1,"title",0],[1,"aria-hidden",0]],null,null,null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.xb(2,278528,null,0,r.n,[n.l,n.t,n.D],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.classAttrValue),e(t,2,0,i.styleAttrValue)}),(function(e,t){var i=t.component;e(t,0,0,i.id||"",i.title,!i.ariaVisible)}))}function l(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,"button",[],[[8,"id",0],[8,"title",0],[1,"aria-label",0],[1,"aria-hidden",0],[1,"data-area",0],[1,"data-nav",0]],[[null,"click"]],(function(e,t,i){var n=!0;return"click"===t&&(n=!1!==e.component.handleClick()&&n),n}),null,null)),n.xb(1,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.xb(2,278528,null,0,r.n,[n.l,n.t,n.D],{ngStyle:[0,"ngStyle"]},null),n.xb(3,4210688,null,0,s.a,[n.l,n.h],{focusOnLoad:[0,"focusOnLoad"]},null)],(function(e,t){var i=t.component;e(t,1,0,i.classAttrValue),e(t,2,0,i.styleAttrValue),e(t,3,0,i.focusOnLoad)}),(function(e,t){var i=t.component;e(t,0,0,i.id||"",i.title,i.ariaLabel,!i.ariaVisible,i.dataArea,i.dataNav)}))}function c(e){return n.ac(2,[(e()(),n.hb(16777216,null,null,1,null,a)),n.xb(1,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null),(e()(),n.hb(16777216,null,null,1,null,l)),n.xb(3,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component;e(t,1,0,!i.iconButton),e(t,3,0,i.iconButton)}),null)}},qTBP:function(e,t,i){},qfyf:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("Mlb/").q)("PERFORMANCE_QUEUE")},rBEp:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},re3B:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("W3Zz"),r=i("Mlb/"),s=i("BMb5");let o=(()=>{class e{constructor(e,t){this.windowService=e;const i=t.getDeviceInfo(),r=i.platform.platformType;this.handlePageHide=(r===n.d.iPhone||r===n.d.iPad)&&i.browser.browserType===n.a.Safari}addUnloadEvent(e,t=!1){let i=!1;const n=this.windowService.nativeWindow,r=(n,r)=>{let s=void 0;return t&&r&&(s=r(n)),i||(i=!0,e()),!t&&r&&(s=r(n)),s},s=n.onbeforeunload;if(n.onbeforeunload=e=>r(e,s&&s.bind(n)),this.handlePageHide){const e=n.onpagehide;n.onpagehide=t=>r(t,e&&e.bind(n))}}}return e.ɵprov=r.bc({factory:function(){return new e(r.cc(s.b),r.cc(n.b))},token:e,providedIn:"root"}),e})()},rmEM:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t,i,n,r,s,o,a,l=!1,c=!1,u="Slide",h,d,m,p,f,g){this.items=e,this.showMoreAriaLabel=t,this.showLessAriaLabel=i,this.showMoreUpdateAriaLabel=n,this.showLessUpdateAriaLabel=r,this.initialListItemCount=s,this.maxItemCount=o,this.registerImpression=a,this.bordered=l,this.highlightOnHover=c,this.animationOnLoad=u,this.showMoreText=h,this.showLessText=d,this.initialTileItemCount=m,this.infiniteShowMoreEnabled=p,this.isSmallMobileCards=f,this.isEvenPadding=g,this.initialTileItemCount=this.initialTileItemCount||this.initialListItemCount,this.currentListItemsShown=this.initialListItemCount,this.currentTilesShown=this.initialTileItemCount}onImpression(e,t){this.registerImpression(e,t)}itemsShown(e,t){return Math.min(this.infiniteShowMoreEnabled?t?this.currentTilesShown:this.currentListItemsShown:e?this.maxItemCount:t&&this.initialTileItemCount||this.initialListItemCount,this.items.length)}showMoreVisible(e){const t=e?this.initialTileItemCount:this.initialListItemCount;return!this.maxItemCount&&t<this.items.length||this.items.length>t&&t<this.maxItemCount}infiniteShowMoreEnabledAndVisible(e){return(e?this.currentTilesShown:this.currentListItemsShown)<this.items.length}infiniteShowMore(){this.currentListItemsShown+=this.initialListItemCount,this.currentTilesShown+=this.initialTileItemCount}}},"s+Eq":function(e,t,i){"use strict";i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return l}));var n=i("Mlb/"),r=i("lrJm"),s=i("24t9");class o{}class a{constructor(e){this.templateRef=e}}let l=(()=>{class e{constructor(e,t){this.changeDetectorRef=e,this.contextMenuService=t,this.leftAlignedCard=!1,this.fullWidth=!1,this.toggleDisabled=!1,this.hideContent=!1,this.multiSelect=!1,this.toggleMenu=new n.n,this.selectItem=new n.n,this.focusLink=new n.n}ngOnInit(){this.opened=!1,this.focusActive=!1,this.mobileContextMenu&&this.contextMenuService.subscribeToCloseEvents(e=>{e&&e.menu&&this.menuModel&&e.menu.id===this.menuModel.id&&this.onCloseMenu()}),this.themeEnabled&&this.themeEnabled.subscribe(e=>{this.isThemeEnabled=e})}ngOnDestroy(){this.opened&&this.toggleMenu.emit(!1)}ngAfterViewInit(){if(1!==this.menuItems.length)throw new r.a("Must have exactly 1 *ohpDropdownMenuItemContent in a DropdownMenu as a child");this.menuItemTemplate=this.menuItems.first.templateRef,this.changeDetectorRef.detectChanges()}onToggleMenu(e,t){if(t.preventDefault(),this.toggleDisabled&&!this.fullWidth)return this.opened=!0,void this.toggleMenu.emit(!0);this.opened!==e&&(e||!this.menu?(e&&!this.hideContent&&this.mobileContextMenu&&this.contextMenuService.showMenu({menu:this.menuModel,position:{left:0,top:0},focusFirstItem:this.focusActive}),this.opened=e,this.toggleMenu.emit(e)):this.menu.close())}onSelectItem(e){this.selectItem.emit(e)}onCloseMenu(e){this.opened=!1,(this.focusActive||e)&&this.dropdownLink.nativeElement.focus(),this.focusActive=!1,this.toggleMenu.emit(!1)}handleKey(t){const i=s.a.getKey(t);if(!this.opened)return void(2===i&&(this.focusActive=!0));if(-1===e.expectedKeys.indexOf(i))return;t.preventDefault();const n=this.menuModel.items.length-1;switch(i){case 1:case 2:case 3:this.onToggleMenu(!1,t);break;case 4:this.focusActive=!0,this.menu.setActiveIndex(n,!0);break;case 5:this.focusActive=!0,this.menu.setActiveIndex(0,!0)}}handleFocus(e){this.focusLink.emit(e)}}return e.expectedKeys=[1,2,3,4,5],e})()},tnOy:function(e,t,i){},tuJr:function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return b}));var n=i("Mlb/"),r=i("vk2e"),s=i("RitX"),o=i("mu6k"),a=i("W3Zz"),l=i("hZW2"),c=i("PBJH"),u=i("BMb5"),h=i("g0MB"),d=i("w1PR"),m=(i("s+Eq"),i("5FMq"),n.wb({encapsulation:2,styles:[],data:{}}));function p(e){return n.ac(0,[(e()(),n.hb(0,null,null,0))],null,null)}function f(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),n.hb(16777216,null,null,2,null,p)),n.xb(2,540672,null,0,r.o,[n.O],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),n.Qb(3,{item:0,index:1}),(e()(),n.hb(0,null,null,0))],(function(e,t){var i=t.component,n=e(t,3,0,t.context.item,t.context.index);e(t,2,0,n,i.menuItemTemplate)}),null)}function g(e){return n.ac(0,[(e()(),n.yb(0,0,null,null,4,"ohp-menu",[],null,[[null,"selectItem"],[null,"closeMenu"]],(function(e,t,i){var n=!0,r=e.component;return"selectItem"===t&&(n=!1!==r.onSelectItem(i)&&n),"closeMenu"===t&&(n=!1!==r.onCloseMenu(i)&&n),n}),s.b,s.a)),n.xb(1,4440064,[[2,4]],1,o.a,[a.b,l.a,n.h,c.a,n.D,n.l,u.b],{menuModel:[0,"menuModel"],animateClose:[1,"animateClose"],leftAlignedCard:[2,"leftAlignedCard"],multiSelect:[3,"multiSelect"],contextAriaLabel:[4,"contextAriaLabel"]},{selectItem:"selectItem",closeMenu:"closeMenu"}),n.Tb(603979776,3,{menuItems:1}),(e()(),n.hb(0,null,null,1,null,f)),n.xb(4,16384,[[3,4]],0,o.b,[n.L],null,null)],(function(e,t){var i=t.component;e(t,1,0,i.menuModel,!0,i.leftAlignedCard,i.multiSelect,i.menuModel.linkAriaLabel)}),null)}function b(e){return n.ac(0,[n.Tb(671088640,1,{dropdownLink:0}),n.Tb(671088640,2,{menu:0}),(e()(),n.yb(2,0,null,null,11,"div",[["class","dropdown-menu-wrapper"]],[[8,"id",0]],null,null,null,null)),n.xb(3,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n.Qb(4,{"dropdown-menu-wrapper--relative":0,"dropdown-menu-wrapper--max-width":1}),(e()(),n.yb(5,0,[[1,0],["dropdownLink",1]],null,4,"button",[["aria-haspopup","true"],["data-clicklog","custom"],["keyboardFocusTooltip",""]],[[8,"id",0],[1,"aria-label",0],[1,"aria-expanded",0],[1,"aria-owns",0],[1,"aria-describedby",0],[8,"title",0]],[[null,"click"],[null,"keydown"],[null,"focus"],[null,"blur"]],(function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.onToggleMenu(!r.opened,i)&&n),"keydown"===t&&(n=!1!==r.handleKey(i)&&n),"focus"===t&&(n=!1!==r.handleFocus(!0)&&n),"blur"===t&&(n=!1!==r.handleFocus(!1)&&n),n}),null,null)),n.xb(6,278528,null,0,r.i,[n.s,n.t,n.l,n.D],{ngClass:[0,"ngClass"]},null),n.Ob(7,3),n.xb(8,4210688,null,0,h.a,[n.l,n.D,d.a],null,null),n.Mb(null,0),(e()(),n.yb(10,0,null,null,1,"p",[["class","aria-description"]],[[8,"id",0]],null,null,null,null)),(e()(),n.Xb(11,null,["",""])),(e()(),n.hb(16777216,null,null,1,null,g)),n.xb(13,16384,null,0,r.k,[n.O,n.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var i=t.component,n=e(t,4,0,!i.overridePositioning,i.fullWidth);e(t,3,0,"dropdown-menu-wrapper",n);var r=e(t,7,0,i.menuModel.linkCssClass,i.isThemeEnabled&&i.menuModel.themeCssClass&&!i.opened?i.menuModel.themeCssClass:"",i.opened&&i.menuModel.openCssClass?i.menuModel.openCssClass:"");e(t,6,0,r),e(t,13,0,i.opened&&!i.mobileContextMenu&&!i.hideContent)}),(function(e,t){var i=t.component;e(t,2,0,n.Fb(1,"",i.menuModel.id,"-dropdown-wrapper")),e(t,5,0,n.Fb(1,"",i.menuModel.id+"-dropdown-link",""),i.menuModel.linkAriaLabel,i.opened?"true":"false",i.opened?i.menuModel.id+"-dropdown":null,i.menuModel.id+"-button-description",i.menuModel.linkTooltip||""),e(t,10,0,n.Fb(1,"",i.menuModel.id+"-button-description","")),e(t,11,0,i.menuModel.linkAriaDescription)}))}},"uH9+":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("pd4Y");let s=(()=>{class e{constructor(e){this.dateService=e}getTimestampType(e){const t=this.dateService.timespanInSeconds(e),i=this.dateService.getLocalMidnight(),n=this.dateService.addDays(i,-1),r=this.dateService.addDays(i,-6),s=this.dateService.getStartOfYear();return t>=-3300&&t<-60?9:t<0?0:t<120?1:t<3600?2:e>=i?3:e>=n?4:e>=r?5:e>=s?6:7}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a))},token:e,providedIn:"root"}),e})()},uNUv:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("BaAg"),r=i("kfAr"),s=i("Mlb/"),o=i("hhzZ"),a=i("QOOv");let l=(()=>{class e{constructor(e,t){this.instrumentationService=e,this.mruConfigService=t,this.recordedThumbnails=new Set}instrumentThumbnailLoad(e,t,i,n,s){if(!this.mruConfigService.config.logThumbnailLoadSuccess||this.recordedThumbnails.has(t)||!r.a.thumbnailFileTypes.has(s))return;const o=this.getInstrumentationParams(e?"Success":"Failed",i,n,s);this.instrumentationService.logGenericEvent("Thumbnail_Load",o),this.recordedThumbnails.add(t)}getInstrumentationParams(e,t,i,r){const s={};return s.State=e,s.ItemCategory=t,s.Index=i.toString(),s.DocumentType=n.b[r],s}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(o.a),s.cc(a.a))},token:e,providedIn:"root"}),e})()},uUrA:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Uqr9");class r{static createGuid(){let e=n.a.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}))}}},up2P:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},upmJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},uzn7:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("XV2T"),r=i("BMb5"),s=i("Mlb/"),o=i("hhzZ"),a=i("cgnd");let l=(()=>{class e extends n.a{constructor(e,t,i){try{super(t.config.puid,i.getStorage(r.a.LocalStorage)),i.isStorageAvailable(r.a.LocalStorage)||e.logGenericEvent("Local_Storage_Unavailable")}catch(e){}}}return e.ɵprov=s.bc({factory:function(){return new e(s.cc(o.a),s.cc(a.b),s.cc(r.b))},token:e,providedIn:"root"}),e})()},v3sZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("dFxn");let s=(()=>{class e{constructor(e){this.config=e.parse("oneNoteConfig")||{oneNoteApiPath:null,enableOneNoteApis:!1}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a))},token:e,providedIn:"root"}),e})()},vW6f:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));let n=new(i("Mlb/").q)("ShellHeight")},w1PR:function(e,t,i){"use strict";i.d(t,"a",(function(){return M}));var n=i("bb6g"),r=i("jV/k"),s=i("59BC"),o=i("GAcG"),a=i("fRG8"),l=i("PxQI"),c=i("O6Zd"),u=i("S5zL"),h=i("RT4L"),d=i("Y8if"),m=i("70cc"),p=function(e){return e[e.Darker=0]="Darker",e[e.Dark=1]="Dark",e[e.DarkAlt=2]="DarkAlt",e[e.Primary=3]="Primary",e[e.Secondary=4]="Secondary",e[e.Tertiary=5]="Tertiary",e[e.Light=6]="Light",e[e.Lighter=7]="Lighter",e[e.LighterAlt=8]="LighterAlt",e}({}),f=function(e){return e[e.White=0]="White",e[e.NeutralLighterAlt=1]="NeutralLighterAlt",e[e.NeutralLight=2]="NeutralLight",e[e.NeutralTertiaryAlt=3]="NeutralTertiaryAlt",e[e.NeutralSecondary=4]="NeutralSecondary",e[e.NeutralPrimary=5]="NeutralPrimary",e[e.NeutralDark=6]="NeutralDark",e[e.Black=7]="Black",e[e.Gray40=8]="Gray40",e[e.Gray50=9]="Gray50",e}({}),g=i("BaAg"),b=i("cgnd"),v=i("Mlb/"),S=i("hZW2"),y=i("7Gwk"),w=i("4/We"),C=i("dFxn"),I=i("/I02"),T=i("JH4S"),k=i("Z0U4"),E=i("PBJH"),A=i("BMb5"),P=i("5aVq"),x=i("Ax7d"),D=i("R4AA");let M=(()=>{class e{constructor(t,i,o,p,f,b,v,S,y,w,C,I,T,k){this.documentService=t,this.eventService=i,this.capabilitiesService=o,this.clientStartupService=f,this.contextService=b,this.userContext=v,this.routeService=S,this.locService=y,this.windowService=w,this.ngZone=C,this.shellShimService=I,this.webPwaService=T,this.ntpService=k,this.capabilitiesService.capabilities.antpLoaded&&(this.windowService.nativeWindow.darkTheme={IsDarkMode:!0,ThemeType:"User",ThemeId:"dark-mode",NavBar:"#1B1A19",Accent:"#F7894A",Dark:"#F7894A",Darker:"#F7894A",DarkAlt:"#F7894A",Primary:"#F7894A",Secondary:"#F7894A",Tertiary:"#F7894A",Light:"#F7894A",Lighter:"#F7894A",LighterAlt:"#F7894A"},this.windowService.nativeWindow.addEventListener("AntpThemeChangeEvent",()=>{const e=this.getUserTheme();this.eventService.broadcastEvent({name:"themeChanged",args:[e.reactShellTheme,!0]})})),this.reactShellEnabled=o.capabilities.reactShellEnabled,this.isPWA=o.capabilities.pwaEnabled,this.themeShadeClassPostfixes=new Map,this.grayscaleThemeShadeClassPostfixes=new Map,this.supportedAppThemes=new Map,this.nativeDocument=this.documentService.nativeDocument,this.currentRouteApp=g.b.Unknown,this.currentGrayscaleThemeShades=e.grayscaleThemeShades;const E=this.createThemeChangeObservable();this.themeConfig=p.parse("themeConfig"),this.initializeUserTheme();const A=this.getStartingTheme();this.themeShades=Object(r.a)(A).pipe(Object(a.a)(E),Object(l.a)(1)),this.darkModeSubscription=Object(s.a)(this.themeShades,this.routeService.getRouteChangeEndObservable()).pipe(Object(c.a)(([e,t])=>e.theme.reactShellTheme.IsDarkMode&&("OfficeHome"===t.currentRoute.route||"Pwa"===t.currentRoute.route||"AppGallery"===t.currentRoute.route))),this.processedInitialPageLoad=!1,this.displayedAppTheme=g.b.Unknown,this.initializeActiveThemeUtilities(),A.userSelected||this.changeAppThemeReact(A.theme.shades,!1),(o.capabilities.wacStartPageEnabled||o.capabilities.fluidHostEnabled||o.capabilities.fluidHostCreateEnabled)&&(this.initializeAppThemeChangeHandler(),this.shellShimService.afterShellRendered.then(()=>{const t=this.nativeDocument.querySelector(e.shellHeaderLinkSelector),i=this.nativeDocument.querySelector(e.shellBrandingTextSelector);this.homepageHeaderUrl=t?t.getAttribute("href"):"",this.homepageHeaderText=i?i.textContent:"";const n=this.themeConfig.appPageTypeOnLoad&&g.a.fileTypeNameToFileType(this.themeConfig.appPageTypeOnLoad)||this.currentRouteApp;n!==g.b.Unknown&&this.changeShell(n),this.processedInitialPageLoad=!0}));const P=this.routeService.getRouteChangeEndObservable().pipe(Object(c.a)(e=>!!e.currentRoute&&!(this.capabilitiesService.capabilities.leftNavReact||this.capabilitiesService.capabilities.leftNavReactSquares||"OfficeHome"!==e.currentRoute.route&&"Pwa"!==e.currentRoute.route)),Object(u.a)());P.pipe(Object(h.a)(1)).subscribe(e=>Object(n.b)(this,void 0,void 0,(function*(){const t=yield this.shellShimService.getShellShim();t&&t.Theme&&t.Theme.SetFullBleedEnabled&&t.Theme.SetFullBleedEnabled(e)})));const x=this.themeShades.pipe(Object(u.a)());this._fullBleedTheming=Object(s.a)(x,P).pipe(Object(c.a)(([e,t])=>({shouldFullBleed:this.determineFullBleedTheming(e)&&t,bleedColor:this.getNavBarColor(e),bleedFontColor:this.getBleedFontColor(e),themeData:e}))).pipe(Object(l.a)()).pipe(Object(d.a)({shouldFullBleed:!1,bleedColor:this.getNavBarColor(A),bleedFontColor:this.getBleedFontColor(A),themeData:A})),this.capabilitiesService.capabilities.backplateThemingEnabled&&(this._backplatesEnabledObservable=Object(s.a)(x,P).pipe(Object(c.a)(([e,t])=>t&&this.backplateThemingEnabled(e.theme)))),Object(s.a)(x,this.webPwaService.isStandalone).pipe(Object(m.a)(([e,t])=>t)).subscribe(([e])=>{this.webPwaService.isOfficeApp()&&this.documentService.updateThemeColor(this.getNavBarColor(e))})}get fullBleedTheming(){return this._fullBleedTheming}get backplatesTheming(){return this._backplatesEnabledObservable}getEduHeaderImageForWidth(e,t){return t>=1366?e[1920]:t>=1024?e[1366]:t>=640?e[1024]:e[640]}createThemeChangeObservable(){return o.a.create(t=>{this.eventService.events.withScope(0).pipe(Object(m.a)(e=>"themeChanged"===e.name&&!!e.args)).subscribe(i=>{const n=i.args;if(this.reactShellEnabled){let i=n[0];i.IsDarkMode?(this.capabilitiesService.capabilities.darkThemeEnabled||(i=this.windowService.nativeWindow.darkTheme),this.currentGrayscaleThemeShades=e.grayscaleThemeShadesDark,this.capabilitiesService.capabilities.spaceModeEnabled&&(i=this.windowService.nativeWindow.spaceTheme)):(this.currentGrayscaleThemeShades=e.grayscaleThemeShades,this.capabilitiesService.capabilities.backplateThemingEnabled&&i.ThemeId&&"base"===i.ThemeId.toLowerCase()&&i.ThemeType&&"tenant"===i.ThemeType.toLowerCase()&&(i=this.windowService.nativeWindow.backplateTheme));const r=[i.Darker||i.Primary,i.Dark||i.Primary,i.DarkAlt||i.Primary,i.Primary||i.Primary,i.Secondary||i.Primary,i.Tertiary||i.Primary,i.Light||i.Primary,i.Lighter||i.Primary,i.LighterAlt||i.Primary];this.ngZone.run(()=>t.next({theme:{shades:r,reactShellTheme:i,themeType:i.ThemeType,themeId:i.ThemeId},userSelected:n[1]}))}else{const e=n[0];e&&e.forEach((t,i)=>{t&&"#"!==t[0]&&(e[i]="#"+t)}),this.ngZone.run(()=>t.next({theme:{shades:e,reactShellTheme:null,themeType:"Default",themeId:n[2]},userSelected:n[1]||!1}))}})})}getNavBarColor(e){const t=e.theme.reactShellTheme;return t?t.NavBar||t.Primary:e.theme.shades[p.Primary]}getBleedFontColor(e){const t=e.theme.reactShellTheme;return t&&t.DefaultText?t.DefaultText:"#FFFFFF"}determineFullBleedTheming(e){return!(this.capabilitiesService.capabilities.leftNavReact||this.capabilitiesService.capabilities.leftNavReactSquares)&&e.theme.reactShellTheme&&null!=e.theme.reactShellTheme.FullBleedImages}changeShell(e){this.changeShellAppTheme(e),this.changeShellAppHeader(e),this.changeShellHelpPane(e)}backplateThemingEnabled(e){return this.capabilitiesService.capabilities.backplateThemingEnabled&&e&&e.themeId&&"base"===e.themeId.toLowerCase()&&e.themeType&&"tenant"===e.themeType.toLowerCase()}changeShellAppTheme(t,i=!1){return Object(n.b)(this,void 0,void 0,(function*(){if(!this.supportedAppThemes.has(t)||t===this.displayedAppTheme&&!i)return;let n=this.supportedAppThemes.get(t);if(!t&&this.backplateThemingEnabled(this.userTheme)&&(n=this.windowService.nativeWindow.backplateTheme),!n.theme)return;const r=this.getThemeShades(n.theme);let s;this.reactShellEnabled?(t!==this.displayedAppTheme&&this.changeAppThemeReact(r,!1),(yield this.shellShimService.getShellShim()).Theme.SetAppBrandTheme(n.theme)):(this.documentService.addOrUpdateStylesheet(n.themeCssUrl,"ohpAppTheme"),this.shouldChangeShellTheme()?(this.documentService.addCssClassToElement(this.nativeDocument.body,"ohpAppTheme"),this.documentService.addCssClassToElement(this.nativeDocument.getElementById(e.shellLauncherId),"animate"),this.documentService.addCssClassToElement(this.nativeDocument.getElementById(e.shellNavHeaderId),"animate"),this.documentService.addCssClassToElement(this.nativeDocument.getElementById(e.shellTopMenuId),"animate")):(this.documentService.removeCssClassFromElement(this.nativeDocument.body,"ohpAppTheme"),this.documentService.addCssClassToElement(this.nativeDocument.getElementById("officeHomeRoot"),"ohpAppTheme")),this.generateActiveThemeCss(r,!1)),s=this.reactShellEnabled?[n.theme,!1]:[r,!1,g.b[t]+"_theme"],this.eventService.broadcastEvent({name:"themeChanged",args:s}),this.displayedAppTheme=t}))}darkMode(e){const t=e?this.windowService.nativeWindow.spaceTheme:this.windowService.nativeWindow.darkTheme;return{shades:this.getThemeShades(t),reactShellTheme:t,themeType:"App",themeId:this.windowService.nativeWindow.darkTheme.ThemeId}}changeShellAppHeader(t){if(!this.supportedAppThemes.has(t))return;const i=this.supportedAppThemes.get(t);if(this.reactShellEnabled)return void this.updateShellHeader(i.headerText);const n=this.nativeDocument.querySelector(e.shellHeaderLinkSelector),r=this.nativeDocument.querySelector(e.shellBrandingTextSelector);n&&r&&(n.setAttribute("href",i.headerUrl),r.textContent=i.headerText)}changeShellHelpPane(e){return Object(n.b)(this,void 0,void 0,(function*(){if(!this.reactShellEnabled||!this.supportedAppThemes.has(e))return;const t=this.supportedAppThemes.get(e);t.helpPaneNamespace&&(yield this.shellShimService.getShellShim()).NFD.UpdateHelpNamespace(t.helpPaneNamespace)}))}resetShellHelpPane(){return Object(n.b)(this,void 0,void 0,(function*(){if(!this.reactShellEnabled)return;let e="";e=this.isPWA?this.clientStartupService.config.authType===b.a.OrgId?"IWPWA":"MSAPWA":this.clientStartupService.config.authType===b.a.OrgId?"IWAPP":"IWAPPC",(yield this.shellShimService.getShellShim()).NFD.UpdateHelpNamespace(e)}))}resetShellTheme(){return Object(n.b)(this,void 0,void 0,(function*(){if(this.displayedAppTheme===g.b.Unknown)return;let t;this.reactShellEnabled?(this.clientStartupService.config.authType===b.a.MSA&&this.changeAppThemeReact(this.userTheme.shades),(yield this.shellShimService.getShellShim()).Theme.SetAppBrandTheme(this.windowService.nativeWindow.commercialDefaultTheme)):(this.documentService.removeCssClassFromElement(this.nativeDocument.body,"ohpAppTheme"),this.documentService.removeCssClassFromElement(this.nativeDocument.getElementById("officeHomeRoot"),"ohpAppTheme"),this.documentService.removeCssClassFromElement(this.nativeDocument.getElementById(e.shellLauncherId),"animate"),this.documentService.removeCssClassFromElement(this.nativeDocument.getElementById(e.shellNavHeaderId),"animate"),this.documentService.removeCssClassFromElement(this.nativeDocument.getElementById(e.shellTopMenuId),"animate")),t=this.reactShellEnabled?[this.userTheme.reactShellTheme,!1]:[this.userTheme.shades,!1,this.userTheme.themeId],this.eventService.broadcastEvent({name:"themeChanged",args:t}),this.displayedAppTheme=g.b.Unknown}))}resetShellHeader(){return Object(n.b)(this,void 0,void 0,(function*(){if(this.reactShellEnabled)this.updateShellHeader(this.isPWA&&"Tenant"!==this.userTheme.themeType?"":this.themeConfig.homePageTitle);else{const t=this.nativeDocument.querySelector(e.shellBrandingTextSelector);t&&(t.textContent=this.homepageHeaderText);const i=this.nativeDocument.querySelector(e.shellHeaderLinkSelector);i&&i.setAttribute("href",this.homepageHeaderUrl)}}))}resetShell(){return Object(n.b)(this,void 0,void 0,(function*(){this.resetShellTheme(),this.resetShellHeader(),this.resetShellHelpPane()}))}initializeActiveThemeUtilities(){this.themeShadeClassPostfixes.set(p.Darker,"tdr"),this.themeShadeClassPostfixes.set(p.Dark,"td"),this.themeShadeClassPostfixes.set(p.DarkAlt,"tda"),this.themeShadeClassPostfixes.set(p.Primary,"tp"),this.themeShadeClassPostfixes.set(p.Secondary,"ts"),this.themeShadeClassPostfixes.set(p.Tertiary,"tt"),this.themeShadeClassPostfixes.set(p.Light,"tl"),this.themeShadeClassPostfixes.set(p.Lighter,"tlr"),this.themeShadeClassPostfixes.set(p.LighterAlt,"tlra"),this.grayscaleThemeShadeClassPostfixes.set(f.White,"w"),this.grayscaleThemeShadeClassPostfixes.set(f.NeutralLighterAlt,"nla"),this.grayscaleThemeShadeClassPostfixes.set(f.NeutralLight,"nl"),this.grayscaleThemeShadeClassPostfixes.set(f.NeutralTertiaryAlt,"nta"),this.grayscaleThemeShadeClassPostfixes.set(f.NeutralSecondary,"ns"),this.grayscaleThemeShadeClassPostfixes.set(f.NeutralPrimary,"np"),this.grayscaleThemeShadeClassPostfixes.set(f.NeutralDark,"nd"),this.grayscaleThemeShadeClassPostfixes.set(f.Black,"bl"),this.grayscaleThemeShadeClassPostfixes.set(f.Gray40,"g40"),this.grayscaleThemeShadeClassPostfixes.set(f.Gray50,"g50"),this.themeShades.subscribe(e=>{e.userSelected&&(this.userTheme=e.theme,!this.reactShellEnabled&&this.currentRouteApp!==g.b.Unknown&&this.themeConfig.defaultUserThemeSelected&&this.changeShellAppTheme(this.currentRouteApp,!0),!this.reactShellEnabled||this.currentRouteApp===g.b.Unknown||this.currentRouteApp!==g.b.FluidActivityBlueprint&&this.currentRouteApp!==g.b.Fluid||this.changeAppThemeReact(this.userTheme.shades,!1),this.currentRouteApp===g.b.Unknown)&&(this.reactShellEnabled?(this.isPWA&&this.updateShellHeader("Tenant"!==this.userTheme.themeType?"":this.themeConfig.homePageTitle),this.changeAppThemeReact(this.userTheme.shades,!("Search"===this.currentPage||"Start"===this.currentPage||"Templates"===this.currentPage))):this.generateActiveThemeCss(e.theme.shades,!0))})}initializeAppThemeChangeHandler(){this.routeService.getRouteChangeStartObservable().pipe(Object(m.a)(e=>{var t;return this.capabilitiesService.capabilities.wacHeaderDisabled||e.currentRoute&&"Content"!==e.currentRoute.route||"Content"===(null===(t=e.currentRoute)||void 0===t?void 0:t.route)&&(e.currentRoute.app===g.b.Fluid||e.currentRoute.app===g.b.FluidActivityBlueprint)})).subscribe(e=>{this.currentRouteApp=e.currentRoute&&e.currentRoute.app?e.currentRoute.app:g.b.Unknown,this.currentPage=e.currentRoute.route,this.processedInitialPageLoad&&(this.currentRouteApp===g.b.Fluid||this.currentRouteApp===g.b.FluidActivityBlueprint?(this.resetShellTheme(),this.resetShellHeader(),this.changeShellHelpPane(this.currentRouteApp),this.changeAppThemeReact(this.userTheme.shades,!1)):this.currentRouteApp?this.changeShell(this.currentRouteApp):(this.resetShell(),this.capabilitiesService.capabilities.darkModeEnabled&&this.changeAppThemeReact(this.userTheme.shades,!("Search"===this.currentPage||"Start"===this.currentPage||"Templates"===this.currentPage))))})}initializeUserTheme(){const t=this.themeConfig;this.supportedAppThemes.set(g.b.Word,{themeCssUrl:t.wordThemeCssPath,theme:this.configThemeShadesToTheme(t.wordThemeShades),headerText:this.locService.WordName,headerUrl:t.wordShellUrl,helpPaneNamespace:"WDWAENDUSER"}),this.supportedAppThemes.set(g.b.Excel,{themeCssUrl:t.excelThemeCssPath,theme:this.configThemeShadesToTheme(t.excelThemeShades),headerText:this.locService.ExcelName,headerUrl:t.excelShellUrl,helpPaneNamespace:"XLWAENDUSER"}),this.supportedAppThemes.set(g.b.PowerPoint,{themeCssUrl:t.powerpointThemeCssPath,theme:this.configThemeShadesToTheme(t.powerpointThemeShades),headerText:this.locService.PowerPointName,headerUrl:t.powerpointShellUrl,helpPaneNamespace:"PPWAENDUSER"}),this.supportedAppThemes.set(g.b.Sway,{themeCssUrl:t.swayThemeCssPath,theme:this.configThemeShadesToTheme(t.swayThemeShades),headerText:this.locService.SwayName,headerUrl:t.swayShellUrl,helpPaneNamespace:"STORYIM"}),this.supportedAppThemes.set(g.b.OneNote,{themeCssUrl:t.onenoteThemeCssPath,theme:this.configThemeShadesToTheme(t.onenoteThemeShades),headerText:this.locService.OneNoteName,headerUrl:t.onenoteShellUrl,helpPaneNamespace:"ONWAENDUSER"}),this.supportedAppThemes.set(g.b.Forms,{themeCssUrl:t.formsThemeCssPath,theme:this.configThemeShadesToTheme(t.formsThemeShades),headerText:"Forms",headerUrl:t.formsShellUrl,helpPaneNamespace:"FWAENDUSER"}),this.supportedAppThemes.set(g.b.Visio,{themeCssUrl:t.visioThemeCssPath,theme:this.configThemeShadesToTheme(t.visioThemeShades),headerText:this.locService.VisioName,headerUrl:t.visioShellUrl,helpPaneNamespace:"VIWAENDUSER"}),this.supportedAppThemes.set(g.b.Fluid,{themeCssUrl:null,theme:null,headerText:t.homePageTitle,headerUrl:t.homePageUrl,helpPaneNamespace:"IWAPP"}),this.supportedAppThemes.set(g.b.FluidActivityBlueprint,{themeCssUrl:null,theme:null,headerText:t.homePageTitle,headerUrl:t.homePageUrl,helpPaneNamespace:"IWAPP"}),this.userTheme=this.getUserTheme(),this.userTheme.reactShellTheme&&this.userTheme.reactShellTheme.IsDarkMode&&(this.currentGrayscaleThemeShades=e.grayscaleThemeShadesDark)}configThemeShadesToTheme(e){return this.getAppBrandTheme(e.map(e=>"#"+e))}getUserTheme(){const e=this.themeConfig;if(this.reactShellEnabled){const t=this.capabilitiesService.capabilities.spaceModeEnabled;if(this.capabilitiesService.capabilities.antpLoaded){if(this.ntpService.isDarkMode())return this.darkMode(!1)}else if(this.capabilitiesService.capabilities.darkModeEnabled||t)if(this.isPWA&&this.capabilitiesService.capabilities.isPwaInUwp){const e=(new Windows.UI.ViewManagement.UISettings).getColorValue(Windows.UI.ViewManagement.UIColorType.background);if(255===e.a&&0===e.b&&0===e.g&&0===e.r)return this.darkMode(t)}else if(e.isDarkMode||this.capabilitiesService.capabilities.darkModeOverride)return this.darkMode(t);if(e.preferOfficeTheme){const e=this.windowService.nativeWindow.commercialDefaultTheme;return{shades:this.getThemeShades(e),reactShellTheme:e,themeType:"App",themeId:this.userContext.user.themeId}}{const e=(this.themeConfig&&this.themeConfig.userThemeShades||[]).map(e=>"#"+e);return{shades:e,reactShellTheme:Object.assign(Object.assign({},this.windowService.nativeWindow.commercialDefaultTheme),this.getAppBrandTheme(e)),themeType:this.themeConfig.useTenantTheme?"Tenant":"User",themeId:this.userContext.user.themeId}}}{const e=this.themeConfig.defaultUserThemeSelected?"Default":this.themeConfig.useTenantTheme?"Tenant":"User";return{shades:(this.themeConfig&&this.themeConfig.userThemeShades||[]).map(e=>"#"+e),reactShellTheme:null,themeType:e,themeId:this.userContext.user.themeId}}}getStartingTheme(){const e=this.themeConfig.appPageTypeOnLoad;if(!e&&this.backplateThemingEnabled(this.userTheme))return{theme:{shades:this.getThemeShades(window.backplateTheme),reactShellTheme:this.windowService.nativeWindow.backplateTheme,themeType:"Tenant",themeId:"base"},userSelected:!0};if(e&&this.reactShellEnabled){const t=g.a.fileTypeNameToFileType(e);if(this.supportedAppThemes.has(t)){const e=this.supportedAppThemes.get(t).theme;if(e){const t=this.getThemeShades(e);return{theme:{shades:t,reactShellTheme:Object.assign(Object.assign({},this.windowService.nativeWindow.commercialDefaultTheme),this.getAppBrandTheme(t)),themeType:"App",themeId:this.userContext.user.themeId},userSelected:!1}}}}return{theme:this.userTheme,userSelected:!0}}generateActiveThemeCss(t,i){if(!t||9!==t.length)return;const n=(t,n)=>`${i?"":".ohpAppTheme "}${e.activeThemeParentSelector} .ms-fcl-${t}-a:active{color:${n}}${i?"":".ohpAppTheme "}${e.activeThemeParentSelector} .ms-bgc-${t}-a:active{background-color:${n}}${i?"":".ohpAppTheme "}${e.activeThemeParentSelector} .ms-bcl-${t}-a:active{border-color:${n}}`,r=this.currentGrayscaleThemeShades.reduce((e,t,i)=>{const r=this.grayscaleThemeShadeClassPostfixes.get(i);return`${e}${n(r,t)}`},""),s=t.reduce((e,t,i)=>{const r=this.themeShadeClassPostfixes.get(i);return`${e}${n(r,t)}`},r);this.documentService.addOrUpdateStyleTag(i?e.activeThemeCssId:e.activeAppThemeCssId,s)}changeAppThemeReact(t,i=!0){if(!t||9!==t.length)return;const n=(t,i)=>{let n="";for(let r=0;r<e.themeProperties.length;r++){const s=e.themeProperties[r];let o=s.propName;this.contextService.isRtl&&(o=o.replace(/(left|right)/g,e=>"left"===e?"right":"left")),n+=`.ohpAppTheme .ms-${s.className}-${t}{${o}:${i}}`;for(let r=0;r<e.themeSelectorPostfixes.length;r++)n+=`.ohpAppTheme .ms-${s.className}-${t}-${e.themeSelectorPostfixes[r]}{${o}:${i}}`}return n},r=(this.capabilitiesService.capabilities.darkModeEnabled&&this.userTheme.reactShellTheme&&this.userTheme.reactShellTheme.IsDarkMode&&i?e.grayscaleThemeShadesDark:e.grayscaleThemeShades).reduce((e,t,i)=>{const r=this.grayscaleThemeShadeClassPostfixes.get(i);return`${e}${n(r,t)}`},""),s=t.reduce((e,t,i)=>{const r=this.themeShadeClassPostfixes.get(i);return`${e}${n(r,t)}`},r);this.documentService.addOrUpdateStyleTag("ohp-app-theme",s)}shouldChangeShellTheme(){return this.reactShellEnabled?"Default"===this.userTheme.reactShellTheme.ThemeType||this.userTheme.reactShellTheme.PreferOfficeTheme:this.themeConfig.defaultUserThemeSelected&&this.userTheme.themeId&&"base"===this.userTheme.themeId.toLowerCase()}getAppBrandTheme(e){return{Darker:e[0],Dark:e[1],DarkAlt:e[2],Primary:e[3],Secondary:e[4],Tertiary:e[5],Light:e[6],Lighter:e[7],LighterAlt:e[8]}}getThemeShades(e){return[e.Darker,e.Dark,e.DarkAlt,e.Primary,e.Secondary,e.Tertiary,e.Light,e.Lighter,e.LighterAlt]}updateShellHeader(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=yield this.shellShimService.getShellShim();t&&t.Header.UpdateHeaderLink(e,null)}))}}return e.eduThemeBackplateOverrides={backpack:{"background-color":"rgba(255, 179, 221, 0.9)"},unicorn:{"background-color":"rgba(72, 117, 46, 0.9)",color:"#FFFFFF"}},e.activeThemeCssId="activeThemeCss",e.activeAppThemeCssId="activeAppThemeCss",e.activeThemeParentSelector=".o365cs-base.o365cst",e.themeProperties=[{className:"fcl",propName:"color"},{className:"bgc",propName:"background-color"},{className:"bcl",propName:"border-color"},{className:"bclt",propName:"border-top-color"},{className:"bclb",propName:"border-bottom-color"},{className:"bclr",propName:"border-right-color"}],e.themeSelectorPostfixes=["f:focus","h:hover","a:active","af:after"],e.grayscaleThemeShades=["#ffffff","#FAF9F8","#EDEBE9","#C8C6C4","#605E5C","#323130","#252423","#000000","#E1DFDD","#D2D0CE"],e.grayscaleThemeShadesDark=["#252423","#1B1A19","#323130","#484644","#B3B0AD","#D2D0CE","#E9E8E8","#FFFFFF","#323130","#3B3A39"],e.shellBrandingTextSelector="a > .o365cs-nav-brandingText",e.shellHeaderLinkSelector="a.o365cs-nav-bposLogo",e.shellTopMenuId="O365_TopMenu",e.shellNavHeaderId="O365_NavHeader",e.shellLauncherId="O365_MainLink_NavMenu",e.ɵprov=v.bc({factory:function(){return new e(v.cc(S.a),v.cc(y.a),v.cc(w.a),v.cc(C.a),v.cc(b.b),v.cc(I.a),v.cc(T.a),v.cc(k.a),v.cc(E.a),v.cc(A.b),v.cc(v.z),v.cc(P.a),v.cc(x.a),v.cc(D.a))},token:e,providedIn:"root"}),e})()},wwmn:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mlb/"),r=i("dFxn");let s=(()=>{class e{constructor(e){this.config=e.parse("officeHomeApiConfig")||{authTypeHeader:null,correlationIdHeader:null,defaultTimeoutInMs:3e5,externalTrafficHeader:null,featureOverrides:null,featureOverridesParamName:null,flightOverrides:null,flightOverridesParamName:null,jwtAuthEnabled:!1,mockRequestHeader:null,tenantIdHeader:null,testTrafficHeader:null,userIdHeader:null,workloadQueryParameter:null}}}return e.ɵprov=n.bc({factory:function(){return new e(n.cc(r.a))},token:e,providedIn:"root"}),e})()},"x+6c":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},xIlw:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}},xSeq:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t){this.elementRef=e,this.changeDetectorRef=t}ngAfterViewInit(){this.focusOnLoad&&(this.elementRef.nativeElement.focus(),this.detectChanges&&this.changeDetectorRef.detectChanges())}}},xoWf:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}}});
//# sourceMappingURL=antp-bundle-91b22f98516fa471e258.js.map